# TASK-005: Внедрение дашборда сектора 1С

**Дата создания:** 2025-12-06 11:18 (UTC+3, Брест)  
**Статус:** Новая  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vue.js)

---

## Описание

Внедрить интерактивный дашборд для управления тикетами сектора 1С. Дашборд должен отображаться после нажатия на кнопку отчёта со стартовой страницы (`IndexPage.vue`). 

Дашборд реализует Kanban-подход с тремя этапами обработки тикетов:
1. **Сформировано обращение** (синий акцент)
2. **Рассмотрение ТЗ** (жёлтый акцент)
3. **Исполнение** (зелёный акцент)

Каждый этап содержит колонки сотрудников с их тикетами и нулевую точку для входящих тикетов.

---

## Контекст

На стартовой странице (`IndexPage.vue`) уже реализована система отчётов с кнопками. При нажатии на кнопку отчёта происходит переход на соответствующий маршрут через Vue Router.

**Текущее состояние:**
- Стартовая страница отображает кнопки отчётов из `reports-config.js`
- При клике на кнопку вызывается `navigateToReport(route)`, который выполняет `router.push(route)`
- В роутере пока нет маршрута для дашборда сектора 1С

**Требуется:**
- Добавить новый отчёт "Дашборд сектора 1С" в конфигурацию
- Создать маршрут в роутере
- Реализовать компонент дашборда с полной функциональностью

---

## Модули и компоненты

### Главный компонент:
- `vue-app/src/components/dashboard/DashboardSector1C.vue` — главный компонент дашборда

### Дочерние компоненты:
- `vue-app/src/components/dashboard/DashboardStage.vue` — компонент этапа (колонка)
- `vue-app/src/components/dashboard/EmployeeColumn.vue` — колонка сотрудника
- `vue-app/src/components/dashboard/ZeroPoint.vue` — нулевая точка (входящие тикеты)
- `vue-app/src/components/dashboard/TicketCard.vue` — карточка тикета

### Сервисы:
- `vue-app/src/services/dashboard-sector-1c-service.js` — сервис для работы с API дашборда

### Конфигурация и роутинг:
- `vue-app/src/config/reports-config.js` — добавление нового отчёта
- `vue-app/src/router/index.js` — добавление маршрута

### Стили:
- `vue-app/src/styles/dashboard-sector-1c.css` — глобальные стили дашборда (опционально)

---

## Зависимости

### От других задач:
- **TASK-001** — IndexPage.vue должен быть создан и работать
- **TASK-004-01** — Система отчётов должна быть реализована

### От модулей:
- `vue-router` — для навигации
- `vue` (версия 3.x) — для компонентов
- Bitrix24 REST API — для получения данных о тикетах

### Ссылка на дизайн:
- ASCII-схема: `/UIX/ascii-schemas/dashboard-sector-1c.txt`
- Компонент: `DashboardSector1C.vue`

---

## Ступенчатые подзадачи

Задача разбита на отдельные подзадачи с детальными описаниями:

1. **TASK-005-01:** Добавление отчёта в конфигурацию и роутер
   - Добавить отчёт в `reports-config.js`
   - Добавить маршрут в `router/index.js`

2. **TASK-005-02:** Создание главного компонента `DashboardSector1C.vue`
   - Структура компонента
   - Props, Events, State, Methods
   - Интеграция с API

3. **TASK-005-03:** Создание компонента этапа `DashboardStage.vue`
   - Отображение этапа с колонками сотрудников
   - Интеграция с нулевой точкой

4. **TASK-005-04:** Создание компонента колонки сотрудника `EmployeeColumn.vue`
   - Отображение сотрудника и его тикетов
   - Обработка Drag & Drop

5. **TASK-005-05:** Создание компонента нулевой точки `ZeroPoint.vue`
   - Отображение входящих тикетов
   - Drag & Drop из нулевой точки

6. **TASK-005-06:** Создание компонента карточки тикета `TicketCard.vue`
   - Отображение информации о тикете
   - Интерактивность (клик, перетаскивание)

7. **TASK-005-07:** Создание сервиса для работы с API
   - Методы для получения данных
   - Методы для обновления тикетов
   - Интеграция с Bitrix24 REST API

8. **TASK-005-08:** Реализация Drag & Drop функциональности
   - HTML5 Drag & Drop API или библиотека
   - Визуальная обратная связь
   - Валидация перемещений

---

## API-методы Bitrix24

### Используемые методы:

1. **`crm.deal.list`** — получение списка тикетов/сделок
   - Документация: https://context7.com/bitrix24/rest/crm.deal.list
   - Параметры: `filter`, `select`, `order`

2. **`crm.deal.get`** — получение детальной информации о тикете
   - Документация: https://context7.com/bitrix24/rest/crm.deal.get
   - Параметры: `id`

3. **`crm.deal.update`** — обновление тикета (изменение этапа, назначение)
   - Документация: https://context7.com/bitrix24/rest/crm.deal.update
   - Параметры: `id`, `fields`

4. **`user.get`** — получение данных сотрудников
   - Документация: https://context7.com/bitrix24/rest/user.get
   - Параметры: `id` или `filter`

5. **`crm.timeline.comment.add`** — добавление комментария к тикету
   - Документация: https://context7.com/bitrix24/rest/crm.timeline.comment.add
   - Параметры: `fields`

---

## Технические требования

### Версии:
- **Vue.js:** 3.x (Composition API)
- **Vue Router:** последняя версия
- **Bitrix24 REST API:** актуальная версия

### Зависимости:
- `vue` — фреймворк
- `vue-router` — роутинг
- `@/services/bitrix24-api-service.js` — сервис для Bitrix24 API (если существует)

### Ограничения:
- Использовать только Vanilla JS или Vue.js (без дополнительных библиотек для Drag & Drop, если возможно)
- Стили должны соответствовать гайдлайнам Bitrix24
- Компоненты должны быть переиспользуемыми

### Адаптивность:
- **Десктоп (> 1024px):** три колонки этапов рядом
- **Планшет (768px - 1024px):** две колонки этапов
- **Мобильный (< 768px):** одна колонка этапа, вертикальная прокрутка

---

## Критерии приёмки

- [ ] Отчёт "Дашборд сектора 1С" добавлен в конфигурацию и отображается на стартовой странице
- [ ] При клике на отчёт происходит переход на дашборд
- [ ] Дашборд отображает три этапа обработки тикетов
- [ ] Каждый этап содержит нулевую точку и колонки сотрудников
- [ ] Тикеты отображаются в карточках с информацией (ID, тема, приоритет, статус)
- [ ] Реализован Drag & Drop для перемещения тикетов между сотрудниками и этапами
- [ ] При перемещении тикета данные обновляются через Bitrix24 REST API
- [ ] Счётчики тикетов обновляются автоматически
- [ ] Реализована обработка ошибок (показ уведомлений через Bitrix24 UI)
- [ ] Дашборд адаптивен для разных размеров экранов
- [ ] Все компоненты изолированы и переиспользуемы
- [ ] Код соответствует стандартам Vue.js и PSR-12 (для комментариев)
- [ ] Добавлено логирование всех операций

---

## Тестирование

### Функциональное тестирование:
1. Открыть стартовую страницу
2. Найти кнопку "Дашборд сектора 1С"
3. Кликнуть на кнопку — должен произойти переход на дашборд
4. Проверить отображение трёх этапов
5. Проверить отображение сотрудников и их тикетов
6. Проверить нулевую точку (входящие тикеты)
7. Перетащить тикет из нулевой точки на сотрудника
8. Перетащить тикет между сотрудниками
9. Перетащить тикет между этапами
10. Проверить обновление счётчиков

### Интеграционное тестирование:
1. Проверить загрузку данных из Bitrix24 REST API
2. Проверить сохранение изменений в Bitrix24 при перемещении тикетов
3. Проверить обработку ошибок API

### Адаптивное тестирование:
1. Проверить на десктопе (> 1024px)
2. Проверить на планшете (768px - 1024px)
3. Проверить на мобильном (< 768px)

---

## История правок

- **2025-12-06 11:18 (UTC+3, Брест):** Создана задача TASK-005 для внедрения дашборда сектора 1С
- **2025-12-06 12:00 (UTC+3, Брест):** Задача завершена. Все компоненты созданы и протестированы. См. TASK-005-IMPLEMENTATION-SUMMARY.md для деталей реализации.
- **2025-12-06 12:21 (UTC+3, Брест):** Добавлено отображение суммы тикетов в названии стадии. Название стадии теперь содержит общее количество тикетов в формате "Название стадии (N)". См. раздел "Дополнительные улучшения" в TASK-005-IMPLEMENTATION-SUMMARY.md.

