# TASK-041-05: Попап 1-го уровня с ответственными для модуля «График приёма и закрытий сектора 1С»

**Дата создания:** 2025-12-15 12:39 (UTC+0300, Brest)  
**Дата завершения:** 2025-12-15 18:00 (UTC+0300, Brest)  
**Статус:** ✅ Завершено  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vue.js Developer)  
**Связь с задачей:** Шаг 5 из TASK-041

## Цель этапа
Реализовать изолированный попап 1-го уровня, показывающий «Сотрудники ответственные» на основе поля `assigned`. Не смешивать код с существующими попапами; обеспечить корректную агрегацию, пустые состояния и единый стиль с текущими графиками сектора 1С.

## Контекст
- Бэкенд возвращает агрегат `responsible[]: [{ id, name, count }]` (нормализованный `assignedById`).  
- Логика получения ответственных в модулях 1 и 2: `ticket-utils.js` (`getAssignedById`, `parseEmployeeId`, `isZeroPointTicket`, keeper=1051).  
- Неделя и агрегации — в UTC; данные уже отфильтрованы по продукту 1С.
- Попап должен быть отдельным модулем/файлом, не влиять на существующие попапы.

## Задачи этапа
1) Изоляция попапа  
   - Создать отдельный компонент/модуль для попапа 1-го уровня (без реюза существующих попапов).  
   - Подключить в новый модуль через собственный импорт/регистрацию.

2) Данные для попапа  
   - Принимать `responsible[]` из ответа бэкенда: `{ id, name, count }`.  
   - Учесть правила нулевой точки (keeper=1051, отсутствует assigned) — согласовать, показывать ли их или фильтровать (следовать логике модулей 1/2).  
   - Сортировка: по count убыв., при равенстве — по name (опционально).

3) UI/UX  
   - Заголовок: «Сотрудники ответственные».  
   - Список: имя, count, опционально аватар/идентификатор, если есть маппинг.  
   - Пустое состояние: «Нет данных» / «Не назначен» при отсутствии ответственных.  
   - Стили — в духе текущих попапов сектора 1С, но код изолирован.

4) Триггер открытия  
   - Открывать попап по клику на соответствующий элемент графика/легенды (аналогично текущей логике, но отдельный обработчик/файл).  
   - Обеспечить передачу `responsible[]` в попап при открытии.

5) Устойчивость и ошибки  
   - Проверить работу при пустом массиве/отсутствии поля.  
   - Проверить поведение при наличии только keeper/пустых ответственных (если они не исключаются).  
   - Локализация/подписи согласовать с существующим модулем.

## Ожидаемые результаты этапа
- Изолированный попап 1-го уровня подключён в новый модуль.  
- Отображается список ответственных из `responsible[]`; пустые состояния обработаны.  
- Код попапа не влияет на существующие попапы; стилистика согласована.  
- Триггер открытия и передача данных работают.

## Критерии приёмки этапа
- Попап 1-го уровня открывается из нового модуля и показывает ответственных (name, count).  
- Обработаны пустые случаи и кейс keeper/без ответственного по принятому правилу.  
- Код попапа изолирован (отдельный файл/модуль), без регрессий в других попапах.  
- Стили и локализация согласованы с текущим UI сектора 1С.  

## Дополнительные уточнения
- Если в проекте есть маппинг сотрудников (id → имя/аватар), использовать его для отображения; иначе показывать только name/count.  
- Убедиться, что обработчики кликов в графиках передают корректный payload (например, seriesId или категорию), чтобы можно было открыть попап с `responsible[]`.  
- При пустом списке показывать понятное сообщение («Нет данных» / «Не назначен»), избегать пустых контейнеров.  
- Логику нулевой точки (keeper=1051, отсутствие assigned) применять последовательно с модулями 1/2; явно описать в коде попапа, кого скрываем/показываем.  
- Держать стили попапа в отдельном файле/блоке, чтобы изменение не влияло на старые попапы.

