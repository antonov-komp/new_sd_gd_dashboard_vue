# TASK-028-02: UX/UI проектирование улучшенного интерфейса

**Дата создания:** 2025-12-11 15:00 (UTC+3, Брест)  
**Статус:** Завершён  
**Приоритет:** Средний  
**Исполнитель:** Bitrix24 Программист (Vue.js)  
**Родительская задача:** TASK-028

---

## 📋 Цель этапа

Спроектировать улучшенный UX/UI для секции фильтров и блока стадий графика состояния сектора 1С с учётом гайдлайнов Bitrix24 UI Kit и модульной системы 8px.

---

## 🎨 1. Проектирование группировки фильтров

### 1.1. Структура панели фильтров

**Принцип:** Визуальная группировка фильтров по секциям с заголовками и фоновыми блоками.

**Новая структура:**
```
┌─────────────────────────────────────────────────────────┐
│ Фильтры                                    [Сбросить]   │
├─────────────────────────────────────────────────────────┤
│                                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 📊 Этапы                                            │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ ☑ Сформировано обращение                            │ │
│ │ ☑ Рассмотрение ТЗ                                    │ │
│ │ ☑ Исполнение                                         │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 👥 Сотрудники сектора 1С                            │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ [🔍 Поиск сотрудника...]                           │ │
│ │ ┌─────────────────────────────────────────────┐     │ │
│ │ │ ☐ Все сотрудники                            │     │ │
│ │ │ ☐ Иванов Иван Иванович                      │     │ │
│ │ │ ☐ Петров Петр Петрович                      │     │ │
│ │ └─────────────────────────────────────────────┘     │ │
│ │ 💡 Выберите сотрудников сектора 1С                  │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 📅 Период                                            │ │
│ ├─────────────────────────────────────────────────────┤ │
│ │ [▼ Последняя неделя                    ]            │ │
│ │                                                      │ │
│ │ (Если выбран "Произвольный период":)                │ │
│ │ С: [2025-12-01]  По: [2025-12-11]                  │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 1.2. Визуальные характеристики секций фильтров

**Контейнер секции:**
- Фон: `var(--b24-bg-white)` (#ffffff)
- Бордер: `1px solid var(--b24-border-light)` (#e5e7eb)
- Скругление: `var(--radius-lg)` (8px)
- Паддинг: `var(--spacing-md)` (16px) — сетка 8px
- Тень: `var(--shadow-sm)` (0 1px 2px rgba(0,0,0,0.05))
- Отступ между секциями: `var(--spacing-md)` (16px)

**Заголовок секции:**
- Шрифт: `font-weight: 600`, `font-size: var(--font-size-sm)` (14px)
- Цвет: `var(--b24-text-primary)` (#333333)
- Отступ снизу: `var(--spacing-sm)` (8px)
- Иконка: 16x16px, отступ справа `var(--spacing-xs)` (4px)

**Поля внутри секции:**
- Отступ между полями: `var(--spacing-sm)` (8px)
- Label: `font-weight: 500`, `font-size: var(--font-size-sm)` (14px)
- Placeholder: `var(--b24-text-muted)` (#999999)

### 1.3. Спецификация для каждого фильтра

#### Фильтр "Этапы"
- **Тип:** Группа чекбоксов
- **Расположение:** Вертикальный список
- **Отступ между чекбоксами:** `var(--spacing-xs)` (4px)
- **Состояния:**
  - Default: чекбокс + текст `var(--b24-text-primary)`
  - Hover: фон `var(--b24-bg-light)` (#f9fafb)
  - Checked: чекбокс `var(--b24-primary)` (#007bff)

#### Фильтр "Сотрудники"
- **Тип:** Поиск + список с множественным выбором
- **Компонент:** `EmployeeSelect.vue` (новый)
- **Поле поиска:**
  - Placeholder: "🔍 Поиск сотрудника сектора 1С..."
  - Паддинг: `var(--spacing-sm)` (8px)
  - Бордер: `1px solid var(--b24-border-medium)` (#ced4da)
  - Скругление: `var(--radius-sm)` (4px)
  - Фон: `var(--b24-bg-white)` (#ffffff)
- **Список сотрудников:**
  - Максимальная высота: 200px (5 элементов по 40px)
  - Скролл: при превышении высоты
  - Элемент списка:
    - Паддинг: `var(--spacing-sm)` (8px)
    - Hover: фон `var(--b24-bg-light)` (#f9fafb)
    - Selected: фон `var(--b24-primary-lighter)` (#e7f3ff), бордер слева `3px solid var(--b24-primary)`
- **Состояния:**
  - Loading: спиннер + текст "Загрузка сотрудников..."
  - Empty: текст "Нет сотрудников сектора 1С" + иконка
  - Error: текст "Ошибка загрузки" + кнопка "Повторить"

#### Фильтр "Период"
- **Тип:** Выпадающий список + календарь (опционально)
- **Выпадающий список:**
  - Паддинг: `var(--spacing-sm)` (8px)
  - Бордер: `1px solid var(--b24-border-medium)` (#ced4da)
  - Скругление: `var(--radius-sm)` (4px)
- **Календарь (для произвольного периода):**
  - Два поля даты в одну строку
  - Отступ между полями: `var(--spacing-sm)` (8px)
  - Валидация: красная рамка при ошибке

---

## 🎯 2. Проектирование визуального контейнера для стадий

### 2.1. Структура контейнера стадий

**Принцип:** Явный контейнер с фоном и бордером, внутри которого размещены чипы стадий.

**Новая структура:**
```
┌─────────────────────────────────────────────────────────┐
│ 📊 График состояния сектора 1С                         │
├─────────────────────────────────────────────────────────┤
│                                                          │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Этапы для отображения:                              │ │
│ │                                                      │ │
│ │ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ │ │
│ │ │ ☑ Сформировано│ │ ☑ Рассмотрение│ │ ☑ Исполнение │ │ │
│ │ │   обращение   │ │   ТЗ          │ │              │ │ │
│ │ │   [синий]     │ │   [жёлтый]    │ │   [зелёный] │ │ │
│ │ └──────────────┘ └──────────────┘ └──────────────┘ │ │
│ │                                                      │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                          │
│ [График]                                                 │
│                                                          │
└─────────────────────────────────────────────────────────┘
```

### 2.2. Визуальные характеристики контейнера стадий

**Контейнер:**
- Фон: `var(--b24-bg-light)` (#f8f9fa) — более тёмный, чем текущий
- Бордер: `1px solid var(--b24-border-light)` (#e5e7eb)
- Скругление: `var(--radius-lg)` (8px)
- Паддинг: `var(--spacing-md)` (16px) — сетка 8px
- Отступ снизу: `var(--spacing-md)` (16px)

**Заголовок контейнера:**
- Текст: "Этапы для отображения:"
- Шрифт: `font-weight: 600`, `font-size: var(--font-size-sm)` (14px)
- Цвет: `var(--b24-text-primary)` (#333333)
- Отступ снизу: `var(--spacing-sm)` (8px)

**Чипы стадий:**
- Расположение: Flex row с gap `var(--spacing-sm)` (8px)
- Минимальная высота: 40px (5 * 8px)
- Паддинг: `var(--spacing-sm) var(--spacing-md)` (8px 16px)
- Скругление: `var(--radius-md)` (6px)
- Бордер: `1px solid var(--b24-border-medium)` (#ced4da)
- Фон: `var(--b24-bg-white)` (#ffffff)

**Состояния чипов:**

1. **Default (не выбран):**
   - Фон: `var(--b24-bg-white)` (#ffffff)
   - Бордер: `1px solid var(--b24-border-medium)` (#ced4da)
   - Текст: `var(--b24-text-primary)` (#333333)
   - Иконка цвета стадии: 16x16px, скругление `var(--radius-xs)` (2px)

2. **Hover:**
   - Фон: `var(--b24-bg-light)` (#f9fafb)
   - Бордер: `1px solid var(--b24-primary)` (#007bff)
   - Тень: `var(--shadow-sm)` (0 1px 2px rgba(0,0,0,0.05))
   - Курсор: `pointer`
   - Transition: `var(--transition-base)` (0.2s ease)

3. **Active (выбран):**
   - Фон: `var(--b24-primary-lighter)` (#e7f3ff)
   - Бордер: `2px solid var(--b24-primary)` (#007bff)
   - Текст: `var(--b24-primary)` (#007bff)
   - Font-weight: `600`
   - Иконка цвета стадии: более яркая (без прозрачности)

4. **Disabled (если применимо):**
   - Фон: `var(--b24-bg)` (#f5f5f5)
   - Бордер: `1px solid var(--b24-border-light)` (#e5e7eb)
   - Текст: `var(--b24-text-disabled)` (#cccccc)
   - Курсор: `not-allowed`
   - Opacity: `0.6`

**Структура чипа:**
```
┌─────────────────────────────────────┐
│ [■] Сформировано обращение          │
│  └─ цвет стадии                     │
└─────────────────────────────────────┘
```

**Внутренняя структура чипа:**
- Flex row с gap `var(--spacing-xs)` (4px)
- Чекбокс: 16x16px
- Индикатор цвета: 16x16px, скругление `var(--radius-xs)` (2px)
- Текст: `font-size: var(--font-size-sm)` (14px)

---

## 👥 3. Проектирование компонента выбора сотрудника

### 3.1. Структура компонента EmployeeSelect

**Принцип:** Поиск с автодополнением + список с множественным выбором.

**Структура:**
```
┌─────────────────────────────────────────────────────┐
│ 👥 Сотрудники сектора 1С                            │
├─────────────────────────────────────────────────────┤
│                                                      │
│ [🔍 Поиск сотрудника сектора 1С...]                │
│                                                      │
│ ┌───────────────────────────────────────────────┐   │
│ │ ☐ Все сотрудники                              │   │
│ │ ☑ Иванов Иван Иванович                        │   │
│ │   Разработчик                                  │   │
│ │ ☐ Петров Петр Петрович                        │   │
│ │   Тестировщик                                  │   │
│ │ ☐ Сидоров Сидор Сидорович                     │   │
│ │   Аналитик                                     │   │
│ └───────────────────────────────────────────────┘   │
│                                                      │
│ 💡 Выбрано: 2 сотрудника                             │
│                                                      │
└─────────────────────────────────────────────────────┘
```

### 3.2. Визуальные характеристики

**Поле поиска:**
- Тип: `input[type="text"]`
- Placeholder: "🔍 Поиск сотрудника сектора 1С..."
- Паддинг: `var(--spacing-sm)` (8px)
- Бордер: `1px solid var(--b24-border-medium)` (#ced4da)
- Скругление: `var(--radius-sm)` (4px)
- Фон: `var(--b24-bg-white)` (#ffffff)
- Focus: бордер `2px solid var(--b24-primary)` (#007bff)
- Отступ снизу: `var(--spacing-sm)` (8px)

**Список сотрудников:**
- Контейнер:
  - Максимальная высота: 200px (5 элементов по 40px)
  - Скролл: `overflow-y: auto`
  - Бордер: `1px solid var(--b24-border-light)` (#e5e7eb)
  - Скругление: `var(--radius-sm)` (4px)
  - Фон: `var(--b24-bg-white)` (#ffffff)
- Элемент списка:
  - Паддинг: `var(--spacing-sm)` (8px)
  - Минимальная высота: 40px (5 * 8px)
  - Flex row с gap `var(--spacing-xs)` (4px)
  - Hover: фон `var(--b24-bg-light)` (#f9fafb)
  - Selected: фон `var(--b24-primary-lighter)` (#e7f3ff), бордер слева `3px solid var(--b24-primary)`
- Чекбокс: 16x16px
- Имя: `font-weight: 500`, `font-size: var(--font-size-sm)` (14px)
- Должность: `font-size: var(--font-size-xs)` (12px), цвет `var(--b24-text-secondary)` (#666666)

**Состояния:**

1. **Loading:**
   ```
   ┌───────────────────────────────────────────────┐
   │ ⏳ Загрузка сотрудников сектора 1С...        │
   └───────────────────────────────────────────────┘
   ```
   - Спиннер: 16x16px, цвет `var(--b24-primary)` (#007bff)
   - Текст: `var(--b24-text-secondary)` (#666666)

2. **Empty (нет результатов поиска):**
   ```
   ┌───────────────────────────────────────────────┐
   │ 📭 Нет сотрудников по запросу "..."           │
   └───────────────────────────────────────────────┘
   ```
   - Иконка: 24x24px
   - Текст: `var(--b24-text-muted)` (#999999)

3. **Empty (нет сотрудников сектора 1С):**
   ```
   ┌───────────────────────────────────────────────┐
   │ 📭 Нет сотрудников сектора 1С                 │
   └───────────────────────────────────────────────┘
   ```
   - Иконка: 24x24px
   - Текст: `var(--b24-text-muted)` (#999999)

4. **Error:**
   ```
   ┌───────────────────────────────────────────────┐
   │ ❌ Ошибка загрузки сотрудников                │
   │ [Повторить попытку]                          │
   └───────────────────────────────────────────────┘
   ```
   - Иконка: 24x24px, цвет `var(--b24-danger)` (#dc3545)
   - Текст ошибки: `var(--b24-danger)` (#dc3545)
   - Кнопка "Повторить": стиль `var(--b24-primary)`

**Счётчик выбранных:**
- Расположение: под списком
- Текст: "💡 Выбрано: N сотрудника(ов)"
- Шрифт: `font-size: var(--font-size-xs)` (12px)
- Цвет: `var(--b24-text-secondary)` (#666666)

### 3.3. Поведение компонента

**Поиск:**
- Дебаунс: 300ms (задержка перед запросом)
- Минимальная длина запроса: 2 символа (или загрузка всех при пустом поле)
- Лимит результатов: 20 сотрудников
- Сортировка: по ФИО (алфавит)

**Выбор:**
- Множественный выбор через чекбоксы
- Опция "Все сотрудники" снимает выбор остальных
- При выборе конкретного сотрудника опция "Все сотрудники" снимается

**Кеширование:**
- Кеш на сессию (sessionStorage)
- Ключ: `sector1c_employees_${searchQuery}`
- TTL: до закрытия вкладки

---

## 📐 4. Сетка 8px и отступы

### 4.1. Принцип модульной системы

**Все отступы должны быть кратны 8px:**
- `--spacing-xs: 4px` (0.5 * 8px) — минимальные отступы
- `--spacing-sm: 8px` (1 * 8px) — маленькие отступы
- `--spacing-md: 16px` (2 * 8px) — средние отступы
- `--spacing-lg: 24px` (3 * 8px) — большие отступы
- `--spacing-xl: 32px` (4 * 8px) — очень большие отступы

### 4.2. Применение в компонентах

**Панель фильтров:**
- Внешний паддинг: `var(--spacing-lg)` (24px)
- Отступ между секциями: `var(--spacing-md)` (16px)
- Паддинг внутри секции: `var(--spacing-md)` (16px)
- Отступ между полями: `var(--spacing-sm)` (8px)

**Контейнер стадий:**
- Внешний паддинг: `var(--spacing-md)` (16px)
- Отступ между заголовком и чипами: `var(--spacing-sm)` (8px)
- Gap между чипами: `var(--spacing-sm)` (8px)
- Паддинг чипа: `var(--spacing-sm) var(--spacing-md)` (8px 16px)

**Компонент EmployeeSelect:**
- Отступ между полем поиска и списком: `var(--spacing-sm)` (8px)
- Паддинг элемента списка: `var(--spacing-sm)` (8px)
- Отступ между списком и счётчиком: `var(--spacing-xs)` (4px)

---

## 🎨 5. Цветовая схема (Bitrix24 UI Kit)

### 5.1. Используемые переменные

**Основные цвета:**
- Primary: `var(--b24-primary)` (#007bff)
- Success: `var(--b24-success)` (#28a745)
- Warning: `var(--b24-warning)` (#ffc107)
- Danger: `var(--b24-danger)` (#dc3545)

**Цвета стадий:**
- Formed: `var(--b24-primary)` (#007bff)
- Review: `var(--b24-warning)` (#ffc107)
- Execution: `var(--b24-success)` (#28a745)

**Фоны:**
- Основной: `var(--b24-bg-white)` (#ffffff)
- Светлый: `var(--b24-bg-light)` (#f9fafb)
- Активный: `var(--b24-primary-lighter)` (#e7f3ff)

**Границы:**
- Светлая: `var(--b24-border-light)` (#e5e7eb)
- Средняя: `var(--b24-border-medium)` (#ced4da)
- Фокус: `var(--b24-primary)` (#007bff)

**Текст:**
- Основной: `var(--b24-text-primary)` (#333333)
- Вторичный: `var(--b24-text-secondary)` (#666666)
- Приглушённый: `var(--b24-text-muted)` (#999999)

---

## 📱 6. Адаптивность

### 6.1. Мобильная версия (< 768px)

**Панель фильтров:**
- Скрыта по умолчанию
- Кнопка "Фильтры" для открытия
- Полная ширина при открытии
- Секции фильтров: вертикально, одна под другой

**Контейнер стадий:**
- Чипы стадий: вертикально (flex column)
- Минимальная ширина чипа: 100%
- Отступ между чипами: `var(--spacing-sm)` (8px)

**Компонент EmployeeSelect:**
- Поле поиска: полная ширина
- Список: полная ширина, максимальная высота: 150px

### 6.2. Планшет (768px - 1023px)

**Панель фильтров:**
- Секции фильтров: 2 колонки (grid)
- Отступ между колонками: `var(--spacing-md)` (16px)

**Контейнер стадий:**
- Чипы стадий: горизонтально (flex row), wrap
- Минимальная ширина чипа: 200px

### 6.3. Десктоп (>= 1024px)

**Панель фильтров:**
- Секции фильтров: 3 колонки (grid)
- Отступ между колонками: `var(--spacing-md)` (16px)

**Контейнер стадий:**
- Чипы стадий: горизонтально (flex row)
- Минимальная ширина чипа: 180px

---

## ✅ 7. Критерии приёмки проектирования

- [x] Спроектирована группировка фильтров с заголовками секций
- [x] Определены отступы по сетке 8px для всех элементов
- [x] Спроектирован визуальный контейнер для стадий с фоном и бордером
- [x] Определены состояния hover/active/disabled для чипов стадий
- [x] Спроектирован компонент EmployeeSelect с поиском и состояниями
- [x] Определена цветовая схема на основе Bitrix24 UI Kit
- [x] Спроектирована адаптивность для мобильных, планшетов и десктопов

---

## 📝 8. Следующие шаги

**Этап 3: Техническое решение**
- Специфицировать пропсы/события компонентов
- Определить API-метод для сотрудников
- Добавить дебаунс и кеширование

---

**Дата завершения проектирования:** 2025-12-11 15:00 (UTC+3, Брест)  
**Следующий этап:** TASK-028-03 — Техническое решение
