# TASK-041-06: Интеграция и навигация для модуля «График приёма и закрытий сектора 1С»

**Дата создания:** 2025-12-15 12:40 (UTC+0300, Brest)  
**Дата завершения:** 2025-12-15 18:00 (UTC+0300, Brest)  
**Статус:** ✅ Завершено  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vue.js Developer)  
**Связь с задачей:** Шаг 6 из TASK-041

## Цель этапа
Встроить новый модуль в роутинг/меню приложения, обеспечить корректную работу фильтров и графиков при смене фильтров, а также синхронизацию состояния (store/контекст) по аналогии с модулем «График состояния сектора 1С».

## Контекст
- Новый модуль: «График приёма и закрытий сектора 1С» (TASK-041), без селектора этапов.  
- Доступы и фильтры — как у «Графика состояния сектора 1С».  
- Неделя/агрегации — в UTC, расчёт на бэкенде.  
- Попап 1-го уровня — изолированный (см. этап 5).

## Задачи этапа
1) Роутинг/меню  
   - Добавить пункт/маршрут для нового модуля в общий роутинг.  
   - Обеспечить те же правила доступа, что и у «Графика состояния сектора 1С».

2) Подключение данных  
   - Подключить REST-эндпоинт модуля (из этапа 2) к странице/компоненту.  
   - Гарантировать первичный запрос на текущую неделю (weekNumber, weekStartUtc, weekEndUtc) при открытии.

3) Фильтры и состояние  
   - Сохранить UI фильтров как в базовом модуле.  
   - При смене фильтров — обновлять данные графиков/попапа.  
   - Если используется глобальный стор/контекст — синхронизировать с ним (формат данных, selected filters).

4) Согласованность с UI без селектора  
   - Убедиться, что удалённый селектор этапов не требует дополнительных веток в роутинге/хранении состояния.  
   - Проверить, что легенды/цвета/подписи не завязаны на выбор этапов.

5) Обработка ошибок и загрузки  
   - Добавить состояния загрузки/ошибок, как в базовом модуле.  
   - Логировать ошибки API; при ошибке показывать сообщение, не ломая UI.

## Ожидаемые результаты этапа
- Модуль доступен из меню/роутинга с корректными правами.  
- Данные подтягиваются при открытии и при смене фильтров; синхронизация со стором работает.  
- UI без селектора этапов работает корректно, легенды/цвета/подписи отображаются.  
- Ошибки/загрузка обрабатываются без регрессий.

## Критерии приёмки этапа
- Маршрут/пункт меню для модуля добавлен, доступы совпадают с базовым модулем.  
- Фильтры работают: при изменении данные графиков/попапа обновляются.  
- Нет зависимостей от селектора этапов; состояние/лейаут не ломаются.  
- Состояния загрузки и ошибки отображаются, логирование включено.  

## Дополнительные уточнения
- Добавляя маршрут, ориентироваться на существующие записи для «Графика состояния сектора 1С» (те же guards/permissions).  
- При работе со стором использовать те же слайсы/модули, что и базовый модуль, но без ключей для селектора этапов.  
- Первичная загрузка: запрос на текущую неделю сразу после монтирования; последующие — при смене фильтров.  
- Логи ошибок отправлять в общий логгер, как в базовом модуле, чтобы не терять диагностику.  
- Проверить, что навигация назад/вперёд (history) корректно восстанавливает состояние фильтров и выбранной недели, если это поддерживается в базовом модуле.

