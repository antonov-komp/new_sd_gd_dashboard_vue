# TASK-068: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏"

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-23 15:01 (UTC+3, –ë—Ä–µ—Å—Ç)  
**–°—Ç–∞—Ç—É—Å:** –ù–æ–≤–∞—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** Backend Developer (PHP)  
**–°–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:** 
- [TASK-059-05: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ 3 –º–µ—Å—è—Ü–∞](./TASK-059-05-file-cache-implementation.md)
- [TASK-067-6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è –º–µ—Å—è—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞](./TASK-067-6-integrate-cache-months.md)

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏" (`periodMode: 'weeks'`) –≤ –º–æ–¥—É–ª–µ "–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°", –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–æ–º—É, –∫–∞–∫ —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –¥–ª—è —Ä–µ–∂–∏–º–∞ "3 –º–µ—Å—è—Ü–∞" (`periodMode: 'months'`).

**–¶–µ–ª—å:** –°–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏" —Å 2-5 —Å–µ–∫—É–Ω–¥ –¥–æ 0.01-0.05 —Å–µ–∫—É–Ω–¥ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ —Å—á—ë—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –∫–µ—à–∞ —Å TTL 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã).

---

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç

### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:

- –†–µ–∂–∏–º "4 –Ω–µ–¥–µ–ª–∏" –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24
- –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: 2-5 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –†–µ—à–µ–Ω–∏–µ:

- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª–æ–≤—ã–π –∫–µ—à —Å TTL 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã) –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏"
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–µ—à–∞ (`GraphAdmissionClosureCache`)
- –†–∞—Å—à–∏—Ä–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–∞ –∫–µ—à–∞ –¥–ª—è —É—á—ë—Ç–∞ `weekStartUtc` –∏ `weekEndUtc`
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∫–∞–∫ –≤ —Ä–µ–∂–∏–º–µ "3 –º–µ—Å—è—Ü–∞")
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–µ—à–∞, —á—Ç–æ –∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ "months"
  - –û—Ç–¥–µ–ª—å–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: `api/cache/graph-admission-closure/weeks/`
  - –ü—Ä–µ—Ñ–∏–∫—Å –∫–ª—é—á–∞: `weeks_` (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞)
  - TTL: 120 —Å–µ–∫—É–Ω–¥ (–∫–æ—Ä–æ—á–µ, —á–µ–º –¥–ª—è "months" ‚Äî 300 —Å–µ–∫—É–Ω–¥, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è —á–∞—â–µ)

### –°–≤—è–∑—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–µ—à–µ–º:

- –†–µ–∂–∏–º "3 –º–µ—Å—è—Ü–∞" —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–µ—à (TTL: 300 —Å–µ–∫—É–Ω–¥)
- –†–µ–∂–∏–º "4 –Ω–µ–¥–µ–ª–∏" –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –º–µ—Ö–∞–Ω–∏–∑–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–ª—é—á–∏ –∫–µ—à–∞ –¥–æ–ª–∂–Ω—ã —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –ø–æ `periodMode` –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∑–∞–ø—Ä–æ—Å–∞

---

## üèóÔ∏è –ú–æ–¥—É–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ò–∑–º–µ–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã:

- `api/cache/GraphAdmissionClosureCache.php` ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–µ–∂–∏–º–∞ "weeks"
- `api/graph-admission-closure/service/GraphAdmissionClosureService.php` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –º–µ—Ç–æ–¥ `handle()`
- `api/graph-admission-closure/cache/CacheStore.php` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∫–µ—à–∞:

```
api/
‚îú‚îÄ‚îÄ cache/
‚îÇ   ‚îî‚îÄ‚îÄ graph-admission-closure/
‚îÇ       ‚îú‚îÄ‚îÄ months/          # –°—É—â–µ—Å—Ç–≤—É—é—â–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ "3 –º–µ—Å—è—Ü–∞"
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ {cache-key}.json
‚îÇ       ‚îî‚îÄ‚îÄ weeks/           # –ù–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏"
‚îÇ           ‚îî‚îÄ‚îÄ {cache-key}.json
```

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **–û—Ç –∑–∞–¥–∞—á:** 
  - TASK-059-05: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ 3 –º–µ—Å—è—Ü–∞
  - TASK-067-6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è –º–µ—Å—è—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
- **–û—Ç –º–æ–¥—É–ª–µ–π:** 
  - –ú–æ–¥—É–ª—å: –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°
  - –ö–ª–∞—Å—Å: `GraphAdmissionClosureCache`
  - –ö–ª–∞—Å—Å: `GraphAdmissionClosureService`
- **–û—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫:** 
  - PHP 8.4+ (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏)

---

## üéØ –°—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

**–í–∞–∂–Ω–æ:** –≠—Ç–∞–ø—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å—Ç—Ä–æ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, —Ç–∞–∫ –∫–∞–∫ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ.

```
–≠—Ç–∞–ø 1 (TASK-068-01)
    ‚Üì
–≠—Ç–∞–ø 2 (TASK-068-02)
    ‚Üì
–≠—Ç–∞–ø 3 (TASK-068-03) ‚Üê –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —ç—Ç–∞–ø–æ–≤ 1 –∏ 2
    ‚Üì
–≠—Ç–∞–ø 4 (TASK-068-04) ‚Üê –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —ç—Ç–∞–ø–∞ 3
    ‚Üì
–≠—Ç–∞–ø 5 (TASK-068-05) ‚Üê —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
```

---

### –≠—Ç–∞–ø 1: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ GraphAdmissionClosureCache –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–µ–∂–∏–º–∞ "weeks"

**–§–∞–π–ª:** `DOCS/TASKS/TASK-068-01-extend-cache-for-weeks.md`  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç (–±–∞–∑–æ–≤—ã–π —ç—Ç–∞–ø)

**–¶–µ–ª—å:** –†–∞—Å—à–∏—Ä–∏—Ç—å –∫–ª–∞—Å—Å `GraphAdmissionClosureCache` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ä–µ–∂–∏–º–∞ "weeks" —Å –æ—Ç–¥–µ–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π –∫–µ—à–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `CACHE_WEEKS_DIR` –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–µ—à–∞ —Ä–µ–∂–∏–º–∞ "weeks"
- –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `getCachePath()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã `get()` –∏ `set()` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –∏–∑ –∫–ª—é—á–∞
- –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `ensureCacheDirectory()` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–æ–¥ `clearExpired()` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–±–µ–∏–º–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º–∏
- –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `api/cache/graph-admission-closure/weeks/`

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –§–∞–π–ª: `api/cache/GraphAdmissionClosureCache.php`
- –°—Ç—Ä–æ–∫–∏: 22 (–¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É), 214-220 (–æ–±–Ω–æ–≤–∏—Ç—å `getCachePath()`), 35-72 (–æ–±–Ω–æ–≤–∏—Ç—å `get()`), 82-124 (–æ–±–Ω–æ–≤–∏—Ç—å `set()`), 284-299 (–æ–±–Ω–æ–≤–∏—Ç—å `ensureCacheDirectory()`), 174-206 (–æ–±–Ω–æ–≤–∏—Ç—å `clearExpired()`)

---

### –≠—Ç–∞–ø 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞ –∫–µ—à–∞ –¥–ª—è —É—á—ë—Ç–∞ weekStartUtc/weekEndUtc

**–§–∞–π–ª:** `DOCS/TASKS/TASK-068-02-update-cache-key-generation.md`  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1-2 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø 1 (TASK-068-01)

**–¶–µ–ª—å:** –û–±–Ω–æ–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–∞ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks", —á—Ç–æ–±—ã —É—á–∏—Ç—ã–≤–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª—å.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `generateKey()` –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è `weekStartUtc` –∏ `weekEndUtc` –≤ –∫–ª—é—á
- –û–±–µ—Å–ø–µ—á–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å –∫–ª—é—á–∞: `weeks_` –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks", `months_` –¥–ª—è —Ä–µ–∂–∏–º–∞ "months"
- –û–±–Ω–æ–≤–∏—Ç—å `CacheStore::generateKey()` (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –§–∞–π–ª: `api/cache/GraphAdmissionClosureCache.php`
- –°—Ç—Ä–æ–∫–∏: 228-249 (–æ–±–Ω–æ–≤–∏—Ç—å `generateKey()`)
- **–í–∞–∂–Ω–æ:** –§–æ—Ä–º–∞—Ç –¥–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `Y-m-d\TH:i:s\Z` (ISO-8601 —Å UTC)

---

### –≠—Ç–∞–ø 3: –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è GraphAdmissionClosureService –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `DOCS/TASKS/TASK-068-03-add-cache-to-service.md`  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø—ã 1 –∏ 2 (TASK-068-01, TASK-068-02)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–µ—à–∞ –≤ –º–µ—Ç–æ–¥ `handle()` –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks".

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–µ—à–∞ –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω–µ `forceRefresh`)
- –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∫–µ—à –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (TTL: 120 —Å–µ–∫—É–Ω–¥)
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `forceRefresh` –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks"
- –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π (–∫–∞–∂–¥—ã–π 10-–π –∑–∞–ø—Ä–æ—Å)
- –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –º–µ—Ç–æ–¥ `getCacheKeyForWeeks()` –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –§–∞–π–ª: `api/graph-admission-closure/service/GraphAdmissionClosureService.php`
- –°—Ç—Ä–æ–∫–∏: –ü–æ—Å–ª–µ 54 (–¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–µ—à–∞), –ø–æ—Å–ª–µ 219 (–¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à)
- **–í–∞–∂–Ω–æ:** –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è –î–û –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–µ—à–∞ (–¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

---

### –≠—Ç–∞–ø 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏"

**–§–∞–π–ª:** `DOCS/TASKS/TASK-068-04-add-performance-logging.md`  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1 —á–∞—Å  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø 3 (TASK-068-03)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏" (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ä–µ–∂–∏–º—É "3 –º–µ—Å—è—Ü–∞").

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (`microtime(true)`)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –≤ –∫–µ—à (cache hit): `[WEEKS-PERFORMANCE] Total execution time (from cache): X.XXX seconds`
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–æ–º–∞—Ö–µ –∫–µ—à–∞ (cache miss): `[WEEKS-PERFORMANCE] Total execution time: XX.XX seconds`
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Ñ–æ—Ä–º–∞—Ç–∞ —Å —Ä–µ–∂–∏–º–æ–º "months"

**–ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –§–∞–π–ª: `api/graph-admission-closure/service/GraphAdmissionClosureService.php`
- –°—Ç—Ä–æ–∫–∏: –ü–æ—Å–ª–µ 54 (–Ω–∞—á–∞–ª–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è), –≤ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–µ—à–∞ (cache hit), –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –∫–µ—à (cache miss)

---

### –≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∫–µ—à–∞

**–§–∞–π–ª:** `DOCS/TASKS/TASK-068-05-testing-cache-weeks.md`  
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —ç—Ç–∞–ø—ã (TASK-068-01, TASK-068-02, TASK-068-03, TASK-068-04)

**–¶–µ–ª—å:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏".

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–µ—à–∞
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–µ—á–µ–Ω–∏–µ TTL (120 —Å–µ–∫—É–Ω–¥)
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `forceRefresh`
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∫–µ—à–µ–º –∏ –±–µ–∑)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: cache hit < 0.1 —Å–µ–∫, cache miss 2-5 —Å–µ–∫
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –æ—á–∏—Å—Ç–∫–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### Backend (PHP):
- PHP 8.4+
- –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–µ—à–∞ (755)
- –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫–µ—à–∞:
```php
[
    'data' => [
        'success' => true,
        'meta' => [...],
        'data' => [...]
    ],
    'metadata' => [
        'created_at' => 1234567890,
        'expires_at' => 1234567890,
        'ttl' => 120
    ]
]
```

### TTL:
- **–î–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏":** 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)
  - **–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:** –î–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è —á–∞—â–µ, —á–µ–º –≤ –º–µ—Å—è—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
  - **–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞:** –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `CACHE_WEEKS_TTL = 120` –≤ `GraphAdmissionClosureCache`
- **–î–ª—è —Ä–µ–∂–∏–º–∞ "3 –º–µ—Å—è—Ü–∞":** 300 —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç) ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  - **–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞:** `DEFAULT_TTL = 300` (—Å—Ç—Ä–æ–∫–∞ 27 –≤ `GraphAdmissionClosureCache.php`)

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ TTL:

| –†–µ–∂–∏–º | TTL | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|-------|-----|-------------|
| 4 –Ω–µ–¥–µ–ª–∏ | 120 —Å–µ–∫ (2 –º–∏–Ω) | –î–∞–Ω–Ω—ã–µ –º–µ–Ω—è—é—Ç—Å—è —á–∞—â–µ, –Ω—É–∂–Ω–∞ –±–æ–ª–µ–µ —Å–≤–µ–∂–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| 3 –º–µ—Å—è—Ü–∞ | 300 —Å–µ–∫ (5 –º–∏–Ω) | –ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ª—å—à–µ, –º–æ–∂–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –¥–æ–ª—å—à–µ |

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks":
```php
$cacheKey = $this->cacheStore->generateKey([
    'product' => '1C',
    'periodMode' => 'weeks',
    'weekStartUtc' => '2025-12-16T00:00:00Z',
    'weekEndUtc' => '2025-12-22T23:59:59Z',
    'includeTickets' => false,
    'includeNewTicketsByStages' => false,
    'includeCarryoverTickets' => false,
    'includeCarryoverTicketsByDuration' => false
]);
```

**–§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞:** `weeks_{MD5_—Ö–µ—à_–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤}`

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏

### –û–±—â–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
- [ ] –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–µ–∂–∏–º–∞ "4 –Ω–µ–¥–µ–ª–∏"
- [ ] –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∫–µ—à–µ–º: 0.01-0.05 —Å–µ–∫—É–Ω–¥
- [ ] –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ –∫–µ—à–∞: 2-5 —Å–µ–∫—É–Ω–¥ (–Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å)
- [ ] TTL —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (120 —Å–µ–∫—É–Ω–¥)
- [ ] –ö–ª—é—á–∏ –∫–µ—à–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- [ ] –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–∞—Ä–∞–º–µ—Ç—Ä `forceRefresh` —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [ ] –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PSR-12
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
- –°–º. —Ä–∞–∑–¥–µ–ª—ã "–°—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏" –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –ø–æ–¥–∑–∞–¥–∞—á

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–µ—à –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks"
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks"
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–µ—á–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è –∫–µ—à–∞ (120 —Å–µ–∫—É–Ω–¥)
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—á–∏—Å—Ç–∫—É —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `forceRefresh`
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
1. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∫–µ—à–µ–º (–ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî cache miss)
   - –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è: 2-5 —Å–µ–∫—É–Ω–¥
   - –õ–æ–≥: `[WEEKS-PERFORMANCE] Total execution time: XX.XX seconds`
2. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∫–µ—à–µ–º (–ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å ‚Äî cache hit)
   - –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è: 0.01-0.05 —Å–µ–∫—É–Ω–¥
   - –õ–æ–≥: `[WEEKS-PERFORMANCE] Total execution time (from cache): X.XXX seconds`
3. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –±–µ–∑ –∫–µ—à–∞ (—Å `forceRefresh: true`)
   - –û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è: 2-5 —Å–µ–∫—É–Ω–¥ (–Ω–µ –¥–æ–ª–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è)
4. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å —Ä–µ–∂–∏–º–æ–º "3 –º–µ—Å—è—Ü–∞"
   - –†–µ–∂–∏–º "months": cache hit ~0.01-0.05 —Å–µ–∫, cache miss ~5-15 —Å–µ–∫
   - –†–µ–∂–∏–º "weeks": cache hit ~0.01-0.05 —Å–µ–∫, cache miss ~2-5 —Å–µ–∫

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è:

```bash
# –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ curl
time curl -X POST http://localhost/api/graph-1c-admission-closure.php \
  -H "Content-Type: application/json" \
  -d '{"periodMode": "weeks", "product": "1C"}'

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
tail -f logs/app/graph-admission-closure-$(date +%Y-%m-%d).log | grep WEEKS-PERFORMANCE
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–µ—à–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏ "weeks" –∏ "months"
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∫–µ—à–µ–π —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫–µ—à–∞ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "periodMode": "weeks",
  "product": "1C"
}
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
1. –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (cache miss):
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞: `weeks_a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6`
   - –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24: ~3 —Å–µ–∫—É–Ω–¥
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à: `api/cache/graph-admission-closure/weeks/weeks_a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6.json`
   - –õ–æ–≥–∏: `[WEEKS-PERFORMANCE] Total execution time: 3.45 seconds`

2. –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å (cache hit):
   - –¢–æ—Ç –∂–µ –∫–ª—é—á: `weeks_a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6`
   - –í–æ–∑–≤—Ä–∞—Ç –∏–∑ –∫–µ—à–∞: ~0.02 —Å–µ–∫—É–Ω–¥
   - –õ–æ–≥–∏: `[WEEKS-PERFORMANCE] Total execution time (from cache): 0.023 seconds`

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–ø—Ä–æ—Å —Å —è–≤–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ –Ω–µ–¥–µ–ª–∏

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "periodMode": "weeks",
  "weekStartUtc": "2025-12-16T00:00:00Z",
  "weekEndUtc": "2025-12-22T23:59:59Z",
  "product": "1C",
  "includeCarryoverTickets": true
}
```

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞:**
```php
$normalized = [
    'product' => '1C',
    'periodMode' => 'weeks',
    'weekStartUtc' => '2025-12-16T00:00:00Z',
    'weekEndUtc' => '2025-12-22T23:59:59Z',
    'includeTickets' => false,
    'includeNewTicketsByStages' => false,
    'includeCarryoverTickets' => true,
    'includeCarryoverTicketsByDuration' => false
];
// MD5 —Ö–µ—à: abc123def456...
// –ö–ª—é—á: weeks_abc123def456...
```

### –ü—Ä–∏–º–µ—Ä 3: –ó–∞–ø—Ä–æ—Å —Å forceRefresh

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "periodMode": "weeks",
  "product": "1C",
  "forceRefresh": true
}
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ö–µ—à –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è (–¥–∞–∂–µ –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24: ~3 —Å–µ–∫—É–Ω–¥
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–µ—à–∞ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ)
- –õ–æ–≥–∏: `[Cache] Force refresh requested, skipping cache check`

---

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞ –≤ —Ä–µ–∂–∏–º–µ "4 –Ω–µ–¥–µ–ª–∏":

**–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `GraphAdmissionClosureService::handle()`:**

```php
// –ù–µ–¥–µ–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
$weeksModeStartTime = microtime(true); // –ù–∞—á–∞–ª–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏

[$weekStart, $weekEnd] = $this->dateHelper->getWeekBounds($weekStartParam, $weekEndParam);
$weeks = $this->dateHelper->getFourWeeksBounds($weekStart, $weekEnd);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞ (–µ—Å–ª–∏ –Ω–µ forceRefresh)
if (!$forceRefresh) {
    $cacheKey = $this->cacheStore->generateKey([
        'product' => $product,
        'periodMode' => 'weeks',
        'weekStartUtc' => $weekStart->format('Y-m-d\TH:i:s\Z'),
        'weekEndUtc' => $weekEnd->format('Y-m-d\TH:i:s\Z'),
        'includeTickets' => $includeTickets,
        'includeNewTicketsByStages' => $includeNewTicketsByStages,
        'includeCarryoverTickets' => $includeCarryoverTickets,
        'includeCarryoverTicketsByDuration' => $includeCarryoverTicketsByDuration
    ]);
    
    $cachedData = $this->cacheStore->get($cacheKey);
    if ($cachedData !== null) {
        $cacheResponseTime = microtime(true) - $weeksModeStartTime;
        error_log("[Cache] Cache hit for key: {$cacheKey}");
        error_log("[WEEKS-PERFORMANCE] Total execution time (from cache): " . round($cacheResponseTime, 3) . " seconds");
        return $cachedData;
    }
    
    error_log("[Cache] Cache miss for key: {$cacheKey}");
} else {
    error_log("[Cache] Force refresh requested, skipping cache check");
}

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Bitrix24 API
// ... –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ...
// ... –∞–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ ...
// ... —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ ...

$response = [
    'success' => true,
    'meta' => [...],
    'data' => [...]
];

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à (—Ç–æ–ª—å–∫–æ –¥–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤)
if (isset($response['success']) && $response['success'] === true) {
    $cacheKey = $this->cacheStore->generateKey([...]); // –¢–æ—Ç –∂–µ –∫–ª—é—á, —á—Ç–æ –∏ –≤—ã—à–µ
    
    if ($this->cacheStore->set($cacheKey, $response, 120)) {
        error_log("[Cache] Cache saved for key: {$cacheKey}");
    } else {
        error_log("[Cache] Failed to save cache for key: {$cacheKey}");
    }
    
    // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π (–∫–∞–∂–¥—ã–π 10-–π –∑–∞–ø—Ä–æ—Å)
    if (rand(1, 10) === 1) {
        $deleted = $this->cacheStore->clearExpired();
        if ($deleted > 0) {
            error_log("[Cache] Cleared {$deleted} expired cache entries");
        }
    }
}

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
$weeksModeTotalTime = microtime(true) - $weeksModeStartTime;
error_log("[WEEKS-PERFORMANCE] Total execution time: " . round($weeksModeTotalTime, 2) . " seconds");

return $response;
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç: `Y-m-d\TH:i:s\Z` (ISO-8601 —Å UTC)
- TTL: 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞: –∫–∞–∂–¥—ã–π 10-–π –∑–∞–ø—Ä–æ—Å

---

## üìö –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°—Å—ã–ª–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥:

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "months" (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏):**
- `GraphAdmissionClosureCache::generateKey()` (—Å—Ç—Ä–æ–∫–∏ 228-249): —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- `GraphAdmissionClosureService::handleMonthsMode()` (—Å—Ç—Ä–æ–∫–∏ 232-493): –ø—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∫–µ—à–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞ (—Å—Ç—Ä–æ–∫–∏ 246-267): –ø—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à (—Å—Ç—Ä–æ–∫–∏ 464-478): –ø—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ API (–∫–æ–Ω—Ç—Ä–∞–∫—Ç):**
- –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `{success: true, meta: {...}, data: {...}}`
- –ù–µ –∏–∑–º–µ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

### –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö:

**–§–æ—Ä–º–∞—Ç –¥–∞—Ç (ISO-8601 —Å UTC):**
- –ü—Ä–∏–º–µ—Ä: `'2025-12-16T00:00:00Z'`
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: `$dateTime->format('Y-m-d\TH:i:s\Z')`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤: `DatePeriodHelper::getFourWeeksBounds()` (—Å—Ç—Ä–æ–∫–∏ 52-53)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞ –∫–µ—à–∞:**
```json
{
  "data": {
    "success": true,
    "meta": {
      "weekNumber": 50,
      "weekStartUtc": "2025-12-16T00:00:00Z",
      "weekEndUtc": "2025-12-22T23:59:59Z",
      "weeks": [...]
    },
    "data": {
      "newTickets": 10,
      "closedTickets": 8,
      "series": {...},
      "weeksData": [...]
    }
  },
  "metadata": {
    "created_at": 1703328000,
    "expires_at": 1703328120,
    "ttl": 120
  }
}
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [TASK-059-05: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤–æ–≥–æ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ 3 –º–µ—Å—è—Ü–∞](./TASK-059-05-file-cache-implementation.md)
- [TASK-067-6: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è –º–µ—Å—è—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞](./TASK-067-6-integrate-cache-months.md)
- [–ê–Ω–∞–ª–∏–∑ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è](../../ARCHITECTURE/graph-admission-closure-analysis.md)
- [–ú–æ–¥—É–ª—å: –ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°](../../MODULES/module-03-graph-admission-closure/README.md)
- [GraphAdmissionClosureCache.php](../../../api/cache/GraphAdmissionClosureCache.php) ‚Äî —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
- [GraphAdmissionClosureService.php](../../../api/graph-admission-closure/service/GraphAdmissionClosureService.php) ‚Äî —Ç–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏:

1. **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–µ—à–∞**
   - **–†–∏—Å–∫:** –í–µ–±-—Å–µ—Ä–≤–µ—Ä –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å/–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã –≤ `weeks/`
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∑–∞—Ä–∞–Ω–µ–µ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∞ 755, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞

2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö**
   - **–†–∏—Å–∫:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª –∫–µ—à–∞
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–ø–∏—Å—å —á–µ—Ä–µ–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ `set()`)

3. **–†–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤**
   - **–†–∏—Å–∫:** –§–æ—Ä–º–∞—Ç –¥–∞—Ç –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —Ä–∞–∑–Ω—ã–º –∫–ª—é—á–∞–º
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç `Y-m-d\TH:i:s\Z`, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–µ–π

4. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫–µ—à–∞**
   - **–†–∏—Å–∫:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –∫–µ—à–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π, TTL 120 —Å–µ–∫—É–Ω–¥ (–∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫)

### –ë–∏–∑–Ω–µ—Å-—Ä–∏—Å–∫–∏:

1. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–µ—à–µ**
   - **–†–∏—Å–∫:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –≤ Bitrix24
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ö–æ—Ä–æ—Ç–∫–∏–π TTL (120 —Å–µ–∫—É–Ω–¥), –ø–∞—Ä–∞–º–µ—Ç—Ä `forceRefresh` –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ñ–∞–π–ª–æ–≤**
   - **–†–∏—Å–∫:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ñ–∞–π–ª–æ–≤
   - **–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ (–∫–∞–∂–¥—ã–π 10-–π –∑–∞–ø—Ä–æ—Å), –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å cron-–∑–∞–¥–∞—á—É

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã:

- [ ] –ò–∑—É—á–µ–Ω—ã –≤—Å–µ 5 —ç—Ç–∞–ø–æ–≤ TASK-068
- [ ] –ò–∑—É—á–µ–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "months" (TASK-059-05, TASK-067-6)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `GraphAdmissionClosureCache` (—Å—Ç—Ä–æ–∫–∏ 1-300)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `GraphAdmissionClosureService` (—Å—Ç—Ä–æ–∫–∏ 29-222)
- [ ] –°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `api/cache/graph-admission-closure/weeks/`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (755)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–µ—à–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ "months" (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞)

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:

**–≠—Ç–∞–ø 1 (TASK-068-01):**
- [ ] –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `CACHE_WEEKS_DIR` –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –í—Å–µ –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤
- [ ] –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `weeks/` —Å–æ–∑–¥–∞–Ω–∞
- [ ] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ (—Ä–µ–∂–∏–º "months" —Ä–∞–±–æ—Ç–∞–µ—Ç)

**–≠—Ç–∞–ø 2 (TASK-068-02):**
- [ ] –ú–µ—Ç–æ–¥ `generateKey()` –æ–±–Ω–æ–≤–ª—ë–Ω
- [ ] –ü—Ä–µ—Ñ–∏–∫—Å—ã –∫–ª—é—á–µ–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (`weeks_` –∏ `months_`)
- [ ] –¢–µ—Å—Ç—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π –ø—Ä–æ—Ö–æ–¥—è—Ç

**–≠—Ç–∞–ø 3 (TASK-068-03):**
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à –¥–æ–±–∞–≤–ª–µ–Ω–æ
- [ ] TTL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 120 —Å–µ–∫—É–Ω–¥
- [ ] –ú–µ—Ç–æ–¥ `getCacheKeyForWeeks()` —Å–æ–∑–¥–∞–Ω

**–≠—Ç–∞–ø 4 (TASK-068-04):**
- [ ] –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∂–∏–º—É "months"

**–≠—Ç–∞–ø 5 (TASK-068-05):**
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

### –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:

- [ ] –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PSR-12
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ TASK-068
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- [ ] –ö–æ–¥ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ

### –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

- [ ] –í—Å–µ 5 —ç—Ç–∞–ø–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks"
- [ ] –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º:
  - Cache hit: < 0.1 —Å–µ–∫—É–Ω–¥
  - Cache miss: 2-5 —Å–µ–∫—É–Ω–¥
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (—Ä–µ–∂–∏–º "months" —Ä–∞–±–æ—Ç–∞–µ—Ç)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –û—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∫–µ—à–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
ls -la api/cache/graph-admission-closure/
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å: months/ –∏ weeks/

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã –∫–µ—à–∞
ls -la api/cache/graph-admission-closure/weeks/
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ñ–∞–π–ª—ã: weeks_*.json

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
tail -20 logs/app/graph-admission-closure-$(date +%Y-%m-%d).log | grep -E "Cache|WEEKS-PERFORMANCE"
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏: Cache hit/miss, WEEKS-PERFORMANCE

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
grep "WEEKS-PERFORMANCE" logs/app/graph-admission-closure-*.log | tail -5
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è: ~0.01-0.05 (cache hit) –∏ ~2-5 (cache miss)
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤:

1. **–ù–∞—á–∞—Ç—å —Å –≠—Ç–∞–ø–∞ 1** ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ `GraphAdmissionClosureCache`
   - –≠—Ç–æ –±–∞–∑–æ–≤—ã–π —ç—Ç–∞–ø, –æ—Ç –Ω–µ–≥–æ –∑–∞–≤–∏—Å—è—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ
   - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–µ–∂–∏–º "months" –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

2. **–ó–∞—Ç–µ–º –≠—Ç–∞–ø 2** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–µ–π
   - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∫–µ—à–∞
   - –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É

3. **–ó–∞—Ç–µ–º –≠—Ç–∞–ø 3** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å
   - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
   - –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

4. **–ó–∞—Ç–µ–º –≠—Ç–∞–ø 4** ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –≠—Ç–∞–ø–∞ 3
   - –ü–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–µ—à–∞

5. **–§–∏–Ω–∞–ª—å–Ω–æ –≠—Ç–∞–ø 5** ‚Äî –ø–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç—Ç–∞–ø–æ–≤
   - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–æ–≤–µ—Ç—ã –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –∫–∞–∫ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å**
   - –†–µ–∂–∏–º "months" —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (—Å—Ç—Ä–æ–∫–∏ 232-493 –≤ `GraphAdmissionClosureService.php`)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è —Ä–µ–∂–∏–º–∞ "weeks"

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è**
   - –ù–µ –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–∏–º–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è

3. **–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**
   - –ü–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å `[Cache]` –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–µ—à–µ–º

4. **–°–æ—Ö—Ä–∞–Ω—è—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**
   - –†–µ–∂–∏–º "months" –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å
   - –ù–µ –∏–∑–º–µ–Ω—è—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

5. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã**
   - –ò–∑–±–µ–≥–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
   - –°–æ–∑–¥–∞—Ç—å `getCacheKeyForWeeks()` –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## üìä –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∞–≤–æ–∫

- **2025-12-23 15:01 (UTC+3, –ë—Ä–µ—Å—Ç):** –°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ä–µ–∂–∏–º "4 –Ω–µ–¥–µ–ª–∏"
- **2025-12-23 15:30 (UTC+3, –ë—Ä–µ—Å—Ç):** –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞, —Ä–∞–∑–¥–µ–ª—ã —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏ –∏ —Ä–µ—à–µ–Ω–∏—è–º–∏, —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥, –¥–µ—Ç–∞–ª—å–Ω—ã–µ —á–µ–∫-–ª–∏—Å—Ç—ã

---

**–ê–≤—Ç–æ—Ä:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.1

