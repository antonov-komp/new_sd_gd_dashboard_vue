# TASK-038-05: Тестирование и документация — переключение стадий в попапе 1-го уровня (Vue)

**Дата создания:** 2025-12-15 12:30 (UTC+3, Брест)  
**Статус:** Завершена  
**Приоритет:** Средний  
**Исполнитель:** Bitrix24 Программист (Vue.js)  
**Связь:** Этап 5 эпика TASK-038 (`TASK-038-popup-stage-switching.md`)  
**Модуль:** График состояния сектора 1С (`EmployeeDetailsModal.vue`, `GraphStateChart.vue`)  

## Цель
Провести ручное тестирование сценариев переключения стадий в попапе 1-го уровня, верифицировать работу на всех типах графиков (line/bar/doughnut), проверить доступность (keyboard), обработку ошибок и обновить пользовательскую документацию.

## Тестовые сценарии (ручные)
- **Базовый флоу:** line/bar/doughnut → попап 1-го уровня → клик по названию стадии → выбор другой стадии → лоадер → успешное обновление данных (стадия, totalCount, employees).
- **Повторный выбор той же стадии:** список закрывается, данных не меняет.
- **Отсутствуют метаданные → REST-фолбэк:** переключение вызывает запрос, данные загружаются; при ошибке — уведомление, стейт прежний.
- **Пустой ответ/0 сотрудников:** уведомление/placeholder, стадия не меняется.
- **Ошибка/таймаут REST:** уведомление в попапе, кнопка “Повторить”, стейт прежний.
- **Клавиатура:** TAB по пунктам списка стадий, Enter — выбрать, ESC — закрыть список; ESC из попапа — закрывает модалку.
- **Уровни 2/3:** после смены стадии уровни сброшены; “Назад” из 2/3 возвращает корректно в рамках текущей стадии.
- **Цвета и словарь стадий:** маркеры и прогресс-бары соответствуют stage color map.
- **Падение сети/slow 3G:** проверить, что лоадер виден, таймаут срабатывает, повтор корректен.
- **Выбор стадии без данных в метаданных:** убедиться, что REST вызван один раз, при повторе без изменений данных нет двойных запросов.

## Документация
- Обновить `DOCS/USER-GUIDE/graph-state-sector-1c/00-overview.md` (раздел “Детализация данных”) — кратко описать, что в попапе 1-го уровня можно переключать стадии без закрытия модалки.
- При необходимости — краткое дополнение в UI-гайд/анализ (`DOCS/GUIDES/ui-analysis-graph-state-sector-1c.md`) о dropdown стадий.
- Сослаться на REST-методы (context7.com/apidocs) при описании источников данных, если используется REST-фолбэк.

## Чек-лист приемки
- Все указанные сценарии вручную пройдены на line/bar/doughnut.
- Обработка ошибок/таймаутов видна пользователю, кнопка “Повторить” работает.
- Клавиатурная доступность подтверждена.
- Цвета стадий соответствуют словарю; нет рассинхрона лейблов/цветов.
- Документация обновлена; изменения отражены в user guide (и при необходимости в UI-гайде).
- Тесты на медленном соединении и при падении запроса подтверждены; нет двойных повторных запросов при открытом лоадере.

## Итоги тестирования (2025-12-15, Брест, UTC+3)
- Пройдены сценарии: базовый флоу, повторный выбор той же стадии, отсутствие метаданных → REST, пустой ответ, ошибка/таймаут (кнопка “Повторить”), клавиатура TAB/Enter/ESC, уровни 2/3 после смены стадии, slow 3G.
- Цвета/лейблы стадий соответствуют stage color map (formed/review/execution).
- При ошибке/таймауте стейт откатывается, старая стадия сохраняется, повтор работает.

## Связанные материалы
- `DOCS/TASKS/TASK-038-popup-stage-switching.md`
- `DOCS/TASKS/TASK-038-01-popup-stage-switching-analysis.md`
- `DOCS/TASKS/TASK-038-02-popup-stage-switching-data.md`
- `DOCS/TASKS/TASK-038-03-popup-stage-switching-ui.md`
- `DOCS/TASKS/TASK-038-04-popup-stage-switching-navigation.md`
- `DOCS/USER-GUIDE/graph-state-sector-1c/00-overview.md`
- `DOCS/GUIDES/ui-analysis-graph-state-sector-1c.md`

