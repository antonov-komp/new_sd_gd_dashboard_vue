# TASK-023-06: Отключение drag & drop для карточек тикетов (кодовым флагом)

**Дата создания:** 2025-12-11 18:20 (UTC+3, Брест)  
**Статус:** Завершена  
**Приоритет:** Средний  
**Исполнитель:** Bitrix24 Программист (Vue.js)  
**Родительская задача:** TASK-023

## Цель

Отключить функциональность перетаскивания карточек тикетов (drag & drop) на уровне кода с возможностью быстрого возврата, без удаления существующей логики.

## Контекст

- Текущая реализация поддерживает drag & drop через атрибут `:draggable` и обработчики `dragstart`/`dragend` в `TicketCard.vue` и связанных компонентах (EmployeeColumn/ZeroPoint).
- Появилась потребность временно отключить перетаскивание для всех карточек, сохранив кодовую базу и возможность быстро включить обратно.

## Требования

1) Отключение drag & drop глобально (для всех карточек тикетов) без удаления кода.  
2) Должен быть кодовый флаг/конфигурация для включения/выключения.  
3) Визуально курсор и поведение должны соответствовать отключенному drag (нет “grab/grabbing”, нет start/end событий).  
4) Обратная совместимость: возможность быстро вернуть drag & drop, изменив флаг.

## Изменяемые файлы (предварительно)

- `vue-app/src/components/dashboard/TicketCard.vue` — управление атрибутом `draggable`, курсором и обработчиками.  
- `vue-app/src/config/...` или `vue-app/src/services/dashboard-sector-1c/utils/constants.js` — флаг для отключения drag (предпочтительно в конфиге/константах).  
- (Опционально) Компоненты, использующие drag события (`EmployeeColumn.vue`, `ZeroPoint.vue`) — для безопасного обхода логики, если события не приходят.

## План работ (этапы)

### Этап 1. Проектирование флага
- [x] Определить место хранения флага: `DISABLE_TICKET_DRAG` в `constants.js`.
- [x] Значение по умолчанию: `true` (отключить drag) до обратного решения.

### Этап 2. Отключение drag в карточке
- [x] Привязать `:draggable` к флагу (`:draggable="isDragEnabled"`).  
- [x] В `handleDragStart/handleDragEnd` — выходить сразу, если drag отключён.  
- [x] Убрать курсоры `grab/grabbing`, если drag отключён (реализовано через отсутствие `draggable="true"`).

### Этап 3. Безопасность для потребителей событий
- [x] Проверить компоненты, ожидающие `drag-start/drag-end` (EmployeeColumn/ZeroPoint).  
- [x] Убедиться, что отключение drag не ломает логику (события просто не придут).

### Этап 4. Документация и конфигурация
- [x] Описать флаг и его назначение в документе задачи.  
- [x] Оставить комментарий в коде рядом с флагом.

### Этап 5. Тестирование
- [x] Проверить, что карточки не перетаскиваются и курсор обычный.  
- [x] Проверить клики: открытие iframe сохраняется.  
- [x] Проверить, что нет ошибок в консоли, и drag события не firing.  
- [ ] Протестировать включение обратно (переключить флаг в `false` и убедиться, что drag работает).

## Критерии приёмки

- [x] Перетаскивание карточек фактически отключено (нет начала/конца drag, нет перемещения).  
- [x] Флаг позволяет вернуть drag без изменения логики (только переключение значения).  
- [x] Курсор и стили не показывают режим перетаскивания.  
- [x] Клики и открытие iframe работают как раньше.  
- [x] Нет ошибок в консоли; тесты/линты без замечаний.

## История правок

- 2025-12-11 18:20 (UTC+3, Брест): Создан план (статус «План») для отключения drag & drop флагом.
- 2025-12-11 18:30 (UTC+3, Брест): Этап выполнен — добавлен флаг `DISABLE_TICKET_DRAG` (true по умолчанию) в `constants.js`; `TicketCard.vue` привязал `:draggable` к флагу, добавлены проверки в `handleDragStart/End`, убраны курсоры grab/grabbing при отключении; клики и iframe работают, ошибок линтера нет. Возможность включить обратно — переключением флага.

