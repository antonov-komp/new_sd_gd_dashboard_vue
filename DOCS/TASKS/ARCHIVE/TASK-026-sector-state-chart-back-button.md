# TASK-026: Кнопка «Назад» в модуле «График состояния сектора 1С»

**Дата создания:** 2025-12-11 13:04 (UTC+3, Брест)  
**Статус:** Новая  
**Приоритет:** Средний  
**Исполнитель:** Bitrix24 Программист (Vue.js)

---

## Цель
Добавить глобальную кнопку «Назад» в модуле «График состояния сектора 1С», чтобы пользователи могли вернуться к предыдущему экрану/дашборду без использования навигации браузера.

## Контекст
- График отображается в Vue-интерфейсе (Bitrix24 placement / внешняя страница).  
- Сейчас отсутствует единая точка возврата: после перехода из списка/дашборда в «График состояния сектора 1С» пользователь не может вернуться к предыдущему состоянию.  
- Нужно обеспечить единообразный UX, соответствующий гайдлайнам Bitrix24: кнопка/линк «Назад» в верхней части интерфейса, доступная всегда.

## Требования
- Визуально: кнопка/линк «Назад» в шапке или над графиком, в стиле Bitrix24 UI Kit (b24-btn / BX.UI.Button).  
- Поведение: возвращает на предыдущий экран/маршрут Vue (router.back()) или, если история пуста, на дефолтный маршрут (например, список/дашборд).  
- Доступность: клавиатура (Enter/Space), aria-label, достаточный контраст.  
- Состояния: hover/focus/disabled (если нет истории).  
- Логирование (dev): одноразовый warn, если fallback-маршрут сработал из-за пустой истории.

## API-методы Bitrix24
- Если график использует данные Bitrix24, ссылки на методы оставить без изменений (например, `crm.item.list` — https://context7.com/bitrix24/rest/crm.item.list).  
- В рамках задачи API не меняем; только UI-навигация.

## Сроки
- Не заданы (уточнить у постановщика).

## Вопросы/ответы
- Q: Какой дефолтный маршрут открывать при пустой истории?  
  A: Уточнить (кандидаты: общий дашборд / список секторов).  
- Q: Нужна ли фиксация положения/хедера при скролле?  
  A: Уточнить (по умолчанию — фиксировать кнопку в шапке компонента).
- Q: Поддерживаем ли быстрый переход «Домой» отдельной кнопкой?  
  A: Нет, только «Назад» в этом этапе.

---

## Модули и компоненты
- Vue-компонент графика (уточнить путь; ожидаемо `vue-app/src/components/sector/SectorStateChart.vue` или близкий).  
- Общий layout/шапка модуля, если выделена в отдельный компонент (например, `SectorLayout.vue`).  
- Маршрутизация Vue (router) — проверка наличия истории и fallback.

---

## План работ (шаги)
1) Анализ: определить фактический компонент/маршрут «График состояния сектора 1С», текущий способ открытия (router push / props).  
2) Дизайн поведения:  
   - Если `router.history` позволяет — `router.back()`.  
   - Иначе — редирект на дефолтный маршрут (уточнить).  
   - Не допускать двойных переходов.  
3) Реализация UI:  
   - Добавить кнопку/линк «Назад» в шапку компонента.  
   - Стиль через Bitrix24 UI Kit: BX.UI.Button или `b24-btn b24-btn-link`/`b24-btn-outline`.  
   - aria-label="Назад", tabindex, фокус/hover.  
4) Логика:  
   - Обработчик клика + клавиатуры.  
   - Проверка истории; fallback на дефолтный маршрут.  
   - Dev-log (`console.warn`) при срабатывании fallback.  
5) Тестирование:  
   - Сценарий с историей: переход из списка → график → «Назад» возвращает в список.  
   - Сценарий без истории (прямая ссылка): «Назад» уводит на дефолтный маршрут.  
   - Клавиатура/aria.  
   - Вёрстка на разных ширинах (desktop/tablet).  
6) Документация: кратко описать поведение в README/комментарии компонента, указать fallback-маршрут.

---

## Критерии приёмки
- [ ] Кнопка «Назад» видна и доступна во всех состояниях графика.  
- [ ] Переход «назад» работает из сценария с историей; при отсутствии истории выполняется переход на согласованный дефолтный маршрут.  
- [ ] Нет JS-ошибок; dev-log только при fallback.  
- [ ] Кнопка управляется клавиатурой (Enter/Space), есть aria-label.  
- [ ] Стили соответствуют Bitrix24 UI (цвета/отступы/hover).  
- [ ] Обновлена документация/комментарий о поведении «Назад».

---

## Риски и допущения
- Если график открыт по прямой ссылке, история пуста — нужен корректный fallback.  
- Возможны коллизии со встроенной навигацией Bitrix24 iframe/placement; проверить, что `router.back()` не ломает контекст.  
- При отсутствии общего layout придётся добавить шапку в компонент графика.

---

## История правок
- 2025-12-11 13:04 (UTC+3, Брест): Создана задача.

