# TASK-027: Кнопка «Назад» в модуле «График состояния сектора 1С»

**Дата создания:** 2025-12-11 13:04 (UTC+3, Брест)  
**Статус:** Завершена  
**Приоритет:** Средний  
**Исполнитель:** Bitrix24 Программист (Vue.js)

---

## Цель
Добавить глобальную кнопку «Назад» в модуле «График состояния сектора 1С», чтобы пользователи могли вернуться к предыдущему экрану/дашборду без использования навигации браузера.

## Контекст
- График отображается в Vue-интерфейсе (Bitrix24 placement / внешняя страница).  
- Сейчас отсутствует единая точка возврата: после перехода из списка/дашборда в «График состояния сектора 1С» пользователь не может вернуться к предыдущему состоянию.  
- Нужно обеспечить единообразный UX, соответствующий гайдлайнам Bitrix24: кнопка/линк «Назад» в верхней части интерфейса, доступная всегда.

## Требования
- Визуально: кнопка/линк «Назад» в шапке или над графиком, в стиле Bitrix24 UI Kit (b24-btn / BX.UI.Button).  
- Поведение: возвращает на предыдущий экран/маршрут Vue (router.back()) или, если история пуста, на дефолтный маршрут (например, список/дашборд).  
- Доступность: клавиатура (Enter/Space), aria-label, достаточный контраст.  
- Состояния: hover/focus/disabled (если нет истории).  
- Логирование (dev): одноразовый warn, если fallback-маршрут сработал из-за пустой истории.

## API-методы Bitrix24
- Если график использует данные Bitrix24, ссылки на методы оставить без изменений (например, `crm.item.list` — https://context7.com/bitrix24/rest/crm.item.list).  
- В рамках задачи API не меняем; только UI-навигация.

## Сроки
- Не заданы (уточнить у постановщика).

## Вопросы/ответы
- Q: Какой дефолтный маршрут открывать при пустой истории?  
  A: **Реализовано:** `dashboard-sector-1c` (дашборд сектора 1С).  
- Q: Нужна ли фиксация положения/хедера при скролле?  
  A: **Реализовано:** Кнопка размещена в шапке компонента вместе с хлебными крошками, фиксация не требуется.  
- Q: Поддерживаем ли быстрый переход «Домой» отдельной кнопкой?  
  A: Нет, только «Назад» в этом этапе.

---

## Модули и компоненты
- **Реализовано:** `vue-app/src/components/graph-state/GraphStateDashboard.vue` — основной компонент дашборда с кнопкой «Назад».  
- **Реализовано:** Кнопка интегрирована в строку хлебных крошек (breadcrumbs) в шапке компонента.  
- **Реализовано:** Маршрутизация Vue (router) — проверка наличия истории и fallback на `dashboard-sector-1c`.

---

## План работ (шаги)
1) Анализ: определить фактический компонент/маршрут «График состояния сектора 1С», текущий способ открытия (router push / props).  
2) Дизайн поведения:  
   - Если `router.history` позволяет — `router.back()`.  
   - Иначе — редирект на дефолтный маршрут (уточнить).  
   - Не допускать двойных переходов.  
3) Реализация UI:  
   - Добавить кнопку/линк «Назад» в шапку компонента.  
   - Стиль через Bitrix24 UI Kit: BX.UI.Button или `b24-btn b24-btn-link`/`b24-btn-outline`.  
   - aria-label="Назад", tabindex, фокус/hover.  
4) Логика:  
   - Обработчик клика + клавиатуры.  
   - Проверка истории; fallback на дефолтный маршрут.  
   - Dev-log (`console.warn`) при срабатывании fallback.  
5) Тестирование:  
   - Сценарий с историей: переход из списка → график → «Назад» возвращает в список.  
   - Сценарий без истории (прямая ссылка): «Назад» уводит на дефолтный маршрут.  
   - Клавиатура/aria.  
   - Вёрстка на разных ширинах (desktop/tablet).  
6) Документация: кратко описать поведение в README/комментарии компонента, указать fallback-маршрут.

---

## Критерии приёмки
- [x] Кнопка «Назад» видна и доступна во всех состояниях графика.  
- [x] Переход «назад» работает из сценария с историей; при отсутствии истории выполняется переход на согласованный дефолтный маршрут (`dashboard-sector-1c`).  
- [x] Нет JS-ошибок; dev-log (`console.warn`) только при fallback.  
- [x] Кнопка управляется клавиатурой (Enter/Space), есть aria-label.  
- [x] Стили соответствуют Bitrix24 UI (цвета/отступы/hover/focus/disabled).  
- [x] Обновлена документация/комментарий о поведении «Назад».

---

## Риски и допущения
- Если график открыт по прямой ссылке, история пуста — нужен корректный fallback.  
- Возможны коллизии со встроенной навигацией Bitrix24 iframe/placement; проверить, что `router.back()` не ломает контекст.  
- При отсутствии общего layout придётся добавить шапку в компонент графика.

---

## История правок
- 2025-12-11 13:04 (UTC+3, Брест): Создана задача.
- 2025-12-11 13:15 (UTC+3, Брест): Задача завершена. Реализована кнопка «Назад» в виде круглой кнопки со стрелкой, интегрированная в строку хлебных крошек. Логика: `router.back()` с fallback на `dashboard-sector-1c`. Добавлены стили Bitrix24 UI, поддержка клавиатуры и доступности (aria-label, focus/hover/disabled состояния). Все критерии приёмки выполнены.

