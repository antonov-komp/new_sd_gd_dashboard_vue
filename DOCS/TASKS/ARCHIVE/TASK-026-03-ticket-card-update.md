# TASK-026-03: Обновление TicketCard.vue под конфиг "В работе" (UF_SLA_SERVICE_STR, сектор 1С)

**Дата создания:** 2025-12-11 19:05 (UTC+3, Брест)  
**Дата завершения:** 2025-12-11 13:26 (UTC+3, Брест)  
**Статус:** ✅ Завершена  
**Приоритет:** Высокий  
**Исполнитель:** Bitrix24 Программист (Vue.js)  
**Родитель:** TASK-026 (Система конфигурации значения "В работе" для сектора 1С)

## Цель
Интегрировать новый конфиг `service-config.js` в UI карточки тикета (`TicketCard.vue`) для отображения плашки "В работе" (значение из `UF_SLA_SERVICE_STR`) в секторе 1С. Обеспечить корректное отображение устойчивых значений, цветов, fallback для пустых/неизвестных значений, а также совместимость с обновлённым маппером (этап 026-02).

## Контекст
- Источник данных: поле Bitrix24 `UF_SLA_SERVICE_STR` (текст).  
- Конфиг значений: `vue-app/src/config/service-config.js` (этап 026-01).  
- Маппер: `ticket-mapper.js` обновляется на этапе 026-02, должен передавать объект сервиса или необходимые поля.  
- Важно: конфиг/отображение относятся только к сектору 1С. Для других секторов будут отдельные конфиги/компоненты.

## Область работ и файлы
- **Основной файл для изменения:**  
  - `vue-app/src/components/dashboard/TicketCard.vue`
- **Ссылочно:**  
  - `vue-app/src/config/service-config.js` (конфиг и утилиты).  
  - `vue-app/src/services/dashboard-sector-1c/mappers/ticket-mapper.js` (должен предоставить данные).  
  - `vue-app/src/services/dashboard-sector-1c/utils/constants.js` (проверить неиспользуемые классы/цвета, убрать дубли при необходимости).

## Требования к отображению
- Использовать данные сервиса из маппера: либо объект `service`, либо поля (label, backgroundColor, textColor, color).  
- Применить динамические стили плашки: фон, цвет текста, опционально бордер/тень — на основе конфига.  
- Fallback: для пустых/неизвестных значений — показывать текст из fallback (например, "Не указано") и нейтральную палитру (серый), не ломать верстку.  
- Сохранить структуру карточки и существующий UX (размеры/отступы/адаптивность).  
- Избежать жестко захардкоженных классов под старые значения; перейти на динамические стили/классы.  
- Не ломать другие элементы карточки (приоритеты, статусы и т.д.).  

## Подзадачи
1. Импортировать конфиг/утилиты `service-config.js` в компонент (если нужен прямой доступ; или использовать данные из маппера).  
2. Обновить вычисления/методы, отвечающие за отображение плашки "В работе":  
   - получить лейбл, фон, цвет текста, id, описание (при необходимости).  
   - учесть, что маппер может вернуть уже готовый объект (предпочтительно использовать его, чтобы не дублировать логику).  
3. Обновить шаблон плашки:  
   - привязать динамические стили (`:style` или CSS-переменные) к `backgroundColor`, `textColor`, `color`.  
   - вывести лейбл (label).  
   - обеспечить graceful fallback: текст fallback и нейтральный фон, если сервис не найден/пустой.  
4. Обновить/упростить стили:  
   - убрать лишние статические классы для старых значений.  
   - при необходимости вынести в CSS-переменные (например, `--service-bg`, `--service-text`).  
   - убедиться в контрастности текста на фоне.  
5. Проверить адаптивность/переполнение: длинные строки не должны ломать макет (оверфлоу hidden/ellipsis при необходимости).  
6. Самопроверка: убедиться, что компонент не тянет ненужные зависимости, сборка не ломается.

## Критерии приёмки (для этапа 026-03) ✅
- [x] `TicketCard.vue` отображает плашку "В работе" на основе данных из маппера/конфига.  
- [x] Динамические стили (фон/текст) берутся из конфига; нет жёстко закодированных классов под старые значения.  
- [x] Fallback показывается для пустых/неизвестных значений (текст и нейтральный фон).  
- [x] Остальные элементы карточки не затронуты (приоритеты, статусы и т.д.).  
- [x] Контраст/читаемость сохранены; длинные названия не ломают верстку.  
- [x] Импорты/экспорты валидны, сборка не ломается.  
- [x] Старое отображение статуса "В работе" удалено (дублировало плашку сервиса).

## Тестирование (быстрый чек)
- Карточка с `UF_SLA_SERVICE_STR = '1С.Бухгалтерия'` → лейбл "1С.Бухгалтерия", цвета из конфига.  
- Смешанный регистр, пробелы → корректный лейбл и цвета.  
- Пусто/неизвестно → fallback-текст ("Не указано" или аналог) и нейтральная палитра.  
- Длинное значение (эмуляция) → не ломает макет, текст усечён/перенесён адекватно.  
- Сборка/рендер: компонент не падает, консоль без ошибок.

## Зависимости/заметки
- Требуется готовый маппер (этап 026-02) и конфиг (026-01).  
- Конфиг/отображение — только для сектора 1С; для других секторов потребуются свои компоненты/конфиги.  
- Не добавлять новые внешние зависимости; опираться на существующий стек (Vue 3, Vite).

## История правок
- 2025-12-11 19:05 (UTC+3, Брест): Создана задача 026-03.
- 2025-12-11 13:26 (UTC+3, Брест): ✅ Этап успешно выполнен. Компонент `TicketCard.vue` обновлён для отображения плашки "В работе" через конфиг. Старое дублирующее отображение статуса удалено.

