# TASK-081: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã cache miss –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è –Ω–∞–ø—Ä—è–º—É—é

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-10 14:30 (UTC+3, –ë—Ä–µ—Å—Ç)
**–°—Ç–∞—Ç—É—Å:** –ó–∞–≤–µ—Ä—à–µ–Ω–æ ‚úÖ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** Backend Developer (PHP)
**–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–¥–∞—á–∞:** [TASK-080: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞](./TASK-080-fix-universal-cache-params.md)
**–ü–æ–¥–∑–∞–¥–∞—á–∞:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

---

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É, –∫–æ–≥–¥–∞ —Ä—É—á–Ω–æ–π –∫–µ—à –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è "–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°" –Ω–∞–ø—Ä—è–º—É—é. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–µ—à–∞.

**–¶–µ–ª—å:** –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–ø–æ—Å–æ–±–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥—É–ª—è.

---

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç

### –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:

**–°—Ü–µ–Ω–∞—Ä–∏–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å –∫–µ—à —á–µ—Ä–µ–∑ "–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º" - –∫–µ—à —Å–æ–∑–¥–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
2. –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥—É–ª—å "–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°" –Ω–∞–ø—Ä—è–º—É—é
3. –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ (cache miss), –∫–µ—à –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–†–∞–∑–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª—å:**
   - –†—É—á–Ω–æ–π –∫–µ—à: –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è
   - –ú–æ–¥—É–ª—å: –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è
   - –ï—Å–ª–∏ –≤—Ä–µ–º—è –∏–∑–º–µ–Ω–∏–ª–æ—Å—å (–Ω–æ–≤–∞—è –Ω–µ–¥–µ–ª—è), –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞–∑–Ω—ã–µ ‚Üí —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –∫–µ—à–∞

2. **–ö–æ—Ä–æ—Ç–∫–∏–π TTL:**
   - –¢–æ—á–Ω—ã–π –∫–µ—à: TTL = 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–µ—à: TTL = 300 —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)
   - –í–æ–∑–º–æ–∂–Ω–æ, –∫–µ—à –ø—Ä–æ—Å—Ç–æ –∏—Å—Ç–µ–∫–∞–µ—Ç

3. **–†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:**
   - –†—É—á–Ω–æ–π –∫–µ—à –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è —Å –æ–¥–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
   - –ú–æ–¥—É–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

4. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –∫–ª—é—á–∞–º–∏:**
   - –ö–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ-—Ä–∞–∑–Ω–æ–º—É
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç

---

## üèóÔ∏è –ú–æ–¥—É–ª–∏ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ó–∞—Ç—Ä–∞–≥–∏–≤–∞–µ–º—ã–µ —Ñ–∞–π–ª—ã:

- `api/graph-admission-closure/service/GraphAdmissionClosureService.php` - –ª–æ–≥–∏–∫–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- `api/cache/GraphAdmissionClosureCache.php` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π –∫–µ—à–∞
- `api/graph-admission-closure/util/DatePeriodHelper.php` - —Ä–∞—Å—á–µ—Ç –≥—Ä–∞–Ω–∏—Ü –Ω–µ–¥–µ–ª—å
- `vue-app/src/components/graph-admission-closure/GraphAdmissionClosureDashboard.vue` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

---

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **–û—Ç –∑–∞–¥–∞—á:**
  - TASK-080: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞
  - TASK-076: –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–µ–π —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏

- **–û—Ç –º–æ–¥—É–ª–µ–π:**
  - GraphAdmissionClosureService
  - GraphAdmissionClosureCache
  - DatePeriodHelper

---

## üéØ –°—Ç—É–ø–µ–Ω—á–∞—Ç—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏

### –ü–æ–¥–∑–∞–¥–∞—á–∞ 1: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è

**–¶–µ–ª—å:** –°–æ–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫–∞–∫–∏–µ –∫–ª—é—á–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏ –ø–æ—á–µ–º—É –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç cache miss.

**–®–∞–≥–∏:**

1. **–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```php
   // –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ GraphAdmissionClosureService.php:
   error_log("[CACHE-DEBUG] === Cache check started ===");
   error_log("[CACHE-DEBUG] Request time: " . date('Y-m-d H:i:s T'));
   error_log("[CACHE-DEBUG] Payload: " . json_encode($payload, JSON_UNESCAPED_UNICODE));
   error_log("[CACHE-DEBUG] Week bounds: {$weekStart->format('Y-m-d H:i:s T')} - {$weekEnd->format('Y-m-d H:i:s T')}");
   error_log("[CACHE-DEBUG] Generated exact key: {$cacheKey}");
   error_log("[CACHE-DEBUG] Generated universal key: {$universalCacheKey}");
   error_log("[CACHE-DEBUG] Checking exact cache key: {$cacheKey}");
   error_log("[CACHE-DEBUG] ‚úó Exact cache MISS for key: {$cacheKey}"); // –∏–ª–∏ ‚úì HIT
   error_log("[CACHE-DEBUG] ‚úó‚úó DOUBLE cache MISS - will load from Bitrix24");
   ```

   ```php
   // –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ cache-create.php:
   error_log("[CACHE-CREATE] === Manual cache creation started ===");
   error_log("[CACHE-CREATE] Module: {$moduleId}, Mode: {$mode}");
   error_log("[CACHE-CREATE] Creation time: " . date('Y-m-d H:i:s T'));
   error_log("[CACHE-CREATE] Generated key: {$cacheKey}");
   error_log("[CACHE-CREATE] ‚úì Cache created successfully for key: {$cacheKey}");
   ```

2. **–°—Ä–∞–≤–Ω–∏—Ç—å –ª–æ–≥–∏:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä—É—á–Ω–æ–≥–æ –∫–µ—à–∞
   - –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è –Ω–∞–ø—Ä—è–º—É—é

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- [ ] –°–æ–±—Ä–∞–Ω–Ω—ã –ª–æ–≥–∏ —Å –∫–ª—é—á–∞–º–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- [ ] –í—ã—è–≤–ª–µ–Ω–æ —Ä–∞–∑–ª–∏—á–∏–µ –≤ –∫–ª—é—á–∞—Ö/–ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö

---

### –ü–æ–¥–∑–∞–¥–∞—á–∞ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü –Ω–µ–¥–µ–ª—å

**–¶–µ–ª—å:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å–æ–≤–ø–∞–¥–∞—é—Ç –ª–∏ –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª—å –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–µ—à–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è.

**–®–∞–≥–∏:**

1. **–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª—å:**
   ```php
   error_log("[CACHE-DEBUG] Week calculation time: " . date('Y-m-d H:i:s'));
   error_log("[CACHE-DEBUG] Current week: {$weekStart->format('Y-m-d')} - {$weekEnd->format('Y-m-d')}");
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç –≤ DatePeriodHelper:**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≥—Ä–∞–Ω–∏—Ü—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å timezone (UTC)

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- [ ] –ì—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª—å —Å–æ–≤–ø–∞–¥–∞—é—Ç –≤ –æ–±–æ–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö
- [ ] –ò–ª–∏ –≤—ã—è–≤–ª–µ–Ω–æ —Ä–∞–∑–ª–∏—á–∏–µ, –æ–±—ä—è—Å–Ω—è—é—â–µ–µ –ø—Ä–æ–±–ª–µ–º—É

---

### –ü–æ–¥–∑–∞–¥–∞—á–∞ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ TTL –∏ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –∫–µ—à–∞

**–¶–µ–ª—å:** –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω–µ –∏—Å—Ç–µ–∫–∞–µ—Ç –ª–∏ –∫–µ—à —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ.

**–®–∞–≥–∏:**

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å TTL:**
   - –¢–æ—á–Ω—ã–π –∫–µ—à: 120 —Å–µ–∫—É–Ω–¥
   - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–µ—à: 300 —Å–µ–∫—É–Ω–¥

2. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏:**
   ```php
   error_log("[CACHE-DEBUG] Cache TTL: {$ttl} seconds");
   error_log("[CACHE-DEBUG] Cache expires at: " . date('Y-m-d H:i:s', time() + $ttl));
   ```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- [ ] –û–ø—Ä–µ–¥–µ–ª–µ–Ω–æ, –∏—Å—Ç–µ–∫–∞–µ—Ç –ª–∏ –∫–µ—à –¥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- [ ] –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–≤–µ–ª–∏—á–µ–Ω TTL

---

### –ü–æ–¥–∑–∞–¥–∞—á–∞ 4: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–¶–µ–ª—å:** –í–Ω–µ–¥—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ - —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –¥–æ–ª–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–µ—à –∫–∞–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è.

**–ù–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ `forceRefresh=false`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–ª–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –Ω–µ–ø–æ–ª–Ω—ã–π –∫–µ—à
- –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –Ω–µ –≤–∫–ª—é—á–∞–ª–æ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–í–Ω–µ–¥—Ä–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ cache-create.php:**
   ```php
   $defaultParams = [
       'includeTickets' => true,
       'includeNewTicketsByStages' => true,         // TASK-081: –î–æ–±–∞–≤–ª–µ–Ω–æ
       'includeCarryoverTickets' => true,
       'includeCarryoverTicketsByDuration' => true, // TASK-081: –î–æ–±–∞–≤–ª–µ–Ω–æ
       'useCache' => true,                          // TASK-081: –î–æ–±–∞–≤–ª–µ–Ω–æ
       'forceRefresh' => true                       // TASK-081: –ò–∑–º–µ–Ω–µ–Ω–æ —Å false –Ω–∞ true
   ];
   ```

2. **–ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ forceRefresh:**
   - `forceRefresh = true` –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è - –≤—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–µ—Ç —Å–≤–µ–∂–∏–π –∫–µ—à

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏:**
- [x] –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [x] –†—É—á–Ω–æ–π –∫–µ—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç forceRefresh=true –¥–ª—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è
- [ ] –†—É—á–Ω–æ–π –∫–µ—à –∏–º–µ–µ—Ç —Ç–∞–∫–æ–π –∂–µ —Ä–∞–∑–º–µ—Ä –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –∫–∞–∫ –∫–µ—à –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:

1. **GraphAdmissionClosureService.php:**
   ```php
   // –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
   error_log("[CACHE-DEBUG] Request time: " . microtime(true));
   error_log("[CACHE-DEBUG] Payload: " . json_encode($payload, JSON_UNESCAPED_UNICODE));
   error_log("[CACHE-DEBUG] Week bounds: {$weekStart->format('c')} - {$weekEnd->format('c')}");
   error_log("[CACHE-DEBUG] Exact key: {$cacheKey}");
   error_log("[CACHE-DEBUG] Universal key: {$universalCacheKey}");
   ```

2. **–í–æ–∑–º–æ–∂–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ TTL:**
   ```php
   // –í GraphAdmissionClosureService.php, —Å—Ç—Ä–æ–∫–∞ 298
   if ($this->cacheStore->set($cacheKey, $response, 3600)) { // 1 —á–∞—Å –≤–º–µ—Å—Ç–æ 120 —Å–µ–∫
   ```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏

### –û–±—â–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏:
- [ ] –†—É—á–Ω–æ–π –∫–µ—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–æ–¥—É–ª—è –Ω–∞–ø—Ä—è–º—É—é
- [ ] Cache hit —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–±–ª–µ–º
- [ ] –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º PSR-12

### –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

**–¢–µ—Å—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π:**
1. –°–æ–∑–¥–∞—Ç—å —Ä—É—á–Ω–æ–π –∫–µ—à
2. –ü–æ–¥–æ–∂–¥–∞—Ç—å 1-2 –º–∏–Ω—É—Ç—ã
3. –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥—É–ª—å –Ω–∞–ø—Ä—è–º—É—é
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ cache hit
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∫–µ—à–∞

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

1. **–¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞**
   ```bash
   # –°–æ–∑–¥–∞—Ç—å –∫–µ—à
   curl -X POST /api/admin/cache-create.php -d '{"module_id":"graph-admission-closure-weeks"}'

   # –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥—É–ª—å (–∏–º–∏—Ç–∞—Ü–∏—è)
   curl -X POST /api/graph-admission-closure/bootstrap.php -d '{"periodMode":"weeks","includeCarryoverTickets":true}'
   ```

2. **–¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤**
   ```
   tail -f /var/log/php/error.log | grep CACHE-DEBUG
   ```

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –†–∞–∑–Ω—ã–µ timezone
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ —Ä–∞—Å—á–µ—Ç—ã –≤ UTC

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ö–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–µ—à–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è TTL
**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å TTL –¥–æ —Ä–∞–∑—É–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (1-24 —á–∞—Å–∞)

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [TASK-080: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –∫–µ—à–∞](./TASK-080-fix-universal-cache-params.md)
- [TASK-076: –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–µ–π —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏](./TASK-076-manual-cache-creation-with-notifications.md)
- [GraphAdmissionClosureService.php](../../../api/graph-admission-closure/service/GraphAdmissionClosureService.php)
- [GraphAdmissionClosureCache.php](../../../api/cache/GraphAdmissionClosureCache.php)

---

## üìä –ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∞–≤–æ–∫

- **2025-01-10 14:30 (UTC+3, –ë—Ä–µ—Å—Ç):** –°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º—ã cache miss
- **2025-01-10 15:00 (UTC+3, –ë—Ä–µ—Å—Ç):** –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ GraphAdmissionClosureService –∏ cache-create.php
- **2025-01-10 15:30 (UTC+3, –ë—Ä–µ—Å—Ç):** –ù–∞–π–¥–µ–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ - —Ä—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –Ω–µ –≤–∫–ª—é—á–∞–ª–æ –ø–æ–ª–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ forceRefresh=false
- **2025-01-10 15:45 (UTC+3, –ë—Ä–µ—Å—Ç):** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ª–æ–≥–∏–∫–∞ –≤ cache-create.php - –¥–æ–±–∞–≤–ª–µ–Ω—ã includeNewTicketsByStages, includeCarryoverTicketsByDuration, forceRefresh=true

---

**–ê–≤—Ç–æ—Ä:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å –∏ –ê–Ω–∞–ª–∏—Ç–∏–∫
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0