# TASK-069: –≠—Ç–∞–ø 1 ‚Äî –ê–Ω–∞–ª–∏–∑ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-23 18:18 (UTC+3, –ë—Ä–µ—Å—Ç)  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏:** –†–µ—Ñ–∞–∫—Ç–æ—Ä-–º–µ–Ω–µ–¥–∂–µ—Ä, –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å

---

## üìã –¶–µ–ª—å —ç—Ç–∞–ø–∞

–ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞ `api/tickets-time-tracking-sector-1c.php`, –≤—ã–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ü–µ–ª–µ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –º–æ–¥—É–ª—è.

---

## üîç –ó–∞–¥–∞—á–∏ —ç—Ç–∞–ø–∞

### 1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞

#### 1.1. –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π

–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—é:

**–§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏ –∏ –Ω–µ–¥–µ–ª—è–º–∏:**
- `getWeekBounds()` ‚Äî –≥—Ä–∞–Ω–∏—Ü—ã —Ç–µ–∫—É—â–µ–π ISO-–Ω–µ–¥–µ–ª–∏
- `getFourWeeksBounds()` ‚Äî –≥—Ä–∞–Ω–∏—Ü—ã 4 –Ω–µ–¥–µ–ª—å
- `getWeekNumberByDate()` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –Ω–µ–¥–µ–ª–∏ –ø–æ –¥–∞—Ç–µ
- `isInRange()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è –¥–∞—Ç—ã –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª

**–§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å HTTP:**
- `jsonResponse()` ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON-–æ—Ç–≤–µ—Ç–∞
- `parseJsonBody()` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞

**–§—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å Bitrix24 API:**
- `getSector1CEmployees()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–°
- `getElapsedTimeRecords()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç
- `getTasksByIds()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø–æ ID
- `getEmployeesData()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
- `getTasksDetails()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∑–∞–¥–∞—á–∞—Ö

**–§—É–Ω–∫—Ü–∏–∏ –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏:**
- `matchTasksWithTickets()` ‚Äî –º–∞—Ç—á–∏–Ω–≥ –∑–∞–¥–∞—á —Å —Ç–∏–∫–µ—Ç–∞–º–∏
- `aggregateByWeeksAndEmployees()` ‚Äî –∞–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ –Ω–µ–¥–µ–ª—è–º –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º
- `createEmployeesSummary()` ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ summary –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º

**–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
- –ë–ª–æ–∫ `try-catch` –≤ –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞ ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### 1.2. –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

```
–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ parseJsonBody()
‚îú‚îÄ‚îÄ getWeekBounds()
‚îú‚îÄ‚îÄ getFourWeeksBounds()
‚îú‚îÄ‚îÄ getSector1CEmployees()
‚îÇ   ‚îî‚îÄ‚îÄ CRest::call('user.get')
‚îú‚îÄ‚îÄ getElapsedTimeRecords()
‚îÇ   ‚îú‚îÄ‚îÄ CRest::call('tasks.task.list')
‚îÇ   ‚îî‚îÄ‚îÄ CRest::call('task.elapseditem.getlist')
‚îú‚îÄ‚îÄ getTasksByIds()
‚îÇ   ‚îî‚îÄ‚îÄ CRest::callBatch('tasks.task.get')
‚îú‚îÄ‚îÄ matchTasksWithTickets()
‚îÇ   ‚îú‚îÄ‚îÄ CRest::call('crm.item.list')
‚îÇ   ‚îî‚îÄ‚îÄ getWeekNumberByDate()
‚îú‚îÄ‚îÄ getEmployeesData()
‚îÇ   ‚îî‚îÄ‚îÄ CRest::call('user.get')
‚îú‚îÄ‚îÄ aggregateByWeeksAndEmployees()
‚îÇ   ‚îú‚îÄ‚îÄ getWeekNumberByDate()
‚îÇ   ‚îî‚îÄ‚îÄ matchTasksWithTickets() (—á–µ—Ä–µ–∑ taskTicketMap)
‚îú‚îÄ‚îÄ createEmployeesSummary()
‚îî‚îÄ‚îÄ getTasksDetails() (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ‚îú‚îÄ‚îÄ CRest::callBatch('tasks.task.get')
    ‚îî‚îÄ‚îÄ matchTasksWithTickets()
```

#### 1.3. –ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í—ã–¥–µ–ª–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```php
// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
const SECTOR_1C_DEPARTMENT_ID = 366;
const ENTITY_TYPE_ID = 140;
const SECTOR_1C_TAG = '1C';

// –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
$pageSize = 50;
$batchSize = 50;
$perPage = 10 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∑–∞–¥–∞—á)
```

#### 1.4. –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –º–æ–¥—É–ª–µ:

**–ó–∞–ø–∏—Å—å —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã:**
```php
[
    'ID' => int,
    'TASK_ID' => int,
    'USER_ID' => int,
    'CREATED_DATE' => string,
    'SECONDS' => int,
    'MINUTES' => float,
    'HOURS' => float,
    'COMMENT_TEXT' => string,
    '_task' => array,
    '_ufCrmTask' => array|null
]
```

**–ù–µ–¥–µ–ª—è:**
```php
[
    'weekNumber' => int,
    'weekStartUtc' => string,
    'weekEndUtc' => string,
    'weekStart' => DateTimeImmutable,
    'weekEnd' => DateTimeImmutable
]
```

**–û—Ç–≤–µ—Ç API:**
```php
[
    'success' => bool,
    'meta' => [
        'weekNumber' => int,
        'weekStartUtc' => string,
        'weekEndUtc' => string,
        'totalWeeks' => int,
        'sector1CEmployeesCount' => int
    ],
    'data' => [
        'totalElapsedTime' => float,
        'totalElapsedTimeUnit' => 'hours',
        'totalRecordsCount' => int,
        'weeks' => array,
        'employeesSummary' => array,
        'tasks' => array (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ),
        'pagination' => array (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ]
]
```

### 2. –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

#### 2.1. –î–∏–∞–≥—Ä–∞–º–º–∞ —Å–ª–æ—ë–≤

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Controller Layer                   ‚îÇ
‚îÇ   TimeTrackingController             ‚îÇ
‚îÇ   - –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–∞                  ‚îÇ
‚îÇ   - –í–∞–ª–∏–¥–∞—Ü–∏—è                        ‚îÇ
‚îÇ   - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Service Layer                      ‚îÇ
‚îÇ   TimeTrackingService                ‚îÇ
‚îÇ   - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏        ‚îÇ
‚îÇ   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–º –¥–∞–Ω–Ω—ã—Ö        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
               ‚îÇ
       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
       ‚îÇ                ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Repository  ‚îÇ  ‚îÇ Domain Layer         ‚îÇ
‚îÇ Layer       ‚îÇ  ‚îÇ - TaskTicketMatcher  ‚îÇ
‚îÇ             ‚îÇ  ‚îÇ - TimeAggregator     ‚îÇ
‚îÇ - Employee  ‚îÇ  ‚îÇ - EmployeeSummary    ‚îÇ
‚îÇ - Task      ‚îÇ  ‚îÇ   Builder            ‚îÇ
‚îÇ - Ticket   ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ - Elapsed   ‚îÇ
‚îÇ   Time      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Bitrix Layer                       ‚îÇ
‚îÇ   Bitrix24Client                     ‚îÇ
‚îÇ   - –û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ CRest                ‚îÇ
‚îÇ   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 2.2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**
```php
interface RepositoryInterface
{
    public function findByIds(array $ids): array;
    public function findByFilter(array $filter): array;
}
```

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞:**
```php
interface AggregatorInterface
{
    public function aggregate(array $records, array $weeks): array;
}
```

#### 2.3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤

**–ö–æ–Ω—Ç—Ä–∞–∫—Ç –º–µ—Ç–æ–¥–∞ `getTimeTrackingData()`:**
```php
/**
 * @param array $params –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:
 *   - product: string (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å '1C')
 *   - weekStartUtc: string|null (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
 *   - weekEndUtc: string|null (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
 *   - includeTaskDetails: bool (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)
 *   - taskIds: array|null (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–¥–∞—á)
 *   - page: int (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
 *   - perPage: int (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)
 * @return array –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ API
 */
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

–°–æ–∑–¥–∞—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É (–≤ —Ñ–æ—Ä–º–∞—Ç–µ Mermaid –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ):

```mermaid
graph TD
    A[HTTP Request] --> B[TimeTrackingController]
    B --> C[TimeTrackingService]
    C --> D[EmployeeRepository]
    C --> E[ElapsedTimeRepository]
    C --> F[TaskRepository]
    C --> G[TicketRepository]
    C --> H[TaskTicketMatcher]
    C --> I[TimeAggregator]
    C --> J[EmployeeSummaryBuilder]
    D --> K[Bitrix24Client]
    E --> K
    F --> K
    G --> K
    K --> L[CRest]
    C --> M[WeekHelper]
    C --> N[DateHelper]
    C --> O[ResponseHelper]
```

### 4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–ø–∏—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

#### 4.1. Unit-—Ç–µ—Å—Ç—ã

**WeekHelper:**
- –¢–µ—Å—Ç `getWeekBounds()` —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º–∏ –¥–∞—Ç–∞–º–∏
- –¢–µ—Å—Ç `getWeekBounds()` –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (—Ç–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è)
- –¢–µ—Å—Ç `getFourWeeksBounds()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ 4 –Ω–µ–¥–µ–ª—å
- –¢–µ—Å—Ç `getWeekNumberByDate()` ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –Ω–µ–¥–µ–ª–∏
- –¢–µ—Å—Ç `isInRange()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø–∞–¥–∞–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª

**DateHelper:**
- –¢–µ—Å—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞—Ç
- –¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã —Å UTC

**ResponseHelper:**
- –¢–µ—Å—Ç `jsonResponse()` ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON
- –¢–µ—Å—Ç `parseJsonBody()` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞

**Bitrix24Client:**
- –¢–µ—Å—Ç `getUsers()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –¢–µ—Å—Ç `getTasks()` ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á
- –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ API

**Repositories:**
- –¢–µ—Å—Ç `EmployeeRepository::getSector1CEmployees()`
- –¢–µ—Å—Ç `TaskRepository::getTasksByIds()`
- –¢–µ—Å—Ç `ElapsedTimeRepository::getElapsedTimeRecords()`

**Domain Services:**
- –¢–µ—Å—Ç `TaskTicketMatcher::matchTasksWithTickets()`
- –¢–µ—Å—Ç `TimeAggregator::aggregateByWeeksAndEmployees()`
- –¢–µ—Å—Ç `EmployeeSummaryBuilder::createEmployeesSummary()`

#### 4.2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑ `includeTaskDetails`)
- –¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å `includeTaskDetails=true`
- –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ Bitrix24 API
- –¢–µ—Å—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–∞

#### 4.3. –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å—Ç–∞—Ä–æ–≥–æ –∏ –Ω–æ–≤–æ–≥–æ –∫–æ–¥–∞
- –¢–µ—Å—Ç —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º –æ–±—ä—ë–º–æ–º –¥–∞–Ω–Ω—ã—Ö

---

## üìù –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç—Ç–∞–ø–∞

### –î–æ–∫—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã:

1. **–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞** (`DOCS/ANALYSIS/tickets-time-tracking-analysis.md`)
   - –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
   - –î–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

2. **–î–∏–∞–≥—Ä–∞–º–º–∞ —Ü–µ–ª–µ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** (–≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–æ)
   - –°–ª–æ–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
   - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

3. **–°–ø–∏—Å–æ–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤** (–≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ –∞–Ω–∞–ª–∏–∑–∞)
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
   - –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã –º–µ—Ç–æ–¥–æ–≤
   - –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

4. **–ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** (`DOCS/TESTING/tickets-time-tracking-test-plan.md`)
   - Unit-—Ç–µ—Å—Ç—ã
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
   - –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ —ç—Ç–∞–ø–∞

- [ ] –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ —Ç–µ–∫—É—â–µ–º —Ñ–∞–π–ª–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –î–∏–∞–≥—Ä–∞–º–º–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —Å–æ–∑–¥–∞–Ω–∞
- [ ] –í—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤—ã–¥–µ–ª–µ–Ω—ã
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –¶–µ–ª–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
- [ ] –î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–æ–∑–¥–∞–Ω–∞
- [ ] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- [ ] –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω
- [ ] –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **–û—Å–Ω–æ–≤–Ω–æ–π –ø–ª–∞–Ω:** `DOCS/REFACTORING/TASK-069-refactoring-plan-tickets-time-tracking.md`
- **–ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª:** `api/tickets-time-tracking-sector-1c.php`
- **–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** `DOCS/REFACTORING/TASK-069-stage-02-structure.md`

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

**2-3 —á–∞—Å–∞**

- –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞: 1 —á–∞—Å
- –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: 30 –º–∏–Ω—É—Ç
- –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º: 30 –º–∏–Ω—É—Ç
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–ª–∞–Ω–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: 30 –º–∏–Ω—É—Ç
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: 30 –º–∏–Ω—É—Ç

---

**–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–∞–≤–æ–∫:**
- 2025-12-23 18:18 (UTC+3, –ë—Ä–µ—Å—Ç): –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç —ç—Ç–∞–ø–∞ 1


