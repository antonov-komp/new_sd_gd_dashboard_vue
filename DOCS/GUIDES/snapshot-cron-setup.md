# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–æ–≤

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-08  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìã –û–±–∑–æ—Ä

–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞ 1–° —á–µ—Ä–µ–∑ cron. –°–ª–µ–ø–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- **–ù–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏:** –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 00:00
- **–ö–æ–Ω–µ—Ü –Ω–µ–¥–µ–ª–∏:** –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 23:59

---

## üéØ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP 7.4 –∏–ª–∏ –≤—ã—à–µ
- –î–æ—Å—Ç—É–ø –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ cron (–ø—Ä–∞–≤–∞ root –∏–ª–∏ sudo)
- –í–µ–±-—Å–µ—Ä–≤–µ—Ä —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º Bitrix24 API (CRest)
- –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `logs/snapshots/`
- –ü—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é —Å–æ —Å–ª–µ–ø–∫–∞–º–∏

---

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron

### –®–∞–≥ 1: –û—Ç–∫—Ä—ã—Ç—å crontab –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
crontab -e
```

–ï—Å–ª–∏ –≤—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ cron –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `www-data`):

```bash
sudo crontab -u www-data -e
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ crontab:

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–ª–µ–ø–∫–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞ 1–°
# –°–ª–µ–ø–æ–∫ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏ (–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 00:00)
0 0 * * 1 cd /var/www/back && php api/create-snapshot-week-start.php >> logs/snapshots/cron-week-start.log 2>&1

# –°–ª–µ–ø–æ–∫ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏ (–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 23:59)
59 23 * * 0 cd /var/www/back && php api/create-snapshot-week-end.php >> logs/snapshots/cron-week-end.log 2>&1
```

**–ü–æ—è—Å–Ω–µ–Ω–∏—è:**
- `0 0 * * 1` ‚Äî –∫–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 00:00 (1 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫)
- `59 23 * * 0` ‚Äî –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ –≤ 23:59 (0 = –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
- `cd /var/www/back` ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞ (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à –ø—É—Ç—å)
- `>> logs/snapshots/cron-week-start.log` ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞ –≤ –ª–æ–≥
- `2>&1` ‚Äî –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –≤ —Ç–æ—Ç –∂–µ —Ñ–∞–π–ª

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```bash
crontab -l
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø–∏—Å–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:

```bash
# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
mkdir -p /var/www/back/logs/snapshots
chmod 755 /var/www/back/logs/snapshots

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ —Å–∫—Ä–∏–ø—Ç—ã
chmod +x /var/www/back/api/create-snapshot-week-start.php
chmod +x /var/www/back/api/create-snapshot-week-end.php
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è cron

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
php scripts/check-snapshot-cron.php
```

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–µ–¥–µ—Ç:
- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
- –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—É—Å–ø–µ—à–Ω–æ/–æ—à–∏–±–∫–∞)
- –ù–∞–ª–∏—á–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–ª–µ–ø–∫–æ–≤
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 20 —Å—Ç—Ä–æ–∫
php scripts/monitor-snapshot-logs.php

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
php scripts/monitor-snapshot-logs.php --lines=50

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
php scripts/monitor-snapshot-logs.php --level=ERROR

# –¢–æ–ª—å–∫–æ —Å–ª–µ–ø–∫–∏ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏
php scripts/monitor-snapshot-logs.php --type=week-start
```

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

```bash
php scripts/monitor-snapshot-logs.php --follow
```

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –≤—ã—Ö–æ–¥–∞.

### –ü—Ä—è–º–æ–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥-—Ñ–∞–π–ª–æ–≤

```bash
# –õ–æ–≥–∏ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏
tail -f logs/snapshots/week-start-2025-12.log

# –õ–æ–≥–∏ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏
tail -f logs/snapshots/week-end-2025-12.log

# Cron-–ª–æ–≥–∏
tail -f logs/snapshots/cron-week-start.log
tail -f logs/snapshots/cron-week-end.log
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥-—Ñ–∞–π–ª–æ–≤

```
logs/
‚îî‚îÄ‚îÄ snapshots/
    ‚îú‚îÄ‚îÄ week-start-2025-12.log    # –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–æ–≤ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏
    ‚îú‚îÄ‚îÄ week-end-2025-12.log      # –õ–æ–≥–∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–æ–≤ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏
    ‚îú‚îÄ‚îÄ cron-week-start.log       # Cron-–ª–æ–≥–∏ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏
    ‚îî‚îÄ‚îÄ cron-week-end.log         # Cron-–ª–æ–≥–∏ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏
```

**–§–æ—Ä–º–∞—Ç –ª–æ–≥-–∑–∞–ø–∏—Å–∏:**
```
[2025-12-08 00:00:00] [INFO] –ù–∞—á–∞–ª–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏
[2025-12-08 00:00:01] [INFO] –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ç–æ—Ä–∞...
[2025-12-08 00:00:15] [INFO] –î–∞–Ω–Ω—ã–µ —Å–µ–∫—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
[2025-12-08 00:00:16] [INFO] –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–µ–∫—Ç–æ—Ä–∞...
[2025-12-08 00:00:17] [INFO] –î–∞–Ω–Ω—ã–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ
[2025-12-08 00:00:18] [INFO] –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–µ–ø–∫–∞...
[2025-12-08 00:00:20] [SUCCESS] –°–ª–µ–ø–æ–∫ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω: 2025/week-50/week-start-2025-12-08.json
```

**–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:**
- `INFO` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `WARNING` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR` ‚Äî –æ—à–∏–±–∫–∏
- `SUCCESS` ‚Äî —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

–ü–µ—Ä–µ–¥ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π cron —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –≤—Ä—É—á–Ω—É—é:

```bash
# –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–∞ –Ω–∞—á–∞–ª–∞ –Ω–µ–¥–µ–ª–∏ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)
php api/create-snapshot-week-start.php --force

# –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–ø–∫–∞ –∫–æ–Ω—Ü–∞ –Ω–µ–¥–µ–ª–∏ (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)
php api/create-snapshot-week-end.php --force

# –¢–µ—Å—Ç –±–µ–∑ –∫–µ—à–∞
php api/create-snapshot-week-start.php --force --no-cache
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã cron

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ cron –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ–≥–æ —Ä–∞–±–æ—Ç—É:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ cron
tail -f /var/log/syslog | grep CRON

# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
grep CRON /var/log/syslog | grep www-data
```

---

## ‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –°–∫—Ä–∏–ø—Ç—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ PHP
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ —Å–∫—Ä–∏–ø—Ç–∞–º
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ PHP:
   ```bash
   which php
   # –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –≤ cron: /usr/bin/php
   ```

2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –ø—É—Ç–∏ –≤ cron:
   ```bash
   0 0 * * 1 /usr/bin/php /var/www/back/api/create-snapshot-week-start.php >> /var/www/back/logs/snapshots/cron-week-start.log 2>&1
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
   ```bash
   chmod +x api/create-snapshot-week-start.php
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å cron

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è cron:
   ```bash
   crontab -l
   # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ cron –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ```

2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞:
   ```bash
   chown -R www-data:www-data /var/www/back/logs/snapshots
   chmod -R 755 /var/www/back/logs/snapshots
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ API

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Bitrix24 API
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ API
- –¢–∞–π–º–∞—É—Ç—ã

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `settings.php` –∏ `crest.php`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –æ—à–∏–±–æ–∫:
   ```bash
   php scripts/monitor-snapshot-logs.php --level=ERROR
   ```
3. –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö (–µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ)

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–µ–ø–∫–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω—ã:**
- –û—à–∏–±–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–æ–∑–¥–∞–Ω–∏—è
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ endpoint `api/snapshots.php`
- –ü—Ä–æ–±–ª–µ–º—ã —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   php scripts/monitor-snapshot-logs.php --level=ERROR
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ endpoint `api/snapshots.php` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å–µ–∫—Ç–æ—Ä–∞:
   ```bash
   curl http://localhost/api/get-sector-data.php
   ```

---

## üîß –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–æ—Ç–∞—Ü–∏—é –ª–æ–≥–æ–≤ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏—Å–∫–∞:

**–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `/etc/logrotate.d/snapshots`:**
```
/var/www/back/logs/snapshots/*.log {
    daily
    rotate 30
    compress
    delaycompress
    missingok
    notifempty
    create 0644 www-data www-data
}
```

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–π—Ç–µ —Å—Ç–∞—Ä—ã–µ –ª–æ–≥-—Ñ–∞–π–ª—ã:

```bash
# –£–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π
find /var/www/back/logs/snapshots -name "*.log" -mtime +90 -delete
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

–°–ª–µ–¥–∏—Ç–µ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞:

```bash
# –†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
du -sh /var/www/back/logs/snapshots

# –†–∞–∑–º–µ—Ä —Å–ª–µ–ø–∫–æ–≤
du -sh /var/www/back/storage/app/snapshots
```

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
php scripts/check-snapshot-cron.php
```

–°–∫—Ä–∏–ø—Ç –≤—ã–≤–æ–¥–∏—Ç:
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø—É—Å–∫–∏
- –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ù–∞–ª–∏—á–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Å–ª–µ–ø–∫–æ–≤
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö –º–æ–∂–Ω–æ:

1. **Email-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email –≤ —Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
2. **Telegram-–±–æ—Ç:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å Telegram-–±–æ—Ç–æ–º –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
3. **–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–ª–µ–ø–∫–æ–≤:** `DOCS/ARCHITECTURE/graph-state-snapshots.md`
- **–ó–∞–¥–∞—á–∏:** `DOCS/TASKS/TASK-019-04-01.md`, `DOCS/TASKS/TASK-019-04-02.md`

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞:

1. –û–±–Ω–æ–≤–∏—Ç–µ –ø—É—Ç–∏ –≤ cron-–∑–∞–ø–∏—Å—è—Ö
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é
3. –û–±–Ω–æ–≤–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

**–ê–≤—Ç–æ—Ä:** –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∏—Å–∞—Ç–µ–ª—å  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-12-08


