const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ticketListUtils-B_VRpfUN.js","./priority-config-C4bE-FeE.js","./main-BMmu7UHV.js","./main-DFwah1ox.css","./priority-config-Bxxce_5E.css","./ticket-mapper-B8nzW9iN.js"])))=>i.map(i=>d[i]);
var Gt=Object.defineProperty;var Ft=(o,t,e)=>t in o?Gt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var et=(o,t,e)=>Ft(o,typeof t!="symbol"?t+"":t,e);import{_ as $e,g as Z,G as De,m as ot,H as $t,f as We,o as g,j as se,k as ve,a as b,d as ae,b as r,y as Ce,n as he,B as we,I as Ht,J as Ye,K as me,L as Vt,M as At,N as He,O as Kt,P as Yt,Q as jt,R as zt,S as qt,U as Zt,V as Xt,W as Jt,X as rt,c as q,Y as C,t as W,F as de,e as ue,Z as Xe,$ as Qt,x as er,l as Se,a0 as tr,z as Dt,r as St,a1 as Et,a2 as Re,T as Je,a3 as Me,a4 as _t}from"./main-BMmu7UHV.js";import{F as Bt}from"./FiltersPanel-CgSXsCzJ.js";import{L as Pe,D as rr,B as ar}from"./index-5rw2n9qS.js";import{g as wt,a as sr,b as Ct,D as or,T as Qe,c as nt}from"./priority-config-C4bE-FeE.js";const nr={key:0,class:"modal-overlay"},lr={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},ir={class:"modal-body"},cr={class:"mode-description"},dr={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:o=>["weeks","months"].includes(o)}},emits:["close","start-loading","select-mode"],setup(o,{emit:t}){const e=o,a=t,s=Z(e.currentMode);function l(m){if(!["weeks","months"].includes(m)){console.warn("[PeriodModeInfoModal] Invalid mode:",m);return}s.value=m,console.log("[DEBUG Modal] handleModeSelect: mode =",m),console.log("[DEBUG Modal] Emitting select-mode event"),a("select-mode",m),console.log("[DEBUG Modal] Emitting close event"),a("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),a("start-loading")},100)}function u(){console.log("[DEBUG Modal] handleClose called, selectedMode =",s.value),console.log("[DEBUG Modal] Emitting select-mode event with",s.value),a("select-mode",s.value),console.log("[DEBUG Modal] Emitting close event"),a("close")}function d(m){m.key==="Escape"&&e.isVisible&&u()}return De(()=>e.currentMode,m=>{["weeks","months"].includes(m)&&(s.value=m)}),ot(()=>{e.isVisible&&document.addEventListener("keydown",d)}),$t(()=>{document.removeEventListener("keydown",d)}),De(()=>e.isVisible,m=>{m?(document.addEventListener("keydown",d),s.value=e.currentMode):document.removeEventListener("keydown",d)}),(m,p)=>(g(),We(Ht,{to:"body"},[se(we,{name:"modal-fade"},{default:ve(()=>[o.isVisible?(g(),b("div",nr,[r("div",lr,[r("div",{class:"modal-header"},[p[2]||(p[2]=r("h2",{id:"modal-title",class:"modal-title"},[r("span",{class:"modal-icon"},"‚ÑπÔ∏è"),Ce(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),r("button",{class:"modal-close-btn",onClick:u,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),r("div",ir,[p[5]||(p[5]=r("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),r("div",cr,[r("button",{class:he(["mode-item mode-item--clickable",{"mode-item--selected":s.value==="weeks"}]),onClick:p[0]||(p[0]=S=>l("weeks")),type:"button"},[...p[3]||(p[3]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìÖ"),r("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),r("button",{class:he(["mode-item mode-item--clickable",{"mode-item--selected":s.value==="months"}]),onClick:p[1]||(p[1]=S=>l("months")),type:"button"},[...p[4]||(p[4]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìä"),r("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):ae("",!0)]),_:1})]))}},ur=$e(dr,[["__scopeId","data-v-4a42a9a6"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Tt=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var o=window.screen;if(o)return(o.deviceXDPI||1)/(o.logicalXDPI||1)}return 1}(),Ve={toTextLines:function(o){var t=[],e;for(o=[].concat(o);o.length;)e=o.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?o.push.apply(o,e):He(o)||t.unshift(""+e);return t},textSize:function(o,t,e){var a=[].concat(t),s=a.length,l=o.font,u=0,d;for(o.font=e.string,d=0;d<s;++d)u=Math.max(o.measureText(a[d]).width,u);return o.font=l,{height:s*e.lineHeight,width:u}},bound:function(o,t,e){return Math.max(o,Math.min(t,e))},arrayDiff:function(o,t){var e=o.slice(),a=[],s,l,u,d;for(s=0,u=t.length;s<u;++s)d=t[s],l=e.indexOf(d),l===-1?a.push([d,1]):e.splice(l,1);for(s=0,u=e.length;s<u;++s)a.push([e[s],-1]);return a},rasterize:function(o){return Math.round(o*Tt)/Tt}};function tt(o,t){var e=t.x,a=t.y;if(e===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var s=o.x-e,l=o.y-a,u=Math.sqrt(s*s+l*l);return{x:u?s/u:0,y:u?l/u:-1}}function kr(o,t,e,a,s){switch(s){case"center":e=a=0;break;case"bottom":e=0,a=1;break;case"right":e=1,a=0;break;case"left":e=-1,a=0;break;case"top":e=0,a=-1;break;case"start":e=-e,a=-a;break;case"end":break;default:s*=Math.PI/180,e=Math.cos(s),a=Math.sin(s);break}return{x:o,y:t,vx:e,vy:a}}var vr=0,Nt=1,Ot=2,Ut=4,It=8;function je(o,t,e){var a=vr;return o<e.left?a|=Nt:o>e.right&&(a|=Ot),t<e.top?a|=It:t>e.bottom&&(a|=Ut),a}function hr(o,t){for(var e=o.x0,a=o.y0,s=o.x1,l=o.y1,u=je(e,a,t),d=je(s,l,t),m,p,S;!(!(u|d)||u&d);)m=u||d,m&It?(p=e+(s-e)*(t.top-a)/(l-a),S=t.top):m&Ut?(p=e+(s-e)*(t.bottom-a)/(l-a),S=t.bottom):m&Ot?(S=a+(l-a)*(t.right-e)/(s-e),p=t.right):m&Nt&&(S=a+(l-a)*(t.left-e)/(s-e),p=t.left),m===u?(e=p,a=S,u=je(e,a,t)):(s=p,l=S,d=je(s,l,t));return{x0:e,x1:s,y0:a,y1:l}}function ze(o,t){var e=t.anchor,a=o,s,l;return t.clamp&&(a=hr(a,t.area)),e==="start"?(s=a.x0,l=a.y0):e==="end"?(s=a.x1,l=a.y1):(s=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),kr(s,l,o.vx,o.vy,t.align)}var qe={arc:function(o,t){var e=(o.startAngle+o.endAngle)/2,a=Math.cos(e),s=Math.sin(e),l=o.innerRadius,u=o.outerRadius;return ze({x0:o.x+a*l,y0:o.y+s*l,x1:o.x+a*u,y1:o.y+s*u,vx:a,vy:s},t)},point:function(o,t){var e=tt(o,t.origin),a=e.x*o.options.radius,s=e.y*o.options.radius;return ze({x0:o.x-a,y0:o.y-s,x1:o.x+a,y1:o.y+s,vx:e.x,vy:e.y},t)},bar:function(o,t){var e=tt(o,t.origin),a=o.x,s=o.y,l=0,u=0;return o.horizontal?(a=Math.min(o.x,o.base),l=Math.abs(o.base-o.x)):(s=Math.min(o.y,o.base),u=Math.abs(o.base-o.y)),ze({x0:a,y0:s+u,x1:a+l,y1:s,vx:e.x,vy:e.y},t)},fallback:function(o,t){var e=tt(o,t.origin);return ze({x0:o.x,y0:o.y,x1:o.x+(o.width||0),y1:o.y+(o.height||0),vx:e.x,vy:e.y},t)}},Ae=Ve.rasterize;function yr(o){var t=o.borderWidth||0,e=o.padding,a=o.size.height,s=o.size.width,l=-s/2,u=-a/2;return{frame:{x:l-e.left-t,y:u-e.top-t,w:s+e.width+t*2,h:a+e.height+t*2},text:{x:l,y:u,w:s,h:a}}}function mr(o,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var a=e.getBasePixel();return o.horizontal?{x:a,y:null}:{x:null,y:a}}function pr(o){return o instanceof zt?qe.arc:o instanceof qt?qe.point:o instanceof Zt?qe.bar:qe.fallback}function gr(o,t,e,a,s,l){var u=Math.PI/2;if(l){var d=Math.min(l,s/2,a/2),m=t+d,p=e+d,S=t+a-d,M=e+s-d;o.moveTo(t,p),m<S&&p<M?(o.arc(m,p,d,-Math.PI,-u),o.arc(S,p,d,-u,0),o.arc(S,M,d,0,u),o.arc(m,M,d,u,Math.PI)):m<S?(o.moveTo(m,e),o.arc(S,p,d,-u,u),o.arc(m,p,d,u,Math.PI+u)):p<M?(o.arc(m,p,d,-Math.PI,0),o.arc(m,M,d,0,Math.PI)):o.arc(m,p,d,-Math.PI,Math.PI),o.closePath(),o.moveTo(t,e)}else o.rect(t,e,a,s)}function fr(o,t,e){var a=e.backgroundColor,s=e.borderColor,l=e.borderWidth;!a&&(!s||!l)||(o.beginPath(),gr(o,Ae(t.x)+l/2,Ae(t.y)+l/2,Ae(t.w)-l,Ae(t.h)-l,e.borderRadius),o.closePath(),a&&(o.fillStyle=a,o.fill()),s&&l&&(o.strokeStyle=s,o.lineWidth=l,o.lineJoin="miter",o.stroke()))}function br(o,t,e){var a=e.lineHeight,s=o.w,l=o.x,u=o.y+a/2;return t==="center"?l+=s/2:(t==="end"||t==="right")&&(l+=s),{h:a,w:s,x:l,y:u}}function _r(o,t,e){var a=o.shadowBlur,s=e.stroked,l=Ae(e.x),u=Ae(e.y),d=Ae(e.w);s&&o.strokeText(t,l,u,d),e.filled&&(a&&s&&(o.shadowBlur=0),o.fillText(t,l,u,d),a&&s&&(o.shadowBlur=a))}function wr(o,t,e,a){var s=a.textAlign,l=a.color,u=!!l,d=a.font,m=t.length,p=a.textStrokeColor,S=a.textStrokeWidth,M=p&&S,ee;if(!(!m||!u&&!M))for(e=br(e,s,d),o.font=d.string,o.textAlign=s,o.textBaseline="middle",o.shadowBlur=a.textShadowBlur,o.shadowColor=a.textShadowColor,u&&(o.fillStyle=l),M&&(o.lineJoin="round",o.lineWidth=S,o.strokeStyle=p),ee=0,m=t.length;ee<m;++ee)_r(o,t[ee],{stroked:M,filled:u,w:e.w,x:e.x,y:e.y+e.h*ee})}var Mt=function(o,t,e,a){var s=this;s._config=o,s._index=a,s._model=null,s._rects=null,s._ctx=t,s._el=e};Ye(Mt.prototype,{_modelize:function(o,t,e,a){var s=this,l=s._index,u=Kt(me([e.font,{}],a,l)),d=me([e.color,Yt.color],a,l);return{align:me([e.align,"center"],a,l),anchor:me([e.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:me([e.backgroundColor,null],a,l),borderColor:me([e.borderColor,null],a,l),borderRadius:me([e.borderRadius,0],a,l),borderWidth:me([e.borderWidth,0],a,l),clamp:me([e.clamp,!1],a,l),clip:me([e.clip,!1],a,l),color:d,display:o,font:u,lines:t,offset:me([e.offset,4],a,l),opacity:me([e.opacity,1],a,l),origin:mr(s._el,a),padding:jt(me([e.padding,4],a,l)),positioner:pr(s._el),rotation:me([e.rotation,0],a,l)*(Math.PI/180),size:Ve.textSize(s._ctx,t,u),textAlign:me([e.textAlign,"start"],a,l),textShadowBlur:me([e.textShadowBlur,0],a,l),textShadowColor:me([e.textShadowColor,d],a,l),textStrokeColor:me([e.textStrokeColor,d],a,l),textStrokeWidth:me([e.textStrokeWidth,0],a,l)}},update:function(o){var t=this,e=null,a=null,s=t._index,l=t._config,u,d,m,p=me([l.display,!0],o,s);p&&(u=o.dataset.data[s],d=Vt(At(l.formatter,[u,o]),u),m=He(d)?[]:Ve.toTextLines(d),m.length&&(e=t._modelize(p,m,l,o),a=yr(e))),t._model=e,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(o,t){var e=this,a=o.ctx,s=e._model,l=e._rects,u;this.visible()&&(a.save(),s.clip&&(u=s.area,a.beginPath(),a.rect(u.left,u.top,u.right-u.left,u.bottom-u.top),a.clip()),a.globalAlpha=Ve.bound(0,s.opacity,1),a.translate(Ae(t.x),Ae(t.y)),a.rotate(s.rotation),fr(a,l.frame,s),wr(a,s.lines,l.text,s),a.restore())}});var Cr=Number.MIN_SAFE_INTEGER||-9007199254740991,Tr=Number.MAX_SAFE_INTEGER||9007199254740991;function Fe(o,t,e){var a=Math.cos(e),s=Math.sin(e),l=t.x,u=t.y;return{x:l+a*(o.x-l)-s*(o.y-u),y:u+s*(o.x-l)+a*(o.y-u)}}function Wt(o,t){var e=Tr,a=Cr,s=t.origin,l,u,d,m,p;for(l=0;l<o.length;++l)u=o[l],d=u.x-s.x,m=u.y-s.y,p=t.vx*d+t.vy*m,e=Math.min(e,p),a=Math.max(a,p);return{min:e,max:a}}function Ze(o,t){var e=t.x-o.x,a=t.y-o.y,s=Math.sqrt(e*e+a*a);return{vx:(t.x-o.x)/s,vy:(t.y-o.y)/s,origin:o,ln:s}}var Rt=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};Ye(Rt.prototype,{center:function(){var o=this._rect;return{x:o.x+o.w/2,y:o.y+o.h/2}},update:function(o,t,e){this._rotation=e,this._rect={x:t.x+o.x,y:t.y+o.y,w:t.w,h:t.h}},contains:function(o){var t=this,e=1,a=t._rect;return o=Fe(o,t.center(),-t._rotation),!(o.x<a.x-e||o.y<a.y-e||o.x>a.x+a.w+e*2||o.y>a.y+a.h+e*2)},intersects:function(o){var t=this._points(),e=o._points(),a=[Ze(t[0],t[1]),Ze(t[0],t[3])],s,l,u;for(this._rotation!==o._rotation&&a.push(Ze(e[0],e[1]),Ze(e[0],e[3])),s=0;s<a.length;++s)if(l=Wt(t,a[s]),u=Wt(e,a[s]),l.max<u.min||u.max<l.min)return!1;return!0},_points:function(){var o=this,t=o._rect,e=o._rotation,a=o.center();return[Fe({x:t.x,y:t.y},a,e),Fe({x:t.x+t.w,y:t.y},a,e),Fe({x:t.x+t.w,y:t.y+t.h},a,e),Fe({x:t.x,y:t.y+t.h},a,e)]}});function Pt(o,t,e){var a=t.positioner(o,t),s=a.vx,l=a.vy;if(!s&&!l)return{x:a.x,y:a.y};var u=e.w,d=e.h,m=t.rotation,p=Math.abs(u/2*Math.cos(m))+Math.abs(d/2*Math.sin(m)),S=Math.abs(u/2*Math.sin(m))+Math.abs(d/2*Math.cos(m)),M=1/Math.max(Math.abs(s),Math.abs(l));return p*=s*M,S*=l*M,p+=t.offset*s,S+=t.offset*l,{x:a.x+p,y:a.y+S}}function Wr(o,t){var e,a,s,l;for(e=o.length-1;e>=0;--e)for(s=o[e].$layout,a=e-1;a>=0&&s._visible;--a)l=o[a].$layout,l._visible&&s._box.intersects(l._box)&&t(s,l);return o}function $r(o){var t,e,a,s,l,u,d;for(t=0,e=o.length;t<e;++t)a=o[t],s=a.$layout,s._visible&&(d=new Proxy(a._el,{get:(m,p)=>m.getProps([p],!0)[p]}),l=a.geometry(),u=Pt(d,a.model(),l),s._box.update(u,l,a.rotation()));return Wr(o,function(m,p){var S=m._hidable,M=p._hidable;S&&M||M?p._visible=!1:S&&(m._visible=!1)})}var Ke={prepare:function(o){var t=[],e,a,s,l,u;for(e=0,s=o.length;e<s;++e)for(a=0,l=o[e].length;a<l;++a)u=o[e][a],t.push(u),u.$layout={_box:new Rt,_hidable:!1,_visible:!0,_set:e,_idx:u._index};return t.sort(function(d,m){var p=d.$layout,S=m.$layout;return p._idx===S._idx?S._set-p._set:S._idx-p._idx}),this.update(t),t},update:function(o){var t=!1,e,a,s,l,u;for(e=0,a=o.length;e<a;++e)s=o[e],l=s.model(),u=s.$layout,u._hidable=l&&l.display==="auto",u._visible=s.visible(),t|=u._hidable;t&&$r(o)},lookup:function(o,t){var e,a;for(e=o.length-1;e>=0;--e)if(a=o[e].$layout,a&&a._visible&&a._box.contains(t))return o[e];return null},draw:function(o,t){var e,a,s,l,u,d;for(e=0,a=t.length;e<a;++e)s=t[e],l=s.$layout,l._visible&&(u=s.geometry(),d=Pt(s._el,s.model(),u),l._box.update(d,u,s.rotation()),s.draw(o,d))}},Ar=function(o){if(He(o))return null;var t=o,e,a,s;if(Xt(o))if(!He(o.label))t=o.label;else if(!He(o.r))t=o.r;else for(t="",e=Object.keys(o),s=0,a=e.length;s<a;++s)t+=(s!==0?", ":"")+e[s]+": "+o[e[s]];return""+t},Dr={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Ar,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},_e="$datalabels",xt="$default";function Sr(o,t){var e=o.datalabels,a={},s=[],l,u;return e===!1?null:(e===!0&&(e={}),t=Ye({},[t,e]),l=t.labels||{},u=Object.keys(l),delete t.labels,u.length?u.forEach(function(d){l[d]&&s.push(Ye({},[t,l[d],{_key:d}]))}):s.push(t),a=s.reduce(function(d,m){return Jt(m.listeners||{},function(p,S){d[S]=d[S]||{},d[S][m._key||xt]=p}),delete m.listeners,d},{}),{labels:s,listeners:a})}function at(o,t,e,a){if(t){var s=e.$context,l=e.$groups,u;t[l._set]&&(u=t[l._set][l._key],u&&At(u,[s,a])===!0&&(o[_e]._dirty=!0,e.update(s)))}}function Er(o,t,e,a,s){var l,u;!e&&!a||(e?a?e!==a&&(u=l=!0):u=!0:l=!0,u&&at(o,t.leave,e,s),l&&at(o,t.enter,a,s))}function Br(o,t){var e=o[_e],a=e._listeners,s,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Ke.lookup(e._labels,t);else if(t.type!=="mouseout")return;s=e._hovered,e._hovered=l,Er(o,a,s,l,t)}}function Nr(o,t){var e=o[_e],a=e._listeners.click,s=a&&Ke.lookup(e._labels,t);s&&at(o,a,s,t)}var Lt={id:"datalabels",defaults:Dr,beforeInit:function(o){o[_e]={_actives:[]}},beforeUpdate:function(o){var t=o[_e];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(o,t,e){var a=t.index,s=o[_e],l=s._datasets[a]=[],u=o.isDatasetVisible(a),d=o.data.datasets[a],m=Sr(d,e),p=t.meta.data||[],S=o.ctx,M,ee,Q,N,B,T,h,c;for(S.save(),M=0,Q=p.length;M<Q;++M)if(h=p[M],h[_e]=[],u&&h&&o.getDataVisibility(M)&&!h.skip)for(ee=0,N=m.labels.length;ee<N;++ee)B=m.labels[ee],T=B._key,c=new Mt(B,S,h,M),c.$groups={_set:a,_key:T||xt},c.$context={active:!1,chart:o,dataIndex:M,dataset:d,datasetIndex:a},c.update(c.$context),h[_e].push(c),l.push(c);S.restore(),Ye(s._listeners,m.listeners,{merger:function(w,A,U){A[w]=A[w]||{},A[w][t.index]=U[w],s._listened=!0}})},afterUpdate:function(o){o[_e]._labels=Ke.prepare(o[_e]._datasets)},afterDatasetsDraw:function(o){Ke.draw(o,o[_e]._labels)},beforeEvent:function(o,t){if(o[_e]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":Br(o,e);break;case"click":Nr(o,e);break}}},afterEvent:function(o){var t=o[_e],e=t._actives,a=t._actives=o.getActiveElements(),s=Ve.arrayDiff(e,a),l,u,d,m,p,S,M;for(l=0,u=s.length;l<u;++l)if(p=s[l],p[1])for(M=p[0].element[_e]||[],d=0,m=M.length;d<m;++d)S=M[d],S.$context.active=p[1]===1,S.update(S.$context);(t._dirty||s.length)&&(Ke.update(t._labels),o.render()),delete t._dirty}};const Or={class:"ac-chart"},Ur={class:"ac-chart__header"},Ir={class:"ac-chart__subtitle"},Mr={class:"ac-chart__controls"},Rr={class:"chart-type-selector"},Pr=["onClick"],xr={class:"chart-type-icon"},Lr={class:"chart-type-label"},Gr={class:"ac-chart__summary"},Fr={class:"summary-week-block summary-week-block--current"},Hr={class:"summary-week-block__title"},Vr={class:"summary-week-block__title-week"},Kr={key:0,class:"summary-week-block__title-dates"},Yr={class:"summary-week-block__cards"},jr={class:"summary-card__value-wrapper"},zr={class:"summary-card__value"},qr=["title"],Zr={class:"percentage-indicator__arrow"},Xr={class:"percentage-indicator__value"},Jr={class:"percentage-indicator__label"},Qr={class:"summary-card__value-wrapper"},ea={class:"summary-card__value-main"},ta=["title"],ra={class:"percentage-indicator__arrow"},aa={class:"percentage-indicator__value"},sa={class:"percentage-indicator__label"},oa={class:"summary-card__breakdown"},na={class:"breakdown-item breakdown-item--this-week"},la={class:"breakdown-item__value"},ia={class:"breakdown-item breakdown-item--other-week"},ca={class:"breakdown-item__value"},da={class:"summary-card__value-wrapper"},ua={class:"summary-card__value-main"},ka=["title"],va={class:"percentage-indicator__arrow"},ha={class:"percentage-indicator__value"},ya={class:"percentage-indicator__label"},ma={class:"summary-card__breakdown"},pa={class:"breakdown-item breakdown-item--this-week"},ga={class:"breakdown-item__value"},fa={class:"breakdown-item breakdown-item--previous-week"},ba={class:"breakdown-item__value"},_a={class:"breakdown-item breakdown-item--older"},wa={class:"breakdown-item__value"},Ca={class:"summary-card summary-card--stages"},Ta={class:"summary-card__tags"},Wa={key:0,class:"stage-tag stage-tag--empty"},$a={key:0,class:"summary-week-divider"},Aa={key:1,class:"summary-week-block summary-week-block--previous"},Da={class:"summary-week-block__title"},Sa={class:"summary-week-block__title-week"},Ea={key:0,class:"summary-week-block__title-dates"},Ba={class:"summary-week-block__cards"},Na={class:"summary-card__value-wrapper"},Oa={class:"summary-card__values-comparison"},Ua={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Ia={class:"summary-card__value"},Ma={class:"value-label"},Ra={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Pa={class:"summary-card__value summary-card__value--current-week"},xa={class:"value-label"},La=["title"],Ga={class:"percentage-indicator__arrow"},Fa={class:"percentage-indicator__value"},Ha={class:"percentage-indicator__label"},Va={class:"summary-card__value-wrapper"},Ka={class:"summary-card__values-comparison"},Ya={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ja={class:"summary-card__value-main"},za={class:"value-label"},qa={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Za={class:"summary-card__value-main summary-card__value-main--current-week"},Xa={class:"value-label"},Ja=["title"],Qa={class:"percentage-indicator__arrow"},es={class:"percentage-indicator__value"},ts={class:"percentage-indicator__label"},rs={class:"summary-card__breakdown"},as={class:"breakdown-item breakdown-item--this-week"},ss={class:"breakdown-item__value"},os={class:"breakdown-item breakdown-item--other-week"},ns={class:"breakdown-item__value"},ls={class:"summary-card__value-wrapper"},is={class:"summary-card__values-comparison"},cs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ds={class:"summary-card__value-main"},us={class:"value-label"},ks={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},vs={class:"summary-card__value-main summary-card__value-main--current-week"},hs={class:"value-label"},ys=["title"],ms={class:"percentage-indicator__arrow"},ps={class:"percentage-indicator__value"},gs={class:"percentage-indicator__label"},fs={class:"summary-card__breakdown"},bs={class:"breakdown-item breakdown-item--this-week"},_s={class:"breakdown-item__value"},ws={class:"breakdown-item breakdown-item--previous-week"},Cs={class:"breakdown-item__value"},Ts={class:"breakdown-item breakdown-item--older"},Ws={class:"breakdown-item__value"},$s={class:"summary-card summary-card--stages summary-card--previous"},As={class:"summary-card__tags"},Ds={key:0,class:"stage-tag stage-tag--empty"},Ss={class:"ac-chart__body"},Es={key:0,class:"split-charts-container"},Bs={class:"chart-wrapper chart-wrapper--left"},Ns={class:"chart-canvas-wrapper"},Os={class:"chart-wrapper chart-wrapper--right"},Us={class:"chart-canvas-wrapper"},Is={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0],carryoverCreatedOtherWeek:[0]},stagesByWeek:[],stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(o,{emit:t}){rt.register(Lt);const e=o,a=t,s=q(()=>{var n;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>=2?k[k.length-2]:null}),l=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],u=Z("line"),d={color:"#111827",font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:k=>{var n;return((n=k==null?void 0:k.dataset)==null?void 0:n.borderColor)||"#111827"},borderWidth:1,borderRadius:4,padding:4,offset:8,formatter:k=>k==null||isNaN(k)?"":h(k),display:k=>{var R,K,P,j;if(((K=(R=k==null?void 0:k.chart)==null?void 0:R.config)==null?void 0:K.type)!=="line")return!1;const D=(j=(P=k==null?void 0:k.dataset)==null?void 0:P.data)==null?void 0:j[k.dataIndex];return D!=null&&!isNaN(D)&&isFinite(D)}};q(()=>{var k;return((k=e.meta)==null?void 0:k.weekNumber)??"‚Äî"});const m=()=>{var n,D;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>0?k.map(R=>`–ù–µ–¥–µ–ª—è ${R.weekNumber}`):[(D=e.meta)!=null&&D.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function p(k,n,D,R=.3,K=0){if(!n)return((f,i)=>{const y=parseInt(f.slice(1,3),16),$=parseInt(f.slice(3,5),16),F=parseInt(f.slice(5,7),16);return`rgba(${y}, ${$}, ${F}, ${i})`})(D,R);const P=(V,f)=>{const i=parseInt(V.slice(1,3),16),y=parseInt(V.slice(3,5),16),$=parseInt(V.slice(5,7),16);return`rgba(${i}, ${y}, ${$}, ${f})`},j=k.createLinearGradient(0,n.bottom,0,n.top);return j.addColorStop(0,P(D,R)),j.addColorStop(1,P(D,K)),j}const S=q(()=>{var P,j,V,f;const k=m(),n=Array.isArray((P=e.data.series)==null?void 0:P.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],D=Array.isArray((j=e.data.series)==null?void 0:j.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],R=Array.isArray((V=e.data.series)==null?void 0:V.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],K=Array.isArray((f=e.data.series)==null?void 0:f.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:k,datasets:[{label:"–ù–æ–≤—ã–µ",data:n,backgroundColor:i=>{const y=i.chart,{ctx:$,chartArea:F}=y;return p($,F,C.primary)},borderColor:C.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.primary,pointBackgroundColor:C.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:C.primary,borderColor:C.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:D,backgroundColor:i=>{const y=i.chart,{ctx:$,chartArea:F}=y;return p($,F,C.success)},borderColor:C.success,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.success,pointBackgroundColor:C.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:C.success,borderColor:C.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:R,backgroundColor:C.successLight,borderColor:C.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.successLight,pointBackgroundColor:C.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.successLight,borderColor:C.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:K,backgroundColor:C.warning,borderColor:C.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.warning,borderColor:C.warning}}]}}),M=q(()=>{var P,j,V,f,i;const k=m(),n=Array.isArray((P=e.data.series)==null?void 0:P.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],D=Array.isArray((j=e.data.series)==null?void 0:j.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],R=Array.isArray((V=e.data.series)==null?void 0:V.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],K=Array.isArray((f=e.data.series)==null?void 0:f.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((i=e.data.series)==null?void 0:i.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:k,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:n,backgroundColor:y=>{const $=y.chart,{ctx:F,chartArea:J}=$;return p(F,J,C.carryover)},borderColor:C.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryover,pointBackgroundColor:C.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:C.carryover,borderColor:C.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:D,backgroundColor:C.carryoverLight,borderColor:C.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverLight,pointBackgroundColor:C.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverLight,borderColor:C.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:R,backgroundColor:C.warning,borderColor:C.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:K,backgroundColor:C.carryoverDark,borderColor:C.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverDark,pointBackgroundColor:C.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverDark,borderColor:C.carryoverDark}}]}}),ee=q(()=>{var y,$,F,J,re,ce,pe,Te,ge,fe,te;const k=((y=e.meta)==null?void 0:y.weeks)||[],n=k.length>0?k.map(ke=>`–ù–µ–¥–µ–ª—è ${ke.weekNumber}`):[($=e.meta)!=null&&$.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],D=Array.isArray((F=e.data.series)==null?void 0:F.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],R=Array.isArray((J=e.data.series)==null?void 0:J.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],K=Array.isArray((re=e.data.series)==null?void 0:re.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],P=Array.isArray((ce=e.data.series)==null?void 0:ce.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],j=Array.isArray((pe=e.data.series)==null?void 0:pe.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],V=Array.isArray((Te=e.data.series)==null?void 0:Te.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],f=Array.isArray((ge=e.data.series)==null?void 0:ge.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],i=Array.isArray((fe=e.data.series)==null?void 0:fe.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((te=e.data.series)==null?void 0:te.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:n,datasets:[{label:"–ù–æ–≤—ã–µ",data:D,backgroundColor:C.primary,borderColor:C.primary,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.primary,pointBackgroundColor:C.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:C.primary,borderColor:C.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:R,backgroundColor:C.success,borderColor:C.success,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.success,pointBackgroundColor:C.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:C.success,borderColor:C.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:K,backgroundColor:C.successLight,borderColor:C.successLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.successLight,pointBackgroundColor:C.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.successLight,borderColor:C.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:P,backgroundColor:C.warning,borderColor:C.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:j,backgroundColor:C.carryover,borderColor:C.carryover,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryover,pointBackgroundColor:C.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:C.carryover,borderColor:C.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:V,backgroundColor:C.carryoverLight,borderColor:C.carryoverLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverLight,pointBackgroundColor:C.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverLight,borderColor:C.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:f,backgroundColor:C.warning,borderColor:C.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:i,backgroundColor:C.carryoverDark,borderColor:C.carryoverDark,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverDark,pointBackgroundColor:C.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverDark,borderColor:C.carryoverDark}}]}}),Q=q(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[C.primary,C.success,C.carryover],borderWidth:1}]})),N=q(()=>{switch(u.value){case"line":return Pe;case"bar":return ar;case"doughnut":return rr;default:return Pe}}),B=q(()=>u.value==="doughnut"?Q.value:ee.value),T=k=>{if(!k)return"‚Äî";try{return new Date(k).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return k}};function h(k){return k==null||isNaN(k)?"0":k>=1e3?k.toLocaleString("ru-RU"):k.toString()}function c(k){const n=k%10,D=k%100;return D>=11&&D<=14?"—Ç–∏–∫–µ—Ç–æ–≤":n===1?"—Ç–∏–∫–µ—Ç":n>=2&&n<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const w=q(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{datalabels:{...d,anchor:"end",align:"top"},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:k=>{var j,V,f,i,y,$;if(!k||k.length===0)return"";const n=(j=k[0])==null?void 0:j.dataIndex,D=((V=e.meta)==null?void 0:V.weeks)||[];if(D.length>0&&n!==void 0&&D[n]){const F=D[n];return`–ù–µ–¥–µ–ª—è ${F.weekNumber} (${T(F.weekStartUtc)} ‚Äî ${T(F.weekEndUtc)})`}const R=(f=e.meta)==null?void 0:f.weekNumber,K=(i=e.meta)==null?void 0:i.weekStartUtc,P=(y=e.meta)==null?void 0:y.weekEndUtc;return R&&K&&P?`–ù–µ–¥–µ–ª—è ${R} (${T(K)} ‚Äî ${T(P)})`:(($=k[0])==null?void 0:$.label)||""},label:k=>{const n=k.parsed.y,D=k.dataset.label||"";if(n==null||isNaN(n))return`${D}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const R=h(n),K=c(n);return`${D}: ${R} ${K}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:k=>rt.defaults.plugins.legend.labels.generateLabels(k).map((D,R)=>{const K=k.data.datasets[R],P=k.getDatasetMeta(R),j=K.borderDash&&Array.isArray(K.borderDash)&&K.borderDash.length>0||K.borderWidth===2||K.fill===!1;return P.hidden?(D.fontColor="#9ca3af",D.textDecoration="line-through",D.opacity=.5):j?D.fontColor="#6b7280":D.fontColor="#111827",D})},onClick:(k,n)=>{const D=n.datasetIndex;if(D==null){console.warn("[Legend] Invalid datasetIndex:",D);return}const R=k.chart;if(!R){console.warn("[Legend] Chart not found");return}const K=R.getDatasetMeta(D);if(!K){console.warn("[Legend] Dataset meta not found for index:",D);return}K.hidden=!K.hidden,R.update("active")},onHover:(k,n)=>{k.native&&k.native.target&&(k.native.target.style.cursor="pointer")},onLeave:(k,n)=>{k.native&&k.native.target&&(k.native.target.style.cursor="default")}}},scales:u.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:k=>k==null||isNaN(k)?"0":h(k)},title:{display:!1},grid:{color:k=>{if(!k||!k.tick||k.tick.value===void 0)return"#e5e7eb";const n=k.tick.value;return isNaN(n)||!isFinite(n)?"#e5e7eb":n===0||n%5===0?"#d1d5db":"#e5e7eb"},lineWidth:k=>{if(!k||!k.tick||k.tick.value===void 0)return 1;const n=k.tick.value;return isNaN(n)||!isFinite(n)?1:n===0||n%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),A=q(()=>{var k,n,D,R,K,P,j,V;if((k=e.data)!=null&&k.series){const f=e.data.series,i=Math.max((Array.isArray(f.new)?f.new.length:0)-1,(Array.isArray(f.closed)?f.closed.length:0)-1,(Array.isArray(f.closedCreatedThisWeek)?f.closedCreatedThisWeek.length:0)-1,(Array.isArray(f.closedCreatedOtherWeek)?f.closedCreatedOtherWeek.length:0)-1,(Array.isArray(f.carryover)?f.carryover.length:0)-1,(Array.isArray(f.carryoverCreatedThisWeek)?f.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(f.carryoverCreatedPreviousWeek)?f.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(f.carryoverCreatedOlder)?f.carryoverCreatedOlder.length:0)-1,(Array.isArray(f.carryoverCreatedOtherWeek)?f.carryoverCreatedOtherWeek.length:0)-1,-1);if(i>=0){const y={newTickets:Array.isArray(f.new)&&f.new[i]!==void 0?f.new[i]:0,closedTickets:Array.isArray(f.closed)&&f.closed[i]!==void 0?f.closed[i]:0,closedTicketsCreatedThisWeek:Array.isArray(f.closedCreatedThisWeek)&&f.closedCreatedThisWeek[i]!==void 0?f.closedCreatedThisWeek[i]:0,closedTicketsCreatedOtherWeek:Array.isArray(f.closedCreatedOtherWeek)&&f.closedCreatedOtherWeek[i]!==void 0?f.closedCreatedOtherWeek[i]:0,carryoverTickets:Array.isArray(f.carryover)&&f.carryover[i]!==void 0?f.carryover[i]:0,carryoverTicketsCreatedThisWeek:Array.isArray(f.carryoverCreatedThisWeek)&&f.carryoverCreatedThisWeek[i]!==void 0?f.carryoverCreatedThisWeek[i]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(f.carryoverCreatedPreviousWeek)&&f.carryoverCreatedPreviousWeek[i]!==void 0?f.carryoverCreatedPreviousWeek[i]:0,carryoverTicketsCreatedOlder:Array.isArray(f.carryoverCreatedOlder)&&f.carryoverCreatedOlder[i]!==void 0?f.carryoverCreatedOlder[i]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(f.carryoverCreatedOtherWeek)&&f.carryoverCreatedOtherWeek[i]!==void 0?f.carryoverCreatedOtherWeek[i]:0};if(y.carryoverTickets>0&&console.log("[DEBUG currentWeekData]",{total:y.carryoverTickets,thisWeek:y.carryoverTicketsCreatedThisWeek,previousWeek:y.carryoverTicketsCreatedPreviousWeek,older:y.carryoverTicketsCreatedOlder,otherWeek:y.carryoverTicketsCreatedOtherWeek,sum:y.carryoverTicketsCreatedThisWeek+y.carryoverTicketsCreatedPreviousWeek+y.carryoverTicketsCreatedOlder,lastIndex:i,series:{carryoverCreatedPreviousWeek:f.carryoverCreatedPreviousWeek,carryoverCreatedOlder:f.carryoverCreatedOlder,carryoverCreatedPreviousWeekLength:(n=f.carryoverCreatedPreviousWeek)==null?void 0:n.length,carryoverCreatedOlderLength:(D=f.carryoverCreatedOlder)==null?void 0:D.length,carryoverCreatedPreviousWeekLast:(R=f.carryoverCreatedPreviousWeek)==null?void 0:R[i],carryoverCreatedOlderLast:(K=f.carryoverCreatedOlder)==null?void 0:K[i]},currentWeek:e.data.currentWeek,data:{carryoverTicketsCreatedPreviousWeek:e.data.carryoverTicketsCreatedPreviousWeek,carryoverTicketsCreatedOlder:e.data.carryoverTicketsCreatedOlder}}),y.newTickets>0||y.closedTickets>0||y.carryoverTickets>0)return y}}if((P=e.data)!=null&&P.currentWeek&&typeof e.data.currentWeek=="object"){const f=e.data.currentWeek;if((f.newTickets??0)>0||(f.closedTickets??0)>0||(f.carryoverTickets??0)>0)return f}if((j=e.data)!=null&&j.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const f=e.data.weeksData[e.data.weeksData.length-1];if((f.newTickets??0)>0||(f.closedTickets??0)>0||(f.carryoverTickets??0)>0)return f}if((V=e.data)!=null&&V.series){const f=e.data.series,i=Math.max((Array.isArray(f.new)?f.new.length:0)-1,(Array.isArray(f.closed)?f.closed.length:0)-1,(Array.isArray(f.carryover)?f.carryover.length:0)-1,-1);if(i>=0)return{newTickets:Array.isArray(f.new)&&f.new[i]!==void 0?f.new[i]:0,closedTickets:Array.isArray(f.closed)&&f.closed[i]!==void 0?f.closed[i]:0,closedTicketsCreatedThisWeek:Array.isArray(f.closedCreatedThisWeek)&&f.closedCreatedThisWeek[i]!==void 0?f.closedCreatedThisWeek[i]:0,closedTicketsCreatedOtherWeek:Array.isArray(f.closedCreatedOtherWeek)&&f.closedCreatedOtherWeek[i]!==void 0?f.closedCreatedOtherWeek[i]:0,carryoverTickets:Array.isArray(f.carryover)&&f.carryover[i]!==void 0?f.carryover[i]:0,carryoverTicketsCreatedThisWeek:Array.isArray(f.carryoverCreatedThisWeek)&&f.carryoverCreatedThisWeek[i]!==void 0?f.carryoverCreatedThisWeek[i]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(f.carryoverCreatedPreviousWeek)&&f.carryoverCreatedPreviousWeek[i]!==void 0?f.carryoverCreatedPreviousWeek[i]:0,carryoverTicketsCreatedOlder:Array.isArray(f.carryoverCreatedOlder)&&f.carryoverCreatedOlder[i]!==void 0?f.carryoverCreatedOlder[i]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(f.carryoverCreatedOtherWeek)&&f.carryoverCreatedOtherWeek[i]!==void 0?f.carryoverCreatedOtherWeek[i]:0}}return e.data||{}}),U=q(()=>{var n,D,R,K,P,j,V,f,i,y;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>0?k[k.length-1]:{weekNumber:((R=(D=e.meta)==null?void 0:D.currentWeek)==null?void 0:R.weekNumber)??((K=e.meta)==null?void 0:K.weekNumber)??null,weekStartUtc:((j=(P=e.meta)==null?void 0:P.currentWeek)==null?void 0:j.weekStartUtc)??((V=e.meta)==null?void 0:V.weekStartUtc)??null,weekEndUtc:((i=(f=e.meta)==null?void 0:f.currentWeek)==null?void 0:i.weekEndUtc)??((y=e.meta)==null?void 0:y.weekEndUtc)??null}}),E=q(()=>{var k,n,D,R,K,P,j,V,f;if((k=e.data)!=null&&k.series){const i=e.data.series,y=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.closedCreatedThisWeek)?i.closedCreatedThisWeek.length:0)-1,(Array.isArray(i.closedCreatedOtherWeek)?i.closedCreatedOtherWeek.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,(Array.isArray(i.carryoverCreatedThisWeek)?i.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(i.carryoverCreatedPreviousWeek)?i.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(i.carryoverCreatedOlder)?i.carryoverCreatedOlder.length:0)-1,(Array.isArray(i.carryoverCreatedOtherWeek)?i.carryoverCreatedOtherWeek.length:0)-1,-1);if(y>=1){const $=y-1,F=(D=(n=e.meta)==null?void 0:n.weeks)==null?void 0:D[$],J={weekNumber:(F==null?void 0:F.weekNumber)??null,weekStartUtc:(F==null?void 0:F.weekStartUtc)??null,weekEndUtc:(F==null?void 0:F.weekEndUtc)??null,newTickets:Array.isArray(i.new)&&i.new[$]!==void 0?i.new[$]:0,closedTickets:Array.isArray(i.closed)&&i.closed[$]!==void 0?i.closed[$]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[$]!==void 0?i.closedCreatedThisWeek[$]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[$]!==void 0?i.closedCreatedOtherWeek[$]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[$]!==void 0?i.carryover[$]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[$]!==void 0?i.carryoverCreatedThisWeek[$]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(i.carryoverCreatedPreviousWeek)&&i.carryoverCreatedPreviousWeek[$]!==void 0?i.carryoverCreatedPreviousWeek[$]:0,carryoverTicketsCreatedOlder:Array.isArray(i.carryoverCreatedOlder)&&i.carryoverCreatedOlder[$]!==void 0?i.carryoverCreatedOlder[$]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[$]!==void 0?i.carryoverCreatedOtherWeek[$]:0};if(J.newTickets>0||J.closedTickets>0||J.carryoverTickets>0)return J}}if((R=e.data)!=null&&R.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const i=e.data.weeksData.length-2,y=e.data.weeksData[i],$=(P=(K=e.meta)==null?void 0:K.weeks)==null?void 0:P[i];if((y.newTickets??0)>0||(y.closedTickets??0)>0||(y.carryoverTickets??0)>0)return{weekNumber:y.weekNumber??($==null?void 0:$.weekNumber)??null,weekStartUtc:($==null?void 0:$.weekStartUtc)??null,weekEndUtc:($==null?void 0:$.weekEndUtc)??null,newTickets:y.newTickets??0,closedTickets:y.closedTickets??0,closedTicketsCreatedThisWeek:y.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:y.closedTicketsCreatedOtherWeek??0,carryoverTickets:y.carryoverTickets??0,carryoverTicketsCreatedThisWeek:y.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:y.carryoverTicketsCreatedOtherWeek??0}}if((j=e.data)!=null&&j.series){const i=e.data.series,y=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,-1);if(y>=1){const $=y-1,F=(f=(V=e.meta)==null?void 0:V.weeks)==null?void 0:f[$];return{weekNumber:(F==null?void 0:F.weekNumber)??null,weekStartUtc:(F==null?void 0:F.weekStartUtc)??null,weekEndUtc:(F==null?void 0:F.weekEndUtc)??null,newTickets:Array.isArray(i.new)&&i.new[$]!==void 0?i.new[$]:0,closedTickets:Array.isArray(i.closed)&&i.closed[$]!==void 0?i.closed[$]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[$]!==void 0?i.closedCreatedThisWeek[$]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[$]!==void 0?i.closedCreatedOtherWeek[$]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[$]!==void 0?i.carryover[$]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[$]!==void 0?i.carryoverCreatedThisWeek[$]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(i.carryoverCreatedPreviousWeek)&&i.carryoverCreatedPreviousWeek[$]!==void 0?i.carryoverCreatedPreviousWeek[$]:0,carryoverTicketsCreatedOlder:Array.isArray(i.carryoverCreatedOlder)&&i.carryoverCreatedOlder[$]!==void 0?i.carryoverCreatedOlder[$]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[$]!==void 0?i.carryoverCreatedOtherWeek[$]:0}}}return null}),G=q(()=>{var n;const k=(n=e.data)==null?void 0:n.stagesByWeek;return Array.isArray(k)?k:null}),O=q(()=>{var n;const k=G.value;if(k&&k.length>0){const D=k.length-1,R=k[D];if(Array.isArray(R))return R}return((n=e.data)==null?void 0:n.stages)??[]}),I=q(()=>{const k=G.value;if(k&&k.length>=2){const n=k.length-2,D=k[n];if(Array.isArray(D))return D}return[]}),H=q(()=>{var k;return(k=E.value)!=null&&k.weekNumber?`–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–µ–¥–µ–ª–∏ ${E.value.weekNumber}`:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"});function Y(k,n){if(typeof k!="number"||isNaN(k)||n==null||typeof n!="number"||isNaN(n)||n===0)return null;if(k===n)return 0;const D=(k-n)/n*100;return!isFinite(D)||isNaN(D)?null:D}function x(k){return k==null||isNaN(k)?"":`${k>=0?"+":""}${k.toFixed(1)}%`}const X=q(()=>{var k,n,D;if((k=e.data)!=null&&k.series){const R=e.data.series,K=Math.max((Array.isArray(R.new)?R.new.length:0)-1,(Array.isArray(R.closed)?R.closed.length:0)-1,(Array.isArray(R.carryover)?R.carryover.length:0)-1,-1);if(K>=2){const P=K-2,j=(D=(n=e.meta)==null?void 0:n.weeks)==null?void 0:D[P];return{weekNumber:(j==null?void 0:j.weekNumber)??null,newTickets:Array.isArray(R.new)&&R.new[P]!==void 0?R.new[P]:0,closedTickets:Array.isArray(R.closed)&&R.closed[P]!==void 0?R.closed[P]:0,carryoverTickets:Array.isArray(R.carryover)&&R.carryover[P]!==void 0?R.carryover[P]:0}}}return null}),_=q(()=>{const k=A.value,n=E.value;return!k||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:Y(k.newTickets??0,n.newTickets??0),closedTickets:Y(k.closedTickets??0,n.closedTickets??0),carryoverTickets:Y(k.carryoverTickets??0,n.carryoverTickets??0)}}),v=q(()=>{const k=E.value,n=X.value;return!k||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:Y(k.newTickets??0,n.newTickets??0),closedTickets:Y(k.closedTickets??0,n.closedTickets??0),carryoverTickets:Y(k.carryoverTickets??0,n.carryoverTickets??0)}});function L(k,n){if(!k||!n)return"";try{const D=new Date(k),R=new Date(n),K=D.getUTCDate(),P=D.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),j=D.getUTCFullYear(),V=R.getUTCDate(),f=R.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),i=R.getUTCFullYear();return j===i&&P===f?`${K} ‚Äî ${V} ${P}`:j===i?`${K} ${P} ‚Äî ${V} ${f}`:`${K} ${P} ${j} ‚Äî ${V} ${f} ${i}`}catch(D){return console.error("[formatWeekDates] Error:",D),""}}const z=k=>{const n=A.value,D=(n==null?void 0:n.newTickets)??0,R=(n==null?void 0:n.closedTickets)??0,K=(n==null?void 0:n.carryoverTickets)??0,P=U.value;k==="new"&&D>0?a("open-stages",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="closed"&&R>0?a("open-responsible",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="carryover"&&K>0&&a("open-carryover",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc})},oe=k=>{const n=E.value;if(!n)return;const D=(n==null?void 0:n.newTickets)??0,R=(n==null?void 0:n.closedTickets)??0,K=(n==null?void 0:n.carryoverTickets)??0,P=s.value;P&&(k==="new"&&D>0?a("open-stages",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="closed"&&R>0?a("open-responsible",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="carryover"&&K>0&&a("open-carryover",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}))};return(k,n)=>{var D,R,K,P,j,V,f,i,y,$,F,J,re,ce,pe,Te,ge,fe,te,ke,ne,ie,le,be,Be,Ne,Oe,Ue,Ie,xe,Le,Ge,lt,it,ct,dt,ut,kt,vt,ht,yt,mt,pt,gt,ft,bt;return g(),b("div",Or,[r("header",Ur,[r("div",null,[n[6]||(n[6]=r("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),r("p",Ir," –ù–µ–¥–µ–ª—è "+W(((R=(D=o.meta)==null?void 0:D.currentWeek)==null?void 0:R.weekNumber)??((K=o.meta)==null?void 0:K.weekNumber)??"‚Äî")+" ¬∑ "+W((((j=(P=o.meta)==null?void 0:P.currentWeek)==null?void 0:j.weekStartUtc)??((V=o.meta)==null?void 0:V.weekStartUtc))||"‚Äî")+" ‚Äî "+W((((i=(f=o.meta)==null?void 0:f.currentWeek)==null?void 0:i.weekEndUtc)??((y=o.meta)==null?void 0:y.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),r("div",Mr,[r("div",Rr,[(g(),b(de,null,ue(l,ye=>r("button",{key:ye.value,class:he(["chart-type-btn",{active:u.value===ye.value}]),onClick:vc=>u.value=ye.value},[r("span",xr,W(ye.icon),1),r("span",Lr,W(ye.label),1)],10,Pr)),64))])])]),r("section",Gr,[r("div",Fr,[r("h3",Hr,[n[7]||(n[7]=r("span",{class:"summary-week-block__title-text"},"–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Vr," –ù–µ–¥–µ–ª—è "+W(U.value.weekNumber??"‚Äî"),1),U.value.weekStartUtc?(g(),b("span",Kr,W(L(U.value.weekStartUtc,U.value.weekEndUtc)),1)):ae("",!0)]),r("div",Yr,[r("div",{class:"summary-card summary-card--new",onClick:n[0]||(n[0]=ye=>z("new"))},[n[8]||(n[8]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",jr,[r("div",zr,W((($=A.value)==null?void 0:$.newTickets)??0),1),_.value.newTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",_.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((F=E.value)==null?void 0:F.weekNumber)??"‚Äî"}): ${x(_.value.newTickets)}`},[r("span",Zr,W(_.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",Xr,W(x(_.value.newTickets)),1),r("span",Jr,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((J=E.value)==null?void 0:J.weekNumber)??"‚Äî"),1)],10,qr)):ae("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown",onClick:n[1]||(n[1]=ye=>z("closed"))},[n[13]||(n[13]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Qr,[r("div",ea,W(((re=A.value)==null?void 0:re.closedTickets)??0),1),_.value.closedTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",_.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ce=E.value)==null?void 0:ce.weekNumber)??"‚Äî"}): ${x(_.value.closedTickets)}`},[r("span",ra,W(_.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",aa,W(x(_.value.closedTickets)),1),r("span",sa,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((pe=E.value)==null?void 0:pe.weekNumber)??"‚Äî"),1)],10,ta)):ae("",!0)]),r("div",oa,[r("div",na,[n[9]||(n[9]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",la,W(((Te=A.value)==null?void 0:Te.closedTicketsCreatedThisWeek)??0),1),n[10]||(n[10]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",ia,[n[11]||(n[11]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ca,W(((ge=A.value)==null?void 0:ge.closedTicketsCreatedOtherWeek)??0),1),n[12]||(n[12]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown",onClick:n[2]||(n[2]=ye=>z("carryover"))},[n[20]||(n[20]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",da,[r("div",ua,W(((fe=A.value)==null?void 0:fe.carryoverTickets)??0),1),_.value.carryoverTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",_.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((te=E.value)==null?void 0:te.weekNumber)??"‚Äî"}): ${x(_.value.carryoverTickets)}`},[r("span",va,W(_.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",ha,W(x(_.value.carryoverTickets)),1),r("span",ya,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((ke=E.value)==null?void 0:ke.weekNumber)??"‚Äî"),1)],10,ka)):ae("",!0)]),r("div",ma,[r("div",pa,[n[14]||(n[14]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",ga,W(((ne=A.value)==null?void 0:ne.carryoverTicketsCreatedThisWeek)??0),1),n[15]||(n[15]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",fa,[n[16]||(n[16]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ba,W(((ie=A.value)==null?void 0:ie.carryoverTicketsCreatedPreviousWeek)??0),1),n[17]||(n[17]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",_a,[n[18]||(n[18]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",wa,W(((le=A.value)==null?void 0:le.carryoverTicketsCreatedOlder)??0),1),n[19]||(n[19]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",Ca,[n[21]||(n[21]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",Ta,[(g(!0),b(de,null,ue(O.value,ye=>(g(),b("span",{key:ye.stageId,class:"stage-tag"},W(ye.stageName||ye.stageId)+" ‚Äî "+W(ye.count),1))),128)),!O.value||O.value.length===0?(g(),b("span",Wa," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ae("",!0)])])])]),E.value?(g(),b("div",$a,[...n[22]||(n[22]=[r("div",{class:"summary-week-divider__line"},null,-1),r("div",{class:"summary-week-divider__label"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)])])):ae("",!0),E.value?(g(),b("div",Aa,[r("h3",Da,[n[23]||(n[23]=r("span",{class:"summary-week-block__title-text"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Sa," –ù–µ–¥–µ–ª—è "+W(E.value.weekNumber??"‚Äî"),1),E.value.weekStartUtc?(g(),b("span",Ea,W(L(E.value.weekStartUtc,E.value.weekEndUtc)),1)):ae("",!0)]),r("div",Ba,[r("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:n[3]||(n[3]=ye=>oe("new"))},[n[24]||(n[24]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Na,[r("div",Oa,[r("div",Ua,[r("div",Ia,W(((be=E.value)==null?void 0:be.newTickets)??0),1),r("span",Ma,"–ù–µ–¥–µ–ª—è "+W(((Be=E.value)==null?void 0:Be.weekNumber)??"‚Äî"),1)]),r("div",Ra,[r("div",Pa,W(((Ne=X.value)==null?void 0:Ne.newTickets)??0),1),r("span",xa,"–ù–µ–¥–µ–ª—è "+W(((Oe=X.value)==null?void 0:Oe.weekNumber)??"‚Äî"),1)])]),v.value.newTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",v.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Ue=X.value)==null?void 0:Ue.weekNumber)??"‚Äî"}): ${x(v.value.newTickets)}`},[r("span",Ga,W(v.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",Fa,W(x(v.value.newTickets)),1),r("span",Ha,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((Ie=X.value)==null?void 0:Ie.weekNumber)??"‚Äî"),1)],10,La)):ae("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:n[4]||(n[4]=ye=>oe("closed"))},[n[29]||(n[29]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Va,[r("div",Ka,[r("div",Ya,[r("div",ja,W(((xe=E.value)==null?void 0:xe.closedTickets)??0),1),r("span",za,"–ù–µ–¥–µ–ª—è "+W(((Le=E.value)==null?void 0:Le.weekNumber)??"‚Äî"),1)]),r("div",qa,[r("div",Za,W(((Ge=X.value)==null?void 0:Ge.closedTickets)??0),1),r("span",Xa,"–ù–µ–¥–µ–ª—è "+W(((lt=X.value)==null?void 0:lt.weekNumber)??"‚Äî"),1)])]),v.value.closedTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",v.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((it=X.value)==null?void 0:it.weekNumber)??"‚Äî"}): ${x(v.value.closedTickets)}`},[r("span",Qa,W(v.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",es,W(x(v.value.closedTickets)),1),r("span",ts,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((ct=X.value)==null?void 0:ct.weekNumber)??"‚Äî"),1)],10,Ja)):ae("",!0)]),r("div",rs,[r("div",as,[n[25]||(n[25]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",ss,W(((dt=E.value)==null?void 0:dt.closedTicketsCreatedThisWeek)??0),1),n[26]||(n[26]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",os,[n[27]||(n[27]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ns,W(((ut=E.value)==null?void 0:ut.closedTicketsCreatedOtherWeek)??0),1),n[28]||(n[28]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:n[5]||(n[5]=ye=>oe("carryover"))},[n[36]||(n[36]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",ls,[r("div",is,[r("div",cs,[r("div",ds,W(((kt=E.value)==null?void 0:kt.carryoverTickets)??0),1),r("span",us,"–ù–µ–¥–µ–ª—è "+W(((vt=E.value)==null?void 0:vt.weekNumber)??"‚Äî"),1)]),r("div",ks,[r("div",vs,W(((ht=X.value)==null?void 0:ht.carryoverTickets)??0),1),r("span",hs,"–ù–µ–¥–µ–ª—è "+W(((yt=X.value)==null?void 0:yt.weekNumber)??"‚Äî"),1)])]),v.value.carryoverTickets!==null?(g(),b("div",{key:0,class:he(["percentage-indicator",v.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((mt=X.value)==null?void 0:mt.weekNumber)??"‚Äî"}): ${x(v.value.carryoverTickets)}`},[r("span",ms,W(v.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",ps,W(x(v.value.carryoverTickets)),1),r("span",gs,"–∫ –Ω–µ–¥–µ–ª–µ "+W(((pt=X.value)==null?void 0:pt.weekNumber)??"‚Äî"),1)],10,ys)):ae("",!0)]),r("div",fs,[r("div",bs,[n[30]||(n[30]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",_s,W(((gt=E.value)==null?void 0:gt.carryoverTicketsCreatedThisWeek)??0),1),n[31]||(n[31]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",ws,[n[32]||(n[32]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Cs,W(((ft=E.value)==null?void 0:ft.carryoverTicketsCreatedPreviousWeek)??0),1),n[33]||(n[33]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Ts,[n[34]||(n[34]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Ws,W(((bt=E.value)==null?void 0:bt.carryoverTicketsCreatedOlder)??0),1),n[35]||(n[35]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",$s,[n[37]||(n[37]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",As,[(g(!0),b(de,null,ue(I.value,ye=>(g(),b("span",{key:ye.stageId,class:"stage-tag"},W(ye.stageName||ye.stageId)+" ‚Äî "+W(ye.count),1))),128)),!I.value||I.value.length===0?(g(),b("span",Ds,W(H.value),1)):ae("",!0)])])])])):ae("",!0)]),r("div",Ss,[u.value==="line"?(g(),b("div",Es,[r("div",Bs,[n[38]||(n[38]=r("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Ns,[se(Xe(Pe),{data:S.value,options:w.value},null,8,["data","options"])])]),r("div",Os,[n[39]||(n[39]=r("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Us,[se(Xe(Pe),{data:M.value,options:w.value},null,8,["data","options"])])])])):(g(),We(Qt(N.value),{key:1,data:B.value,options:w.value},null,8,["data","options"]))])])}}},Ms=$e(Is,[["__scopeId","data-v-3666e13a"]]),Rs={class:"summary-cards-months"},Ps={class:"summary-card summary-card--new"},xs={class:"card-content"},Ls={class:"card-main-value"},Gs=["title"],Fs={class:"card-month-breakdown"},Hs={class:"month-name"},Vs={class:"month-value"},Ks={key:0,class:"month-item month-item--empty"},Ys={class:"summary-card summary-card--closed"},js={class:"card-content"},zs={class:"card-main-value"},qs=["title"],Zs={class:"card-month-breakdown-hierarchical"},Xs={class:"month-header"},Js={class:"month-name"},Qs={class:"month-value"},eo={class:"month-breakdown"},to={class:"breakdown-item breakdown-this-week"},ro={class:"breakdown-value"},ao={class:"breakdown-item breakdown-other-week"},so={class:"breakdown-value"},oo={key:0,class:"month-item-hierarchical month-item--empty"},no={class:"summary-card summary-card--carryover"},lo={class:"card-content"},io={class:"card-current-value"},co={class:"current-value"},uo=["title"],ko={class:"card-month-breakdown"},vo={class:"month-name"},ho={class:"month-value"},yo={key:0,class:"month-item month-item--empty"},mo={class:"summary-card summary-card--stages"},po={class:"card-content"},go={class:"stages-list"},fo={class:"stage-icon"},bo={class:"stage-name"},_o={class:"stage-value"},wo={key:0,class:"stage-item stage-item--empty"},Co={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(o){const t=o;function e(T){return T==null||isNaN(T)?"0":T>=1e6?(T/1e6).toFixed(1)+"M":T>=1e3?T.toLocaleString("ru-RU"):T.toString()}function a(T){return T==null||isNaN(T)?"":`${T>=0?"+":""}${T.toFixed(1)}%`}function s(T,h){if(typeof T!="number"||isNaN(T)||h==null||typeof h!="number"||isNaN(h)||h===0)return null;if(T===h)return 0;const c=(T-h)/h*100;return!isFinite(c)||isNaN(c)?null:c}const l=q(()=>{var T;return((T=t.data)==null?void 0:T.newTickets)||0}),u=q(()=>e(l.value)),d=q(()=>{var T;return((T=t.data)==null?void 0:T.newTicketsByMonth)||[]}),m=q(()=>{var T;return((T=t.data)==null?void 0:T.closedTicketsByMonth)||[]}),p=q(()=>{var T;return((T=t.data)==null?void 0:T.carryoverTicketsByMonth)||[]}),S=q(()=>{const T=p.value;if(T.length===0)return 0;const h=T[T.length-1];return(h==null?void 0:h.count)||0}),M=q(()=>{var c,w,A,U;const T=typeof((c=t.data)==null?void 0:c.newTickets)=="number"?t.data.newTickets:parseInt((w=t.data)==null?void 0:w.newTickets)||0,h=(U=(A=t.data)==null?void 0:A.previousPeriodData)==null?void 0:U.newTickets;return s(T,h)}),ee=q(()=>{var c,w,A,U;const T=typeof((c=t.data)==null?void 0:c.closedTickets)=="number"?t.data.closedTickets:parseInt((w=t.data)==null?void 0:w.closedTickets)||0,h=(U=(A=t.data)==null?void 0:A.previousPeriodData)==null?void 0:U.closedTickets;return s(T,h)}),Q=q(()=>{var w;const T=S.value,h=p.value,c=h.length>0?((w=h[0])==null?void 0:w.count)||0:null;return s(T,c)});function N(T){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[T]||""}function B(T){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[T]||"‚Ä¢"}return(T,h)=>(g(),b("div",Rs,[r("div",Ps,[h[0]||(h[0]=r("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),r("div",xs,[r("div",Ls,[Ce(W(u.value)+" ",1),M.value!==null?(g(),b("span",{key:0,class:he(["percentage-badge",M.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(M.value)}`},W(a(M.value)),11,Gs)):ae("",!0)]),r("div",Fs,[(g(!0),b(de,null,ue(d.value,c=>(g(),b("div",{key:`new-${c.month}`,class:"month-item"},[r("span",Hs,W(c.monthName)+":",1),r("span",Vs,W(e(c.count)),1)]))),128)),d.value.length===0?(g(),b("div",Ks," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ae("",!0)])])]),r("div",Ys,[h[5]||(h[5]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),r("div",js,[r("div",zs,[Ce(W(e(o.data.closedTickets||0))+" ",1),ee.value!==null?(g(),b("span",{key:0,class:he(["percentage-badge",ee.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(ee.value)}`},W(a(ee.value)),11,qs)):ae("",!0)]),r("div",Zs,[(g(!0),b(de,null,ue(m.value,c=>(g(),b("div",{key:`closed-${c.month}`,class:"month-item-hierarchical"},[r("div",Xs,[r("span",Js,W(c.monthName)+":",1),r("span",Qs,W(e(c.count||0)),1)]),r("div",eo,[r("div",to,[h[1]||(h[1]=r("span",{class:"breakdown-icon"},"‚úì",-1)),h[2]||(h[2]=r("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",ro,W(e(c.closedCreatedThisWeek||0)),1)]),r("div",ao,[h[3]||(h[3]=r("span",{class:"breakdown-icon"},"‚Üª",-1)),h[4]||(h[4]=r("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",so,W(e(c.closedCreatedOtherWeek||0)),1)])])]))),128)),m.value.length===0?(g(),b("div",oo," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ae("",!0)])])]),r("div",no,[h[7]||(h[7]=r("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),h[8]||(h[8]=r("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),r("div",lo,[r("div",io,[h[6]||(h[6]=r("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),r("span",co,[Ce(W(e(S.value))+" ",1),Q.value!==null?(g(),b("span",{key:0,class:he(["percentage-badge",Q.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(Q.value)}`},W(a(Q.value)),11,uo)):ae("",!0)])]),r("div",ko,[(g(!0),b(de,null,ue(p.value,c=>(g(),b("div",{key:`carryover-${c.month}`,class:"month-item"},[r("span",vo,W(c.monthName)+":",1),r("span",ho,W(e(c.count||0)),1)]))),128)),p.value.length===0?(g(),b("div",yo," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ae("",!0)])])]),r("div",mo,[h[10]||(h[10]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",po,[r("div",go,[(g(!0),b(de,null,ue(o.data.stages||[],c=>(g(),b("div",{key:c.stageId,class:he(["stage-item",N(c.stageId)])},[r("span",fo,W(B(c.stageId)),1),r("span",bo,W(c.stageName||c.stageId)+":",1),r("span",_o,W(e(c.count||0)),1)],2))),128)),!o.data.stages||o.data.stages.length===0?(g(),b("div",wo,[...h[9]||(h[9]=[r("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):ae("",!0)])])])]))}},To=$e(Co,[["__scopeId","data-v-15d88b90"]]),Wo={class:"line-chart-months"},$o={class:"chart-section"},Ao={class:"chart-title"},Do={key:0,class:"chart-period"},So={class:"chart-wrapper"},Eo={class:"chart-container"},Bo={class:"chart-summary"},No={class:"summary-numbers"},Oo={class:"summary-row"},Uo={class:"summary-values"},Io={class:"summary-row"},Mo={class:"summary-values"},Ro={class:"summary-analysis"},Po=["innerHTML"],xo={class:"chart-section"},Lo={class:"chart-title"},Go={key:0,class:"chart-period"},Fo={class:"chart-wrapper"},Ho={class:"chart-container"},Vo={class:"chart-analysis"},Ko={class:"analysis-content"},Yo=["innerHTML"],jo={class:"chart-table-section"},zo={class:"chart-table-wrapper"},qo={class:"data-table"},Zo={class:"data-row data-row--new"},Xo={class:"data-row data-row--closed"},Jo={class:"data-row data-row--carryover"},Qo={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(o){rt.register(Lt);const t=o;function e(N){return N==null||isNaN(N)?"0":N>=1e3?N.toLocaleString("ru-RU"):N.toString()}const a=q(()=>{var B,T,h;const N=new Set;return(B=t.data.newTicketsByMonth)==null||B.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),(T=t.data.closedTicketsByMonth)==null||T.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),(h=t.data.carryoverTicketsByMonth)==null||h.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),Array.from(N).sort((c,w)=>c-w)}),s=q(()=>{const N=t.data.newTicketsByMonth||[],B=N.map(c=>c.monthName||`–ú–µ—Å—è—Ü ${c.month}`),T=N.map(c=>c.count||0),h=(t.data.closedTicketsByMonth||[]).map(c=>c.count||0);return{labels:B,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:C.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:C.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:C.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:h,borderColor:C.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:C.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:C.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=q(()=>{const N=t.data.carryoverTicketsByMonth||[],B=N.map(h=>h.monthName||`–ú–µ—Å—è—Ü ${h.month}`),T=N.map(h=>h.count||0);return{labels:B,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:C.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:C.carryover}}]}}),u={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(N,B)=>N==null||isNaN(N)?"":N.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(N){const B=N.dataset.data[N.dataIndex];return B!=null&&!isNaN(B)&&isFinite(B)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function d(N){if(!N||N.length===0)return null;const B=N[0],T=N[N.length-1];if(!B||!T)return null;const h=B.monthName||`–ú–µ—Å—è—Ü ${B.month}`,c=T.monthName||`–ú–µ—Å—è—Ü ${T.month}`,w=B.year||new Date().getFullYear();return`${h} ‚Äî ${c} ${w}`}const m=q(()=>{var N;return d(((N=t.data)==null?void 0:N.newTicketsByMonth)||[])}),p=q(()=>{var N;return d(((N=t.data)==null?void 0:N.carryoverTicketsByMonth)||[])}),S=q(()=>{var c,w;const N=((c=t.data)==null?void 0:c.newTicketsByMonth)||[],B=((w=t.data)==null?void 0:w.closedTicketsByMonth)||[];if(N.length===0)return{new:"‚Äî",closed:"‚Äî"};const T=N.map(A=>`${e(A.count||0)} (${A.monthName||A.month})`).join(" ‚Üí "),h=B.map(A=>`${e(A.count||0)} (${A.monthName||A.month})`).join(" ‚Üí ");return{new:T,closed:h}}),M=q(()=>{var w,A;const N=((w=t.data)==null?void 0:w.newTicketsByMonth)||[],B=((A=t.data)==null?void 0:A.closedTicketsByMonth)||[];if(N.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const T=[],h=[],c=[];if(N.length>=2){const U=N[0],E=N[1],G=N[2];if(E&&U&&typeof U.count=="number"&&typeof E.count=="number"){const O=U.monthName||U.month,I=E.monthName||E.month,H=e(U.count||0),Y=e(E.count||0);if(U.count>0){const x=(E.count-U.count)/U.count*100;if(isFinite(x)&&!isNaN(x)){const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",_=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",z=x>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${O}) –¥–æ ${Y} (${I}) ‚Äî <span style="color: ${z}; font-weight: 600;">${v}${_.toFixed(1)}%</span>`)}}else U.count===0&&E.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${O}) –¥–æ ${Y} (${I})`)}if(G&&E&&typeof E.count=="number"&&typeof G.count=="number"){const O=E.monthName||E.month,I=G.monthName||G.month,H=e(E.count||0),Y=e(G.count||0);if(E.count>0){const x=(G.count-E.count)/E.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${O}) ‚Üí ${Y} (${I}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",_=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",z=x>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${O}) –¥–æ ${Y} (${I}) ‚Äî <span style="color: ${z}; font-weight: 600;">${v}${_.toFixed(1)}%</span>`)}}else E.count===0&&G.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${O}) –¥–æ ${Y} (${I})`)}}if(B.length>=2){const U=B[0],E=B[1],G=B[2];if(E&&U&&typeof U.count=="number"&&typeof E.count=="number"){const O=U.monthName||U.month,I=E.monthName||E.month,H=e(U.count||0),Y=e(E.count||0);if(U.count>0){const x=(E.count-U.count)/U.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)c.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${O}) ‚Üí ${Y} (${I}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",_=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",z=x>=0?"#28a745":"#dc3545";c.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${O}) –¥–æ ${Y} (${I}) ‚Äî <span style="color: ${z}; font-weight: 600;">${v}${_.toFixed(1)}%</span>`)}}else U.count===0&&E.count>0&&c.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${O}) –¥–æ ${Y} (${I})`)}if(G&&E&&typeof E.count=="number"&&typeof G.count=="number"){const O=E.monthName||E.month,I=G.monthName||G.month,H=e(E.count||0),Y=e(G.count||0);if(E.count>0){const x=(G.count-E.count)/E.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)c.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${O}) ‚Üí ${Y} (${I}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",_=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",z=x>=0?"#28a745":"#dc3545";c.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${O}) –¥–æ ${Y} (${I}) ‚Äî <span style="color: ${z}; font-weight: 600;">${v}${_.toFixed(1)}%</span>`)}}else E.count===0&&G.count>0&&c.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${O}) –¥–æ ${Y} (${I})`)}}if(h.length>0&&(T.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...h)),c.length>0&&(T.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...c)),N.length>=3&&B.length>=3){const U=N[0],E=N[N.length-1],G=B[0],O=B[B.length-1],I=U.count||0,H=E.count||0,Y=G.count||0,x=O.count||0;if(I>0&&Y>0){const X=(H-I)/I*100,_=(x-Y)/Y*100;if(isFinite(X)&&isFinite(_)){const v=U.monthName||U.month,L=E.monthName||E.month,z=G.monthName||G.month,oe=O.monthName||O.month,k=X>=0?"#28a745":"#dc3545",n=X>=0?"#28a745":"#dc3545",D=_>=0?"#28a745":"#dc3545",R=_>=0?"#28a745":"#dc3545";T.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),T.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${k}; font-weight: 600;">${X>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(I)} (${v}) –¥–æ ${e(H)} (${L}) ‚Äî <span style="color: ${n}; font-weight: 600;">${X>=0?"+":"-"}${Math.abs(X).toFixed(1)}%</span>`),T.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${D}; font-weight: 600;">${_>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(Y)} (${z}) –¥–æ ${e(x)} (${oe}) ‚Äî <span style="color: ${R}; font-weight: 600;">${_>=0?"+":"-"}${Math.abs(_).toFixed(1)}%</span>`)}}}return T.length>0?T:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),ee=q(()=>{var c;const N=((c=t.data)==null?void 0:c.carryoverTicketsByMonth)||[];if(N.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const B=[],T=[],h=N.filter(w=>w&&typeof w.count=="number").map(w=>`${e(w.count||0)} (${w.monthName||w.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(h&&B.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${h}`),N.length>=2){const w=N[0],A=N[1],U=N[2];if(A&&w&&typeof w.count=="number"&&typeof A.count=="number"){const E=w.monthName||w.month,G=A.monthName||A.month,O=e(w.count||0),I=e(A.count||0);if(w.count>0){const H=(A.count-w.count)/w.count*100;if(isFinite(H)&&!isNaN(H))if(Math.abs(H)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${O} (${E}) ‚Üí ${I} (${G}) ‚Äî 0.0%`);else{const Y=H>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(H),X=H>=0?"+":"-",_=H>=0?"#28a745":"#dc3545",v=H>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${_}; font-weight: 600;">${Y}</span> —Å ${O} (${E}) –¥–æ ${I} (${G}) ‚Äî <span style="color: ${v}; font-weight: 600;">${X}${x.toFixed(1)}%</span>`)}}else w.count===0&&A.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${E}) –¥–æ ${I} (${G})`)}if(U&&A&&typeof A.count=="number"&&typeof U.count=="number"){const E=A.monthName||A.month,G=U.monthName||U.month,O=e(A.count||0),I=e(U.count||0);if(A.count>0){const H=(U.count-A.count)/A.count*100;if(isFinite(H)&&!isNaN(H))if(Math.abs(H)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${O} (${E}) ‚Üí ${I} (${G}) ‚Äî 0.0%`);else{const Y=H>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(H),X=H>=0?"+":"-",_=H>=0?"#28a745":"#dc3545",v=H>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${_}; font-weight: 600;">${Y}</span> —Å ${O} (${E}) –¥–æ ${I} (${G}) ‚Äî <span style="color: ${v}; font-weight: 600;">${X}${x.toFixed(1)}%</span>`)}}else A.count===0&&U.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${E}) –¥–æ ${I} (${G})`)}}if(T.length>0&&(B.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),B.push(...T)),N.length>=3){const w=N[0],A=N[N.length-1];if(w&&A&&typeof w.count=="number"&&typeof A.count=="number"){const U=w.count||0,E=A.count||0,G=w.monthName||w.month,O=A.monthName||A.month,I=e(U),H=e(E);if(U>0){const Y=(E-U)/U*100;if(isFinite(Y)&&!isNaN(Y))if(Math.abs(Y)<1)B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${I} (${G}) ‚Üí ${H} (${O}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const x=Y>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",X=Math.abs(Y),_=Y>=0?"+":"-",v=Y>=0?"#28a745":"#dc3545",L=Y>=0?"#28a745":"#dc3545";B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ <span style="color: ${v}; font-weight: 600;">${x}</span> —Å ${I} (${G}) –¥–æ ${H} (${O}) ‚Äî <span style="color: ${L}; font-weight: 600;">${_}${X.toFixed(1)}%</span>`)}}else U===0&&E>0?(B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${G}) –¥–æ ${H} (${O})`)):U>0&&E===0&&(B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${I} (${G}) –¥–æ 0 (${O})`))}}return B.length>0?B:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function Q(N,B){let T=[];switch(N){case"new":T=t.data.newTicketsByMonth||[];break;case"closed":T=t.data.closedTicketsByMonth||[];break;case"carryover":T=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const h of T){if(!h.weeks||!Array.isArray(h.weeks))continue;const c=h.weeks.find(w=>w&&w.weekNumber===B);if(c){const w=c.count||0;return w>0?e(w):"-"}}return"-"}return(N,B)=>(g(),b("div",Wo,[r("div",$o,[r("h3",Ao,[B[0]||(B[0]=Ce(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),m.value?(g(),b("span",Do,"("+W(m.value)+")",1)):ae("",!0)]),r("div",So,[r("div",Eo,[se(Xe(Pe),{data:s.value,options:u},null,8,["data"])]),r("div",Bo,[B[3]||(B[3]=r("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),r("div",No,[r("div",Oo,[B[1]||(B[1]=r("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),r("span",Uo,W(S.value.new),1)]),r("div",Io,[B[2]||(B[2]=r("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),r("span",Mo,W(S.value.closed),1)])]),r("div",Ro,[(g(!0),b(de,null,ue(M.value,(T,h)=>(g(),b("p",{key:h,innerHTML:T},null,8,Po))),128))])])])]),r("div",xo,[r("h3",Lo,[B[4]||(B[4]=Ce(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),p.value?(g(),b("span",Go,"("+W(p.value)+")",1)):ae("",!0)]),r("div",Fo,[r("div",Ho,[se(Xe(Pe),{data:l.value,options:u},null,8,["data"])]),r("div",Vo,[B[5]||(B[5]=r("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),r("div",Ko,[(g(!0),b(de,null,ue(ee.value,(T,h)=>(g(),b("p",{key:h,innerHTML:T},null,8,Yo))),128))])])])]),r("div",jo,[B[10]||(B[10]=r("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),r("div",zo,[r("table",qo,[r("thead",null,[r("tr",null,[B[6]||(B[6]=r("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(g(!0),b(de,null,ue(a.value,T=>(g(),b("th",{key:`week-${T}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+W(T),1))),128))])]),r("tbody",null,[r("tr",Zo,[B[7]||(B[7]=r("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(g(!0),b(de,null,ue(a.value,T=>(g(),b("td",{key:`new-${T}`,class:"week-data-cell"},W(Q("new",T)),1))),128))]),r("tr",Xo,[B[8]||(B[8]=r("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(g(!0),b(de,null,ue(a.value,T=>(g(),b("td",{key:`closed-${T}`,class:"week-data-cell"},W(Q("closed",T)),1))),128))]),r("tr",Jo,[B[9]||(B[9]=r("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(g(!0),b(de,null,ue(a.value,T=>(g(),b("td",{key:`carryover-${T}`,class:"week-data-cell"},W(Q("carryover",T)),1))),128))])])])])])]))}},en=$e(Qo,[["__scopeId","data-v-31a3d565"]]),tn={class:"months-preloader"},rn={class:"preloader-content"},an={class:"progress-container"},sn={class:"progress-bar"},on={class:"progress-text"},nn={class:"preloader-message"},ln={class:"stages-list"},cn={class:"stage-icon"},dn={class:"stage-text"},un={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:o=>o>=0&&o<=100},currentStage:{type:String,default:""}},setup(o){const t=o,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function a(l){return t.progress>=e[l].threshold}function s(l){const u=e[l].threshold,d=l>0?e[l-1].threshold:0;return t.progress>=d&&t.progress<u}return(l,u)=>(g(),b("div",tn,[r("div",rn,[u[0]||(u[0]=er('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),r("div",an,[r("div",sn,[r("div",{class:"progress-fill",style:Se({width:`${o.progress}%`})},null,4)]),r("div",on,W(Math.round(o.progress))+"%",1)]),r("p",nn,W(o.currentStage),1),r("div",ln,[(g(),b(de,null,ue(e,(d,m)=>r("div",{key:m,class:he(["stage-item",{"stage-completed":a(m),"stage-current":s(m)}])},[r("span",cn,W(a(m)?"‚úì":s(m)?"‚Üí":"‚óã"),1),r("span",dn,W(d.label),1)],2)),64))])])]))}},kn=$e(un,[["__scopeId","data-v-b571fe67"]]),vn="/api/graph-1c-admission-closure.php";function hn(o){var a,s,l,u,d,m,p,S,M,ee,Q,N,B,T,h,c,w,A,U,E,G,O,I,H,Y,x,X,_,v,L,z,oe,k,n,D,R,K,P,j,V,f,i,y,$,F,J,re,ce,pe,Te,ge,fe,te,ke,ne,ie,le,be,Be,Ne,Oe,Ue,Ie,xe,Le,Ge;if(!o)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0]},weeksData:[],stagesByWeek:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=o.data||o.result||o,e=t.meta||o.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((a=t.data)==null?void 0:a.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:t.data.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:t.data.carryoverTicketsCreatedOlder??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0}),newTickets:((l=(s=t.data)==null?void 0:s.currentWeek)==null?void 0:l.newTickets)??((u=t.data)==null?void 0:u.newTickets)??t.newTickets??0,closedTickets:((m=(d=t.data)==null?void 0:d.currentWeek)==null?void 0:m.closedTickets)??((p=t.data)==null?void 0:p.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((M=(S=t.data)==null?void 0:S.currentWeek)==null?void 0:M.closedTicketsCreatedThisWeek)??((ee=t.data)==null?void 0:ee.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((N=(Q=t.data)==null?void 0:Q.currentWeek)==null?void 0:N.closedTicketsCreatedOtherWeek)??((B=t.data)==null?void 0:B.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((h=(T=t.data)==null?void 0:T.currentWeek)==null?void 0:h.carryoverTickets)??((c=t.data)==null?void 0:c.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((A=(w=t.data)==null?void 0:w.currentWeek)==null?void 0:A.carryoverTicketsCreatedThisWeek)??((U=t.data)==null?void 0:U.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((G=(E=t.data)==null?void 0:E.currentWeek)==null?void 0:G.carryoverTicketsCreatedOtherWeek)??((O=t.data)==null?void 0:O.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:((H=(I=t.data)==null?void 0:I.currentWeek)==null?void 0:H.carryoverTicketsCreatedPreviousWeek)??((Y=t.data)==null?void 0:Y.carryoverTicketsCreatedPreviousWeek)??t.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:((X=(x=t.data)==null?void 0:x.currentWeek)==null?void 0:X.carryoverTicketsCreatedOlder)??((_=t.data)==null?void 0:_.carryoverTicketsCreatedOlder)??t.carryoverTicketsCreatedOlder??0,series:{new:((L=(v=t.data)==null?void 0:v.series)==null?void 0:L.new)??((z=t.series)==null?void 0:z.new)??[0],closed:((k=(oe=t.data)==null?void 0:oe.series)==null?void 0:k.closed)??((n=t.series)==null?void 0:n.closed)??[0],closedCreatedThisWeek:((R=(D=t.data)==null?void 0:D.series)==null?void 0:R.closedCreatedThisWeek)??((K=t.series)==null?void 0:K.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((j=(P=t.data)==null?void 0:P.series)==null?void 0:j.closedCreatedOtherWeek)??((V=t.series)==null?void 0:V.closedCreatedOtherWeek)??[0],carryover:((i=(f=t.data)==null?void 0:f.series)==null?void 0:i.carryover)??((y=t.series)==null?void 0:y.carryover)??[0],carryoverCreatedThisWeek:((F=($=t.data)==null?void 0:$.series)==null?void 0:F.carryoverCreatedThisWeek)??((J=t.series)==null?void 0:J.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((ce=(re=t.data)==null?void 0:re.series)==null?void 0:ce.carryoverCreatedOtherWeek)??((pe=t.series)==null?void 0:pe.carryoverCreatedOtherWeek)??[0],carryoverCreatedPreviousWeek:((ge=(Te=t.data)==null?void 0:Te.series)==null?void 0:ge.carryoverCreatedPreviousWeek)??((fe=t.series)==null?void 0:fe.carryoverCreatedPreviousWeek)??[0],carryoverCreatedOlder:((ke=(te=t.data)==null?void 0:te.series)==null?void 0:ke.carryoverCreatedOlder)??((ne=t.series)==null?void 0:ne.carryoverCreatedOlder)??[0]},weeksData:((ie=t.data)==null?void 0:ie.weeksData)??t.weeksData??[],stagesByWeek:((le=t.data)==null?void 0:le.stagesByWeek)??t.stagesByWeek??[],stages:((be=t.data)==null?void 0:be.stages)??t.stages??[],responsible:((Be=t.data)==null?void 0:Be.responsible)??t.responsible??[],responsibleCreatedThisWeek:((Ne=t.data)==null?void 0:Ne.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((Oe=t.data)==null?void 0:Oe.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Ue=t.data)==null?void 0:Ue.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Ie=t.data)==null?void 0:Ie.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((xe=t.data)==null?void 0:xe.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((Le=t.data)==null?void 0:Le.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ge=t.data)==null?void 0:Ge.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function Ee(o={}){const{endpoint:t=vn,product:e="1C",weekStartUtc:a=null,weekEndUtc:s=null,periodMode:l="weeks",useCache:u=!0,forceRefresh:d=!1,includeTickets:m=!1,includeNewTicketsByStages:p=!1,includeCarryoverTickets:S=!0,includeCarryoverTicketsByDuration:M=!1}=o,ee={product:e,weekStartUtc:a,weekEndUtc:s,periodMode:l,useCache:u,forceRefresh:d,includeTickets:m,includeNewTicketsByStages:p,includeCarryoverTickets:S,includeCarryoverTicketsByDuration:M},Q=tr(t),N=await fetch(Q,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(ee)});if(!N.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${N.status})`);const B=await N.json();if((B==null?void 0:B.success)===!1)throw new Error(B.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return hn(B)}const yn={class:"ac-dashboard-months"},mn={key:"content"},pn={class:"dashboard-header"},gn={class:"header-content"},fn={class:"breadcrumbs-row"},bn=["aria-label","aria-disabled","data-fallback","disabled"],_n={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},wn={class:"dashboard-layout"},Cn={class:"filters-container"},Tn={class:"chart-container"},Wn={__name:"GraphAdmissionClosureMonthsDashboard",setup(o){const t=Dt(),e=Z(!0),a=Z(0),s=Z("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),l=Z(null),u=Z(null),d=Z({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),m=Z(!1),p=q(()=>typeof window>"u"?!1:window.history.length>1),S=q(()=>p.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),M={name:"dashboard-sector-1c"};function ee(O){var I;if((I=O==null?void 0:O.preventDefault)==null||I.call(O),!m.value){m.value=!0;try{if(p.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(M)}finally{m.value=!1}}}const Q=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),N=q(()=>{const O=Q.value.customDateRange.startDate||Q.value.customDateRange.endDate,I=Q.value.employees.length===1&&Q.value.employees.includes("all");return O||!I});async function B(O,I,H=500){const Y=a.value,x=10,X=(O-Y)/x,_=H/x;for(let v=0;v<x;v++)await new Promise(L=>setTimeout(L,_)),a.value=Math.min(Y+X*(v+1),O);a.value=O,s.value=I}async function T(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,a.value=0,s.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let O=null,I=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await B(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const H=Date.now(),Y=2e4;O=setInterval(()=>{const v=Date.now()-H,L=Math.min(5+v/Y*85,90);a.value=L,L<35?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":L<65?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":L<85?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":s.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),I=setTimeout(()=>{O&&(clearInterval(O),O=null)},Y+1e4);const x=await Ee({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(I),O&&(clearInterval(O),O=null),a.value=90,s.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await B(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",x);const{meta:X,data:_}=x;u.value=X,d.value=_,console.log("[DEBUG MonthsDashboard] Data set, meta:",X,"data keys:",Object.keys(_)),await new Promise(v=>setTimeout(v,200))}catch(H){O&&(clearInterval(O),O=null),I&&(clearTimeout(I),I=null),console.error("[DEBUG MonthsDashboard] API call failed:",H),l.value=H instanceof Error?H:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",H),a.value=100,s.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function h(O){Q.value.stages=O}function c(O){Q.value.employees=O}function w(O){Q.value.dateRange=O}function A(O){Q.value.customDateRange=O}function U(){Q.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},E()}function E(){T()}function G(O){if(!["weeks","months"].includes(O)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",O);return}O==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:O}}))}return ot(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),T()}),(O,I)=>{const H=St("router-link");return g(),b("div",yn,[se(we,{name:"fade",mode:"out-in"},{default:ve(()=>[e.value?(g(),We(kn,{key:"preloader",progress:a.value,"current-stage":s.value},null,8,["progress","current-stage"])):(g(),b("div",mn,[r("div",pn,[r("div",gn,[r("div",fn,[r("button",{class:"btn-back-link",type:"button",onClick:ee,"aria-label":S.value,"aria-disabled":!p.value,"data-fallback":!p.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,bn),r("nav",_n,[se(H,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ve(()=>[...I[0]||(I[0]=[Ce(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),I[2]||(I[2]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),se(H,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ve(()=>[...I[1]||(I[1]=[Ce(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),I[3]||(I[3]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),I[4]||(I[4]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),I[5]||(I[5]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),I[6]||(I[6]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",wn,[r("div",Cn,[se(Bt,{stages:Q.value.stages,employees:Q.value.employees,dateRange:Q.value.dateRange,customDateRange:Q.value.customDateRange,hasActiveFilters:N.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":h,"onUpdate:employees":c,"onUpdate:dateRange":w,"onUpdate:customDateRange":A,"onUpdate:periodMode":G,onReset:U,onApply:E},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),r("div",Tn,[l.value?(g(),We(Et,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(g(),b(de,{key:1},[se(To,{data:d.value},null,8,["data"]),se(en,{data:d.value,meta:u.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},$n=$e(Wn,[["__scopeId","data-v-fe3ca7ed"]]);class st{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const a=await this.getEmployeesByIds(e);return console.log("Loaded employees:",a.length),{stages:this.groupTicketsByStages(t,a),employees:a,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const a of t){console.log(`Loading tickets for stage: ${a}`);const s=await this.getTicketsByStage(a);e.push(...s),console.log(`Loaded ${s.length} tickets for stage ${a}`)}return e}static async getTicketsByStage(t){const e=[];let a=0;const s=50;let l=!0;for(;l;)try{const d=await Re.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:a,useOriginalUfNames:"Y"});let m=[];d&&d.result&&(Array.isArray(d.result)?m=d.result:d.result.items&&Array.isArray(d.result.items)?m=d.result.items:d.result.data&&Array.isArray(d.result.data)&&(m=d.result.data)),m.length>0?(e.push(...m),a+=m.length,l=m.length===s):l=!1}catch(d){console.error(`Error loading tickets batch for stage ${t} (start: ${a}):`,d),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const u=e.filter(d=>{const m=d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product||d.ufCrm7TypeProduct||d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product;return Array.isArray(m)?m.includes(this.SECTOR_TAG):typeof m=="object"&&m!==null?m.value===this.SECTOR_TAG||m===this.SECTOR_TAG:m===this.SECTOR_TAG});return console.log(`Filtered ${u.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),u}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(a=>{const s=a.assignedById||a.assignedByIdId||a.ASSIGNED_BY_ID||a.assignedById||a.assignedById&&typeof a.assignedById=="object"&&(a.assignedById.id||a.assignedById.ID)||a.assignedById&&typeof a.assignedById=="object"&&a.assignedById.value;if(s){const l=parseInt(s);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await Re.call("user.get",{filter:{ID:t}});let a=[];return e&&e.result&&(Array.isArray(e.result)?a=e.result:console.warn("Unexpected user.get result format:",e)),a.map(s=>({id:parseInt(s.ID||s.id||0),name:`${s.NAME||s.name||""} ${s.LAST_NAME||s.lastName||""}`.trim()||s.EMAIL||s.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:s.WORK_POSITION||s.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:s.EMAIL||s.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const a=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(s=>({...s,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(s=>({...s,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(s=>({...s,tickets:[]}))}];return t.forEach(s=>{const l=this.mapStageId(s.stageId||s.STAGE_ID||""),u=a.find(d=>d.id===l);if(u){const d=s.assignedById||s.ASSIGNED_BY_ID||null,m=d?parseInt(d):null;if(m){let p=u.employees.find(S=>S.id===m);p||(p={id:m,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${m}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},u.employees.push(p)),p.tickets.push(this.mapTicket(s))}}}),a}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),a=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",s=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,u=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",d=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",m=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,p=wt(m),S=sr(p);return{id:e,title:a,priorityId:p.id,priorityLabel:p.label,priorityColors:S,priority:p.id,priorityBitrixValue:p.bitrixValue||null,status:this.mapStatus(s),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(s),createdAt:u,modifiedAt:d,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return wt(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=Ct(t);if(e&&e.bitrixValue)return e.bitrixValue;const a={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return a[t]?a[t]:Ct(or).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(a=>!(a.assignedById||a.ASSIGNED_BY_ID)).forEach(a=>{const s=this.mapStageId(a.stageId||a.STAGE_ID||"");e[s]&&e[s].push(this.mapTicket(a))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,a){try{const s=this.mapStageIdToBitrix(a);return(await Re.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:s}})).result===!0}catch(s){throw console.error("Error assigning ticket:",s),s}}static async createTicket(t){try{const e=await Re.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await Re.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await Re.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(a){throw console.error("Error adding comment:",a),a}}}et(st,"ENTITY_TYPE_ID",140),et(st,"SECTOR_TAG","1C");const An={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Dn={class:"modal"},Sn={key:0,class:"modal__tabs"},En={key:"level-0-categories",class:"level-0"},Bn={class:"modal__header"},Nn={class:"modal__title"},On={key:0},Un={class:"modal__body"},In={class:"categories-list"},Mn=["onClick"],Rn={class:"category-item"},Pn={class:"category-item__icon"},xn={key:0},Ln={key:1},Gn={class:"category-item__content"},Fn={class:"category-item__label"},Hn={class:"category-item__count"},Vn={key:0,class:"category-item__arrow"},Kn={class:"modal__footer"},Yn={key:"level-1-categories",class:"level-1"},jn={class:"modal__header"},zn={class:"modal__body"},qn={key:"loading",class:"loading-names"},Zn={key:"empty",class:"modal__empty"},Xn={key:"list",class:"responsible-list"},Jn=["onClick"],Qn={class:"responsible-list__name"},el={class:"responsible-list__count"},tl={key:0,class:"responsible-list__arrow"},rl={class:"modal__footer"},al={key:"level-2-categories",class:"level-2"},sl={class:"modal__header"},ol={class:"modal__title"},nl={class:"modal__body"},ll={key:"loading",class:"loading-state"},il={key:"error",class:"error-state"},cl={class:"error-message"},dl={key:"empty",class:"empty-state"},ul={key:"tickets",class:"tickets-list-container"},kl={key:"level-0-employees",class:"level-0"},vl={class:"modal__header"},hl={class:"modal__title"},yl={key:0},ml={class:"modal__body"},pl={key:"loading",class:"loading-names"},gl={key:"empty",class:"modal__empty"},fl={key:"list",class:"responsible-list"},bl=["onClick"],_l={class:"responsible-list__name"},wl={class:"responsible-list__count"},Cl={key:0,class:"responsible-list__arrow"},Tl={class:"modal__footer"},Wl={key:"level-1-employees",class:"level-1"},$l={class:"modal__header"},Al={class:"modal__title"},Dl={class:"modal__body"},Sl={class:"categories-list"},El=["onClick"],Bl={class:"category-item"},Nl={class:"category-item__icon"},Ol={key:0},Ul={key:1},Il={class:"category-item__content"},Ml={class:"category-item__label"},Rl={class:"category-item__count"},Pl={key:0,class:"category-item__arrow"},xl={class:"modal__footer"},Ll={key:"level-2-employees",class:"level-2"},Gl={class:"modal__header"},Fl={class:"modal__title"},Hl={class:"modal__body"},Vl={key:"loading",class:"loading-state"},Kl={key:"error",class:"error-state"},Yl={class:"error-message"},jl={key:"empty",class:"empty-state"},zl={class:"empty-state-message"},ql={key:"tickets",class:"tickets-list-container"},Zl={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(o){const t=o,e=Z(0),a=Z("categories"),s=Z(null),l=Z(null),u=Z(null),d=Z([]),m=Z(!1),p=Z(null),S=Z([]),M=Z([]),ee=Z(!1),Q=q(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),N=q(()=>{const _=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(v=>{const L=v.id??"unassigned";_.has(L)||_.set(L,{id:v.id,name:v.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const z=_.get(L);z.thisWeekCount=v.count??0,z.thisWeekTickets=v.tickets||[],z.totalCount+=z.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(v=>{const L=v.id??"unassigned";_.has(L)||_.set(L,{id:v.id,name:v.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const z=_.get(L);z.otherWeekCount=v.count??0,z.otherWeekTickets=v.tickets||[],z.totalCount+=z.otherWeekCount}),Array.from(_.values())}),B=q(()=>{if(!l.value)return[];const _=l.value.thisWeekTickets||[],v=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:_.length,otherWeekTickets:v.length,employee:l.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.thisWeekCount??0,tickets:_,employeeId:l.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.otherWeekCount??0,tickets:v,employeeId:l.value.id}]}),T=q(()=>(M.value||[]).length>0);async function h(_){const v=_.filter(L=>L.id!==null&&L.id!==void 0).map(L=>L.id);if(v.length===0)return _;try{const L=await st.getEmployeesByIds(v),z=new Map;return L.forEach(oe=>{z.set(oe.id,oe.name)}),_.map(oe=>oe.id&&z.has(oe.id)?{...oe,name:z.get(oe.id)}:oe)}catch(L){return console.error("[ResponsibleModal] Error enriching names:",L),_}}De([()=>a.value,()=>N.value],async([_,v])=>{if(!(_!=="employees"||e.value!==0)){if(!v||v.length===0){M.value=[];return}ee.value=!0;try{M.value=await h(v)}catch(L){console.error("[ResponsibleModal] Error loading employee names:",L),M.value=v}finally{ee.value=!1}}},{immediate:!0}),De(()=>t.responsible,async _=>{if(!(e.value!==0||s.value||a.value!=="categories")){if(!_||_.length===0){S.value=[];return}ee.value=!0;try{S.value=await h(_)}catch(v){console.error("[ResponsibleModal] Error loading employee names:",v),S.value=_}finally{ee.value=!1}}},{immediate:!1});const c=q(()=>(S.value||[]).length>0);function w(_){a.value!==_&&(a.value=_,e.value=0,s.value=null,l.value=null,u.value=null,d.value=[],p.value=null,S.value=[],M.value=[])}async function A(_){if(!(!_||_.count===0)){s.value=_,e.value=1,ee.value=!0;try{S.value=await h(_.responsible)}catch(v){console.error("[ResponsibleModal] Error loading employee names:",v),S.value=_.responsible}finally{ee.value=!1}}}async function U(_,v=null){var L,z;!_||!_.id||_.totalCount===0||(v&&v.currentTarget&&(v.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{v.currentTarget&&(v.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:_.id,name:_.name,thisWeekCount:_.thisWeekCount,otherWeekCount:_.otherWeekCount,thisWeekTickets:((L=_.thisWeekTickets)==null?void 0:L.length)||0,otherWeekTickets:((z=_.otherWeekTickets)==null?void 0:z.length)||0,employee:_}),l.value={..._,thisWeekTickets:_.thisWeekTickets||[],otherWeekTickets:_.otherWeekTickets||[]},e.value=1)}async function E(_){var L;if(!_||_.count===0)return;u.value=_,e.value=2;const v=_.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:_.id,label:_.label,count:_.count,ticketsInGradation:v.length,selectedEmployee:(L=l.value)==null?void 0:L.id}),v.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",v.length),await G(v)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await O(_))}async function G(_){m.value=!0,p.value=null;try{try{const{prepareTicketsForDisplay:v}=await Me(async()=>{const{prepareTicketsForDisplay:L}=await import("./ticketListUtils-B_VRpfUN.js").then(z=>z.t);return{prepareTicketsForDisplay:L}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await v(_,null,null)}catch(v){console.error("[ResponsibleModal] Error preparing tickets:",v),d.value=_}d.value.length===0&&(p.value=null)}catch(v){p.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",v),d.value=[]}finally{m.value=!1}}async function O(_){m.value=!0,p.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const v=await Ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),L=_.id==="this-week"?v.data.responsibleCreatedThisWeek:v.data.responsibleCreatedOtherWeek,z=L==null?void 0:L.find(k=>k.id===l.value.id),oe=(z==null?void 0:z.tickets)||[];try{const{prepareTicketsForDisplay:k}=await Me(async()=>{const{prepareTicketsForDisplay:n}=await import("./ticketListUtils-B_VRpfUN.js").then(D=>D.t);return{prepareTicketsForDisplay:n}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await k(oe,null,null)}catch(k){console.error("[ResponsibleModal] Error preparing tickets:",k),d.value=oe}d.value.length===0&&(p.value=null)}catch(v){p.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",v),d.value=[]}finally{m.value=!1}}async function I(_,v=null){!_||!_.id||_.count===0||(v&&v.currentTarget&&(v.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{v.currentTarget&&(v.currentTarget.style.transform="")},150)),l.value=_,e.value=2,await H(_.id))}async function H(_){var v,L,z,oe,k,n,D,R,K,P;m.value=!0,p.value=null;try{let j=[];if(console.log("[ResponsibleModal] loadEmployeeTickets called:",{employeeId:_,selectedCategory:(v=s.value)==null?void 0:v.id,hasSelectedCategory:!!s.value,hasResponsible:!!((L=s.value)!=null&&L.responsible),responsibleCount:((oe=(z=s.value)==null?void 0:z.responsible)==null?void 0:oe.length)||0}),s.value&&s.value.responsible){const V=s.value.responsible.find(f=>f.id===_);console.log("[ResponsibleModal] Employee found in category:",{employee:V,hasTickets:!!(V!=null&&V.tickets),ticketsCount:((k=V==null?void 0:V.tickets)==null?void 0:k.length)||0}),j=(V==null?void 0:V.tickets)||[]}if(j.length===0&&t.weekStartUtc&&t.weekEndUtc){console.log("[ResponsibleModal] Tickets not found in category, loading from API");const V=await Ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0});console.log("[ResponsibleModal] API response:",{hasResponsibleCreatedThisWeek:!!V.data.responsibleCreatedThisWeek,hasResponsibleCreatedOtherWeek:!!V.data.responsibleCreatedOtherWeek,thisWeekCount:((n=V.data.responsibleCreatedThisWeek)==null?void 0:n.length)||0,otherWeekCount:((D=V.data.responsibleCreatedOtherWeek)==null?void 0:D.length)||0});const f=((R=s.value)==null?void 0:R.id)==="created-this-week"?V.data.responsibleCreatedThisWeek:V.data.responsibleCreatedOtherWeek;console.log("[ResponsibleModal] Category data:",{categoryId:(K=s.value)==null?void 0:K.id,categoryDataCount:(f==null?void 0:f.length)||0});const i=f==null?void 0:f.find(y=>y.id===_);console.log("[ResponsibleModal] Employee found in API response:",{employee:i,hasTickets:!!(i!=null&&i.tickets),ticketsCount:((P=i==null?void 0:i.tickets)==null?void 0:P.length)||0}),j=(i==null?void 0:i.tickets)||[]}try{const{prepareTicketsForDisplay:V}=await Me(async()=>{const{prepareTicketsForDisplay:f}=await import("./ticketListUtils-B_VRpfUN.js").then(i=>i.t);return{prepareTicketsForDisplay:f}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await V(j,null,null)}catch(V){console.error("[ResponsibleModal] Error preparing tickets:",V),d.value=j}d.value.length===0&&(p.value=null)}catch(j){p.value=j.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",j),d.value=[]}finally{m.value=!1}}function Y(){e.value===2?(e.value=1,a.value==="categories"?l.value=null:u.value=null,d.value=[],p.value=null):e.value===1&&(e.value=0,a.value==="categories"?(s.value=null,S.value=[]):l.value=null)}function x(_){const v=nt(_.id);window.open(v,"_blank")}function X(){a.value==="employees"&&u.value?G(u.value.tickets):a.value==="categories"&&l.value&&H(l.value.id)}return De(()=>t.isVisible,_=>{var v,L,z,oe;if(_){console.log("[TASK-070] ResponsibleModal opened for week",t.weekNumber),console.log("[TASK-070] ResponsibleModal data:",{weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,responsibleCreatedThisWeek:((v=t.responsibleCreatedThisWeek)==null?void 0:v.length)||0,responsibleCreatedOtherWeek:((L=t.responsibleCreatedOtherWeek)==null?void 0:L.length)||0,closedTicketsCreatedThisWeek:t.closedTicketsCreatedThisWeek,closedTicketsCreatedOtherWeek:t.closedTicketsCreatedOtherWeek}),console.log("[TASK-070] ResponsibleModal detailed data:",{responsibleCreatedThisWeek:t.responsibleCreatedThisWeek,responsibleCreatedOtherWeek:t.responsibleCreatedOtherWeek,responsibleCreatedThisWeekWithTickets:(z=t.responsibleCreatedThisWeek)==null?void 0:z.map(n=>{var D;return{id:n.id,name:n.name,count:n.count,hasTickets:!!n.tickets,ticketsCount:((D=n.tickets)==null?void 0:D.length)||0}}),responsibleCreatedOtherWeekWithTickets:(oe=t.responsibleCreatedOtherWeek)==null?void 0:oe.map(n=>{var D;return{id:n.id,name:n.name,count:n.count,hasTickets:!!n.tickets,ticketsCount:((D=n.tickets)==null?void 0:D.length)||0}})});const k=t.weekNumber;k&&console.log("[TASK-070] ResponsibleModal: Week number",k)}else e.value=0,a.value="categories",s.value=null,l.value=null,u.value=null,d.value=[],p.value=null,S.value=[],M.value=[]}),(_,v)=>o.isVisible?(g(),b("div",An,[r("div",Dn,[e.value===0?(g(),b("div",Sn,[r("button",{class:he(["modal__tab",{"modal__tab--active":a.value==="categories"}]),onClick:v[0]||(v[0]=L=>w("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),r("button",{class:he(["modal__tab",{"modal__tab--active":a.value==="employees"}]),onClick:v[1]||(v[1]=L=>w("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):ae("",!0),se(we,{name:"level",mode:"out-in"},{default:ve(()=>{var L,z,oe,k;return[a.value==="categories"&&e.value===0?(g(),b("div",En,[r("header",Bn,[r("h3",Nn,[v[12]||(v[12]=Ce(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(g(),b("span",On," ¬∑ –ù–µ–¥–µ–ª—è "+W(o.weekNumber),1)):ae("",!0)]),r("button",{class:"modal__close",onClick:v[2]||(v[2]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Un,[r("ul",In,[(g(!0),b(de,null,ue(Q.value,n=>(g(),b("li",{key:n.id,class:he(["categories-list__item",{"categories-list__item--clickable":n.count>0}]),onClick:D=>A(n)},[r("div",Rn,[r("div",Pn,[n.id==="created-this-week"?(g(),b("span",xn,"‚úì")):(g(),b("span",Ln,"‚Üª"))]),r("div",Gn,[r("div",Fn,W(n.label),1),r("div",Hn,W(n.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),n.count>0?(g(),b("span",Vn,"‚Üí")):ae("",!0)])],10,Mn))),128))])]),r("footer",Kn,[r("button",{class:"btn",onClick:v[3]||(v[3]=n=>_.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===1?(g(),b("div",Yn,[r("header",jn,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),v[13]||(v[13]=r("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("button",{class:"modal__close",onClick:v[4]||(v[4]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",zn,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>[ee.value?(g(),b("div",qn,[...v[14]||(v[14]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):c.value?(g(),b("ul",Xn,[(g(!0),b(de,null,ue(S.value,n=>(g(),b("li",{key:n.id||n.name,class:he(["responsible-list__item",{"responsible-list__item--clickable":n.id&&n.count>0}]),onClick:D=>I(n,D),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",Qn,W(n.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",el,W(n.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),n.id&&n.count>0?(g(),b("span",tl,"‚Üí")):ae("",!0)],10,Jn))),128))])):(g(),b("p",Zn,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),r("footer",rl,[r("button",{class:"btn",onClick:v[5]||(v[5]=n=>_.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===2?(g(),b("div",al,[r("header",sl,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",ol,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+W(((L=l.value)==null?void 0:L.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:v[6]||(v[6]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",nl,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>[m.value?(g(),b("div",ll,[...v[15]||(v[15]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(g(),b("div",il,[v[16]||(v[16]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),v[17]||(v[17]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",cl,W(p.value),1),r("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(g(),b("div",dl,[...v[18]||(v[18]=[r("div",{class:"empty-state-icon"},"üìã",-1),r("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(g(),b("div",ul,[se(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ve(()=>[(g(!0),b(de,null,ue(d.value,(n,D)=>(g(),We(Qe,{key:n.id,ticket:n,draggable:!1,style:Se({"--ticket-index":D}),onClick:x},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):a.value==="employees"&&e.value===0?(g(),b("div",kl,[r("header",vl,[r("h3",hl,[v[19]||(v[19]=Ce(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(g(),b("span",yl," ¬∑ –ù–µ–¥–µ–ª—è "+W(o.weekNumber),1)):ae("",!0)]),r("button",{class:"modal__close",onClick:v[7]||(v[7]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",ml,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>[ee.value?(g(),b("div",pl,[...v[20]||(v[20]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):T.value?(g(),b("ul",fl,[(g(!0),b(de,null,ue(M.value,n=>(g(),b("li",{key:n.id||n.name,class:he(["responsible-list__item",{"responsible-list__item--clickable":n.id&&n.totalCount>0}]),onClick:D=>U(n,D),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",_l,W(n.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",wl,W(n.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),n.id&&n.totalCount>0?(g(),b("span",Cl,"‚Üí")):ae("",!0)],10,bl))),128))])):(g(),b("p",gl,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),r("footer",Tl,[r("button",{class:"btn",onClick:v[8]||(v[8]=n=>_.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===1?(g(),b("div",Wl,[r("header",$l,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Al,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+W(((z=l.value)==null?void 0:z.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:v[9]||(v[9]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Dl,[r("ul",Sl,[(g(!0),b(de,null,ue(B.value,n=>(g(),b("li",{key:n.id,class:he(["categories-list__item",{"categories-list__item--clickable":n.count>0}]),onClick:D=>E(n)},[r("div",Bl,[r("div",Nl,[n.id==="this-week"?(g(),b("span",Ol,"‚úì")):(g(),b("span",Ul,"‚Üª"))]),r("div",Il,[r("div",Ml,W(n.label),1),r("div",Rl,W(n.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),n.count>0?(g(),b("span",Pl,"‚Üí")):ae("",!0)])],10,El))),128))])]),r("footer",xl,[r("button",{class:"btn",onClick:v[10]||(v[10]=n=>_.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===2?(g(),b("div",Ll,[r("header",Gl,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Fl," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+W(((oe=l.value)==null?void 0:oe.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+W(((k=u.value)==null?void 0:k.label)||"")+") ",1),r("button",{class:"modal__close",onClick:v[11]||(v[11]=n=>_.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Hl,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>{var n;return[m.value?(g(),b("div",Vl,[...v[21]||(v[21]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(g(),b("div",Kl,[v[22]||(v[22]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),v[23]||(v[23]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Yl,W(p.value),1),r("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(g(),b("div",jl,[v[24]||(v[24]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",zl,W(a.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((n=u.value)==null?void 0:n.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(g(),b("div",ql,[se(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ve(()=>[(g(!0),b(de,null,ue(d.value,(D,R)=>(g(),We(Qe,{key:D.id,ticket:D,draggable:!1,style:Se({"--ticket-index":R}),onClick:x},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ae("",!0)]}),_:1})])])):ae("",!0)}},Xl=$e(Zl,[["__scopeId","data-v-53bab960"]]),Jl={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Ql={class:"modal"},ei={key:"level-1",class:"level-1"},ti={class:"modal__header"},ri={class:"modal__title"},ai={key:0},si={class:"modal__body"},oi={key:"loading",class:"loading-names"},ni={key:"empty",class:"modal__empty"},li={key:"list",class:"stages-list"},ii=["onClick"],ci={class:"stages-list__name"},di={class:"stages-list__count"},ui={key:0,class:"stages-list__arrow"},ki={class:"modal__footer"},vi={key:"level-2",class:"level-2"},hi={class:"modal__header"},yi={class:"modal__title"},mi={class:"modal__body"},pi={key:"loading",class:"loading-state"},gi={key:"error",class:"error-state"},fi={class:"error-message"},bi={key:"empty",class:"empty-state"},_i={class:"empty-state-message"},wi={key:"tickets",class:"tickets-list-container"},Ci={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,a=Z(1),s=Z(null),l=Z([]),u=Z(!1),d=Z(!1),m=Z(null),p=Z([]),S=q(()=>p.value.length>0&&p.value.some(h=>h.count>0));async function M(){var h;if(console.log("[TASK-070] StagesModal: loadStages called",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),!e.weekStartUtc||!e.weekEndUtc){console.warn("[TASK-070] StagesModal: Missing week boundaries, cannot load stages"),p.value=[];return}d.value=!0,m.value=null;try{console.log("[TASK-070] StagesModal: Fetching stages from API...");const c=await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});console.log("[TASK-070] StagesModal: API response received",{hasNewTicketsByStages:!!c.data.newTicketsByStages,stagesCount:((h=c.data.newTicketsByStages)==null?void 0:h.length)||0}),p.value=c.data.newTicketsByStages||[],p.value.length===0?console.warn("[TASK-070] StagesModal: API returned empty stages array for week",e.weekNumber):console.log("[TASK-070] StagesModal: Stages loaded successfully",p.value.length,"stages")}catch(c){m.value=c.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[TASK-070] StagesModal: Error loading stages:",c),p.value=[]}finally{d.value=!1}}async function ee(h,c=null){!h||h.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),s.value=h,a.value=2,await Q(h.stageId))}async function Q(h){var c;u.value=!0,m.value=null;try{const w=p.value.find(G=>G.stageId===h);if(w&&Array.isArray(w.tickets)&&w.tickets.length>0){console.log("[TASK-070] StagesModal: Using preloaded tickets for stage",h,"count:",w.tickets.length);const G=w.tickets;try{const{prepareTicketsForDisplay:O}=await Me(async()=>{const{prepareTicketsForDisplay:I}=await import("./ticketListUtils-B_VRpfUN.js").then(H=>H.t);return{prepareTicketsForDisplay:I}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await O(G,null,null)}catch(O){console.error("[TASK-070] StagesModal: Error preparing tickets:",O),l.value=G}u.value=!1;return}if(console.log("[TASK-070] StagesModal: Tickets not preloaded, loading from API for stage",h),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const U=(c=(await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:c.find(G=>G.stageId===h),E=(U==null?void 0:U.tickets)||[];try{const{prepareTicketsForDisplay:G}=await Me(async()=>{const{prepareTicketsForDisplay:O}=await import("./ticketListUtils-B_VRpfUN.js").then(I=>I.t);return{prepareTicketsForDisplay:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await G(E,null,null)}catch(G){console.error("[StagesModal] Error preparing tickets:",G),l.value=E}l.value.length===0&&(m.value=null)}catch(w){m.value=w.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",w),l.value=[]}finally{u.value=!1}}function N(){a.value=1,s.value=null,l.value=[],m.value=null}function B(h){const c=nt(h.id);window.open(c,"_blank")}function T(){s.value&&Q(s.value.stageId)}return De(()=>e.isVisible,async h=>{h?(a.value=1,s.value=null,l.value=[],m.value=null,console.log("[TASK-070] StagesModal opened:",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,preloadedData:e.preloadedData?Array.isArray(e.preloadedData)?`Array(${e.preloadedData.length})`:typeof e.preloadedData:"null"}),e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] StagesModal: Using preloaded data, stages count:",e.preloadedData.length),e.preloadedData.every(w=>w.stageId&&w.stageName&&typeof w.count=="number")?(p.value=e.preloadedData,d.value=!1,console.log("[TASK-070] StagesModal: Preloaded data set, stages:",p.value.length)):(console.warn("[TASK-070] StagesModal: Invalid preloaded data structure, falling back to API"),await M())):(console.log("[TASK-070] StagesModal: No preloaded data, loading from API",{weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),await M())):(a.value=1,s.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),De([()=>e.weekNumber,()=>e.preloadedData],async([h,c])=>{e.isVisible&&h&&(c&&Array.isArray(c)&&c.length>0?c.every(A=>A.stageId&&A.stageName&&typeof A.count=="number")?(console.log("[TASK-070] StagesModal: Week changed, updating with preloaded data for week",h),p.value=c,d.value=!1):(console.log("[TASK-070] StagesModal: Week changed, invalid preloaded data, loading from API for week",h),await M()):(console.log("[TASK-070] StagesModal: Week changed, loading from API for week",h),await M()))}),(h,c)=>o.isVisible?(g(),b("div",Jl,[r("div",Ql,[se(we,{name:"level",mode:"out-in"},{default:ve(()=>{var w;return[a.value===1?(g(),b("div",ei,[r("header",ti,[r("h3",ri,[c[3]||(c[3]=Ce(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),o.weekNumber?(g(),b("span",ai," ¬∑ –ù–µ–¥–µ–ª—è "+W(o.weekNumber),1)):ae("",!0)]),r("button",{class:"modal__close",onClick:c[0]||(c[0]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",si,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>[d.value?(g(),b("div",oi,[...c[4]||(c[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):S.value?(g(),b("ul",li,[(g(!0),b(de,null,ue(p.value,A=>(g(),b("li",{key:A.stageId,class:he(["stages-list__item",{"stages-list__item--clickable":A.count>0}]),style:Se({"--stage-color":A.color}),onClick:U=>ee(A,U),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[r("span",{class:"stages-list__color",style:Se({backgroundColor:A.color})},null,4),r("span",ci,W(A.stageName),1),r("span",di,W(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.count>0?(g(),b("span",ui,"‚Üí")):ae("",!0)],14,ii))),128))])):(g(),b("p",ni," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",ki,[r("button",{class:"btn",onClick:c[1]||(c[1]=A=>h.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(g(),b("div",vi,[r("header",hi,[r("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",yi," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+W(((w=s.value)==null?void 0:w.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:c[2]||(c[2]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",mi,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>{var A;return[u.value?(g(),b("div",pi,[...c[5]||(c[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(g(),b("div",gi,[c[6]||(c[6]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",fi,W(m.value),1),r("button",{class:"btn btn-retry",onClick:T},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(g(),b("div",bi,[c[8]||(c[8]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",_i," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+W((A=s.value)==null?void 0:A.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(g(),b("div",wi,[se(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ve(()=>[(g(!0),b(de,null,ue(l.value,(U,E)=>(g(),We(Qe,{key:U.id,ticket:U,draggable:!1,style:Se({"--ticket-index":E}),onClick:B},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ae("",!0)]}),_:1})])])):ae("",!0)}},Ti=$e(Ci,[["__scopeId","data-v-00403024"]]),Wi={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},$i={class:"modal"},Ai={key:"level-1",class:"level-1"},Di={class:"modal__header"},Si={class:"modal__title"},Ei={key:0},Bi={class:"modal__body"},Ni={key:"loading",class:"loading-names"},Oi={key:"empty",class:"modal__empty"},Ui={key:"list",class:"duration-list"},Ii=["onClick"],Mi={class:"duration-list__name"},Ri={class:"duration-list__count"},Pi={key:0,class:"duration-list__arrow"},xi={class:"modal__footer"},Li={key:"level-2",class:"level-2"},Gi={class:"modal__header"},Fi={class:"modal__title"},Hi={class:"modal__body"},Vi={key:"loading",class:"loading-state"},Ki={key:"error",class:"error-state"},Yi={class:"error-message"},ji={key:"empty",class:"empty-state"},zi={class:"empty-state-message"},qi={key:"tickets",class:"tickets-list-container"},Zi={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,a=Z(1),s=Z(null),l=Z([]),u=Z(!1),d=Z(!1),m=Z(null),p=Z([]),S=q(()=>p.value.length>0&&p.value.some(h=>h.count>0));async function M(){if(!e.weekStartUtc||!e.weekEndUtc){p.value=[];return}d.value=!0,m.value=null;try{const h=await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});p.value=h.data.carryoverTicketsByDuration||[]}catch(h){m.value=h.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",h),p.value=[]}finally{d.value=!1}}async function ee(h,c=null){!h||h.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),s.value=h,a.value=2,await Q(h.durationCategory))}async function Q(h){var c;u.value=!0,m.value=null;try{const w=p.value.find(G=>G.durationCategory===h);if(w&&Array.isArray(w.tickets)&&w.tickets.length>0){console.log("[TASK-070] CarryoverDurationModal: Using preloaded tickets for category",h,"count:",w.tickets.length);const G=w.tickets;try{const{prepareTicketsForDisplay:O}=await Me(async()=>{const{prepareTicketsForDisplay:I}=await import("./ticketListUtils-B_VRpfUN.js").then(H=>H.t);return{prepareTicketsForDisplay:I}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await O(G,null,null)}catch(O){console.error("[TASK-070] CarryoverDurationModal: Error preparing tickets:",O),l.value=G}u.value=!1;return}if(console.log("[TASK-070] CarryoverDurationModal: Tickets not preloaded, loading from API for category",h),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const U=(c=(await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:c.find(G=>G.durationCategory===h),E=(U==null?void 0:U.tickets)||[];try{const{prepareTicketsForDisplay:G}=await Me(async()=>{const{prepareTicketsForDisplay:O}=await import("./ticketListUtils-B_VRpfUN.js").then(I=>I.t);return{prepareTicketsForDisplay:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await G(E,null,null)}catch(G){console.error("[CarryoverDurationModal] Error preparing tickets:",G),l.value=E}l.value.length===0&&(m.value=null)}catch(w){m.value=w.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",w),l.value=[]}finally{u.value=!1}}function N(){a.value=1,s.value=null,l.value=[],m.value=null}function B(h){const c=nt(h.id);window.open(c,"_blank")}function T(){s.value&&Q(s.value.durationCategory)}return De(()=>e.isVisible,async h=>{h?(a.value=1,s.value=null,l.value=[],m.value=null,e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] CarryoverDurationModal: Using preloaded data, categories count:",e.preloadedData.length),e.preloadedData.every(w=>w.durationCategory&&w.durationLabel&&typeof w.count=="number")?(p.value=e.preloadedData,d.value=!1):(console.warn("[TASK-070] CarryoverDurationModal: Invalid preloaded data structure, falling back to API"),await M())):(console.log("[TASK-070] CarryoverDurationModal: No preloaded data, loading from API"),await M())):(a.value=1,s.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),De([()=>e.weekNumber,()=>e.preloadedData],async([h,c])=>{e.isVisible&&h&&(c&&Array.isArray(c)&&c.length>0?c.every(A=>A.durationCategory&&A.durationLabel&&typeof A.count=="number")?(console.log("[TASK-070] CarryoverDurationModal: Week changed, updating with preloaded data for week",h),p.value=c,d.value=!1):(console.log("[TASK-070] CarryoverDurationModal: Week changed, invalid preloaded data, loading from API for week",h),await M()):(console.log("[TASK-070] CarryoverDurationModal: Week changed, loading from API for week",h),await M()))}),(h,c)=>o.isVisible?(g(),b("div",Wi,[r("div",$i,[se(we,{name:"level",mode:"out-in"},{default:ve(()=>{var w;return[a.value===1?(g(),b("div",Ai,[r("header",Di,[r("h3",Si,[c[3]||(c[3]=Ce(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),o.weekNumber?(g(),b("span",Ei," ¬∑ –ù–µ–¥–µ–ª—è "+W(o.weekNumber),1)):ae("",!0)]),r("button",{class:"modal__close",onClick:c[0]||(c[0]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Bi,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>[d.value?(g(),b("div",Ni,[...c[4]||(c[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):S.value?(g(),b("ul",Ui,[(g(!0),b(de,null,ue(p.value,A=>(g(),b("li",{key:A.durationCategory,class:he(["duration-list__item",{"duration-list__item--clickable":A.count>0}]),style:Se({"--duration-color":A.color}),onClick:U=>ee(A,U),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[r("span",{class:"duration-list__color",style:Se({backgroundColor:A.color})},null,4),r("span",Mi,W(A.durationLabel),1),r("span",Ri,W(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.count>0?(g(),b("span",Pi,"‚Üí")):ae("",!0)],14,Ii))),128))])):(g(),b("p",Oi," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",xi,[r("button",{class:"btn",onClick:c[1]||(c[1]=A=>h.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(g(),b("div",Li,[r("header",Gi,[r("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Fi," –¢–∏–∫–µ—Ç—ã: "+W(((w=s.value)==null?void 0:w.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:c[2]||(c[2]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Hi,[se(we,{name:"loading",mode:"out-in"},{default:ve(()=>{var A;return[u.value?(g(),b("div",Vi,[...c[5]||(c[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(g(),b("div",Ki,[c[6]||(c[6]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Yi,W(m.value),1),r("button",{class:"btn btn-retry",onClick:T},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(g(),b("div",ji,[c[8]||(c[8]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",zi," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+W((A=s.value)==null?void 0:A.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(g(),b("div",qi,[se(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ve(()=>[(g(!0),b(de,null,ue(l.value,(U,E)=>(g(),We(Qe,{key:U.id,ticket:U,draggable:!1,style:Se({"--ticket-index":E}),onClick:B},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ae("",!0)]}),_:1})])])):ae("",!0)}},Xi=$e(Zi,[["__scopeId","data-v-0d406e97"]]),Ji={class:"ac-dashboard"},Qi={key:"preloader",class:"chart-preloader"},ec={class:"preloader-content"},tc={class:"preloader-message"},rc={key:"content"},ac={key:1,class:"weeks-dashboard"},sc={class:"dashboard-header"},oc={class:"header-content"},nc={class:"breadcrumbs-row"},lc=["aria-label","aria-disabled","data-fallback","disabled"],ic={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},cc={class:"dashboard-layout"},dc={class:"filters-container"},uc={class:"chart-container"},kc={__name:"GraphAdmissionClosureDashboard",setup(o){const t=Dt(),e=Z(!1),a=Z(null),s=Z(null),l=Z({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),u=Z(!1),d=Z(!1),m=Z(!1),p=Z(!0),S=Z(null),M=Z({currentWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null},previousWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null}}),ee=q(()=>{var y;const i=((y=s.value)==null?void 0:y.weeks)||[];return i.length>=2?i[i.length-2]:null}),Q=Z(!1),N=q(()=>typeof window>"u"?!1:window.history.length>1),B=q(()=>N.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),T={name:"dashboard-sector-1c"};function h(i){var y;if((y=i==null?void 0:i.preventDefault)==null||y.call(i),!Q.value){Q.value=!0;try{if(N.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(T)}finally{Q.value=!1}}}const c=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),w=Z("weeks"),A=q(()=>{const i=c.value.customDateRange.startDate||c.value.customDateRange.endDate,y=c.value.employees.length===1&&c.value.employees.includes("all");return i||!y});async function U(){var y,$,F,J;if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",w.value),console.log("[DEBUG] isLoading before:",e.value),w.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,a.value=null;const i=new Promise(re=>setTimeout(re,300));try{console.log("[DEBUG] Starting API call");const re=f(),ce=re.weekStartUtc,pe=re.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:ce,weekEndUtc:pe});const[Te,ge]=await Promise.all([i,Ee({product:"1C",periodMode:"weeks",weekStartUtc:ce,weekEndUtc:pe,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTicketsByDuration:!0})]);console.log("[DEBUG] API call successful, result:",ge);const{meta:fe,data:te,carryoverDebug:ke}=ge;if(s.value=fe,l.value={...te,responsibleCreatedThisWeek:Array.isArray(te.responsibleCreatedThisWeek)?te.responsibleCreatedThisWeek:te.responsibleCreatedThisWeek?Object.values(te.responsibleCreatedThisWeek):[],responsibleCreatedOtherWeek:Array.isArray(te.responsibleCreatedOtherWeek)?te.responsibleCreatedOtherWeek:te.responsibleCreatedOtherWeek?Object.values(te.responsibleCreatedOtherWeek):[]},console.log("[DEBUG] Data set, meta:",fe,"data keys:",Object.keys(te)),console.log("[TASK-070] responsibleCreatedThisWeek from API:",{count:((y=te.responsibleCreatedThisWeek)==null?void 0:y.length)||0,data:te.responsibleCreatedThisWeek,details:($=te.responsibleCreatedThisWeek)==null?void 0:$.map(ne=>{var ie;return{id:ne.id,name:ne.name,count:ne.count,hasTickets:!!ne.tickets,ticketsCount:((ie=ne.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] responsibleCreatedOtherWeek from API:",{count:((F=te.responsibleCreatedOtherWeek)==null?void 0:F.length)||0,data:te.responsibleCreatedOtherWeek,details:(J=te.responsibleCreatedOtherWeek)==null?void 0:J.map(ne=>{var ie;return{id:ne.id,name:ne.name,count:ne.count,hasTickets:!!ne.tickets,ticketsCount:((ie=ne.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] closedTicketsCreatedThisWeek:",te.closedTicketsCreatedThisWeek),console.log("[TASK-070] closedTicketsCreatedOtherWeek:",te.closedTicketsCreatedOtherWeek),te.newTicketsByStages&&(M.value.currentWeek.newTicketsByStages=te.newTicketsByStages,console.log("[TASK-070] Preloaded newTicketsByStages for current week:",te.newTicketsByStages.length,"stages")),te.carryoverTicketsByDuration&&(M.value.currentWeek.carryoverTicketsByDuration=te.carryoverTicketsByDuration,console.log("[TASK-070] Preloaded carryoverTicketsByDuration for current week:",te.carryoverTicketsByDuration.length,"categories")),te.responsibleCreatedThisWeek){const ne=Array.isArray(te.responsibleCreatedThisWeek)?te.responsibleCreatedThisWeek:Object.values(te.responsibleCreatedThisWeek);M.value.currentWeek.responsibleCreatedThisWeek=ne,console.log("[TASK-070] Preloaded responsibleCreatedThisWeek for current week:",ne.length,"employees"),console.log("[TASK-070] responsibleCreatedThisWeek details:",ne.map(ie=>{var le;return{id:ie.id,name:ie.name,count:ie.count,hasTickets:!!ie.tickets,ticketsCount:((le=ie.tickets)==null?void 0:le.length)||0}}))}if(te.responsibleCreatedOtherWeek){const ne=Array.isArray(te.responsibleCreatedOtherWeek)?te.responsibleCreatedOtherWeek:Object.values(te.responsibleCreatedOtherWeek);M.value.currentWeek.responsibleCreatedOtherWeek=ne,console.log("[TASK-070] Preloaded responsibleCreatedOtherWeek for current week:",ne.length,"employees"),console.log("[TASK-070] responsibleCreatedOtherWeek details:",ne.map(ie=>{var le;return{id:ie.id,name:ie.name,count:ie.count,hasTickets:!!ie.tickets,ticketsCount:((le=ie.tickets)==null?void 0:le.length)||0}}))}if(ke&&(console.log("[CARRYOVER-DEBUG] ========================================"),console.log("[CARRYOVER-DEBUG] Total:",ke.total),console.log("[CARRYOVER-DEBUG] ThisWeek:",ke.thisWeek),console.log("[CARRYOVER-DEBUG] PreviousWeek:",ke.previousWeek),console.log("[CARRYOVER-DEBUG] Older:",ke.older),console.log("[CARRYOVER-DEBUG] Sum:",ke.sum,"(expected:",ke.total,")"),console.log("[CARRYOVER-DEBUG] Series:",ke.series),console.log("[CARRYOVER-DEBUG] CurrentWeekData:",ke.currentWeekData),console.log("[CARRYOVER-DEBUG] WeeksData:",ke.weeksData),console.log("[CARRYOVER-DEBUG] Full object:",ke),console.log("[CARRYOVER-DEBUG] ========================================")),ee.value){const ne=ee.value.weekStartUtc,ie=ee.value.weekEndUtc;console.log("[TASK-070] Starting preload for previous week:",{weekNumber:ee.value.weekNumber,weekStartUtc:ne,weekEndUtc:ie}),Ee({product:"1C",periodMode:"weeks",weekStartUtc:ne,weekEndUtc:ie,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTicketsByDuration:!0}).then(le=>{if(console.log("[TASK-070] Preload successful for previous week"),le.data.newTicketsByStages&&(M.value.previousWeek.newTicketsByStages=le.data.newTicketsByStages,console.log("[TASK-070] Preloaded newTicketsByStages for previous week:",le.data.newTicketsByStages.length,"stages")),le.data.carryoverTicketsByDuration&&(M.value.previousWeek.carryoverTicketsByDuration=le.data.carryoverTicketsByDuration,console.log("[TASK-070] Preloaded carryoverTicketsByDuration for previous week:",le.data.carryoverTicketsByDuration.length,"categories")),le.data.responsibleCreatedThisWeek){const be=Array.isArray(le.data.responsibleCreatedThisWeek)?le.data.responsibleCreatedThisWeek:Object.values(le.data.responsibleCreatedThisWeek);M.value.previousWeek.responsibleCreatedThisWeek=be,console.log("[TASK-070] Preloaded responsibleCreatedThisWeek for previous week:",be.length,"employees")}if(le.data.responsibleCreatedOtherWeek){const be=Array.isArray(le.data.responsibleCreatedOtherWeek)?le.data.responsibleCreatedOtherWeek:Object.values(le.data.responsibleCreatedOtherWeek);M.value.previousWeek.responsibleCreatedOtherWeek=be,console.log("[TASK-070] Preloaded responsibleCreatedOtherWeek for previous week:",be.length,"employees")}}).catch(le=>{console.warn("[TASK-070] Failed to preload previous week data (non-critical):",le)})}}catch(re){console.error("[DEBUG] API call failed:",re),a.value=re instanceof Error?re:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",re)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function E(i){var pe;if(!i||!s.value)return console.log("[TASK-070] getPreloadedStagesData: Missing weekMeta or chartMeta"),null;const y=((pe=s.value)==null?void 0:pe.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber,F=y.length>=2?y[y.length-2].weekNumber:null;console.log("[TASK-070] getPreloadedStagesData:",{requestedWeek:i.weekNumber,currentWeekNumber:$,previousWeekNumber:F,weeksInMeta:y.length});const J=i.weekNumber===$,re=i.weekNumber===F;let ce=null;if(J)ce=M.value.currentWeek.newTicketsByStages,console.log("[TASK-070] Requested week is current week, checking currentWeek data:",ce?`Array(${ce.length})`:"null");else if(re)ce=M.value.previousWeek.newTicketsByStages,console.log("[TASK-070] Requested week is previous week, checking previousWeek data:",ce?`Array(${ce.length})`:"null");else return console.log("[TASK-070] Requested week",i.weekNumber,"is neither current nor previous, no preloaded data available"),null;return Array.isArray(ce)&&ce.length>0?(console.log("[TASK-070] Using preloaded stages data for week",i.weekNumber,":",ce.length,"stages"),ce):(console.log("[TASK-070] No preloaded stages data for week",i.weekNumber,", will use API fallback"),null)}function G(i){var re;if(!i||!s.value)return null;const y=((re=s.value)==null?void 0:re.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber,J=i.weekNumber===$?M.value.currentWeek.carryoverTicketsByDuration:M.value.previousWeek.carryoverTicketsByDuration;return Array.isArray(J)&&J.length>0?(console.log("[TASK-070] Using preloaded carryover data for week",i.weekNumber,":",J.length,"categories"),J):(console.log("[TASK-070] No preloaded carryover data for week",i.weekNumber,", will use API fallback"),null)}function O(i){var J;if(!i||!s.value)return null;const y=((J=s.value)==null?void 0:J.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===$&&l.value.responsible||null}function I(i){var J;if(!i||!s.value)return null;const y=((J=s.value)==null?void 0:J.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;if(i.weekNumber===$){const re=l.value.responsibleCreatedThisWeek;return re?Array.isArray(re)?re:Object.values(re):null}return M.value.previousWeek.responsibleCreatedThisWeek||null}function H(i){var J;if(!i||!s.value)return null;const y=((J=s.value)==null?void 0:J.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;if(i.weekNumber===$){const re=l.value.responsibleCreatedOtherWeek;return re?Array.isArray(re)?re:Object.values(re):null}return M.value.previousWeek.responsibleCreatedOtherWeek||null}function Y(i){var J;if(!i||!s.value)return null;const y=((J=s.value)==null?void 0:J.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===$?l.value.closedTicketsCreatedThisWeek??null:null}function x(i){var J;if(!i||!s.value)return null;const y=((J=s.value)==null?void 0:J.weeks)||[],$=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===$?l.value.closedTicketsCreatedOtherWeek??null:null}function X(i){c.value.stages=i}function _(i){c.value.employees=i}function v(i){c.value.dateRange=i}function L(i){c.value.customDateRange=i}function z(i){if(!["weeks","months"].includes(i)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",i);return}i!==w.value&&(w.value=i,U())}function oe(i){const{mode:y}=i.detail;["weeks","months"].includes(y)&&z(y)}function k(){c.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},n()}function n(){U()}function D(i){["weeks","months"].includes(i)&&(w.value=i)}function R(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",p.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",w.value),p.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",p.value),console.log("[DEBUG] isLoading after:",e.value),_t(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),K()})}function K(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",w.value),console.log("[DEBUG] showPeriodModeInfo:",p.value),console.log("[DEBUG] isLoading:",e.value),(!w.value||!["weeks","months"].includes(w.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),w.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",w.value),_t(()=>{console.log("[DEBUG] nextTick callback, periodMode:",w.value),console.log("[DEBUG] isLoading in nextTick:",e.value),w.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),U()):w.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function P(i=null){var y,$,F;i?S.value=i:S.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:(($=s.value)==null?void 0:$.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},d.value=!0}function j(i=null){var y,$,F;i?S.value=i:S.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:(($=s.value)==null?void 0:$.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},u.value=!0}function V(i=null){var y,$,F;i?S.value=i:S.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:(($=s.value)==null?void 0:$.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},m.value=!0}ot(()=>{try{const i="graph-admission-closure-period-mode-info-shown";localStorage.getItem(i)&&localStorage.removeItem(i);const y="graph-admission-closure-period-mode";localStorage.getItem(y)&&localStorage.removeItem(y)}catch(i){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",i)}window.addEventListener("period-mode-change",oe)}),$t(()=>{window.removeEventListener("period-mode-change",oe)});function f(){const i=new Date,y=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate())),$=y.getUTCDay(),F=y.getUTCDate()-$+($===0?-6:1),J=new Date(Date.UTC(y.getUTCFullYear(),y.getUTCMonth(),F,0,0,0)),re=new Date(J);return re.setUTCDate(re.getUTCDate()+6),re.setUTCHours(23,59,59,999),{weekStartUtc:J.toISOString(),weekEndUtc:re.toISOString()}}return(i,y)=>{var F,J,re,ce,pe,Te,ge,fe,te,ke,ne,ie,le,be,Be,Ne,Oe,Ue;const $=St("router-link");return g(),b("div",Ji,[se(we,{name:"fade",mode:"out-in"},{default:ve(()=>[e.value?(g(),b("div",Qi,[r("div",ec,[y[3]||(y[3]=r("div",{class:"preloader-spinner"},[r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"})],-1)),y[4]||(y[4]=r("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),r("p",tc," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+W(w.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),y[5]||(y[5]=r("div",{class:"preloader-dots"},[r("span",{class:"dot"}),r("span",{class:"dot"}),r("span",{class:"dot"})],-1))])])):!p.value&&!e.value?(g(),b("div",rc,[w.value==="months"?(g(),We($n,{key:0})):(g(),b("div",ac,[r("div",sc,[r("div",oc,[r("div",nc,[r("button",{class:"btn-back-link",type:"button",onClick:h,"aria-label":B.value,"aria-disabled":!N.value,"data-fallback":!N.value,disabled:Q.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,lc),r("nav",ic,[se($,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ve(()=>[...y[6]||(y[6]=[Ce(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),y[8]||(y[8]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),se($,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ve(()=>[...y[7]||(y[7]=[Ce(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),y[9]||(y[9]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),y[10]||(y[10]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),y[11]||(y[11]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),y[12]||(y[12]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",cc,[r("div",dc,[se(Bt,{stages:c.value.stages,employees:c.value.employees,dateRange:c.value.dateRange,customDateRange:c.value.customDateRange,hasActiveFilters:A.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":w.value,"onUpdate:stages":X,"onUpdate:employees":_,"onUpdate:dateRange":v,"onUpdate:customDateRange":L,"onUpdate:periodMode":z,onReset:k,onApply:n},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),r("div",uc,[a.value?(g(),We(Et,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:a.value.message},null,8,["message"])):(g(),We(Ms,{key:1,meta:s.value,data:l.value,onOpenResponsible:j,onOpenStages:P,onOpenCarryover:V},null,8,["meta","data"]))])])]))])):ae("",!0)]),_:1}),se(Xl,{"is-visible":u.value,responsible:O(S.value)||l.value.responsible||[],"closed-tickets-created-this-week":Y(S.value)??l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":x(S.value)??l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":I(S.value)||l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":H(S.value)||l.value.responsibleCreatedOtherWeek||[],"week-number":((F=S.value)==null?void 0:F.weekNumber)||((J=s.value)==null?void 0:J.weekNumber)||null,"week-start-utc":((re=S.value)==null?void 0:re.weekStartUtc)||((ce=s.value)==null?void 0:ce.weekStartUtc)||null,"week-end-utc":((pe=S.value)==null?void 0:pe.weekEndUtc)||((Te=s.value)==null?void 0:Te.weekEndUtc)||null,onClose:y[0]||(y[0]=Ie=>{u.value=!1,S.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),se(Ti,{"is-visible":d.value,"week-number":((ge=S.value)==null?void 0:ge.weekNumber)||((fe=s.value)==null?void 0:fe.weekNumber)||null,"week-start-utc":((te=S.value)==null?void 0:te.weekStartUtc)||((ke=s.value)==null?void 0:ke.weekStartUtc)||null,"week-end-utc":((ne=S.value)==null?void 0:ne.weekEndUtc)||((ie=s.value)==null?void 0:ie.weekEndUtc)||null,"preloaded-data":E(S.value),onClose:y[1]||(y[1]=Ie=>{d.value=!1,S.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),se(Xi,{"is-visible":m.value,"week-number":((le=S.value)==null?void 0:le.weekNumber)||((be=s.value)==null?void 0:be.weekNumber)||null,"week-start-utc":((Be=S.value)==null?void 0:Be.weekStartUtc)||((Ne=s.value)==null?void 0:Ne.weekStartUtc)||null,"week-end-utc":((Oe=S.value)==null?void 0:Oe.weekEndUtc)||((Ue=s.value)==null?void 0:Ue.weekEndUtc)||null,"preloaded-data":G(S.value),onClose:y[2]||(y[2]=Ie=>{m.value=!1,S.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),p.value?(g(),We(ur,{key:0,"is-visible":p.value,"current-mode":w.value,onClose:R,onSelectMode:D},null,8,["is-visible","current-mode"])):ae("",!0)])}}},fc=$e(kc,[["__scopeId","data-v-597f9359"]]);export{fc as default};
