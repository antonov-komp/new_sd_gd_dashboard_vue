const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./main-CXbIbH4o.js","./main-BHtrLvUz.css","./ticketListUtils-O2L1S674.js","./priority-config-DfwaRs1D.js","./priority-config-Bxxce_5E.css","./ticket-mapper-D-XXyGOH.js"])))=>i.map(i=>d[i]);
var jt=Object.defineProperty;var zt=(s,t,e)=>t in s?jt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var st=(s,t,e)=>zt(s,typeof t!="symbol"?t+"":t,e);import{_ as Oe,g as J,G as Ie,m as ct,H as Ot,f as De,o as y,j as ue,k as ge,a as f,d as ne,b as r,y as we,n as pe,B as $e,I as qt,J as Xe,K as _e,L as Zt,M as Bt,N as ze,O as Xt,P as Jt,Q as Qt,R as er,S as tr,U as rr,V as ar,W as sr,X as nt,c as z,Y as W,t as C,F as ye,e as me,Z as Le,$ as or,x as nr,l as Me,a0 as lr,a1 as Ue,z as It,r as Mt,a2 as Ut,a3 as Fe,T as rt,a4 as Wt}from"./main-CXbIbH4o.js";import{F as Rt}from"./FiltersPanel-DQ5K7DWL.js";import{L as Ge,D as ir,B as cr}from"./index-BgUR2tco.js";import{g as $t,a as dr,b as At,D as ur,T as at,c as dt}from"./priority-config-DfwaRs1D.js";const kr={key:0,class:"modal-overlay"},vr={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},hr={class:"modal-body"},yr={class:"mode-description"},mr={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:s=>["weeks","months"].includes(s)}},emits:["close","start-loading","select-mode"],setup(s,{emit:t}){const e=s,a=t,o=J(e.currentMode);function l(m){if(!["weeks","months"].includes(m)){console.warn("[PeriodModeInfoModal] Invalid mode:",m);return}o.value=m,console.log("[DEBUG Modal] handleModeSelect: mode =",m),console.log("[DEBUG Modal] Emitting select-mode event"),a("select-mode",m),console.log("[DEBUG Modal] Emitting close event"),a("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),a("start-loading")},100)}function k(){console.log("[DEBUG Modal] handleClose called, selectedMode =",o.value),console.log("[DEBUG Modal] Emitting select-mode event with",o.value),a("select-mode",o.value),console.log("[DEBUG Modal] Emitting close event"),a("close")}function d(m){m.key==="Escape"&&e.isVisible&&k()}return Ie(()=>e.currentMode,m=>{["weeks","months"].includes(m)&&(o.value=m)}),ct(()=>{e.isVisible&&document.addEventListener("keydown",d)}),Ot(()=>{document.removeEventListener("keydown",d)}),Ie(()=>e.isVisible,m=>{m?(document.addEventListener("keydown",d),o.value=e.currentMode):document.removeEventListener("keydown",d)}),(m,p)=>(y(),De(qt,{to:"body"},[ue($e,{name:"modal-fade"},{default:ge(()=>[s.isVisible?(y(),f("div",kr,[r("div",vr,[r("div",{class:"modal-header"},[p[2]||(p[2]=r("h2",{id:"modal-title",class:"modal-title"},[r("span",{class:"modal-icon"},"‚ÑπÔ∏è"),we(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),r("button",{class:"modal-close-btn",onClick:k,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),r("div",hr,[p[5]||(p[5]=r("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),r("div",yr,[r("button",{class:pe(["mode-item mode-item--clickable",{"mode-item--selected":o.value==="weeks"}]),onClick:p[0]||(p[0]=D=>l("weeks")),type:"button"},[...p[3]||(p[3]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìÖ"),r("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),r("button",{class:pe(["mode-item mode-item--clickable",{"mode-item--selected":o.value==="months"}]),onClick:p[1]||(p[1]=D=>l("months")),type:"button"},[...p[4]||(p[4]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìä"),r("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):ne("",!0)]),_:1})]))}},pr=Oe(mr,[["__scopeId","data-v-4a42a9a6"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var St=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var s=window.screen;if(s)return(s.deviceXDPI||1)/(s.logicalXDPI||1)}return 1}(),qe={toTextLines:function(s){var t=[],e;for(s=[].concat(s);s.length;)e=s.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?s.push.apply(s,e):ze(s)||t.unshift(""+e);return t},textSize:function(s,t,e){var a=[].concat(t),o=a.length,l=s.font,k=0,d;for(s.font=e.string,d=0;d<o;++d)k=Math.max(s.measureText(a[d]).width,k);return s.font=l,{height:o*e.lineHeight,width:k}},bound:function(s,t,e){return Math.max(s,Math.min(t,e))},arrayDiff:function(s,t){var e=s.slice(),a=[],o,l,k,d;for(o=0,k=t.length;o<k;++o)d=t[o],l=e.indexOf(d),l===-1?a.push([d,1]):e.splice(l,1);for(o=0,k=e.length;o<k;++o)a.push([e[o],-1]);return a},rasterize:function(s){return Math.round(s*St)/St}};function ot(s,t){var e=t.x,a=t.y;if(e===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var o=s.x-e,l=s.y-a,k=Math.sqrt(o*o+l*l);return{x:k?o/k:0,y:k?l/k:-1}}function gr(s,t,e,a,o){switch(o){case"center":e=a=0;break;case"bottom":e=0,a=1;break;case"right":e=1,a=0;break;case"left":e=-1,a=0;break;case"top":e=0,a=-1;break;case"start":e=-e,a=-a;break;case"end":break;default:o*=Math.PI/180,e=Math.cos(o),a=Math.sin(o);break}return{x:s,y:t,vx:e,vy:a}}var fr=0,Pt=1,xt=2,Lt=4,Ft=8;function Je(s,t,e){var a=fr;return s<e.left?a|=Pt:s>e.right&&(a|=xt),t<e.top?a|=Ft:t>e.bottom&&(a|=Lt),a}function br(s,t){for(var e=s.x0,a=s.y0,o=s.x1,l=s.y1,k=Je(e,a,t),d=Je(o,l,t),m,p,D;!(!(k|d)||k&d);)m=k||d,m&Ft?(p=e+(o-e)*(t.top-a)/(l-a),D=t.top):m&Lt?(p=e+(o-e)*(t.bottom-a)/(l-a),D=t.bottom):m&xt?(D=a+(l-a)*(t.right-e)/(o-e),p=t.right):m&Pt&&(D=a+(l-a)*(t.left-e)/(o-e),p=t.left),m===k?(e=p,a=D,k=Je(e,a,t)):(o=p,l=D,d=Je(o,l,t));return{x0:e,x1:o,y0:a,y1:l}}function Qe(s,t){var e=t.anchor,a=s,o,l;return t.clamp&&(a=br(a,t.area)),e==="start"?(o=a.x0,l=a.y0):e==="end"?(o=a.x1,l=a.y1):(o=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),gr(o,l,s.vx,s.vy,t.align)}var et={arc:function(s,t){var e=(s.startAngle+s.endAngle)/2,a=Math.cos(e),o=Math.sin(e),l=s.innerRadius,k=s.outerRadius;return Qe({x0:s.x+a*l,y0:s.y+o*l,x1:s.x+a*k,y1:s.y+o*k,vx:a,vy:o},t)},point:function(s,t){var e=ot(s,t.origin),a=e.x*s.options.radius,o=e.y*s.options.radius;return Qe({x0:s.x-a,y0:s.y-o,x1:s.x+a,y1:s.y+o,vx:e.x,vy:e.y},t)},bar:function(s,t){var e=ot(s,t.origin),a=s.x,o=s.y,l=0,k=0;return s.horizontal?(a=Math.min(s.x,s.base),l=Math.abs(s.base-s.x)):(o=Math.min(s.y,s.base),k=Math.abs(s.base-s.y)),Qe({x0:a,y0:o+k,x1:a+l,y1:o,vx:e.x,vy:e.y},t)},fallback:function(s,t){var e=ot(s,t.origin);return Qe({x0:s.x,y0:s.y,x1:s.x+(s.width||0),y1:s.y+(s.height||0),vx:e.x,vy:e.y},t)}},Be=qe.rasterize;function _r(s){var t=s.borderWidth||0,e=s.padding,a=s.size.height,o=s.size.width,l=-o/2,k=-a/2;return{frame:{x:l-e.left-t,y:k-e.top-t,w:o+e.width+t*2,h:a+e.height+t*2},text:{x:l,y:k,w:o,h:a}}}function wr(s,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var a=e.getBasePixel();return s.horizontal?{x:a,y:null}:{x:null,y:a}}function Tr(s){return s instanceof er?et.arc:s instanceof tr?et.point:s instanceof rr?et.bar:et.fallback}function Cr(s,t,e,a,o,l){var k=Math.PI/2;if(l){var d=Math.min(l,o/2,a/2),m=t+d,p=e+d,D=t+a-d,L=e+o-d;s.moveTo(t,p),m<D&&p<L?(s.arc(m,p,d,-Math.PI,-k),s.arc(D,p,d,-k,0),s.arc(D,L,d,0,k),s.arc(m,L,d,k,Math.PI)):m<D?(s.moveTo(m,e),s.arc(D,p,d,-k,k),s.arc(m,p,d,k,Math.PI+k)):p<L?(s.arc(m,p,d,-Math.PI,0),s.arc(m,L,d,0,Math.PI)):s.arc(m,p,d,-Math.PI,Math.PI),s.closePath(),s.moveTo(t,e)}else s.rect(t,e,a,o)}function Wr(s,t,e){var a=e.backgroundColor,o=e.borderColor,l=e.borderWidth;!a&&(!o||!l)||(s.beginPath(),Cr(s,Be(t.x)+l/2,Be(t.y)+l/2,Be(t.w)-l,Be(t.h)-l,e.borderRadius),s.closePath(),a&&(s.fillStyle=a,s.fill()),o&&l&&(s.strokeStyle=o,s.lineWidth=l,s.lineJoin="miter",s.stroke()))}function $r(s,t,e){var a=e.lineHeight,o=s.w,l=s.x,k=s.y+a/2;return t==="center"?l+=o/2:(t==="end"||t==="right")&&(l+=o),{h:a,w:o,x:l,y:k}}function Ar(s,t,e){var a=s.shadowBlur,o=e.stroked,l=Be(e.x),k=Be(e.y),d=Be(e.w);o&&s.strokeText(t,l,k,d),e.filled&&(a&&o&&(s.shadowBlur=0),s.fillText(t,l,k,d),a&&o&&(s.shadowBlur=a))}function Sr(s,t,e,a){var o=a.textAlign,l=a.color,k=!!l,d=a.font,m=t.length,p=a.textStrokeColor,D=a.textStrokeWidth,L=p&&D,ee;if(!(!m||!k&&!L))for(e=$r(e,o,d),s.font=d.string,s.textAlign=o,s.textBaseline="middle",s.shadowBlur=a.textShadowBlur,s.shadowColor=a.textShadowColor,k&&(s.fillStyle=l),L&&(s.lineJoin="round",s.lineWidth=D,s.strokeStyle=p),ee=0,m=t.length;ee<m;++ee)Ar(s,t[ee],{stroked:L,filled:k,w:e.w,x:e.x,y:e.y+e.h*ee})}var Gt=function(s,t,e,a){var o=this;o._config=s,o._index=a,o._model=null,o._rects=null,o._ctx=t,o._el=e};Xe(Gt.prototype,{_modelize:function(s,t,e,a){var o=this,l=o._index,k=Xt(_e([e.font,{}],a,l)),d=_e([e.color,Jt.color],a,l);return{align:_e([e.align,"center"],a,l),anchor:_e([e.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:_e([e.backgroundColor,null],a,l),borderColor:_e([e.borderColor,null],a,l),borderRadius:_e([e.borderRadius,0],a,l),borderWidth:_e([e.borderWidth,0],a,l),clamp:_e([e.clamp,!1],a,l),clip:_e([e.clip,!1],a,l),color:d,display:s,font:k,lines:t,offset:_e([e.offset,4],a,l),opacity:_e([e.opacity,1],a,l),origin:wr(o._el,a),padding:Qt(_e([e.padding,4],a,l)),positioner:Tr(o._el),rotation:_e([e.rotation,0],a,l)*(Math.PI/180),size:qe.textSize(o._ctx,t,k),textAlign:_e([e.textAlign,"start"],a,l),textShadowBlur:_e([e.textShadowBlur,0],a,l),textShadowColor:_e([e.textShadowColor,d],a,l),textStrokeColor:_e([e.textStrokeColor,d],a,l),textStrokeWidth:_e([e.textStrokeWidth,0],a,l)}},update:function(s){var t=this,e=null,a=null,o=t._index,l=t._config,k,d,m,p=_e([l.display,!0],s,o);p&&(k=s.dataset.data[o],d=Zt(Bt(l.formatter,[k,s]),k),m=ze(d)?[]:qe.toTextLines(d),m.length&&(e=t._modelize(p,m,l,s),a=_r(e))),t._model=e,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(s,t){var e=this,a=s.ctx,o=e._model,l=e._rects,k;this.visible()&&(a.save(),o.clip&&(k=o.area,a.beginPath(),a.rect(k.left,k.top,k.right-k.left,k.bottom-k.top),a.clip()),a.globalAlpha=qe.bound(0,o.opacity,1),a.translate(Be(t.x),Be(t.y)),a.rotate(o.rotation),Wr(a,l.frame,o),Sr(a,o.lines,l.text,o),a.restore())}});var Dr=Number.MIN_SAFE_INTEGER||-9007199254740991,Nr=Number.MAX_SAFE_INTEGER||9007199254740991;function je(s,t,e){var a=Math.cos(e),o=Math.sin(e),l=t.x,k=t.y;return{x:l+a*(s.x-l)-o*(s.y-k),y:k+o*(s.x-l)+a*(s.y-k)}}function Dt(s,t){var e=Nr,a=Dr,o=t.origin,l,k,d,m,p;for(l=0;l<s.length;++l)k=s[l],d=k.x-o.x,m=k.y-o.y,p=t.vx*d+t.vy*m,e=Math.min(e,p),a=Math.max(a,p);return{min:e,max:a}}function tt(s,t){var e=t.x-s.x,a=t.y-s.y,o=Math.sqrt(e*e+a*a);return{vx:(t.x-s.x)/o,vy:(t.y-s.y)/o,origin:s,ln:o}}var Ht=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};Xe(Ht.prototype,{center:function(){var s=this._rect;return{x:s.x+s.w/2,y:s.y+s.h/2}},update:function(s,t,e){this._rotation=e,this._rect={x:t.x+s.x,y:t.y+s.y,w:t.w,h:t.h}},contains:function(s){var t=this,e=1,a=t._rect;return s=je(s,t.center(),-t._rotation),!(s.x<a.x-e||s.y<a.y-e||s.x>a.x+a.w+e*2||s.y>a.y+a.h+e*2)},intersects:function(s){var t=this._points(),e=s._points(),a=[tt(t[0],t[1]),tt(t[0],t[3])],o,l,k;for(this._rotation!==s._rotation&&a.push(tt(e[0],e[1]),tt(e[0],e[3])),o=0;o<a.length;++o)if(l=Dt(t,a[o]),k=Dt(e,a[o]),l.max<k.min||k.max<l.min)return!1;return!0},_points:function(){var s=this,t=s._rect,e=s._rotation,a=s.center();return[je({x:t.x,y:t.y},a,e),je({x:t.x+t.w,y:t.y},a,e),je({x:t.x+t.w,y:t.y+t.h},a,e),je({x:t.x,y:t.y+t.h},a,e)]}});function Vt(s,t,e){var a=t.positioner(s,t),o=a.vx,l=a.vy;if(!o&&!l)return{x:a.x,y:a.y};var k=e.w,d=e.h,m=t.rotation,p=Math.abs(k/2*Math.cos(m))+Math.abs(d/2*Math.sin(m)),D=Math.abs(k/2*Math.sin(m))+Math.abs(d/2*Math.cos(m)),L=1/Math.max(Math.abs(o),Math.abs(l));return p*=o*L,D*=l*L,p+=t.offset*o,D+=t.offset*l,{x:a.x+p,y:a.y+D}}function Er(s,t){var e,a,o,l;for(e=s.length-1;e>=0;--e)for(o=s[e].$layout,a=e-1;a>=0&&o._visible;--a)l=s[a].$layout,l._visible&&o._box.intersects(l._box)&&t(o,l);return s}function Or(s){var t,e,a,o,l,k,d;for(t=0,e=s.length;t<e;++t)a=s[t],o=a.$layout,o._visible&&(d=new Proxy(a._el,{get:(m,p)=>m.getProps([p],!0)[p]}),l=a.geometry(),k=Vt(d,a.model(),l),o._box.update(k,l,a.rotation()));return Er(s,function(m,p){var D=m._hidable,L=p._hidable;D&&L||L?p._visible=!1:D&&(m._visible=!1)})}var Ze={prepare:function(s){var t=[],e,a,o,l,k;for(e=0,o=s.length;e<o;++e)for(a=0,l=s[e].length;a<l;++a)k=s[e][a],t.push(k),k.$layout={_box:new Ht,_hidable:!1,_visible:!0,_set:e,_idx:k._index};return t.sort(function(d,m){var p=d.$layout,D=m.$layout;return p._idx===D._idx?D._set-p._set:D._idx-p._idx}),this.update(t),t},update:function(s){var t=!1,e,a,o,l,k;for(e=0,a=s.length;e<a;++e)o=s[e],l=o.model(),k=o.$layout,k._hidable=l&&l.display==="auto",k._visible=o.visible(),t|=k._hidable;t&&Or(s)},lookup:function(s,t){var e,a;for(e=s.length-1;e>=0;--e)if(a=s[e].$layout,a&&a._visible&&a._box.contains(t))return s[e];return null},draw:function(s,t){var e,a,o,l,k,d;for(e=0,a=t.length;e<a;++e)o=t[e],l=o.$layout,l._visible&&(k=o.geometry(),d=Vt(o._el,o.model(),k),l._box.update(d,k,o.rotation()),o.draw(s,d))}},Br=function(s){if(ze(s))return null;var t=s,e,a,o;if(ar(s))if(!ze(s.label))t=s.label;else if(!ze(s.r))t=s.r;else for(t="",e=Object.keys(s),o=0,a=e.length;o<a;++o)t+=(o!==0?", ":"")+e[o]+": "+s[e[o]];return""+t},Ir={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Br,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},We="$datalabels",Kt="$default";function Mr(s,t){var e=s.datalabels,a={},o=[],l,k;return e===!1?null:(e===!0&&(e={}),t=Xe({},[t,e]),l=t.labels||{},k=Object.keys(l),delete t.labels,k.length?k.forEach(function(d){l[d]&&o.push(Xe({},[t,l[d],{_key:d}]))}):o.push(t),a=o.reduce(function(d,m){return sr(m.listeners||{},function(p,D){d[D]=d[D]||{},d[D][m._key||Kt]=p}),delete m.listeners,d},{}),{labels:o,listeners:a})}function lt(s,t,e,a){if(t){var o=e.$context,l=e.$groups,k;t[l._set]&&(k=t[l._set][l._key],k&&Bt(k,[o,a])===!0&&(s[We]._dirty=!0,e.update(o)))}}function Ur(s,t,e,a,o){var l,k;!e&&!a||(e?a?e!==a&&(k=l=!0):k=!0:l=!0,k&&lt(s,t.leave,e,o),l&&lt(s,t.enter,a,o))}function Rr(s,t){var e=s[We],a=e._listeners,o,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Ze.lookup(e._labels,t);else if(t.type!=="mouseout")return;o=e._hovered,e._hovered=l,Ur(s,a,o,l,t)}}function Pr(s,t){var e=s[We],a=e._listeners.click,o=a&&Ze.lookup(e._labels,t);o&&lt(s,a,o,t)}var Yt={id:"datalabels",defaults:Ir,beforeInit:function(s){s[We]={_actives:[]}},beforeUpdate:function(s){var t=s[We];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(s,t,e){var a=t.index,o=s[We],l=o._datasets[a]=[],k=s.isDatasetVisible(a),d=s.data.datasets[a],m=Mr(d,e),p=t.meta.data||[],D=s.ctx,L,ee,te,I,M,T,E,S;for(D.save(),L=0,te=p.length;L<te;++L)if(E=p[L],E[We]=[],k&&E&&s.getDataVisibility(L)&&!E.skip)for(ee=0,I=m.labels.length;ee<I;++ee)M=m.labels[ee],T=M._key,S=new Gt(M,D,E,L),S.$groups={_set:a,_key:T||Kt},S.$context={active:!1,chart:s,dataIndex:L,dataset:d,datasetIndex:a},S.update(S.$context),E[We].push(S),l.push(S);D.restore(),Xe(o._listeners,m.listeners,{merger:function(O,G,g){G[O]=G[O]||{},G[O][t.index]=g[O],o._listened=!0}})},afterUpdate:function(s){s[We]._labels=Ze.prepare(s[We]._datasets)},afterDatasetsDraw:function(s){Ze.draw(s,s[We]._labels)},beforeEvent:function(s,t){if(s[We]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":Rr(s,e);break;case"click":Pr(s,e);break}}},afterEvent:function(s){var t=s[We],e=t._actives,a=t._actives=s.getActiveElements(),o=qe.arrayDiff(e,a),l,k,d,m,p,D,L;for(l=0,k=o.length;l<k;++l)if(p=o[l],p[1])for(L=p[0].element[We]||[],d=0,m=L.length;d<m;++d)D=L[d],D.$context.active=p[1]===1,D.update(D.$context);(t._dirty||o.length)&&(Ze.update(t._labels),s.render()),delete t._dirty}};const xr={class:"ac-chart"},Lr={class:"ac-chart__header"},Fr={class:"ac-chart__subtitle"},Gr={class:"ac-chart__controls"},Hr={class:"chart-type-selector"},Vr=["onClick"],Kr={class:"chart-type-icon"},Yr={class:"chart-type-label"},jr={class:"ac-chart__summary"},zr={class:"summary-week-block summary-week-block--current"},qr={class:"summary-week-block__title"},Zr={class:"summary-week-block__title-week"},Xr={key:0,class:"summary-week-block__title-dates"},Jr={class:"summary-week-block__cards"},Qr={class:"summary-card__value-wrapper"},ea={class:"summary-card__value"},ta=["title"],ra={class:"percentage-indicator__arrow"},aa={class:"percentage-indicator__value"},sa={class:"percentage-indicator__label"},oa={class:"summary-card__value-wrapper"},na={class:"summary-card__value-main"},la=["title"],ia={class:"percentage-indicator__arrow"},ca={class:"percentage-indicator__value"},da={class:"percentage-indicator__label"},ua={class:"summary-card__breakdown"},ka={class:"breakdown-item breakdown-item--this-week"},va={class:"breakdown-item__value"},ha={class:"breakdown-item breakdown-item--other-week"},ya={class:"breakdown-item__value"},ma={class:"summary-card__value-wrapper"},pa={class:"summary-card__value-main"},ga=["title"],fa={class:"percentage-indicator__arrow"},ba={class:"percentage-indicator__value"},_a={class:"percentage-indicator__label"},wa={class:"summary-card__breakdown"},Ta={class:"breakdown-item breakdown-item--this-week"},Ca={class:"breakdown-item__value"},Wa={class:"breakdown-item breakdown-item--previous-week"},$a={class:"breakdown-item__value"},Aa={class:"breakdown-item breakdown-item--older"},Sa={class:"breakdown-item__value"},Da={class:"summary-card summary-card--stages"},Na={class:"summary-card__tags"},Ea={key:0,class:"stage-tag stage-tag--empty"},Oa={key:0,class:"summary-week-divider"},Ba={key:1,class:"summary-week-block summary-week-block--previous"},Ia={class:"summary-week-block__title"},Ma={class:"summary-week-block__title-week"},Ua={key:0,class:"summary-week-block__title-dates"},Ra={class:"summary-week-block__cards"},Pa={class:"summary-card__value-wrapper"},xa={class:"summary-card__values-comparison"},La={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Fa={class:"summary-card__value"},Ga={class:"value-label"},Ha={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Va={class:"summary-card__value summary-card__value--current-week"},Ka={class:"value-label"},Ya=["title"],ja={class:"percentage-indicator__arrow"},za={class:"percentage-indicator__value"},qa={class:"percentage-indicator__label"},Za={class:"summary-card__value-wrapper"},Xa={class:"summary-card__values-comparison"},Ja={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Qa={class:"summary-card__value-main"},es={class:"value-label"},ts={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},rs={class:"summary-card__value-main summary-card__value-main--current-week"},as={class:"value-label"},ss=["title"],os={class:"percentage-indicator__arrow"},ns={class:"percentage-indicator__value"},ls={class:"percentage-indicator__label"},is={class:"summary-card__breakdown"},cs={class:"breakdown-item breakdown-item--this-week"},ds={class:"breakdown-item__value"},us={class:"breakdown-item breakdown-item--other-week"},ks={class:"breakdown-item__value"},vs={class:"summary-card__value-wrapper"},hs={class:"summary-card__values-comparison"},ys={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ms={class:"summary-card__value-main"},ps={class:"value-label"},gs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},fs={class:"summary-card__value-main summary-card__value-main--current-week"},bs={class:"value-label"},_s=["title"],ws={class:"percentage-indicator__arrow"},Ts={class:"percentage-indicator__value"},Cs={class:"percentage-indicator__label"},Ws={class:"summary-card__breakdown"},$s={class:"breakdown-item breakdown-item--this-week"},As={class:"breakdown-item__value"},Ss={class:"breakdown-item breakdown-item--previous-week"},Ds={class:"breakdown-item__value"},Ns={class:"breakdown-item breakdown-item--older"},Es={class:"breakdown-item__value"},Os={class:"summary-card summary-card--stages summary-card--previous"},Bs={class:"summary-card__tags"},Is={key:0,class:"stage-tag stage-tag--empty"},Ms={class:"ac-chart__body"},Us={key:0,class:"split-charts-container"},Rs={class:"chart-wrapper chart-wrapper--left"},Ps={class:"chart-canvas-wrapper"},xs={class:"chart-wrapper chart-wrapper--right"},Ls={class:"chart-canvas-wrapper"},Fs={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0],carryoverCreatedOtherWeek:[0]},stagesByWeek:[],stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(s,{emit:t}){nt.register(Yt);const e=s,a=t,o=z(()=>{var i;const n=((i=e.meta)==null?void 0:i.weeks)||[];return n.length>=2?n[n.length-2]:null}),l=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],k=J("line"),d={color:"#111827",font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:n=>{var i;return((i=n==null?void 0:n.dataset)==null?void 0:i.borderColor)||"#111827"},borderWidth:1,borderRadius:4,padding:4,offset:8,formatter:n=>n==null||isNaN(n)?"":E(n),display:n=>{var N,H,w,Y;if(((H=(N=n==null?void 0:n.chart)==null?void 0:N.config)==null?void 0:H.type)!=="line")return!1;const $=(Y=(w=n==null?void 0:n.dataset)==null?void 0:w.data)==null?void 0:Y[n.dataIndex];return $!=null&&!isNaN($)&&isFinite($)}};z(()=>{var n;return((n=e.meta)==null?void 0:n.weekNumber)??"‚Äî"});const m=()=>{var i,$;const n=((i=e.meta)==null?void 0:i.weeks)||[];return n.length>0?n.map(N=>`–ù–µ–¥–µ–ª—è ${N.weekNumber}`):[($=e.meta)!=null&&$.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function p(n,i,$,N=.3,H=0){if(!i)return((_,v)=>{const h=parseInt(_.slice(1,3),16),c=parseInt(_.slice(3,5),16),P=parseInt(_.slice(5,7),16);return`rgba(${h}, ${c}, ${P}, ${v})`})($,N);const w=(oe,_)=>{const v=parseInt(oe.slice(1,3),16),h=parseInt(oe.slice(3,5),16),c=parseInt(oe.slice(5,7),16);return`rgba(${v}, ${h}, ${c}, ${_})`},Y=n.createLinearGradient(0,i.bottom,0,i.top);return Y.addColorStop(0,w($,N)),Y.addColorStop(1,w($,H)),Y}const D=z(()=>{var w,Y,oe,_;const n=m(),i=Array.isArray((w=e.data.series)==null?void 0:w.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],$=Array.isArray((Y=e.data.series)==null?void 0:Y.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],N=Array.isArray((oe=e.data.series)==null?void 0:oe.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],H=Array.isArray((_=e.data.series)==null?void 0:_.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:n,datasets:[{label:"–ù–æ–≤—ã–µ",data:i,backgroundColor:v=>{const h=v.chart,{ctx:c,chartArea:P}=h;return p(c,P,W.primary)},borderColor:W.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.primary,pointBackgroundColor:W.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:W.primary,borderColor:W.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:$,backgroundColor:v=>{const h=v.chart,{ctx:c,chartArea:P}=h;return p(c,P,W.success)},borderColor:W.success,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.success,pointBackgroundColor:W.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:W.success,borderColor:W.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:N,backgroundColor:W.successLight,borderColor:W.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:W.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.successLight,pointBackgroundColor:W.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:W.successLight,borderColor:W.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:H,backgroundColor:W.warning,borderColor:W.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:W.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.warning,pointBackgroundColor:W.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:W.warning,borderColor:W.warning}}]}}),L=z(()=>{var w,Y,oe,_,v;const n=m(),i=Array.isArray((w=e.data.series)==null?void 0:w.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],$=Array.isArray((Y=e.data.series)==null?void 0:Y.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],N=Array.isArray((oe=e.data.series)==null?void 0:oe.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],H=Array.isArray((_=e.data.series)==null?void 0:_.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((v=e.data.series)==null?void 0:v.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:n,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:i,backgroundColor:h=>{const c=h.chart,{ctx:P,chartArea:X}=c;return p(P,X,W.carryover)},borderColor:W.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryover,pointBackgroundColor:W.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:W.carryover,borderColor:W.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:$,backgroundColor:W.carryoverLight,borderColor:W.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:W.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryoverLight,pointBackgroundColor:W.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.carryoverLight,borderColor:W.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:N,backgroundColor:W.warning,borderColor:W.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:W.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.warning,pointBackgroundColor:W.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.warning,borderColor:W.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:H,backgroundColor:W.carryoverDark,borderColor:W.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:W.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryoverDark,pointBackgroundColor:W.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.carryoverDark,borderColor:W.carryoverDark}}]}}),ee=z(()=>{var h,c,P,X,le,ae,se,B,j,ce,ke;const n=((h=e.meta)==null?void 0:h.weeks)||[],i=n.length>0?n.map(K=>`–ù–µ–¥–µ–ª—è ${K.weekNumber}`):[(c=e.meta)!=null&&c.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],$=Array.isArray((P=e.data.series)==null?void 0:P.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],N=Array.isArray((X=e.data.series)==null?void 0:X.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],H=Array.isArray((le=e.data.series)==null?void 0:le.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],w=Array.isArray((ae=e.data.series)==null?void 0:ae.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],Y=Array.isArray((se=e.data.series)==null?void 0:se.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],oe=Array.isArray((B=e.data.series)==null?void 0:B.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],_=Array.isArray((j=e.data.series)==null?void 0:j.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],v=Array.isArray((ce=e.data.series)==null?void 0:ce.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((ke=e.data.series)==null?void 0:ke.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:i,datasets:[{label:"–ù–æ–≤—ã–µ",data:$,backgroundColor:W.primary,borderColor:W.primary,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.primary,pointBackgroundColor:W.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:W.primary,borderColor:W.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:N,backgroundColor:W.success,borderColor:W.success,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.success,pointBackgroundColor:W.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:W.success,borderColor:W.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:H,backgroundColor:W.successLight,borderColor:W.successLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:W.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.successLight,pointBackgroundColor:W.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:W.successLight,borderColor:W.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:w,backgroundColor:W.warning,borderColor:W.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:W.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.warning,pointBackgroundColor:W.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:W.warning,borderColor:W.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:Y,backgroundColor:W.carryover,borderColor:W.carryover,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:W.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryover,pointBackgroundColor:W.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:W.carryover,borderColor:W.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:oe,backgroundColor:W.carryoverLight,borderColor:W.carryoverLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:W.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryoverLight,pointBackgroundColor:W.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.carryoverLight,borderColor:W.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:_,backgroundColor:W.warning,borderColor:W.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:W.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.warning,pointBackgroundColor:W.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.warning,borderColor:W.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:v,backgroundColor:W.carryoverDark,borderColor:W.carryoverDark,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:W.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:W.carryoverDark,pointBackgroundColor:W.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:W.carryoverDark,borderColor:W.carryoverDark}}]}}),te=z(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[W.primary,W.success,W.carryover],borderWidth:1}]})),I=z(()=>{switch(k.value){case"line":return Ge;case"bar":return cr;case"doughnut":return ir;default:return Ge}}),M=z(()=>k.value==="doughnut"?te.value:ee.value),T=n=>{if(!n)return"‚Äî";try{return new Date(n).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return n}};function E(n){return n==null||isNaN(n)?"0":n>=1e3?n.toLocaleString("ru-RU"):n.toString()}function S(n){const i=n%10,$=n%100;return $>=11&&$<=14?"—Ç–∏–∫–µ—Ç–æ–≤":i===1?"—Ç–∏–∫–µ—Ç":i>=2&&i<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const O=z(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{datalabels:{...d,anchor:"end",align:"top"},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:n=>{var Y,oe,_,v,h,c;if(!n||n.length===0)return"";const i=(Y=n[0])==null?void 0:Y.dataIndex,$=((oe=e.meta)==null?void 0:oe.weeks)||[];if($.length>0&&i!==void 0&&$[i]){const P=$[i];return`–ù–µ–¥–µ–ª—è ${P.weekNumber} (${T(P.weekStartUtc)} ‚Äî ${T(P.weekEndUtc)})`}const N=(_=e.meta)==null?void 0:_.weekNumber,H=(v=e.meta)==null?void 0:v.weekStartUtc,w=(h=e.meta)==null?void 0:h.weekEndUtc;return N&&H&&w?`–ù–µ–¥–µ–ª—è ${N} (${T(H)} ‚Äî ${T(w)})`:((c=n[0])==null?void 0:c.label)||""},label:n=>{const i=n.parsed.y,$=n.dataset.label||"";if(i==null||isNaN(i))return`${$}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const N=E(i),H=S(i);return`${$}: ${N} ${H}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:n=>nt.defaults.plugins.legend.labels.generateLabels(n).map(($,N)=>{const H=n.data.datasets[N],w=n.getDatasetMeta(N),Y=H.borderDash&&Array.isArray(H.borderDash)&&H.borderDash.length>0||H.borderWidth===2||H.fill===!1;return w.hidden?($.fontColor="#9ca3af",$.textDecoration="line-through",$.opacity=.5):Y?$.fontColor="#6b7280":$.fontColor="#111827",$})},onClick:(n,i)=>{const $=i.datasetIndex;if($==null){console.warn("[Legend] Invalid datasetIndex:",$);return}const N=n.chart;if(!N){console.warn("[Legend] Chart not found");return}const H=N.getDatasetMeta($);if(!H){console.warn("[Legend] Dataset meta not found for index:",$);return}H.hidden=!H.hidden,N.update("active")},onHover:(n,i)=>{n.native&&n.native.target&&(n.native.target.style.cursor="pointer")},onLeave:(n,i)=>{n.native&&n.native.target&&(n.native.target.style.cursor="default")}}},scales:k.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:n=>n==null||isNaN(n)?"0":E(n)},title:{display:!1},grid:{color:n=>{if(!n||!n.tick||n.tick.value===void 0)return"#e5e7eb";const i=n.tick.value;return isNaN(i)||!isFinite(i)?"#e5e7eb":i===0||i%5===0?"#d1d5db":"#e5e7eb"},lineWidth:n=>{if(!n||!n.tick||n.tick.value===void 0)return 1;const i=n.tick.value;return isNaN(i)||!isFinite(i)?1:i===0||i%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),G=z(()=>{var n,i,$,N,H,w,Y,oe;if((n=e.data)!=null&&n.series){const _=e.data.series,v=Math.max((Array.isArray(_.new)?_.new.length:0)-1,(Array.isArray(_.closed)?_.closed.length:0)-1,(Array.isArray(_.closedCreatedThisWeek)?_.closedCreatedThisWeek.length:0)-1,(Array.isArray(_.closedCreatedOtherWeek)?_.closedCreatedOtherWeek.length:0)-1,(Array.isArray(_.carryover)?_.carryover.length:0)-1,(Array.isArray(_.carryoverCreatedThisWeek)?_.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(_.carryoverCreatedPreviousWeek)?_.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(_.carryoverCreatedOlder)?_.carryoverCreatedOlder.length:0)-1,(Array.isArray(_.carryoverCreatedOtherWeek)?_.carryoverCreatedOtherWeek.length:0)-1,-1);if(v>=0){const h={newTickets:Array.isArray(_.new)&&_.new[v]!==void 0?_.new[v]:0,closedTickets:Array.isArray(_.closed)&&_.closed[v]!==void 0?_.closed[v]:0,closedTicketsCreatedThisWeek:Array.isArray(_.closedCreatedThisWeek)&&_.closedCreatedThisWeek[v]!==void 0?_.closedCreatedThisWeek[v]:0,closedTicketsCreatedOtherWeek:Array.isArray(_.closedCreatedOtherWeek)&&_.closedCreatedOtherWeek[v]!==void 0?_.closedCreatedOtherWeek[v]:0,carryoverTickets:Array.isArray(_.carryover)&&_.carryover[v]!==void 0?_.carryover[v]:0,carryoverTicketsCreatedThisWeek:Array.isArray(_.carryoverCreatedThisWeek)&&_.carryoverCreatedThisWeek[v]!==void 0?_.carryoverCreatedThisWeek[v]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(_.carryoverCreatedPreviousWeek)&&_.carryoverCreatedPreviousWeek[v]!==void 0?_.carryoverCreatedPreviousWeek[v]:0,carryoverTicketsCreatedOlder:Array.isArray(_.carryoverCreatedOlder)&&_.carryoverCreatedOlder[v]!==void 0?_.carryoverCreatedOlder[v]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(_.carryoverCreatedOtherWeek)&&_.carryoverCreatedOtherWeek[v]!==void 0?_.carryoverCreatedOtherWeek[v]:0};if(h.carryoverTickets>0&&console.log("[DEBUG currentWeekData]",{total:h.carryoverTickets,thisWeek:h.carryoverTicketsCreatedThisWeek,previousWeek:h.carryoverTicketsCreatedPreviousWeek,older:h.carryoverTicketsCreatedOlder,otherWeek:h.carryoverTicketsCreatedOtherWeek,sum:h.carryoverTicketsCreatedThisWeek+h.carryoverTicketsCreatedPreviousWeek+h.carryoverTicketsCreatedOlder,lastIndex:v,series:{carryoverCreatedPreviousWeek:_.carryoverCreatedPreviousWeek,carryoverCreatedOlder:_.carryoverCreatedOlder,carryoverCreatedPreviousWeekLength:(i=_.carryoverCreatedPreviousWeek)==null?void 0:i.length,carryoverCreatedOlderLength:($=_.carryoverCreatedOlder)==null?void 0:$.length,carryoverCreatedPreviousWeekLast:(N=_.carryoverCreatedPreviousWeek)==null?void 0:N[v],carryoverCreatedOlderLast:(H=_.carryoverCreatedOlder)==null?void 0:H[v]},currentWeek:e.data.currentWeek,data:{carryoverTicketsCreatedPreviousWeek:e.data.carryoverTicketsCreatedPreviousWeek,carryoverTicketsCreatedOlder:e.data.carryoverTicketsCreatedOlder}}),h.newTickets>0||h.closedTickets>0||h.carryoverTickets>0)return h}}if((w=e.data)!=null&&w.currentWeek&&typeof e.data.currentWeek=="object"){const _=e.data.currentWeek;if((_.newTickets??0)>0||(_.closedTickets??0)>0||(_.carryoverTickets??0)>0)return _}if((Y=e.data)!=null&&Y.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const _=e.data.weeksData[e.data.weeksData.length-1];if((_.newTickets??0)>0||(_.closedTickets??0)>0||(_.carryoverTickets??0)>0)return _}if((oe=e.data)!=null&&oe.series){const _=e.data.series,v=Math.max((Array.isArray(_.new)?_.new.length:0)-1,(Array.isArray(_.closed)?_.closed.length:0)-1,(Array.isArray(_.carryover)?_.carryover.length:0)-1,-1);if(v>=0)return{newTickets:Array.isArray(_.new)&&_.new[v]!==void 0?_.new[v]:0,closedTickets:Array.isArray(_.closed)&&_.closed[v]!==void 0?_.closed[v]:0,closedTicketsCreatedThisWeek:Array.isArray(_.closedCreatedThisWeek)&&_.closedCreatedThisWeek[v]!==void 0?_.closedCreatedThisWeek[v]:0,closedTicketsCreatedOtherWeek:Array.isArray(_.closedCreatedOtherWeek)&&_.closedCreatedOtherWeek[v]!==void 0?_.closedCreatedOtherWeek[v]:0,carryoverTickets:Array.isArray(_.carryover)&&_.carryover[v]!==void 0?_.carryover[v]:0,carryoverTicketsCreatedThisWeek:Array.isArray(_.carryoverCreatedThisWeek)&&_.carryoverCreatedThisWeek[v]!==void 0?_.carryoverCreatedThisWeek[v]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(_.carryoverCreatedPreviousWeek)&&_.carryoverCreatedPreviousWeek[v]!==void 0?_.carryoverCreatedPreviousWeek[v]:0,carryoverTicketsCreatedOlder:Array.isArray(_.carryoverCreatedOlder)&&_.carryoverCreatedOlder[v]!==void 0?_.carryoverCreatedOlder[v]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(_.carryoverCreatedOtherWeek)&&_.carryoverCreatedOtherWeek[v]!==void 0?_.carryoverCreatedOtherWeek[v]:0}}return e.data||{}}),g=z(()=>{var i,$,N,H,w,Y,oe,_,v,h;const n=((i=e.meta)==null?void 0:i.weeks)||[];return n.length>0?n[n.length-1]:{weekNumber:((N=($=e.meta)==null?void 0:$.currentWeek)==null?void 0:N.weekNumber)??((H=e.meta)==null?void 0:H.weekNumber)??null,weekStartUtc:((Y=(w=e.meta)==null?void 0:w.currentWeek)==null?void 0:Y.weekStartUtc)??((oe=e.meta)==null?void 0:oe.weekStartUtc)??null,weekEndUtc:((v=(_=e.meta)==null?void 0:_.currentWeek)==null?void 0:v.weekEndUtc)??((h=e.meta)==null?void 0:h.weekEndUtc)??null}}),u=z(()=>{var n,i,$,N,H,w,Y,oe,_;if((n=e.data)!=null&&n.series){const v=e.data.series,h=Math.max((Array.isArray(v.new)?v.new.length:0)-1,(Array.isArray(v.closed)?v.closed.length:0)-1,(Array.isArray(v.closedCreatedThisWeek)?v.closedCreatedThisWeek.length:0)-1,(Array.isArray(v.closedCreatedOtherWeek)?v.closedCreatedOtherWeek.length:0)-1,(Array.isArray(v.carryover)?v.carryover.length:0)-1,(Array.isArray(v.carryoverCreatedThisWeek)?v.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(v.carryoverCreatedPreviousWeek)?v.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(v.carryoverCreatedOlder)?v.carryoverCreatedOlder.length:0)-1,(Array.isArray(v.carryoverCreatedOtherWeek)?v.carryoverCreatedOtherWeek.length:0)-1,-1);if(h>=1){const c=h-1,P=($=(i=e.meta)==null?void 0:i.weeks)==null?void 0:$[c],X={weekNumber:(P==null?void 0:P.weekNumber)??null,weekStartUtc:(P==null?void 0:P.weekStartUtc)??null,weekEndUtc:(P==null?void 0:P.weekEndUtc)??null,newTickets:Array.isArray(v.new)&&v.new[c]!==void 0?v.new[c]:0,closedTickets:Array.isArray(v.closed)&&v.closed[c]!==void 0?v.closed[c]:0,closedTicketsCreatedThisWeek:Array.isArray(v.closedCreatedThisWeek)&&v.closedCreatedThisWeek[c]!==void 0?v.closedCreatedThisWeek[c]:0,closedTicketsCreatedOtherWeek:Array.isArray(v.closedCreatedOtherWeek)&&v.closedCreatedOtherWeek[c]!==void 0?v.closedCreatedOtherWeek[c]:0,carryoverTickets:Array.isArray(v.carryover)&&v.carryover[c]!==void 0?v.carryover[c]:0,carryoverTicketsCreatedThisWeek:Array.isArray(v.carryoverCreatedThisWeek)&&v.carryoverCreatedThisWeek[c]!==void 0?v.carryoverCreatedThisWeek[c]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(v.carryoverCreatedPreviousWeek)&&v.carryoverCreatedPreviousWeek[c]!==void 0?v.carryoverCreatedPreviousWeek[c]:0,carryoverTicketsCreatedOlder:Array.isArray(v.carryoverCreatedOlder)&&v.carryoverCreatedOlder[c]!==void 0?v.carryoverCreatedOlder[c]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(v.carryoverCreatedOtherWeek)&&v.carryoverCreatedOtherWeek[c]!==void 0?v.carryoverCreatedOtherWeek[c]:0};if(X.newTickets>0||X.closedTickets>0||X.carryoverTickets>0)return X}}if((N=e.data)!=null&&N.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const v=e.data.weeksData.length-2,h=e.data.weeksData[v],c=(w=(H=e.meta)==null?void 0:H.weeks)==null?void 0:w[v];if((h.newTickets??0)>0||(h.closedTickets??0)>0||(h.carryoverTickets??0)>0)return{weekNumber:h.weekNumber??(c==null?void 0:c.weekNumber)??null,weekStartUtc:(c==null?void 0:c.weekStartUtc)??null,weekEndUtc:(c==null?void 0:c.weekEndUtc)??null,newTickets:h.newTickets??0,closedTickets:h.closedTickets??0,closedTicketsCreatedThisWeek:h.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:h.closedTicketsCreatedOtherWeek??0,carryoverTickets:h.carryoverTickets??0,carryoverTicketsCreatedThisWeek:h.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:h.carryoverTicketsCreatedOtherWeek??0}}if((Y=e.data)!=null&&Y.series){const v=e.data.series,h=Math.max((Array.isArray(v.new)?v.new.length:0)-1,(Array.isArray(v.closed)?v.closed.length:0)-1,(Array.isArray(v.carryover)?v.carryover.length:0)-1,-1);if(h>=1){const c=h-1,P=(_=(oe=e.meta)==null?void 0:oe.weeks)==null?void 0:_[c];return{weekNumber:(P==null?void 0:P.weekNumber)??null,weekStartUtc:(P==null?void 0:P.weekStartUtc)??null,weekEndUtc:(P==null?void 0:P.weekEndUtc)??null,newTickets:Array.isArray(v.new)&&v.new[c]!==void 0?v.new[c]:0,closedTickets:Array.isArray(v.closed)&&v.closed[c]!==void 0?v.closed[c]:0,closedTicketsCreatedThisWeek:Array.isArray(v.closedCreatedThisWeek)&&v.closedCreatedThisWeek[c]!==void 0?v.closedCreatedThisWeek[c]:0,closedTicketsCreatedOtherWeek:Array.isArray(v.closedCreatedOtherWeek)&&v.closedCreatedOtherWeek[c]!==void 0?v.closedCreatedOtherWeek[c]:0,carryoverTickets:Array.isArray(v.carryover)&&v.carryover[c]!==void 0?v.carryover[c]:0,carryoverTicketsCreatedThisWeek:Array.isArray(v.carryoverCreatedThisWeek)&&v.carryoverCreatedThisWeek[c]!==void 0?v.carryoverCreatedThisWeek[c]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(v.carryoverCreatedPreviousWeek)&&v.carryoverCreatedPreviousWeek[c]!==void 0?v.carryoverCreatedPreviousWeek[c]:0,carryoverTicketsCreatedOlder:Array.isArray(v.carryoverCreatedOlder)&&v.carryoverCreatedOlder[c]!==void 0?v.carryoverCreatedOlder[c]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(v.carryoverCreatedOtherWeek)&&v.carryoverCreatedOtherWeek[c]!==void 0?v.carryoverCreatedOtherWeek[c]:0}}}return null}),R=z(()=>{var i;const n=(i=e.data)==null?void 0:i.stagesByWeek;return Array.isArray(n)?n:null}),b=z(()=>{var i;const n=R.value;if(n&&n.length>0){const $=n.length-1,N=n[$];if(Array.isArray(N))return N}return((i=e.data)==null?void 0:i.stages)??[]}),U=z(()=>{const n=R.value;if(n&&n.length>=2){const i=n.length-2,$=n[i];if(Array.isArray($))return $}return[]}),V=z(()=>{var n;return(n=u.value)!=null&&n.weekNumber?`–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–µ–¥–µ–ª–∏ ${u.value.weekNumber}`:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"});function F(n,i){if(typeof n!="number"||isNaN(n)||i==null||typeof i!="number"||isNaN(i)||i===0)return null;if(n===i)return 0;const $=(n-i)/i*100;return!isFinite($)||isNaN($)?null:$}function x(n){return n==null||isNaN(n)?"":`${n>=0?"+":""}${n.toFixed(1)}%`}const q=z(()=>{var n,i,$;if((n=e.data)!=null&&n.series){const N=e.data.series,H=Math.max((Array.isArray(N.new)?N.new.length:0)-1,(Array.isArray(N.closed)?N.closed.length:0)-1,(Array.isArray(N.carryover)?N.carryover.length:0)-1,-1);if(H>=2){const w=H-2,Y=($=(i=e.meta)==null?void 0:i.weeks)==null?void 0:$[w];return{weekNumber:(Y==null?void 0:Y.weekNumber)??null,newTickets:Array.isArray(N.new)&&N.new[w]!==void 0?N.new[w]:0,closedTickets:Array.isArray(N.closed)&&N.closed[w]!==void 0?N.closed[w]:0,carryoverTickets:Array.isArray(N.carryover)&&N.carryover[w]!==void 0?N.carryover[w]:0}}}return null}),Z=z(()=>{const n=G.value,i=u.value;return!n||!i?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:F(n.newTickets??0,i.newTickets??0),closedTickets:F(n.closedTickets??0,i.closedTickets??0),carryoverTickets:F(n.carryoverTickets??0,i.carryoverTickets??0)}}),re=z(()=>{const n=u.value,i=q.value;return!n||!i?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:F(n.newTickets??0,i.newTickets??0),closedTickets:F(n.closedTickets??0,i.closedTickets??0),carryoverTickets:F(n.carryoverTickets??0,i.carryoverTickets??0)}});function ve(n,i){if(!n||!i)return"";try{const $=new Date(n),N=new Date(i),H=$.getUTCDate(),w=$.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),Y=$.getUTCFullYear(),oe=N.getUTCDate(),_=N.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),v=N.getUTCFullYear();return Y===v&&w===_?`${H} ‚Äî ${oe} ${w}`:Y===v?`${H} ${w} ‚Äî ${oe} ${_}`:`${H} ${w} ${Y} ‚Äî ${oe} ${_} ${v}`}catch($){return console.error("[formatWeekDates] Error:",$),""}}const fe=n=>{const i=G.value,$=(i==null?void 0:i.newTickets)??0,N=(i==null?void 0:i.closedTickets)??0,H=(i==null?void 0:i.carryoverTickets)??0,w=g.value;n==="new"&&$>0?a("open-stages",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):n==="closed"&&N>0?a("open-responsible",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):n==="carryover"&&H>0&&a("open-carryover",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc})},A=n=>{const i=u.value;if(!i)return;const $=(i==null?void 0:i.newTickets)??0,N=(i==null?void 0:i.closedTickets)??0,H=(i==null?void 0:i.carryoverTickets)??0,w=o.value;w&&(n==="new"&&$>0?a("open-stages",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):n==="closed"&&N>0?a("open-responsible",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):n==="carryover"&&H>0&&a("open-carryover",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}))};return(n,i)=>{var $,N,H,w,Y,oe,_,v,h,c,P,X,le,ae,se,B,j,ce,ke,K,he,Ae,Se,Te,Q,ie,de,Ce,Pe,xe,Ke,Ye,ut,kt,vt,ht,yt,mt,pt,gt,ft,bt,_t,wt,Tt,Ct;return y(),f("div",xr,[r("header",Lr,[r("div",null,[i[6]||(i[6]=r("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),r("p",Fr," –ù–µ–¥–µ–ª—è "+C(((N=($=s.meta)==null?void 0:$.currentWeek)==null?void 0:N.weekNumber)??((H=s.meta)==null?void 0:H.weekNumber)??"‚Äî")+" ¬∑ "+C((((Y=(w=s.meta)==null?void 0:w.currentWeek)==null?void 0:Y.weekStartUtc)??((oe=s.meta)==null?void 0:oe.weekStartUtc))||"‚Äî")+" ‚Äî "+C((((v=(_=s.meta)==null?void 0:_.currentWeek)==null?void 0:v.weekEndUtc)??((h=s.meta)==null?void 0:h.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),r("div",Gr,[r("div",Hr,[(y(),f(ye,null,me(l,be=>r("button",{key:be.value,class:pe(["chart-type-btn",{active:k.value===be.value}]),onClick:Gc=>k.value=be.value},[r("span",Kr,C(be.icon),1),r("span",Yr,C(be.label),1)],10,Vr)),64))])])]),r("section",jr,[r("div",zr,[r("h3",qr,[i[7]||(i[7]=r("span",{class:"summary-week-block__title-text"},"–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Zr," –ù–µ–¥–µ–ª—è "+C(g.value.weekNumber??"‚Äî"),1),g.value.weekStartUtc?(y(),f("span",Xr,C(ve(g.value.weekStartUtc,g.value.weekEndUtc)),1)):ne("",!0)]),r("div",Jr,[r("div",{class:"summary-card summary-card--new",onClick:i[0]||(i[0]=be=>fe("new"))},[i[8]||(i[8]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Qr,[r("div",ea,C(((c=G.value)==null?void 0:c.newTickets)??0),1),Z.value.newTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",Z.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((P=u.value)==null?void 0:P.weekNumber)??"‚Äî"}): ${x(Z.value.newTickets)}`},[r("span",ra,C(Z.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",aa,C(x(Z.value.newTickets)),1),r("span",sa,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((X=u.value)==null?void 0:X.weekNumber)??"‚Äî"),1)],10,ta)):ne("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown",onClick:i[1]||(i[1]=be=>fe("closed"))},[i[13]||(i[13]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",oa,[r("div",na,C(((le=G.value)==null?void 0:le.closedTickets)??0),1),Z.value.closedTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",Z.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ae=u.value)==null?void 0:ae.weekNumber)??"‚Äî"}): ${x(Z.value.closedTickets)}`},[r("span",ia,C(Z.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",ca,C(x(Z.value.closedTickets)),1),r("span",da,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((se=u.value)==null?void 0:se.weekNumber)??"‚Äî"),1)],10,la)):ne("",!0)]),r("div",ua,[r("div",ka,[i[9]||(i[9]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",va,C(((B=G.value)==null?void 0:B.closedTicketsCreatedThisWeek)??0),1),i[10]||(i[10]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",ha,[i[11]||(i[11]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ya,C(((j=G.value)==null?void 0:j.closedTicketsCreatedOtherWeek)??0),1),i[12]||(i[12]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown",onClick:i[2]||(i[2]=be=>fe("carryover"))},[i[20]||(i[20]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",ma,[r("div",pa,C(((ce=G.value)==null?void 0:ce.carryoverTickets)??0),1),Z.value.carryoverTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",Z.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ke=u.value)==null?void 0:ke.weekNumber)??"‚Äî"}): ${x(Z.value.carryoverTickets)}`},[r("span",fa,C(Z.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",ba,C(x(Z.value.carryoverTickets)),1),r("span",_a,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((K=u.value)==null?void 0:K.weekNumber)??"‚Äî"),1)],10,ga)):ne("",!0)]),r("div",wa,[r("div",Ta,[i[14]||(i[14]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",Ca,C(((he=G.value)==null?void 0:he.carryoverTicketsCreatedThisWeek)??0),1),i[15]||(i[15]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Wa,[i[16]||(i[16]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",$a,C(((Ae=G.value)==null?void 0:Ae.carryoverTicketsCreatedPreviousWeek)??0),1),i[17]||(i[17]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Aa,[i[18]||(i[18]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Sa,C(((Se=G.value)==null?void 0:Se.carryoverTicketsCreatedOlder)??0),1),i[19]||(i[19]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",Da,[i[21]||(i[21]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",Na,[(y(!0),f(ye,null,me(b.value,be=>(y(),f("span",{key:be.stageId,class:"stage-tag"},C(be.stageName||be.stageId)+" ‚Äî "+C(be.count),1))),128)),!b.value||b.value.length===0?(y(),f("span",Ea," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ne("",!0)])])])]),u.value?(y(),f("div",Oa,[...i[22]||(i[22]=[r("div",{class:"summary-week-divider__line"},null,-1),r("div",{class:"summary-week-divider__label"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)])])):ne("",!0),u.value?(y(),f("div",Ba,[r("h3",Ia,[i[23]||(i[23]=r("span",{class:"summary-week-block__title-text"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Ma," –ù–µ–¥–µ–ª—è "+C(u.value.weekNumber??"‚Äî"),1),u.value.weekStartUtc?(y(),f("span",Ua,C(ve(u.value.weekStartUtc,u.value.weekEndUtc)),1)):ne("",!0)]),r("div",Ra,[r("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:i[3]||(i[3]=be=>A("new"))},[i[24]||(i[24]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Pa,[r("div",xa,[r("div",La,[r("div",Fa,C(((Te=u.value)==null?void 0:Te.newTickets)??0),1),r("span",Ga,"–ù–µ–¥–µ–ª—è "+C(((Q=u.value)==null?void 0:Q.weekNumber)??"‚Äî"),1)]),r("div",Ha,[r("div",Va,C(((ie=q.value)==null?void 0:ie.newTickets)??0),1),r("span",Ka,"–ù–µ–¥–µ–ª—è "+C(((de=q.value)==null?void 0:de.weekNumber)??"‚Äî"),1)])]),re.value.newTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",re.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Ce=q.value)==null?void 0:Ce.weekNumber)??"‚Äî"}): ${x(re.value.newTickets)}`},[r("span",ja,C(re.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",za,C(x(re.value.newTickets)),1),r("span",qa,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((Pe=q.value)==null?void 0:Pe.weekNumber)??"‚Äî"),1)],10,Ya)):ne("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:i[4]||(i[4]=be=>A("closed"))},[i[29]||(i[29]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Za,[r("div",Xa,[r("div",Ja,[r("div",Qa,C(((xe=u.value)==null?void 0:xe.closedTickets)??0),1),r("span",es,"–ù–µ–¥–µ–ª—è "+C(((Ke=u.value)==null?void 0:Ke.weekNumber)??"‚Äî"),1)]),r("div",ts,[r("div",rs,C(((Ye=q.value)==null?void 0:Ye.closedTickets)??0),1),r("span",as,"–ù–µ–¥–µ–ª—è "+C(((ut=q.value)==null?void 0:ut.weekNumber)??"‚Äî"),1)])]),re.value.closedTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",re.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((kt=q.value)==null?void 0:kt.weekNumber)??"‚Äî"}): ${x(re.value.closedTickets)}`},[r("span",os,C(re.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",ns,C(x(re.value.closedTickets)),1),r("span",ls,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((vt=q.value)==null?void 0:vt.weekNumber)??"‚Äî"),1)],10,ss)):ne("",!0)]),r("div",is,[r("div",cs,[i[25]||(i[25]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",ds,C(((ht=u.value)==null?void 0:ht.closedTicketsCreatedThisWeek)??0),1),i[26]||(i[26]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",us,[i[27]||(i[27]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ks,C(((yt=u.value)==null?void 0:yt.closedTicketsCreatedOtherWeek)??0),1),i[28]||(i[28]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:i[5]||(i[5]=be=>A("carryover"))},[i[36]||(i[36]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",vs,[r("div",hs,[r("div",ys,[r("div",ms,C(((mt=u.value)==null?void 0:mt.carryoverTickets)??0),1),r("span",ps,"–ù–µ–¥–µ–ª—è "+C(((pt=u.value)==null?void 0:pt.weekNumber)??"‚Äî"),1)]),r("div",gs,[r("div",fs,C(((gt=q.value)==null?void 0:gt.carryoverTickets)??0),1),r("span",bs,"–ù–µ–¥–µ–ª—è "+C(((ft=q.value)==null?void 0:ft.weekNumber)??"‚Äî"),1)])]),re.value.carryoverTickets!==null?(y(),f("div",{key:0,class:pe(["percentage-indicator",re.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((bt=q.value)==null?void 0:bt.weekNumber)??"‚Äî"}): ${x(re.value.carryoverTickets)}`},[r("span",ws,C(re.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",Ts,C(x(re.value.carryoverTickets)),1),r("span",Cs,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((_t=q.value)==null?void 0:_t.weekNumber)??"‚Äî"),1)],10,_s)):ne("",!0)]),r("div",Ws,[r("div",$s,[i[30]||(i[30]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",As,C(((wt=u.value)==null?void 0:wt.carryoverTicketsCreatedThisWeek)??0),1),i[31]||(i[31]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Ss,[i[32]||(i[32]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Ds,C(((Tt=u.value)==null?void 0:Tt.carryoverTicketsCreatedPreviousWeek)??0),1),i[33]||(i[33]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Ns,[i[34]||(i[34]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Es,C(((Ct=u.value)==null?void 0:Ct.carryoverTicketsCreatedOlder)??0),1),i[35]||(i[35]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",Os,[i[37]||(i[37]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",Bs,[(y(!0),f(ye,null,me(U.value,be=>(y(),f("span",{key:be.stageId,class:"stage-tag"},C(be.stageName||be.stageId)+" ‚Äî "+C(be.count),1))),128)),!U.value||U.value.length===0?(y(),f("span",Is,C(V.value),1)):ne("",!0)])])])])):ne("",!0)]),r("div",Ms,[k.value==="line"?(y(),f("div",Us,[r("div",Rs,[i[38]||(i[38]=r("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Ps,[ue(Le(Ge),{data:D.value,options:O.value},null,8,["data","options"])])]),r("div",xs,[i[39]||(i[39]=r("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Ls,[ue(Le(Ge),{data:L.value,options:O.value},null,8,["data","options"])])])])):(y(),De(or(I.value),{key:1,data:M.value,options:O.value},null,8,["data","options"]))])])}}},Gs=Oe(Fs,[["__scopeId","data-v-3666e13a"]]),Hs={class:"summary-cards-months"},Vs={class:"summary-card summary-card--new"},Ks={class:"card-content"},Ys={class:"card-main-value"},js=["title"],zs={class:"card-month-breakdown"},qs={class:"month-name"},Zs={class:"month-value"},Xs={key:0,class:"month-item month-item--empty"},Js={class:"summary-card summary-card--closed"},Qs={class:"card-content"},eo={class:"card-main-value"},to=["title"],ro={class:"card-month-breakdown-hierarchical"},ao={class:"month-header"},so={class:"month-name"},oo={class:"month-value"},no={class:"month-breakdown"},lo={class:"breakdown-item breakdown-this-week"},io={class:"breakdown-value"},co={class:"breakdown-item breakdown-other-week"},uo={class:"breakdown-value"},ko={key:0,class:"month-item-hierarchical month-item--empty"},vo={class:"summary-card summary-card--carryover"},ho={class:"card-content"},yo={class:"card-current-value"},mo={class:"current-value"},po=["title"],go={class:"card-month-breakdown"},fo={class:"month-name"},bo={class:"month-value"},_o={key:0,class:"month-item month-item--empty"},wo={class:"summary-card summary-card--stages"},To={class:"card-content"},Co={class:"stages-list"},Wo={class:"stage-icon"},$o={class:"stage-name"},Ao={class:"stage-value"},So={key:0,class:"stage-item stage-item--empty"},Do={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(s){const t=s;function e(T){return T==null||isNaN(T)?"0":T>=1e6?(T/1e6).toFixed(1)+"M":T>=1e3?T.toLocaleString("ru-RU"):T.toString()}function a(T){return T==null||isNaN(T)?"":`${T>=0?"+":""}${T.toFixed(1)}%`}function o(T,E){if(typeof T!="number"||isNaN(T)||E==null||typeof E!="number"||isNaN(E)||E===0)return null;if(T===E)return 0;const S=(T-E)/E*100;return!isFinite(S)||isNaN(S)?null:S}const l=z(()=>{var T;return((T=t.data)==null?void 0:T.newTickets)||0}),k=z(()=>e(l.value)),d=z(()=>{var T;return((T=t.data)==null?void 0:T.newTicketsByMonth)||[]}),m=z(()=>{var T;return((T=t.data)==null?void 0:T.closedTicketsByMonth)||[]}),p=z(()=>{var T;return((T=t.data)==null?void 0:T.carryoverTicketsByMonth)||[]}),D=z(()=>{const T=p.value;if(T.length===0)return 0;const E=T[T.length-1];return(E==null?void 0:E.count)||0}),L=z(()=>{var S,O,G,g;const T=typeof((S=t.data)==null?void 0:S.newTickets)=="number"?t.data.newTickets:parseInt((O=t.data)==null?void 0:O.newTickets)||0,E=(g=(G=t.data)==null?void 0:G.previousPeriodData)==null?void 0:g.newTickets;return o(T,E)}),ee=z(()=>{var S,O,G,g;const T=typeof((S=t.data)==null?void 0:S.closedTickets)=="number"?t.data.closedTickets:parseInt((O=t.data)==null?void 0:O.closedTickets)||0,E=(g=(G=t.data)==null?void 0:G.previousPeriodData)==null?void 0:g.closedTickets;return o(T,E)}),te=z(()=>{var O;const T=D.value,E=p.value,S=E.length>0?((O=E[0])==null?void 0:O.count)||0:null;return o(T,S)});function I(T){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[T]||""}function M(T){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[T]||"‚Ä¢"}return(T,E)=>(y(),f("div",Hs,[r("div",Vs,[E[0]||(E[0]=r("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),r("div",Ks,[r("div",Ys,[we(C(k.value)+" ",1),L.value!==null?(y(),f("span",{key:0,class:pe(["percentage-badge",L.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(L.value)}`},C(a(L.value)),11,js)):ne("",!0)]),r("div",zs,[(y(!0),f(ye,null,me(d.value,S=>(y(),f("div",{key:`new-${S.month}`,class:"month-item"},[r("span",qs,C(S.monthName)+":",1),r("span",Zs,C(e(S.count)),1)]))),128)),d.value.length===0?(y(),f("div",Xs," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ne("",!0)])])]),r("div",Js,[E[5]||(E[5]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),r("div",Qs,[r("div",eo,[we(C(e(s.data.closedTickets||0))+" ",1),ee.value!==null?(y(),f("span",{key:0,class:pe(["percentage-badge",ee.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(ee.value)}`},C(a(ee.value)),11,to)):ne("",!0)]),r("div",ro,[(y(!0),f(ye,null,me(m.value,S=>(y(),f("div",{key:`closed-${S.month}`,class:"month-item-hierarchical"},[r("div",ao,[r("span",so,C(S.monthName)+":",1),r("span",oo,C(e(S.count||0)),1)]),r("div",no,[r("div",lo,[E[1]||(E[1]=r("span",{class:"breakdown-icon"},"‚úì",-1)),E[2]||(E[2]=r("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",io,C(e(S.closedCreatedThisWeek||0)),1)]),r("div",co,[E[3]||(E[3]=r("span",{class:"breakdown-icon"},"‚Üª",-1)),E[4]||(E[4]=r("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",uo,C(e(S.closedCreatedOtherWeek||0)),1)])])]))),128)),m.value.length===0?(y(),f("div",ko," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ne("",!0)])])]),r("div",vo,[E[7]||(E[7]=r("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),E[8]||(E[8]=r("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),r("div",ho,[r("div",yo,[E[6]||(E[6]=r("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),r("span",mo,[we(C(e(D.value))+" ",1),te.value!==null?(y(),f("span",{key:0,class:pe(["percentage-badge",te.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(te.value)}`},C(a(te.value)),11,po)):ne("",!0)])]),r("div",go,[(y(!0),f(ye,null,me(p.value,S=>(y(),f("div",{key:`carryover-${S.month}`,class:"month-item"},[r("span",fo,C(S.monthName)+":",1),r("span",bo,C(e(S.count||0)),1)]))),128)),p.value.length===0?(y(),f("div",_o," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):ne("",!0)])])]),r("div",wo,[E[10]||(E[10]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",To,[r("div",Co,[(y(!0),f(ye,null,me(s.data.stages||[],S=>(y(),f("div",{key:S.stageId,class:pe(["stage-item",I(S.stageId)])},[r("span",Wo,C(M(S.stageId)),1),r("span",$o,C(S.stageName||S.stageId)+":",1),r("span",Ao,C(e(S.count||0)),1)],2))),128)),!s.data.stages||s.data.stages.length===0?(y(),f("div",So,[...E[9]||(E[9]=[r("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):ne("",!0)])])])]))}},No=Oe(Do,[["__scopeId","data-v-15d88b90"]]),Eo={class:"line-chart-months"},Oo={class:"chart-section"},Bo={class:"chart-title"},Io={key:0,class:"chart-period"},Mo={class:"chart-wrapper"},Uo={class:"chart-container"},Ro={class:"chart-summary"},Po={class:"summary-numbers"},xo={class:"summary-row"},Lo={class:"summary-values"},Fo={class:"summary-row"},Go={class:"summary-values"},Ho={class:"summary-analysis"},Vo=["innerHTML"],Ko={class:"chart-section"},Yo={class:"chart-title"},jo={key:0,class:"chart-period"},zo={class:"chart-wrapper"},qo={class:"chart-container"},Zo={class:"chart-analysis"},Xo={class:"analysis-content"},Jo=["innerHTML"],Qo={class:"chart-table-section"},en={class:"chart-table-wrapper"},tn={class:"data-table"},rn={class:"data-row data-row--new"},an={class:"data-row data-row--closed"},sn={class:"data-row data-row--carryover"},on={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(s){nt.register(Yt);const t=s;function e(I){return I==null||isNaN(I)?"0":I>=1e3?I.toLocaleString("ru-RU"):I.toString()}const a=z(()=>{var M,T,E;const I=new Set;return(M=t.data.newTicketsByMonth)==null||M.forEach(S=>{S.weeks&&Array.isArray(S.weeks)&&S.weeks.forEach(O=>{O&&O.weekNumber&&I.add(O.weekNumber)})}),(T=t.data.closedTicketsByMonth)==null||T.forEach(S=>{S.weeks&&Array.isArray(S.weeks)&&S.weeks.forEach(O=>{O&&O.weekNumber&&I.add(O.weekNumber)})}),(E=t.data.carryoverTicketsByMonth)==null||E.forEach(S=>{S.weeks&&Array.isArray(S.weeks)&&S.weeks.forEach(O=>{O&&O.weekNumber&&I.add(O.weekNumber)})}),Array.from(I).sort((S,O)=>S-O)}),o=z(()=>{const I=t.data.newTicketsByMonth||[],M=I.map(S=>S.monthName||`–ú–µ—Å—è—Ü ${S.month}`),T=I.map(S=>S.count||0),E=(t.data.closedTicketsByMonth||[]).map(S=>S.count||0);return{labels:M,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:W.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:W.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:W.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:E,borderColor:W.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:W.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:W.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=z(()=>{const I=t.data.carryoverTicketsByMonth||[],M=I.map(E=>E.monthName||`–ú–µ—Å—è—Ü ${E.month}`),T=I.map(E=>E.count||0);return{labels:M,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:W.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:W.carryover}}]}}),k={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(I,M)=>I==null||isNaN(I)?"":I.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(I){const M=I.dataset.data[I.dataIndex];return M!=null&&!isNaN(M)&&isFinite(M)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function d(I){if(!I||I.length===0)return null;const M=I[0],T=I[I.length-1];if(!M||!T)return null;const E=M.monthName||`–ú–µ—Å—è—Ü ${M.month}`,S=T.monthName||`–ú–µ—Å—è—Ü ${T.month}`,O=M.year||new Date().getFullYear();return`${E} ‚Äî ${S} ${O}`}const m=z(()=>{var I;return d(((I=t.data)==null?void 0:I.newTicketsByMonth)||[])}),p=z(()=>{var I;return d(((I=t.data)==null?void 0:I.carryoverTicketsByMonth)||[])}),D=z(()=>{var S,O;const I=((S=t.data)==null?void 0:S.newTicketsByMonth)||[],M=((O=t.data)==null?void 0:O.closedTicketsByMonth)||[];if(I.length===0)return{new:"‚Äî",closed:"‚Äî"};const T=I.map(G=>`${e(G.count||0)} (${G.monthName||G.month})`).join(" ‚Üí "),E=M.map(G=>`${e(G.count||0)} (${G.monthName||G.month})`).join(" ‚Üí ");return{new:T,closed:E}}),L=z(()=>{var O,G;const I=((O=t.data)==null?void 0:O.newTicketsByMonth)||[],M=((G=t.data)==null?void 0:G.closedTicketsByMonth)||[];if(I.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const T=[],E=[],S=[];if(I.length>=2){const g=I[0],u=I[1],R=I[2];if(u&&g&&typeof g.count=="number"&&typeof u.count=="number"){const b=g.monthName||g.month,U=u.monthName||u.month,V=e(g.count||0),F=e(u.count||0);if(g.count>0){const x=(u.count-g.count)/g.count*100;if(isFinite(x)&&!isNaN(x)){const q=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",Z=Math.abs(x),re=x>=0?"+":"-",ve=x>=0?"#28a745":"#dc3545",fe=x>=0?"#28a745":"#dc3545";E.push(`  ‚Ä¢ <span style="color: ${ve}; font-weight: 600;">${q}</span> —Å ${V} (${b}) –¥–æ ${F} (${U}) ‚Äî <span style="color: ${fe}; font-weight: 600;">${re}${Z.toFixed(1)}%</span>`)}}else g.count===0&&u.count>0&&E.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${b}) –¥–æ ${F} (${U})`)}if(R&&u&&typeof u.count=="number"&&typeof R.count=="number"){const b=u.monthName||u.month,U=R.monthName||R.month,V=e(u.count||0),F=e(R.count||0);if(u.count>0){const x=(R.count-u.count)/u.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)E.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${V} (${b}) ‚Üí ${F} (${U}) ‚Äî 0.0%`);else{const q=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",Z=Math.abs(x),re=x>=0?"+":"-",ve=x>=0?"#28a745":"#dc3545",fe=x>=0?"#28a745":"#dc3545";E.push(`  ‚Ä¢ <span style="color: ${ve}; font-weight: 600;">${q}</span> —Å ${V} (${b}) –¥–æ ${F} (${U}) ‚Äî <span style="color: ${fe}; font-weight: 600;">${re}${Z.toFixed(1)}%</span>`)}}else u.count===0&&R.count>0&&E.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${b}) –¥–æ ${F} (${U})`)}}if(M.length>=2){const g=M[0],u=M[1],R=M[2];if(u&&g&&typeof g.count=="number"&&typeof u.count=="number"){const b=g.monthName||g.month,U=u.monthName||u.month,V=e(g.count||0),F=e(u.count||0);if(g.count>0){const x=(u.count-g.count)/g.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)S.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${V} (${b}) ‚Üí ${F} (${U}) ‚Äî 0.0%`);else{const q=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",Z=Math.abs(x),re=x>=0?"+":"-",ve=x>=0?"#28a745":"#dc3545",fe=x>=0?"#28a745":"#dc3545";S.push(`  ‚Ä¢ <span style="color: ${ve}; font-weight: 600;">${q}</span> —Å ${V} (${b}) –¥–æ ${F} (${U}) ‚Äî <span style="color: ${fe}; font-weight: 600;">${re}${Z.toFixed(1)}%</span>`)}}else g.count===0&&u.count>0&&S.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${b}) –¥–æ ${F} (${U})`)}if(R&&u&&typeof u.count=="number"&&typeof R.count=="number"){const b=u.monthName||u.month,U=R.monthName||R.month,V=e(u.count||0),F=e(R.count||0);if(u.count>0){const x=(R.count-u.count)/u.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)S.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${V} (${b}) ‚Üí ${F} (${U}) ‚Äî 0.0%`);else{const q=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",Z=Math.abs(x),re=x>=0?"+":"-",ve=x>=0?"#28a745":"#dc3545",fe=x>=0?"#28a745":"#dc3545";S.push(`  ‚Ä¢ <span style="color: ${ve}; font-weight: 600;">${q}</span> —Å ${V} (${b}) –¥–æ ${F} (${U}) ‚Äî <span style="color: ${fe}; font-weight: 600;">${re}${Z.toFixed(1)}%</span>`)}}else u.count===0&&R.count>0&&S.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${b}) –¥–æ ${F} (${U})`)}}if(E.length>0&&(T.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...E)),S.length>0&&(T.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...S)),I.length>=3&&M.length>=3){const g=I[0],u=I[I.length-1],R=M[0],b=M[M.length-1],U=g.count||0,V=u.count||0,F=R.count||0,x=b.count||0;if(U>0&&F>0){const q=(V-U)/U*100,Z=(x-F)/F*100;if(isFinite(q)&&isFinite(Z)){const re=g.monthName||g.month,ve=u.monthName||u.month,fe=R.monthName||R.month,A=b.monthName||b.month,n=q>=0?"#28a745":"#dc3545",i=q>=0?"#28a745":"#dc3545",$=Z>=0?"#28a745":"#dc3545",N=Z>=0?"#28a745":"#dc3545";T.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),T.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${n}; font-weight: 600;">${q>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(U)} (${re}) –¥–æ ${e(V)} (${ve}) ‚Äî <span style="color: ${i}; font-weight: 600;">${q>=0?"+":"-"}${Math.abs(q).toFixed(1)}%</span>`),T.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${$}; font-weight: 600;">${Z>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(F)} (${fe}) –¥–æ ${e(x)} (${A}) ‚Äî <span style="color: ${N}; font-weight: 600;">${Z>=0?"+":"-"}${Math.abs(Z).toFixed(1)}%</span>`)}}}return T.length>0?T:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),ee=z(()=>{var S;const I=((S=t.data)==null?void 0:S.carryoverTicketsByMonth)||[];if(I.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const M=[],T=[],E=I.filter(O=>O&&typeof O.count=="number").map(O=>`${e(O.count||0)} (${O.monthName||O.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(E&&M.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${E}`),I.length>=2){const O=I[0],G=I[1],g=I[2];if(G&&O&&typeof O.count=="number"&&typeof G.count=="number"){const u=O.monthName||O.month,R=G.monthName||G.month,b=e(O.count||0),U=e(G.count||0);if(O.count>0){const V=(G.count-O.count)/O.count*100;if(isFinite(V)&&!isNaN(V))if(Math.abs(V)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${b} (${u}) ‚Üí ${U} (${R}) ‚Äî 0.0%`);else{const F=V>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(V),q=V>=0?"+":"-",Z=V>=0?"#28a745":"#dc3545",re=V>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${Z}; font-weight: 600;">${F}</span> —Å ${b} (${u}) –¥–æ ${U} (${R}) ‚Äî <span style="color: ${re}; font-weight: 600;">${q}${x.toFixed(1)}%</span>`)}}else O.count===0&&G.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${u}) –¥–æ ${U} (${R})`)}if(g&&G&&typeof G.count=="number"&&typeof g.count=="number"){const u=G.monthName||G.month,R=g.monthName||g.month,b=e(G.count||0),U=e(g.count||0);if(G.count>0){const V=(g.count-G.count)/G.count*100;if(isFinite(V)&&!isNaN(V))if(Math.abs(V)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${b} (${u}) ‚Üí ${U} (${R}) ‚Äî 0.0%`);else{const F=V>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(V),q=V>=0?"+":"-",Z=V>=0?"#28a745":"#dc3545",re=V>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${Z}; font-weight: 600;">${F}</span> —Å ${b} (${u}) –¥–æ ${U} (${R}) ‚Äî <span style="color: ${re}; font-weight: 600;">${q}${x.toFixed(1)}%</span>`)}}else G.count===0&&g.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${u}) –¥–æ ${U} (${R})`)}}if(T.length>0&&(M.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),M.push(...T)),I.length>=3){const O=I[0],G=I[I.length-1];if(O&&G&&typeof O.count=="number"&&typeof G.count=="number"){const g=O.count||0,u=G.count||0,R=O.monthName||O.month,b=G.monthName||G.month,U=e(g),V=e(u);if(g>0){const F=(u-g)/g*100;if(isFinite(F)&&!isNaN(F))if(Math.abs(F)<1)M.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),M.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${U} (${R}) ‚Üí ${V} (${b}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const x=F>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",q=Math.abs(F),Z=F>=0?"+":"-",re=F>=0?"#28a745":"#dc3545",ve=F>=0?"#28a745":"#dc3545";M.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),M.push(`  ‚Ä¢ <span style="color: ${re}; font-weight: 600;">${x}</span> —Å ${U} (${R}) –¥–æ ${V} (${b}) ‚Äî <span style="color: ${ve}; font-weight: 600;">${Z}${q.toFixed(1)}%</span>`)}}else g===0&&u>0?(M.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),M.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${R}) –¥–æ ${V} (${b})`)):g>0&&u===0&&(M.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),M.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${U} (${R}) –¥–æ 0 (${b})`))}}return M.length>0?M:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function te(I,M){let T=[];switch(I){case"new":T=t.data.newTicketsByMonth||[];break;case"closed":T=t.data.closedTicketsByMonth||[];break;case"carryover":T=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const E of T){if(!E.weeks||!Array.isArray(E.weeks))continue;const S=E.weeks.find(O=>O&&O.weekNumber===M);if(S){const O=S.count||0;return O>0?e(O):"-"}}return"-"}return(I,M)=>(y(),f("div",Eo,[r("div",Oo,[r("h3",Bo,[M[0]||(M[0]=we(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),m.value?(y(),f("span",Io,"("+C(m.value)+")",1)):ne("",!0)]),r("div",Mo,[r("div",Uo,[ue(Le(Ge),{data:o.value,options:k},null,8,["data"])]),r("div",Ro,[M[3]||(M[3]=r("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),r("div",Po,[r("div",xo,[M[1]||(M[1]=r("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),r("span",Lo,C(D.value.new),1)]),r("div",Fo,[M[2]||(M[2]=r("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),r("span",Go,C(D.value.closed),1)])]),r("div",Ho,[(y(!0),f(ye,null,me(L.value,(T,E)=>(y(),f("p",{key:E,innerHTML:T},null,8,Vo))),128))])])])]),r("div",Ko,[r("h3",Yo,[M[4]||(M[4]=we(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),p.value?(y(),f("span",jo,"("+C(p.value)+")",1)):ne("",!0)]),r("div",zo,[r("div",qo,[ue(Le(Ge),{data:l.value,options:k},null,8,["data"])]),r("div",Zo,[M[5]||(M[5]=r("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),r("div",Xo,[(y(!0),f(ye,null,me(ee.value,(T,E)=>(y(),f("p",{key:E,innerHTML:T},null,8,Jo))),128))])])])]),r("div",Qo,[M[10]||(M[10]=r("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),r("div",en,[r("table",tn,[r("thead",null,[r("tr",null,[M[6]||(M[6]=r("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(y(!0),f(ye,null,me(a.value,T=>(y(),f("th",{key:`week-${T}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+C(T),1))),128))])]),r("tbody",null,[r("tr",rn,[M[7]||(M[7]=r("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(y(!0),f(ye,null,me(a.value,T=>(y(),f("td",{key:`new-${T}`,class:"week-data-cell"},C(te("new",T)),1))),128))]),r("tr",an,[M[8]||(M[8]=r("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(y(!0),f(ye,null,me(a.value,T=>(y(),f("td",{key:`closed-${T}`,class:"week-data-cell"},C(te("closed",T)),1))),128))]),r("tr",sn,[M[9]||(M[9]=r("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(y(!0),f(ye,null,me(a.value,T=>(y(),f("td",{key:`carryover-${T}`,class:"week-data-cell"},C(te("carryover",T)),1))),128))])])])])])]))}},nn=Oe(on,[["__scopeId","data-v-31a3d565"]]),ln={class:"months-preloader"},cn={class:"preloader-content"},dn={class:"progress-container"},un={class:"progress-bar"},kn={class:"progress-text"},vn={class:"preloader-message"},hn={class:"stages-list"},yn={class:"stage-icon"},mn={class:"stage-text"},pn={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:s=>s>=0&&s<=100},currentStage:{type:String,default:""}},setup(s){const t=s,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function a(l){return t.progress>=e[l].threshold}function o(l){const k=e[l].threshold,d=l>0?e[l-1].threshold:0;return t.progress>=d&&t.progress<k}return(l,k)=>(y(),f("div",ln,[r("div",cn,[k[0]||(k[0]=nr('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),r("div",dn,[r("div",un,[r("div",{class:"progress-fill",style:Me({width:`${s.progress}%`})},null,4)]),r("div",kn,C(Math.round(s.progress))+"%",1)]),r("p",vn,C(s.currentStage),1),r("div",hn,[(y(),f(ye,null,me(e,(d,m)=>r("div",{key:m,class:pe(["stage-item",{"stage-completed":a(m),"stage-current":o(m)}])},[r("span",yn,C(a(m)?"‚úì":o(m)?"‚Üí":"‚óã"),1),r("span",mn,C(d.label),1)],2)),64))])])]))}},gn=Oe(pn,[["__scopeId","data-v-b571fe67"]]),fn="/api/graph-1c-admission-closure.php";function bn(s){var a,o,l,k,d,m,p,D,L,ee,te,I,M,T,E,S,O,G,g,u,R,b,U,V,F,x,q,Z,re,ve,fe,A,n,i,$,N,H,w,Y,oe,_,v,h,c,P,X,le,ae,se,B,j,ce,ke,K,he,Ae,Se,Te,Q,ie,de,Ce,Pe,xe,Ke,Ye;if(!s)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0]},weeksData:[],stagesByWeek:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=s.data||s.result||s,e=t.meta||s.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((a=t.data)==null?void 0:a.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:t.data.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:t.data.carryoverTicketsCreatedOlder??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0}),newTickets:((l=(o=t.data)==null?void 0:o.currentWeek)==null?void 0:l.newTickets)??((k=t.data)==null?void 0:k.newTickets)??t.newTickets??0,closedTickets:((m=(d=t.data)==null?void 0:d.currentWeek)==null?void 0:m.closedTickets)??((p=t.data)==null?void 0:p.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((L=(D=t.data)==null?void 0:D.currentWeek)==null?void 0:L.closedTicketsCreatedThisWeek)??((ee=t.data)==null?void 0:ee.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((I=(te=t.data)==null?void 0:te.currentWeek)==null?void 0:I.closedTicketsCreatedOtherWeek)??((M=t.data)==null?void 0:M.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((E=(T=t.data)==null?void 0:T.currentWeek)==null?void 0:E.carryoverTickets)??((S=t.data)==null?void 0:S.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((G=(O=t.data)==null?void 0:O.currentWeek)==null?void 0:G.carryoverTicketsCreatedThisWeek)??((g=t.data)==null?void 0:g.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((R=(u=t.data)==null?void 0:u.currentWeek)==null?void 0:R.carryoverTicketsCreatedOtherWeek)??((b=t.data)==null?void 0:b.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:((V=(U=t.data)==null?void 0:U.currentWeek)==null?void 0:V.carryoverTicketsCreatedPreviousWeek)??((F=t.data)==null?void 0:F.carryoverTicketsCreatedPreviousWeek)??t.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:((q=(x=t.data)==null?void 0:x.currentWeek)==null?void 0:q.carryoverTicketsCreatedOlder)??((Z=t.data)==null?void 0:Z.carryoverTicketsCreatedOlder)??t.carryoverTicketsCreatedOlder??0,series:{new:((ve=(re=t.data)==null?void 0:re.series)==null?void 0:ve.new)??((fe=t.series)==null?void 0:fe.new)??[0],closed:((n=(A=t.data)==null?void 0:A.series)==null?void 0:n.closed)??((i=t.series)==null?void 0:i.closed)??[0],closedCreatedThisWeek:((N=($=t.data)==null?void 0:$.series)==null?void 0:N.closedCreatedThisWeek)??((H=t.series)==null?void 0:H.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((Y=(w=t.data)==null?void 0:w.series)==null?void 0:Y.closedCreatedOtherWeek)??((oe=t.series)==null?void 0:oe.closedCreatedOtherWeek)??[0],carryover:((v=(_=t.data)==null?void 0:_.series)==null?void 0:v.carryover)??((h=t.series)==null?void 0:h.carryover)??[0],carryoverCreatedThisWeek:((P=(c=t.data)==null?void 0:c.series)==null?void 0:P.carryoverCreatedThisWeek)??((X=t.series)==null?void 0:X.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((ae=(le=t.data)==null?void 0:le.series)==null?void 0:ae.carryoverCreatedOtherWeek)??((se=t.series)==null?void 0:se.carryoverCreatedOtherWeek)??[0],carryoverCreatedPreviousWeek:((j=(B=t.data)==null?void 0:B.series)==null?void 0:j.carryoverCreatedPreviousWeek)??((ce=t.series)==null?void 0:ce.carryoverCreatedPreviousWeek)??[0],carryoverCreatedOlder:((K=(ke=t.data)==null?void 0:ke.series)==null?void 0:K.carryoverCreatedOlder)??((he=t.series)==null?void 0:he.carryoverCreatedOlder)??[0]},weeksData:((Ae=t.data)==null?void 0:Ae.weeksData)??t.weeksData??[],stagesByWeek:((Se=t.data)==null?void 0:Se.stagesByWeek)??t.stagesByWeek??[],stages:((Te=t.data)==null?void 0:Te.stages)??t.stages??[],responsible:((Q=t.data)==null?void 0:Q.responsible)??t.responsible??[],responsibleCreatedThisWeek:((ie=t.data)==null?void 0:ie.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((de=t.data)==null?void 0:de.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Ce=t.data)==null?void 0:Ce.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Pe=t.data)==null?void 0:Pe.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((xe=t.data)==null?void 0:xe.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((Ke=t.data)==null?void 0:Ke.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ye=t.data)==null?void 0:Ye.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function Ee(s={}){const{endpoint:t=fn,product:e="1C",weekStartUtc:a=null,weekEndUtc:o=null,periodMode:l="weeks",useCache:k=!0,forceRefresh:d=!1,includeTickets:m=!1,includeNewTicketsByStages:p=!1,includeCarryoverTickets:D=!0,includeCarryoverTicketsByDuration:L=!1}=s,ee={product:e,weekStartUtc:a,weekEndUtc:o,periodMode:l,useCache:k,forceRefresh:d,includeTickets:m,includeNewTicketsByStages:p,includeCarryoverTickets:D,includeCarryoverTicketsByDuration:L},te=lr(t),I=await fetch(te,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(ee)});if(!I.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${I.status})`);const M=await I.json();if((M==null?void 0:M.success)===!1)throw new Error(M.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");const T=bn(M);if(M.cache_used===!0){const{CacheNotificationService:E}=await Ue(async()=>{const{CacheNotificationService:O}=await import("./main-CXbIbH4o.js").then(G=>G.aq);return{CacheNotificationService:O}},__vite__mapDeps([0,1]),import.meta.url),S=l==="months"?"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞/–∑–∞–∫—Ä—ã—Ç–∏–π 1–° (3 –º–µ—Å—è—Ü–∞)":"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞/–∑–∞–∫—Ä—ã—Ç–∏–π 1–° (4 –Ω–µ–¥–µ–ª–∏)";E.notifyCacheUsed(S)}return T}const _n=Object.freeze(Object.defineProperty({__proto__:null,fetchAdmissionClosureStats:Ee},Symbol.toStringTag,{value:"Module"})),wn={class:"ac-dashboard-months"},Tn={key:"content"},Cn={class:"dashboard-header"},Wn={class:"header-content"},$n={class:"breadcrumbs-row"},An=["aria-label","aria-disabled","data-fallback","disabled"],Sn={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Dn={class:"dashboard-layout"},Nn={class:"filters-container"},En={class:"chart-container"},On={__name:"GraphAdmissionClosureMonthsDashboard",setup(s){const t=It(),e=J(!0),a=J(0),o=J("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),l=J(null),k=J(null),d=J({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),m=J(!1),p=z(()=>typeof window>"u"?!1:window.history.length>1),D=z(()=>p.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),L={name:"dashboard-sector-1c"};function ee(b){var U;if((U=b==null?void 0:b.preventDefault)==null||U.call(b),!m.value){m.value=!0;try{if(p.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(L)}finally{m.value=!1}}}const te=J({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),I=z(()=>{const b=te.value.customDateRange.startDate||te.value.customDateRange.endDate,U=te.value.employees.length===1&&te.value.employees.includes("all");return b||!U});async function M(b,U,V=500){const F=a.value,x=10,q=(b-F)/x,Z=V/x;for(let re=0;re<x;re++)await new Promise(ve=>setTimeout(ve,Z)),a.value=Math.min(F+q*(re+1),b);a.value=b,o.value=U}async function T(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,a.value=0,o.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let b=null,U=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await M(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const V=Date.now(),F=2e4;b=setInterval(()=>{const re=Date.now()-V,ve=Math.min(5+re/F*85,90);a.value=ve,ve<35?o.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":ve<65?o.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":ve<85?o.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":o.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),U=setTimeout(()=>{b&&(clearInterval(b),b=null)},F+1e4);const x=await Ee({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(U),b&&(clearInterval(b),b=null),a.value=90,o.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await M(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",x);const{meta:q,data:Z}=x;k.value=q,d.value=Z,console.log("[DEBUG MonthsDashboard] Data set, meta:",q,"data keys:",Object.keys(Z)),await new Promise(re=>setTimeout(re,200))}catch(V){b&&(clearInterval(b),b=null),U&&(clearTimeout(U),U=null),console.error("[DEBUG MonthsDashboard] API call failed:",V),l.value=V instanceof Error?V:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",V),a.value=100,o.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function E(b){te.value.stages=b}function S(b){te.value.employees=b}function O(b){te.value.dateRange=b}function G(b){te.value.customDateRange=b}function g(){te.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},u()}function u(){T()}function R(b){if(!["weeks","months"].includes(b)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",b);return}b==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:b}}))}return ct(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),T()}),(b,U)=>{const V=Mt("router-link");return y(),f("div",wn,[ue($e,{name:"fade",mode:"out-in"},{default:ge(()=>[e.value?(y(),De(gn,{key:"preloader",progress:a.value,"current-stage":o.value},null,8,["progress","current-stage"])):(y(),f("div",Tn,[r("div",Cn,[r("div",Wn,[r("div",$n,[r("button",{class:"btn-back-link",type:"button",onClick:ee,"aria-label":D.value,"aria-disabled":!p.value,"data-fallback":!p.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,An),r("nav",Sn,[ue(V,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ge(()=>[...U[0]||(U[0]=[we(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),U[2]||(U[2]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),ue(V,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ge(()=>[...U[1]||(U[1]=[we(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),U[3]||(U[3]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),U[4]||(U[4]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),U[5]||(U[5]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),U[6]||(U[6]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",Dn,[r("div",Nn,[ue(Rt,{stages:te.value.stages,employees:te.value.employees,dateRange:te.value.dateRange,customDateRange:te.value.customDateRange,hasActiveFilters:I.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":E,"onUpdate:employees":S,"onUpdate:dateRange":O,"onUpdate:customDateRange":G,"onUpdate:periodMode":R,onReset:g,onApply:u},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),r("div",En,[l.value?(y(),De(Ut,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(y(),f(ye,{key:1},[ue(No,{data:d.value},null,8,["data"]),ue(nn,{data:d.value,meta:k.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},Bn=Oe(On,[["__scopeId","data-v-fe3ca7ed"]]);class it{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const a=await this.getEmployeesByIds(e);return console.log("Loaded employees:",a.length),{stages:this.groupTicketsByStages(t,a),employees:a,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const a of t){console.log(`Loading tickets for stage: ${a}`);const o=await this.getTicketsByStage(a);e.push(...o),console.log(`Loaded ${o.length} tickets for stage ${a}`)}return e}static async getTicketsByStage(t){const e=[];let a=0;const o=50;let l=!0;for(;l;)try{const d=await Fe.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:a,useOriginalUfNames:"Y"});let m=[];d&&d.result&&(Array.isArray(d.result)?m=d.result:d.result.items&&Array.isArray(d.result.items)?m=d.result.items:d.result.data&&Array.isArray(d.result.data)&&(m=d.result.data)),m.length>0?(e.push(...m),a+=m.length,l=m.length===o):l=!1}catch(d){console.error(`Error loading tickets batch for stage ${t} (start: ${a}):`,d),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const k=e.filter(d=>{const m=d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product||d.ufCrm7TypeProduct||d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product;return Array.isArray(m)?m.includes(this.SECTOR_TAG):typeof m=="object"&&m!==null?m.value===this.SECTOR_TAG||m===this.SECTOR_TAG:m===this.SECTOR_TAG});return console.log(`Filtered ${k.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),k}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(a=>{const o=a.assignedById||a.assignedByIdId||a.ASSIGNED_BY_ID||a.assignedById||a.assignedById&&typeof a.assignedById=="object"&&(a.assignedById.id||a.assignedById.ID)||a.assignedById&&typeof a.assignedById=="object"&&a.assignedById.value;if(o){const l=parseInt(o);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await Fe.call("user.get",{filter:{ID:t}});let a=[];return e&&e.result&&(Array.isArray(e.result)?a=e.result:console.warn("Unexpected user.get result format:",e)),a.map(o=>({id:parseInt(o.ID||o.id||0),name:`${o.NAME||o.name||""} ${o.LAST_NAME||o.lastName||""}`.trim()||o.EMAIL||o.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:o.WORK_POSITION||o.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:o.EMAIL||o.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const a=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(o=>({...o,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(o=>({...o,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(o=>({...o,tickets:[]}))}];return t.forEach(o=>{const l=this.mapStageId(o.stageId||o.STAGE_ID||""),k=a.find(d=>d.id===l);if(k){const d=o.assignedById||o.ASSIGNED_BY_ID||null,m=d?parseInt(d):null;if(m){let p=k.employees.find(D=>D.id===m);p||(p={id:m,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${m}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},k.employees.push(p)),p.tickets.push(this.mapTicket(o))}}}),a}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),a=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",o=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,k=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",d=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",m=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,p=$t(m),D=dr(p);return{id:e,title:a,priorityId:p.id,priorityLabel:p.label,priorityColors:D,priority:p.id,priorityBitrixValue:p.bitrixValue||null,status:this.mapStatus(o),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(o),createdAt:k,modifiedAt:d,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return $t(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=At(t);if(e&&e.bitrixValue)return e.bitrixValue;const a={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return a[t]?a[t]:At(ur).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(a=>!(a.assignedById||a.ASSIGNED_BY_ID)).forEach(a=>{const o=this.mapStageId(a.stageId||a.STAGE_ID||"");e[o]&&e[o].push(this.mapTicket(a))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,a){try{const o=this.mapStageIdToBitrix(a);return(await Fe.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:o}})).result===!0}catch(o){throw console.error("Error assigning ticket:",o),o}}static async createTicket(t){try{const e=await Fe.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await Fe.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await Fe.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(a){throw console.error("Error adding comment:",a),a}}}st(it,"ENTITY_TYPE_ID",140),st(it,"SECTOR_TAG","1C");function In(s){if(!s)return null;try{const t=new Date(s);return isNaN(t.getTime())?null:t}catch{return console.warn("Invalid date format:",s),null}}function Mn(s,t){return Math.floor((s-t)/864e5)}function Un(s){return!s||isNaN(s.getTime())?!1:s<=new Date}const Ne={ONE_MONTH:"one_month",TWO_MONTHS:"two_months",SIX_MONTHS_PLUS:"six_months_plus",ONE_YEAR_PLUS:"one_year_plus"},Re={[Ne.ONE_MONTH]:"–û–¥–∏–Ω –º–µ—Å—è—Ü",[Ne.TWO_MONTHS]:"–î–≤–∞ –º–µ—Å—è—Ü–∞",[Ne.SIX_MONTHS_PLUS]:"–ë–æ–ª–µ–µ –ø–æ–ª—É–≥–æ–¥–∞",[Ne.ONE_YEAR_PLUS]:"–ë–æ–ª–µ–µ –≥–æ–¥–∞"},Nt={[Ne.ONE_MONTH]:30,[Ne.TWO_MONTHS]:60,[Ne.SIX_MONTHS_PLUS]:180,[Ne.ONE_YEAR_PLUS]:365};function Ve(s,t,e=new Date){if(!Array.isArray(s))return console.warn("filterTicketsByTimePeriod: tickets must be an array"),[];if(!Nt[t])return console.warn(`filterTicketsByTimePeriod: Unknown period "${t}"`),s;const a=Nt[t],o=t.includes("_plus");return s.filter(l=>{try{if(!l||!l.id||!l.created_at)return console.warn("Ticket missing required fields:",l),!1;const k=In(l.created_at);if(!k)return console.warn(`Invalid date for ticket ${l.id}: ${l.created_at}`),!1;if(!Un(k))return console.warn(`Future or invalid date for ticket ${l.id}: ${l.created_at}`),!1;const d=Mn(e,k);return o?d>a:d<=a}catch(k){return console.error(`Error filtering ticket ${(l==null?void 0:l.id)||"unknown"}:`,k),!1}})}const Rn={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Pn={class:"modal"},xn={key:0,class:"modal__tabs"},Ln={key:"level-0-categories",class:"level-0"},Fn={class:"modal__header"},Gn={class:"modal__title"},Hn={key:0},Vn={class:"modal__body"},Kn={class:"categories-list"},Yn=["onClick"],jn={class:"category-item"},zn={class:"category-item__icon"},qn={key:0},Zn={key:1},Xn={class:"category-item__content"},Jn={class:"category-item__label"},Qn={class:"category-item__count"},el={key:0,class:"category-item__arrow"},tl={class:"modal__footer"},rl={key:"level-1-categories",class:"level-1"},al={class:"modal__header"},sl={class:"modal__body"},ol={key:"loading",class:"loading-names"},nl={key:"empty",class:"modal__empty"},ll={key:"list",class:"responsible-list"},il=["onClick"],cl={class:"responsible-list__name"},dl={class:"responsible-list__count"},ul={key:0,class:"responsible-list__arrow"},kl={class:"modal__footer"},vl={key:"level-2-categories",class:"level-2"},hl={class:"modal__header"},yl={class:"modal__title"},ml={class:"modal__body"},pl={class:"time-sort-controls"},gl={class:"time-sort-buttons"},fl=["onClick"],bl={class:"count"},_l={key:"loading",class:"loading-state"},wl={key:"error",class:"error-state"},Tl={class:"error-message"},Cl={key:"empty",class:"empty-state"},Wl={class:"empty-state-message"},$l={key:"tickets",class:"tickets-list-container"},Al={key:"level-0-employees",class:"level-0"},Sl={class:"modal__header"},Dl={class:"modal__title"},Nl={key:0},El={class:"modal__body"},Ol={key:"loading",class:"loading-names"},Bl={key:"empty",class:"modal__empty"},Il={key:"list",class:"responsible-list"},Ml=["onClick"],Ul={class:"responsible-list__name"},Rl={class:"responsible-list__count"},Pl={key:0,class:"responsible-list__arrow"},xl={class:"modal__footer"},Ll={key:"level-1-employees",class:"level-1"},Fl={class:"modal__header"},Gl={class:"modal__title"},Hl={class:"modal__body"},Vl={class:"categories-list"},Kl=["onClick"],Yl={class:"category-item"},jl={class:"category-item__icon"},zl={key:0},ql={key:1},Zl={class:"category-item__content"},Xl={class:"category-item__label"},Jl={class:"category-item__count"},Ql={key:0,class:"category-item__arrow"},ei={class:"modal__footer"},ti={key:"level-2-employees",class:"level-2"},ri={class:"modal__header"},ai={class:"modal__title"},si={class:"modal__body"},oi={key:"loading",class:"loading-state"},ni={key:"error",class:"error-state"},li={class:"error-message"},ii={key:"empty",class:"empty-state"},ci={class:"empty-state-message"},di={key:"tickets",class:"tickets-list-container"},ui={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(s){const t=s,e=J(0),a=J("categories"),o=J(null),l=J(null),k=J(null),d=J([]),m=J(!1),p=J(null),D=J([]),L=J([]),ee=J(!1),te=J(Ne.ONE_MONTH),I=z(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),M=z(()=>{const A=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(n=>{const i=n.id??"unassigned";A.has(i)||A.set(i,{id:n.id,name:n.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const $=A.get(i);$.thisWeekCount=n.count??0,$.thisWeekTickets=n.tickets||[],$.totalCount+=$.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(n=>{const i=n.id??"unassigned";A.has(i)||A.set(i,{id:n.id,name:n.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const $=A.get(i);$.otherWeekCount=n.count??0,$.otherWeekTickets=n.tickets||[],$.totalCount+=$.otherWeekCount}),Array.from(A.values())}),T=z(()=>{if(!l.value)return[];const A=l.value.thisWeekTickets||[],n=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:A.length,otherWeekTickets:n.length,employee:l.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.thisWeekCount??0,tickets:A,employeeId:l.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.otherWeekCount??0,tickets:n,employeeId:l.value.id}]}),E=z(()=>(L.value||[]).length>0),S=z(()=>{if(!d.value||d.value.length===0)return[];try{const A=performance.now(),n=Ve(d.value,te.value),i=performance.now();return console.log(`[ResponsibleModal] Filtering took ${(i-A).toFixed(2)}ms, results: ${n.length}`),n}catch(A){return console.error("[ResponsibleModal] Error filtering tickets:",A),[]}}),O=z(()=>Object.keys(Re).map(A=>({key:A,label:Re[A],count:Ve(d.value,A).length})));async function G(A){const n=A.filter(i=>i.id!==null&&i.id!==void 0).map(i=>i.id);if(n.length===0)return A;try{const i=await it.getEmployeesByIds(n),$=new Map;return i.forEach(N=>{$.set(N.id,N.name)}),A.map(N=>N.id&&$.has(N.id)?{...N,name:$.get(N.id)}:N)}catch(i){return console.error("[ResponsibleModal] Error enriching names:",i),A}}Ie([()=>a.value,()=>M.value],async([A,n])=>{if(!(A!=="employees"||e.value!==0)){if(!n||n.length===0){L.value=[];return}ee.value=!0;try{L.value=await G(n)}catch(i){console.error("[ResponsibleModal] Error loading employee names:",i),L.value=n}finally{ee.value=!1}}},{immediate:!0}),Ie(()=>t.responsible,async A=>{if(!(e.value!==0||o.value||a.value!=="categories")){if(!A||A.length===0){D.value=[];return}ee.value=!0;try{D.value=await G(A)}catch(n){console.error("[ResponsibleModal] Error loading employee names:",n),D.value=A}finally{ee.value=!1}}},{immediate:!1});const g=z(()=>(D.value||[]).length>0);function u(A){a.value!==A&&(a.value=A,e.value=0,o.value=null,l.value=null,k.value=null,d.value=[],p.value=null,D.value=[],L.value=[])}async function R(A){var n,i,$;if(!A||A.count===0){console.warn("[ResponsibleModal] handleCategoryClick: Invalid category or count is 0",{category:A,count:A==null?void 0:A.count});return}console.log("[ResponsibleModal] handleCategoryClick called:",{categoryId:A.id,categoryLabel:A.label,categoryCount:A.count,responsibleCount:((n=A.responsible)==null?void 0:n.length)||0,responsibleWithTickets:((i=A.responsible)==null?void 0:i.filter(N=>N.tickets&&N.tickets.length>0).length)||0,responsibleSample:($=A.responsible)==null?void 0:$.slice(0,2).map(N=>{var H;return{id:N.id,name:N.name,count:N.count,hasTickets:!!N.tickets,ticketsCount:((H=N.tickets)==null?void 0:H.length)||0}})}),o.value=A,e.value=1,ee.value=!0;try{D.value=await G(A.responsible),console.log("[ResponsibleModal] After enrichResponsibleWithNames:",{enrichedCount:D.value.length,enrichedSample:D.value.slice(0,2).map(N=>{var H;return{id:N.id,name:N.name,count:N.count,hasTickets:!!N.tickets,ticketsCount:((H=N.tickets)==null?void 0:H.length)||0}})})}catch(N){console.error("[ResponsibleModal] Error loading employee names:",N),D.value=A.responsible}finally{ee.value=!1}}async function b(A,n=null){var i,$;!A||!A.id||A.totalCount===0||(n&&n.currentTarget&&(n.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{n.currentTarget&&(n.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:A.id,name:A.name,thisWeekCount:A.thisWeekCount,otherWeekCount:A.otherWeekCount,thisWeekTickets:((i=A.thisWeekTickets)==null?void 0:i.length)||0,otherWeekTickets:(($=A.otherWeekTickets)==null?void 0:$.length)||0,employee:A}),l.value={...A,thisWeekTickets:A.thisWeekTickets||[],otherWeekTickets:A.otherWeekTickets||[]},e.value=1)}async function U(A){var i;if(!A||A.count===0)return;k.value=A,e.value=2;const n=A.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:A.id,label:A.label,count:A.count,ticketsInGradation:n.length,selectedEmployee:(i=l.value)==null?void 0:i.id}),n.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",n.length),await V(n)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await F(A))}async function V(A){m.value=!0,p.value=null;try{try{const{prepareTicketsForDisplay:n}=await Ue(async()=>{const{prepareTicketsForDisplay:i}=await import("./ticketListUtils-O2L1S674.js").then($=>$.t);return{prepareTicketsForDisplay:i}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);d.value=await n(A,null,null)}catch(n){console.error("[ResponsibleModal] Error preparing tickets:",n),d.value=A}d.value.length===0&&(p.value=null)}catch(n){p.value=n.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",n),d.value=[]}finally{m.value=!1}}async function F(A){m.value=!0,p.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const n=await Ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),i=A.id==="this-week"?n.data.responsibleCreatedThisWeek:n.data.responsibleCreatedOtherWeek,$=i==null?void 0:i.find(H=>H.id===l.value.id),N=($==null?void 0:$.tickets)||[];try{const{prepareTicketsForDisplay:H}=await Ue(async()=>{const{prepareTicketsForDisplay:w}=await import("./ticketListUtils-O2L1S674.js").then(Y=>Y.t);return{prepareTicketsForDisplay:w}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);d.value=await H(N,null,null)}catch(H){console.error("[ResponsibleModal] Error preparing tickets:",H),d.value=N}d.value.length===0&&(p.value=null)}catch(n){p.value=n.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",n),d.value=[]}finally{m.value=!1}}async function x(A,n=null){!A||!A.id||A.count===0||(n&&n.currentTarget&&(n.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{n.currentTarget&&(n.currentTarget.style.transform="")},150)),l.value=A,e.value=2,await q(A.id))}async function q(A){var n,i,$,N,H,w,Y,oe,_,v,h,c,P,X,le,ae,se;m.value=!0,p.value=null;try{let B=[];if(console.log("[ResponsibleModal] loadEmployeeTickets called:",{employeeId:A,selectedCategory:(n=o.value)==null?void 0:n.id,hasSelectedCategory:!!o.value,hasResponsible:!!((i=o.value)!=null&&i.responsible),responsibleCount:((N=($=o.value)==null?void 0:$.responsible)==null?void 0:N.length)||0,categoryData:o.value?{id:o.value.id,label:o.value.label,count:o.value.count,responsibleSample:(H=o.value.responsible)==null?void 0:H.slice(0,2).map(j=>{var ce;return{id:j.id,name:j.name,count:j.count,hasTickets:!!j.tickets,ticketsCount:((ce=j.tickets)==null?void 0:ce.length)||0}})}:null}),o.value&&o.value.responsible){const j=o.value.responsible.find(ce=>ce.id===A);console.log("[ResponsibleModal] Employee found in category:",{employee:j,hasTickets:!!(j!=null&&j.tickets),ticketsCount:((w=j==null?void 0:j.tickets)==null?void 0:w.length)||0,tickets:j!=null&&j.tickets?j.tickets.slice(0,2):null}),B=(j==null?void 0:j.tickets)||[]}if(B.length===0&&t.weekStartUtc&&t.weekEndUtc){console.log("[ResponsibleModal] Tickets not found in category, loading from API",{weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,categoryId:(Y=o.value)==null?void 0:Y.id});const j=await Ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0});console.log("[ResponsibleModal] API response:",{hasResponsibleCreatedThisWeek:!!j.data.responsibleCreatedThisWeek,hasResponsibleCreatedOtherWeek:!!j.data.responsibleCreatedOtherWeek,thisWeekCount:((oe=j.data.responsibleCreatedThisWeek)==null?void 0:oe.length)||0,otherWeekCount:((_=j.data.responsibleCreatedOtherWeek)==null?void 0:_.length)||0,thisWeekSample:(v=j.data.responsibleCreatedThisWeek)==null?void 0:v.slice(0,1).map(K=>{var he;return{id:K.id,name:K.name,count:K.count,hasTickets:!!K.tickets,ticketsCount:((he=K.tickets)==null?void 0:he.length)||0}}),otherWeekSample:(h=j.data.responsibleCreatedOtherWeek)==null?void 0:h.slice(0,1).map(K=>{var he;return{id:K.id,name:K.name,count:K.count,hasTickets:!!K.tickets,ticketsCount:((he=K.tickets)==null?void 0:he.length)||0}})});const ce=((c=o.value)==null?void 0:c.id)==="created-this-week"?j.data.responsibleCreatedThisWeek:j.data.responsibleCreatedOtherWeek;console.log("[ResponsibleModal] Category data:",{categoryId:(P=o.value)==null?void 0:P.id,categoryDataCount:(ce==null?void 0:ce.length)||0,categoryDataSample:ce==null?void 0:ce.slice(0,2).map(K=>{var he;return{id:K.id,name:K.name,count:K.count,hasTickets:!!K.tickets,ticketsCount:((he=K.tickets)==null?void 0:he.length)||0}})});const ke=ce==null?void 0:ce.find(K=>K.id===A);console.log("[ResponsibleModal] Employee found in API response:",{employee:ke?{id:ke.id,name:ke.name,count:ke.count,hasTickets:!!ke.tickets,ticketsCount:((X=ke.tickets)==null?void 0:X.length)||0,ticketsSample:(le=ke.tickets)==null?void 0:le.slice(0,2)}:null}),B=(ke==null?void 0:ke.tickets)||[]}console.log("[ResponsibleModal] Final employeeTickets before prepareTicketsForDisplay:",{ticketsCount:B.length,ticketsSample:B.slice(0,2).map(j=>({id:j.id,title:j.title||j.ufSubject||"No title",stageId:j.stageId}))});try{const{prepareTicketsForDisplay:j}=await Ue(async()=>{const{prepareTicketsForDisplay:ce}=await import("./ticketListUtils-O2L1S674.js").then(ke=>ke.t);return{prepareTicketsForDisplay:ce}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);d.value=await j(B,null,null),console.log("[ResponsibleModal] Tickets after prepareTicketsForDisplay:",{ticketsCount:d.value.length,ticketsSample:d.value.slice(0,2).map(ce=>({id:ce.id,title:ce.title||ce.ufSubject||"No title",stageId:ce.stageId}))})}catch(j){console.error("[ResponsibleModal] Error preparing tickets:",j),console.error("[ResponsibleModal] prepareError details:",{message:j.message,stack:j.stack,employeeTicketsCount:B.length}),d.value=B,console.log("[ResponsibleModal] Using fallback tickets (without enrichment):",d.value.length)}d.value.length===0?(console.warn("[ResponsibleModal] No tickets after loading and preparation",{employeeId:A,categoryId:(ae=o.value)==null?void 0:ae.id,employeeTicketsCount:B.length,finalTicketsCount:d.value.length}),p.value=null):console.log("[ResponsibleModal] Successfully loaded tickets:",d.value.length)}catch(B){p.value=B.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",B),console.error("[ResponsibleModal] Error details:",{message:B.message,stack:B.stack,employeeId:A,categoryId:(se=o.value)==null?void 0:se.id}),d.value=[]}finally{m.value=!1}}function Z(){e.value===2?(e.value=1,a.value==="categories"?l.value=null:k.value=null,d.value=[],p.value=null):e.value===1&&(e.value=0,a.value==="categories"?(o.value=null,D.value=[]):l.value=null)}function re(A){console.log(`[ResponsibleModal] Sort mode changed: ${te.value} -> ${A}`);const n=performance.now();te.value=A,setTimeout(()=>{const i=S.value,$=performance.now();console.log(`[ResponsibleModal] Filtering completed in ${($-n).toFixed(2)}ms, ${i.length} tickets shown`)},0)}function ve(A){const n=dt(A.id);window.open(n,"_blank")}function fe(){a.value==="employees"&&k.value?V(k.value.tickets):a.value==="categories"&&l.value&&q(l.value.id)}return Ie(()=>t.isVisible,A=>{if(A){console.log("[TASK-070] ResponsibleModal opened for week",t.weekNumber),console.log("[TASK-070] ResponsibleModal props types:",{responsibleCreatedThisWeekType:typeof t.responsibleCreatedThisWeek,responsibleCreatedThisWeekIsArray:Array.isArray(t.responsibleCreatedThisWeek),responsibleCreatedThisWeekLength:Array.isArray(t.responsibleCreatedThisWeek)?t.responsibleCreatedThisWeek.length:"not array",responsibleCreatedOtherWeekType:typeof t.responsibleCreatedOtherWeek,responsibleCreatedOtherWeekIsArray:Array.isArray(t.responsibleCreatedOtherWeek),responsibleCreatedOtherWeekLength:Array.isArray(t.responsibleCreatedOtherWeek)?t.responsibleCreatedOtherWeek.length:"not array"}),console.log("[TASK-070] ResponsibleModal data:",{weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,responsibleCreatedThisWeek:Array.isArray(t.responsibleCreatedThisWeek)?t.responsibleCreatedThisWeek.length:t.responsibleCreatedThisWeek?"not array":"null/undefined",responsibleCreatedOtherWeek:Array.isArray(t.responsibleCreatedOtherWeek)?t.responsibleCreatedOtherWeek.length:t.responsibleCreatedOtherWeek?"not array":"null/undefined",closedTicketsCreatedThisWeek:t.closedTicketsCreatedThisWeek,closedTicketsCreatedOtherWeek:t.closedTicketsCreatedOtherWeek}),console.log("[TASK-070] ResponsibleModal detailed data:",{responsibleCreatedThisWeek:t.responsibleCreatedThisWeek,responsibleCreatedOtherWeek:t.responsibleCreatedOtherWeek,responsibleCreatedThisWeekWithTickets:Array.isArray(t.responsibleCreatedThisWeek)?t.responsibleCreatedThisWeek.map(i=>{var $;return{id:i.id,name:i.name,count:i.count,hasTickets:!!i.tickets,ticketsCount:(($=i.tickets)==null?void 0:$.length)||0}}):"not array or null",responsibleCreatedOtherWeekWithTickets:Array.isArray(t.responsibleCreatedOtherWeek)?t.responsibleCreatedOtherWeek.map(i=>{var $;return{id:i.id,name:i.name,count:i.count,hasTickets:!!i.tickets,ticketsCount:(($=i.tickets)==null?void 0:$.length)||0}}):"not array or null"});const n=t.weekNumber;n&&console.log("[TASK-070] ResponsibleModal: Week number",n)}else e.value=0,a.value="categories",o.value=null,l.value=null,k.value=null,d.value=[],p.value=null,D.value=[],L.value=[]}),(A,n)=>s.isVisible?(y(),f("div",Rn,[r("div",Pn,[e.value===0?(y(),f("div",xn,[r("button",{class:pe(["modal__tab",{"modal__tab--active":a.value==="categories"}]),onClick:n[0]||(n[0]=i=>u("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),r("button",{class:pe(["modal__tab",{"modal__tab--active":a.value==="employees"}]),onClick:n[1]||(n[1]=i=>u("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):ne("",!0),ue($e,{name:"level",mode:"out-in"},{default:ge(()=>{var i,$,N,H;return[a.value==="categories"&&e.value===0?(y(),f("div",Ln,[r("header",Fn,[r("h3",Gn,[n[12]||(n[12]=we(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s.weekNumber?(y(),f("span",Hn," ¬∑ –ù–µ–¥–µ–ª—è "+C(s.weekNumber),1)):ne("",!0)]),r("button",{class:"modal__close",onClick:n[2]||(n[2]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Vn,[r("ul",Kn,[(y(!0),f(ye,null,me(I.value,w=>(y(),f("li",{key:w.id,class:pe(["categories-list__item",{"categories-list__item--clickable":w.count>0}]),onClick:Y=>R(w)},[r("div",jn,[r("div",zn,[w.id==="created-this-week"?(y(),f("span",qn,"‚úì")):(y(),f("span",Zn,"‚Üª"))]),r("div",Xn,[r("div",Jn,C(w.label),1),r("div",Qn,C(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),w.count>0?(y(),f("span",el,"‚Üí")):ne("",!0)])],10,Yn))),128))])]),r("footer",tl,[r("button",{class:"btn",onClick:n[3]||(n[3]=w=>A.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===1?(y(),f("div",rl,[r("header",al,[r("button",{class:"btn-back",onClick:Z,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),n[13]||(n[13]=r("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("button",{class:"modal__close",onClick:n[4]||(n[4]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",sl,[ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>[ee.value?(y(),f("div",ol,[...n[14]||(n[14]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):g.value?(y(),f("ul",ll,[(y(!0),f(ye,null,me(D.value,w=>(y(),f("li",{key:w.id||w.name,class:pe(["responsible-list__item",{"responsible-list__item--clickable":w.id&&w.count>0}]),onClick:Y=>x(w,Y),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",cl,C(w.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",dl,C(w.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.id&&w.count>0?(y(),f("span",ul,"‚Üí")):ne("",!0)],10,il))),128))])):(y(),f("p",nl,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),r("footer",kl,[r("button",{class:"btn",onClick:n[5]||(n[5]=w=>A.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===2?(y(),f("div",vl,[r("header",hl,[r("button",{class:"btn-back",onClick:Z,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",yl,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C(((i=l.value)==null?void 0:i.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:n[6]||(n[6]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",ml,[r("div",pl,[n[15]||(n[15]=r("h4",{class:"time-sort-title"},"–ü–æ–∫–∞–∑–∞—Ç—å —Ç–∏–∫–µ—Ç—ã:",-1)),r("div",gl,[(y(!0),f(ye,null,me(O.value,w=>(y(),f("button",{key:w.key,class:pe(["time-sort-btn",{active:te.value===w.key}]),onClick:Y=>re(w.key)},[we(C(w.label)+" ",1),r("span",bl,"("+C(w.count)+")",1)],10,fl))),128))])]),ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>[m.value?(y(),f("div",_l,[...n[16]||(n[16]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(y(),f("div",wl,[n[17]||(n[17]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),n[18]||(n[18]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Tl,C(p.value),1),r("button",{class:"btn btn-retry",onClick:fe},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):S.value.length===0?(y(),f("div",Cl,[n[19]||(n[19]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",Wl," –£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ("+C(Le(Re)[te.value])+") ",1)])):(y(),f("div",$l,[ue(rt,{name:"ticket",tag:"div",class:"tickets-list"},{default:ge(()=>[(y(!0),f(ye,null,me(S.value,(w,Y)=>(y(),De(at,{key:w.id,ticket:w,draggable:!1,style:Me({"--ticket-index":Y}),onClick:ve},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):a.value==="employees"&&e.value===0?(y(),f("div",Al,[r("header",Sl,[r("h3",Dl,[n[20]||(n[20]=we(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s.weekNumber?(y(),f("span",Nl," ¬∑ –ù–µ–¥–µ–ª—è "+C(s.weekNumber),1)):ne("",!0)]),r("button",{class:"modal__close",onClick:n[7]||(n[7]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",El,[ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>[ee.value?(y(),f("div",Ol,[...n[21]||(n[21]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):E.value?(y(),f("ul",Il,[(y(!0),f(ye,null,me(L.value,w=>(y(),f("li",{key:w.id||w.name,class:pe(["responsible-list__item",{"responsible-list__item--clickable":w.id&&w.totalCount>0}]),onClick:Y=>b(w,Y),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",Ul,C(w.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",Rl,C(w.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.id&&w.totalCount>0?(y(),f("span",Pl,"‚Üí")):ne("",!0)],10,Ml))),128))])):(y(),f("p",Bl,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),r("footer",xl,[r("button",{class:"btn",onClick:n[8]||(n[8]=w=>A.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===1?(y(),f("div",Ll,[r("header",Fl,[r("button",{class:"btn-back",onClick:Z,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Gl,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C((($=l.value)==null?void 0:$.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:n[9]||(n[9]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Hl,[r("ul",Vl,[(y(!0),f(ye,null,me(T.value,w=>(y(),f("li",{key:w.id,class:pe(["categories-list__item",{"categories-list__item--clickable":w.count>0}]),onClick:Y=>U(w)},[r("div",Yl,[r("div",jl,[w.id==="this-week"?(y(),f("span",zl,"‚úì")):(y(),f("span",ql,"‚Üª"))]),r("div",Zl,[r("div",Xl,C(w.label),1),r("div",Jl,C(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),w.count>0?(y(),f("span",Ql,"‚Üí")):ne("",!0)])],10,Kl))),128))])]),r("footer",ei,[r("button",{class:"btn",onClick:n[10]||(n[10]=w=>A.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===2?(y(),f("div",ti,[r("header",ri,[r("button",{class:"btn-back",onClick:Z,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",ai," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C(((N=l.value)==null?void 0:N.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+C(((H=k.value)==null?void 0:H.label)||"")+") ",1),r("button",{class:"modal__close",onClick:n[11]||(n[11]=w=>A.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",si,[ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>{var w;return[m.value?(y(),f("div",oi,[...n[22]||(n[22]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(y(),f("div",ni,[n[23]||(n[23]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),n[24]||(n[24]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",li,C(p.value),1),r("button",{class:"btn btn-retry",onClick:fe},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(y(),f("div",ii,[n[25]||(n[25]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",ci,C(a.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((w=k.value)==null?void 0:w.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(y(),f("div",di,[ue(rt,{name:"ticket",tag:"div",class:"tickets-list"},{default:ge(()=>[(y(!0),f(ye,null,me(S.value,(Y,oe)=>(y(),De(at,{key:Y.id,ticket:Y,draggable:!1,style:Me({"--ticket-index":oe}),onClick:ve},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ne("",!0)]}),_:1})])])):ne("",!0)}},ki=Oe(ui,[["__scopeId","data-v-6f43202a"]]),vi={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},hi={class:"modal"},yi={key:"level-1",class:"level-1"},mi={class:"modal__header"},pi={class:"modal__title"},gi={key:0},fi={class:"modal__body"},bi={key:"loading",class:"loading-names"},_i={key:"empty",class:"modal__empty"},wi={key:"list",class:"stages-list"},Ti=["onClick"],Ci={class:"stages-list__name"},Wi={class:"stages-list__count"},$i={key:0,class:"stages-list__arrow"},Ai={class:"modal__footer"},Si={key:"level-2",class:"level-2"},Di={class:"modal__header"},Ni={class:"modal__title"},Ei={class:"modal__body"},Oi={class:"time-sort-controls"},Bi={class:"time-sort-buttons"},Ii=["onClick"],Mi={class:"count"},Ui={key:"loading",class:"loading-state"},Ri={key:"error",class:"error-state"},Pi={class:"error-message"},xi={key:"empty",class:"empty-state"},Li={class:"empty-state-message"},Fi={key:"tickets",class:"tickets-list-container"},Gi={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(s,{emit:t}){const e=s,a=J(1),o=J(null),l=J([]),k=J(!1),d=J(!1),m=J(null),p=J([]),D=J(Ne.ONE_MONTH),L=z(()=>p.value.length>0&&p.value.some(g=>g.count>0)),ee=z(()=>{if(!l.value||l.value.length===0)return[];try{const g=performance.now(),u=Ve(l.value,D.value),R=performance.now();return console.log(`[StagesModal] Filtering took ${(R-g).toFixed(2)}ms, results: ${u.length}`),u}catch(g){return console.error("[StagesModal] Error filtering tickets:",g),[]}}),te=z(()=>Object.keys(Re).map(g=>({key:g,label:Re[g],count:Ve(l.value,g).length})));async function I(){var g;if(console.log("[TASK-070] StagesModal: loadStages called",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),!e.weekStartUtc||!e.weekEndUtc){console.warn("[TASK-070] StagesModal: Missing week boundaries, cannot load stages"),p.value=[];return}d.value=!0,m.value=null;try{console.log("[TASK-070] StagesModal: Fetching stages from API...");const u=await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});console.log("[TASK-070] StagesModal: API response received",{hasNewTicketsByStages:!!u.data.newTicketsByStages,stagesCount:((g=u.data.newTicketsByStages)==null?void 0:g.length)||0}),p.value=u.data.newTicketsByStages||[],p.value.length===0?console.warn("[TASK-070] StagesModal: API returned empty stages array for week",e.weekNumber):console.log("[TASK-070] StagesModal: Stages loaded successfully",p.value.length,"stages")}catch(u){m.value=u.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[TASK-070] StagesModal: Error loading stages:",u),p.value=[]}finally{d.value=!1}}async function M(g,u=null){!g||g.count===0||(u&&u.currentTarget&&(u.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{u.currentTarget&&(u.currentTarget.style.transform="")},150)),o.value=g,a.value=2,await T(g.stageId))}async function T(g){var u;k.value=!0,m.value=null;try{const R=p.value.find(F=>F.stageId===g);if(R&&Array.isArray(R.tickets)&&R.tickets.length>0){console.log("[TASK-070] StagesModal: Using preloaded tickets for stage",g,"count:",R.tickets.length);const F=R.tickets;try{const{prepareTicketsForDisplay:x}=await Ue(async()=>{const{prepareTicketsForDisplay:q}=await import("./ticketListUtils-O2L1S674.js").then(Z=>Z.t);return{prepareTicketsForDisplay:q}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);l.value=await x(F,null,null)}catch(x){console.error("[TASK-070] StagesModal: Error preparing tickets:",x),l.value=F}k.value=!1;return}if(console.log("[TASK-070] StagesModal: Tickets not preloaded, loading from API for stage",g),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const U=(u=(await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:u.find(F=>F.stageId===g),V=(U==null?void 0:U.tickets)||[];try{const{prepareTicketsForDisplay:F}=await Ue(async()=>{const{prepareTicketsForDisplay:x}=await import("./ticketListUtils-O2L1S674.js").then(q=>q.t);return{prepareTicketsForDisplay:x}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);l.value=await F(V,null,null)}catch(F){console.error("[StagesModal] Error preparing tickets:",F),l.value=V}l.value.length===0&&(m.value=null)}catch(R){m.value=R.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",R),l.value=[]}finally{k.value=!1}}function E(){a.value=1,o.value=null,l.value=[],m.value=null}function S(g){const u=dt(g.id);window.open(u,"_blank")}function O(){o.value&&T(o.value.stageId)}function G(g){console.log(`[StagesModal] Sort mode changed: ${D.value} -> ${g}`);const u=performance.now();D.value=g,setTimeout(()=>{const R=ee.value,b=performance.now();console.log(`[StagesModal] Filtering completed in ${(b-u).toFixed(2)}ms, ${R.length} tickets shown`)},0)}return Ie(()=>e.isVisible,async g=>{g?(a.value=1,o.value=null,l.value=[],m.value=null,console.log("[TASK-070] StagesModal opened:",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,preloadedData:e.preloadedData?Array.isArray(e.preloadedData)?`Array(${e.preloadedData.length})`:typeof e.preloadedData:"null"}),e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] StagesModal: Using preloaded data, stages count:",e.preloadedData.length),e.preloadedData.every(R=>R.stageId&&R.stageName&&typeof R.count=="number")?(p.value=e.preloadedData,d.value=!1,console.log("[TASK-070] StagesModal: Preloaded data set, stages:",p.value.length)):(console.warn("[TASK-070] StagesModal: Invalid preloaded data structure, falling back to API"),await I())):(console.log("[TASK-070] StagesModal: No preloaded data, loading from API",{weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),await I())):(a.value=1,o.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),Ie([()=>e.weekNumber,()=>e.preloadedData],async([g,u])=>{e.isVisible&&g&&(u&&Array.isArray(u)&&u.length>0?u.every(b=>b.stageId&&b.stageName&&typeof b.count=="number")?(console.log("[TASK-070] StagesModal: Week changed, updating with preloaded data for week",g),p.value=u,d.value=!1):(console.log("[TASK-070] StagesModal: Week changed, invalid preloaded data, loading from API for week",g),await I()):(console.log("[TASK-070] StagesModal: Week changed, loading from API for week",g),await I()))}),(g,u)=>s.isVisible?(y(),f("div",vi,[r("div",hi,[ue($e,{name:"level",mode:"out-in"},{default:ge(()=>{var R;return[a.value===1?(y(),f("div",yi,[r("header",mi,[r("h3",pi,[u[3]||(u[3]=we(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),s.weekNumber?(y(),f("span",gi," ¬∑ –ù–µ–¥–µ–ª—è "+C(s.weekNumber),1)):ne("",!0)]),r("button",{class:"modal__close",onClick:u[0]||(u[0]=b=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",fi,[ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>[d.value?(y(),f("div",bi,[...u[4]||(u[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):L.value?(y(),f("ul",wi,[(y(!0),f(ye,null,me(p.value,b=>(y(),f("li",{key:b.stageId,class:pe(["stages-list__item",{"stages-list__item--clickable":b.count>0}]),style:Me({"--stage-color":b.color}),onClick:U=>M(b,U),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[r("span",{class:"stages-list__color",style:Me({backgroundColor:b.color})},null,4),r("span",Ci,C(b.stageName),1),r("span",Wi,C(b.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),b.count>0?(y(),f("span",$i,"‚Üí")):ne("",!0)],14,Ti))),128))])):(y(),f("p",_i," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",Ai,[r("button",{class:"btn",onClick:u[1]||(u[1]=b=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(y(),f("div",Si,[r("header",Di,[r("button",{class:"btn-back",onClick:E,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Ni," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+C(((R=o.value)==null?void 0:R.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:u[2]||(u[2]=b=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Ei,[r("div",Oi,[u[5]||(u[5]=r("h4",{class:"time-sort-title"},"–ü–æ–∫–∞–∑–∞—Ç—å —Ç–∏–∫–µ—Ç—ã:",-1)),r("div",Bi,[(y(!0),f(ye,null,me(te.value,b=>(y(),f("button",{key:b.key,class:pe(["time-sort-btn",{active:D.value===b.key}]),onClick:U=>G(b.key)},[we(C(b.label)+" ",1),r("span",Mi,"("+C(b.count)+")",1)],10,Ii))),128))])]),ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>{var b;return[k.value?(y(),f("div",Ui,[...u[6]||(u[6]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏...",-1),r("p",{class:"loading-subtitle"},"–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö",-1)])])):m.value?(y(),f("div",Ri,[u[7]||(u[7]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),u[8]||(u[8]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Pi,C(m.value),1),r("button",{class:"btn btn-retry",onClick:O},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):ee.value.length===0?(y(),f("div",xi,[u[9]||(u[9]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",Li," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+C((b=o.value)==null?void 0:b.stageName)+"¬ª –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ("+C(Le(Re)[D.value])+") ",1)])):(y(),f("div",Fi,[ue(rt,{name:"ticket",tag:"div",class:"tickets-list"},{default:ge(()=>[(y(!0),f(ye,null,me(ee.value,(U,V)=>(y(),De(at,{key:U.id,ticket:U,draggable:!1,style:Me({"--ticket-index":V}),onClick:S},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ne("",!0)]}),_:1})])])):ne("",!0)}},Hi=Oe(Gi,[["__scopeId","data-v-0dacaef9"]]),He=new Map,Vi=5*60*1e3;function Ki(s,t){return`${s}:${JSON.stringify(t)}`}function Et(s){return Date.now()-s.timestamp<Vi}function Yi(s,t){if(He.set(s,{data:t,timestamp:Date.now()}),He.size>20){const e=He.keys().next().value;He.delete(e)}}function ji(s){const t=He.get(s);return t&&Et(t)?(console.log("[API-CACHE] Cache hit for key:",s),t.data):(t&&!Et(t)&&(console.log("[API-CACHE] Cache expired for key:",s),He.delete(s)),null)}async function zi(s={}){const t="/api/graph-1c-admission-closure.php",e=Ki(t,s),a=ji(t);if(a)return a;console.log("[API-CACHE] Cache miss, making API request for:",e);const{fetchAdmissionClosureStats:o}=await Ue(async()=>{const{fetchAdmissionClosureStats:k}=await Promise.resolve().then(()=>_n);return{fetchAdmissionClosureStats:k}},void 0,import.meta.url),l=await o(s);return Yi(e,l),l}async function qi(s,t){return zi({product:"1C",weekStartUtc:s,weekEndUtc:t,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})}const Zi={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Xi={class:"modal"},Ji={key:"level-1",class:"level-1"},Qi={class:"modal__header"},ec={class:"modal__title"},tc={key:0},rc={class:"modal__body"},ac={key:"loading",class:"loading-names"},sc={key:"empty",class:"modal__empty"},oc={key:"list",class:"duration-list"},nc=["onClick"],lc={class:"duration-list__name"},ic={class:"duration-list__count"},cc={key:0,class:"duration-list__arrow"},dc={class:"modal__footer"},uc={key:"level-2",class:"level-2"},kc={class:"modal__header"},vc={class:"modal__title"},hc={class:"modal__body"},yc={class:"time-sort-controls"},mc={class:"time-sort-buttons"},pc=["onClick"],gc={class:"count"},fc={key:"loading",class:"loading-state"},bc={key:"error",class:"error-state"},_c={class:"error-message"},wc={key:"empty",class:"empty-state"},Tc={class:"empty-state-message"},Cc={key:"tickets",class:"tickets-list-container"},Wc={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(s,{emit:t}){const e=s,a=J(1),o=J(null),l=J([]),k=J(!1),d=J(!1),m=J(null),p=J([]),D=J(Ne.ONE_MONTH),L=z(()=>p.value.length>0&&p.value.some(g=>g.count>0)),ee=z(()=>{if(!l.value||l.value.length===0)return[];try{const g=performance.now(),u=Ve(l.value,D.value),R=performance.now();return console.log(`[CarryoverDurationModal] Filtering took ${(R-g).toFixed(2)}ms, results: ${u.length}`),u}catch(g){return console.error("[CarryoverDurationModal] Error filtering tickets:",g),[]}}),te=z(()=>Object.keys(Re).map(g=>({key:g,label:Re[g],count:Ve(l.value,g).length})));async function I(){if(!e.weekStartUtc||!e.weekEndUtc){p.value=[];return}d.value=!0,m.value=null;try{const g=await Ee({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});p.value=g.data.carryoverTicketsByDuration||[]}catch(g){m.value=g.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",g),p.value=[]}finally{d.value=!1}}async function M(g,u=null){!g||g.count===0||(u&&u.currentTarget&&(u.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{u.currentTarget&&(u.currentTarget.style.transform="")},150)),o.value=g,a.value=2,await T(g.durationCategory))}async function T(g){var u;k.value=!0,m.value=null;try{const R=p.value.find(F=>F.durationCategory===g);if(R&&Array.isArray(R.tickets)&&R.tickets.length>0){console.log("[TASK-070] CarryoverDurationModal: Using preloaded tickets for category",g,"count:",R.tickets.length);const F=R.tickets;try{const{prepareTicketsForDisplay:x}=await Ue(async()=>{const{prepareTicketsForDisplay:q}=await import("./ticketListUtils-O2L1S674.js").then(Z=>Z.t);return{prepareTicketsForDisplay:q}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);l.value=await x(F,null,null)}catch(x){console.error("[TASK-070] CarryoverDurationModal: Error preparing tickets:",x),l.value=F}k.value=!1;return}if(console.log("[TASK-070] CarryoverDurationModal: Tickets not preloaded, loading from API for category",g),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const U=(u=(await qi(e.weekStartUtc,e.weekEndUtc)).data.carryoverTicketsByDuration)==null?void 0:u.find(F=>F.durationCategory===g),V=(U==null?void 0:U.tickets)||[];try{const{prepareTicketsForDisplay:F}=await Ue(async()=>{const{prepareTicketsForDisplay:x}=await import("./ticketListUtils-O2L1S674.js").then(q=>q.t);return{prepareTicketsForDisplay:x}},__vite__mapDeps([2,3,0,1,4,5]),import.meta.url);l.value=await F(V,null,null)}catch(F){console.error("[CarryoverDurationModal] Error preparing tickets:",F),l.value=V}l.value.length===0&&(m.value=null)}catch(R){m.value=R.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",R),l.value=[]}finally{k.value=!1}}function E(){a.value=1,o.value=null,l.value=[],m.value=null}function S(g){console.log(`[CarryoverDurationModal] Sort mode changed: ${D.value} -> ${g}`);const u=performance.now();D.value=g,setTimeout(()=>{const R=ee.value,b=performance.now();console.log(`[CarryoverDurationModal] Filtering completed in ${(b-u).toFixed(2)}ms, ${R.length} tickets shown`)},0)}function O(g){const u=dt(g.id);window.open(u,"_blank")}function G(){o.value&&T(o.value.durationCategory)}return Ie(()=>e.isVisible,async g=>{g?(a.value=1,o.value=null,l.value=[],m.value=null,e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] CarryoverDurationModal: Using preloaded data, categories count:",e.preloadedData.length),e.preloadedData.every(R=>R.durationCategory&&R.durationLabel&&typeof R.count=="number")?(p.value=e.preloadedData,d.value=!1):(console.warn("[TASK-070] CarryoverDurationModal: Invalid preloaded data structure, falling back to API"),await I())):(console.log("[TASK-070] CarryoverDurationModal: No preloaded data, loading from API"),await I())):(a.value=1,o.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),Ie([()=>e.weekNumber,()=>e.preloadedData],async([g,u])=>{e.isVisible&&g&&(u&&Array.isArray(u)&&u.length>0?u.every(b=>b.durationCategory&&b.durationLabel&&typeof b.count=="number")?(console.log("[TASK-070] CarryoverDurationModal: Week changed, updating with preloaded data for week",g),p.value=u,d.value=!1):(console.log("[TASK-070] CarryoverDurationModal: Week changed, invalid preloaded data, loading from API for week",g),await I()):(console.log("[TASK-070] CarryoverDurationModal: Week changed, loading from API for week",g),await I()))}),(g,u)=>s.isVisible?(y(),f("div",Zi,[r("div",Xi,[ue($e,{name:"level",mode:"out-in"},{default:ge(()=>{var R;return[a.value===1?(y(),f("div",Ji,[r("header",Qi,[r("h3",ec,[u[3]||(u[3]=we(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),s.weekNumber?(y(),f("span",tc," ¬∑ –ù–µ–¥–µ–ª—è "+C(s.weekNumber),1)):ne("",!0)]),r("button",{class:"modal__close",onClick:u[0]||(u[0]=b=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",rc,[ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>[d.value?(y(),f("div",ac,[...u[4]||(u[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):L.value?(y(),f("ul",oc,[(y(!0),f(ye,null,me(p.value,b=>(y(),f("li",{key:b.durationCategory,class:pe(["duration-list__item",{"duration-list__item--clickable":b.count>0}]),style:Me({"--duration-color":b.color}),onClick:U=>M(b,U),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[r("span",{class:"duration-list__color",style:Me({backgroundColor:b.color})},null,4),r("span",lc,C(b.durationLabel),1),r("span",ic,C(b.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),b.count>0?(y(),f("span",cc,"‚Üí")):ne("",!0)],14,nc))),128))])):(y(),f("p",sc," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",dc,[r("button",{class:"btn",onClick:u[1]||(u[1]=b=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(y(),f("div",uc,[r("header",kc,[r("button",{class:"btn-back",onClick:E,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",vc," –¢–∏–∫–µ—Ç—ã: "+C(((R=o.value)==null?void 0:R.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:u[2]||(u[2]=b=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",hc,[r("div",yc,[u[5]||(u[5]=r("h4",{class:"time-sort-title"},"–ü–æ–∫–∞–∑–∞—Ç—å —Ç–∏–∫–µ—Ç—ã:",-1)),r("div",mc,[(y(!0),f(ye,null,me(te.value,b=>(y(),f("button",{key:b.key,class:pe(["time-sort-btn",{active:D.value===b.key}]),onClick:U=>S(b.key)},[we(C(b.label)+" ",1),r("span",gc,"("+C(b.count)+")",1)],10,pc))),128))])]),ue($e,{name:"loading",mode:"out-in"},{default:ge(()=>{var b;return[k.value?(y(),f("div",fc,[...u[6]||(u[6]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...",-1),r("p",{class:"loading-subtitle"},"–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö",-1)])])):m.value?(y(),f("div",bc,[u[7]||(u[7]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),u[8]||(u[8]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",_c,C(m.value),1),r("button",{class:"btn btn-retry",onClick:G},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):ee.value.length===0?(y(),f("div",wc,[u[9]||(u[9]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",Tc," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+C((b=o.value)==null?void 0:b.durationLabel)+"¬ª –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ ("+C(Le(Re)[D.value])+") ",1)])):(y(),f("div",Cc,[ue(rt,{name:"ticket",tag:"div",class:"tickets-list"},{default:ge(()=>[(y(!0),f(ye,null,me(ee.value,(U,V)=>(y(),De(at,{key:U.id,ticket:U,draggable:!1,style:Me({"--ticket-index":V}),onClick:O},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):ne("",!0)]}),_:1})])])):ne("",!0)}},$c=Oe(Wc,[["__scopeId","data-v-ed532bc9"]]),Ac={class:"ac-dashboard"},Sc={key:"preloader",class:"chart-preloader"},Dc={class:"preloader-content"},Nc={class:"preloader-message"},Ec={key:"content"},Oc={key:1,class:"weeks-dashboard"},Bc={class:"dashboard-header"},Ic={class:"header-content"},Mc={class:"breadcrumbs-row"},Uc=["aria-label","aria-disabled","data-fallback","disabled"],Rc={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Pc={class:"dashboard-layout"},xc={class:"filters-container"},Lc={class:"chart-container"},Fc={__name:"GraphAdmissionClosureDashboard",setup(s){const t=It(),e=J(!1),a=J(null),o=J(null),l=J({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),k=J(!1),d=J(!1),m=J(!1),p=J(!0),D=J(null),L=J({weeks:new Map,currentWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null},previousWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null}}),ee=z(()=>{var c;const h=((c=o.value)==null?void 0:c.weeks)||[];return h.length>=2?h[h.length-2]:null}),te=J(!1),I=z(()=>typeof window>"u"?!1:window.history.length>1),M=z(()=>I.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),T={name:"dashboard-sector-1c"};function E(h){var c;if((c=h==null?void 0:h.preventDefault)==null||c.call(h),!te.value){te.value=!0;try{if(I.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(T)}finally{te.value=!1}}}const S=J({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),O=J("weeks"),G=z(()=>{const h=S.value.customDateRange.startDate||S.value.customDateRange.endDate,c=S.value.employees.length===1&&S.value.employees.includes("all");return h||!c});async function g(){var c,P,X,le;if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",O.value),console.log("[DEBUG] isLoading before:",e.value),O.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,a.value=null;const h=new Promise(ae=>setTimeout(ae,300));try{console.log("[DEBUG] Starting API call");const ae=v(),se=ae.weekStartUtc,B=ae.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:se,weekEndUtc:B});const[j,ce]=await Promise.all([h,Ee({product:"1C",periodMode:"weeks",weekStartUtc:se,weekEndUtc:B,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0})]);console.log("[DEBUG] API call successful, result:",ce);const{meta:ke,data:K,carryoverDebug:he}=ce;o.value=ke;const Ae=Array.isArray(K.responsibleCreatedThisWeek)?K.responsibleCreatedThisWeek:K.responsibleCreatedThisWeek?Object.values(K.responsibleCreatedThisWeek):[],Se=Array.isArray(K.responsibleCreatedOtherWeek)?K.responsibleCreatedOtherWeek:K.responsibleCreatedOtherWeek?Object.values(K.responsibleCreatedOtherWeek):[];l.value={...K,responsibleCreatedThisWeek:Ae,responsibleCreatedOtherWeek:Se},console.log("[DEBUG] Data set, meta:",ke,"data keys:",Object.keys(K)),console.log("[TASK-070] chartData.value.responsibleCreatedThisWeek after normalization:",{isArray:Array.isArray(Ae),length:Ae.length,sample:Ae.slice(0,2).map(Q=>{var ie;return{id:Q.id,name:Q.name,count:Q.count,hasTickets:!!Q.tickets,ticketsCount:((ie=Q.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] chartData.value.responsibleCreatedOtherWeek after normalization:",{isArray:Array.isArray(Se),length:Se.length,sample:Se.slice(0,2).map(Q=>{var ie;return{id:Q.id,name:Q.name,count:Q.count,hasTickets:!!Q.tickets,ticketsCount:((ie=Q.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] responsibleCreatedThisWeek from API:",{count:((c=K.responsibleCreatedThisWeek)==null?void 0:c.length)||0,data:K.responsibleCreatedThisWeek,details:(P=K.responsibleCreatedThisWeek)==null?void 0:P.map(Q=>{var ie;return{id:Q.id,name:Q.name,count:Q.count,hasTickets:!!Q.tickets,ticketsCount:((ie=Q.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] responsibleCreatedOtherWeek from API:",{count:((X=K.responsibleCreatedOtherWeek)==null?void 0:X.length)||0,data:K.responsibleCreatedOtherWeek,details:(le=K.responsibleCreatedOtherWeek)==null?void 0:le.map(Q=>{var ie;return{id:Q.id,name:Q.name,count:Q.count,hasTickets:!!Q.tickets,ticketsCount:((ie=Q.tickets)==null?void 0:ie.length)||0}})}),console.log("[TASK-070] closedTicketsCreatedThisWeek:",K.closedTicketsCreatedThisWeek),console.log("[TASK-070] closedTicketsCreatedOtherWeek:",K.closedTicketsCreatedOtherWeek);const Te=(ke==null?void 0:ke.weeks)||[];if(console.log("[PERF-OPTIMIZATION] Preloading popup data for",Te.length,"weeks"),Te.forEach((Q,ie)=>{L.value.weeks.has(Q.weekNumber)||L.value.weeks.set(Q.weekNumber,{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null,weekMeta:Q});const de=L.value.weeks.get(Q.weekNumber);ie===Te.length-1&&(K.newTicketsByStages&&(de.newTicketsByStages=K.newTicketsByStages,console.log("[PERF-OPTIMIZATION] Preloaded newTicketsByStages for week",Q.weekNumber,":",K.newTicketsByStages.length,"stages")),K.carryoverTicketsByDuration&&(de.carryoverTicketsByDuration=K.carryoverTicketsByDuration,console.log("[PERF-OPTIMIZATION] Preloaded carryoverTicketsByDuration for week",Q.weekNumber,":",K.carryoverTicketsByDuration.length,"categories")))}),K.newTicketsByStages&&(L.value.currentWeek.newTicketsByStages=K.newTicketsByStages),K.carryoverTicketsByDuration&&(L.value.currentWeek.carryoverTicketsByDuration=K.carryoverTicketsByDuration),Te.length>1&&b(Te.slice(0,-1)),K.responsibleCreatedThisWeek){const Q=Array.isArray(K.responsibleCreatedThisWeek)?K.responsibleCreatedThisWeek:Object.values(K.responsibleCreatedThisWeek);L.value.currentWeek.responsibleCreatedThisWeek=Q,console.log("[TASK-070] Preloaded responsibleCreatedThisWeek for current week:",Q.length,"employees"),console.log("[TASK-070] responsibleCreatedThisWeek details:",Q.map(ie=>{var de;return{id:ie.id,name:ie.name,count:ie.count,hasTickets:!!ie.tickets,ticketsCount:((de=ie.tickets)==null?void 0:de.length)||0}}))}if(K.responsibleCreatedOtherWeek){const Q=Array.isArray(K.responsibleCreatedOtherWeek)?K.responsibleCreatedOtherWeek:Object.values(K.responsibleCreatedOtherWeek);L.value.currentWeek.responsibleCreatedOtherWeek=Q,console.log("[TASK-070] Preloaded responsibleCreatedOtherWeek for current week:",Q.length,"employees"),console.log("[TASK-070] responsibleCreatedOtherWeek details:",Q.map(ie=>{var de;return{id:ie.id,name:ie.name,count:ie.count,hasTickets:!!ie.tickets,ticketsCount:((de=ie.tickets)==null?void 0:de.length)||0}}))}if(he&&(console.log("[CARRYOVER-DEBUG] ========================================"),console.log("[CARRYOVER-DEBUG] Total:",he.total),console.log("[CARRYOVER-DEBUG] ThisWeek:",he.thisWeek),console.log("[CARRYOVER-DEBUG] PreviousWeek:",he.previousWeek),console.log("[CARRYOVER-DEBUG] Older:",he.older),console.log("[CARRYOVER-DEBUG] Sum:",he.sum,"(expected:",he.total,")"),console.log("[CARRYOVER-DEBUG] Series:",he.series),console.log("[CARRYOVER-DEBUG] CurrentWeekData:",he.currentWeekData),console.log("[CARRYOVER-DEBUG] WeeksData:",he.weeksData),console.log("[CARRYOVER-DEBUG] Full object:",he),console.log("[CARRYOVER-DEBUG] ========================================")),ee.value){const Q=ee.value.weekStartUtc,ie=ee.value.weekEndUtc;console.log("[TASK-070] Starting preload for previous week:",{weekNumber:ee.value.weekNumber,weekStartUtc:Q,weekEndUtc:ie}),Ee({product:"1C",periodMode:"weeks",weekStartUtc:Q,weekEndUtc:ie,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0}).then(de=>{if(console.log("[TASK-070] Preload successful for previous week"),de.data.newTicketsByStages&&(L.value.previousWeek.newTicketsByStages=de.data.newTicketsByStages,console.log("[TASK-070] Preloaded newTicketsByStages for previous week:",de.data.newTicketsByStages.length,"stages")),de.data.carryoverTicketsByDuration&&(L.value.previousWeek.carryoverTicketsByDuration=de.data.carryoverTicketsByDuration,console.log("[TASK-070] Preloaded carryoverTicketsByDuration for previous week:",de.data.carryoverTicketsByDuration.length,"categories")),de.data.responsibleCreatedThisWeek){const Ce=Array.isArray(de.data.responsibleCreatedThisWeek)?de.data.responsibleCreatedThisWeek:Object.values(de.data.responsibleCreatedThisWeek);L.value.previousWeek.responsibleCreatedThisWeek=Ce,console.log("[TASK-070] Preloaded responsibleCreatedThisWeek for previous week:",Ce.length,"employees")}if(de.data.responsibleCreatedOtherWeek){const Ce=Array.isArray(de.data.responsibleCreatedOtherWeek)?de.data.responsibleCreatedOtherWeek:Object.values(de.data.responsibleCreatedOtherWeek);L.value.previousWeek.responsibleCreatedOtherWeek=Ce,console.log("[TASK-070] Preloaded responsibleCreatedOtherWeek for previous week:",Ce.length,"employees")}}).catch(de=>{console.warn("[TASK-070] Failed to preload previous week data (non-critical):",de)})}}catch(ae){console.error("[DEBUG] API call failed:",ae),a.value=ae instanceof Error?ae:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",ae)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function u(h){var B;if(!h||!o.value)return console.log("[TASK-070] getPreloadedStagesData: Missing weekMeta or chartMeta"),null;const c=((B=o.value)==null?void 0:B.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber,X=c.length>=2?c[c.length-2].weekNumber:null;console.log("[TASK-070] getPreloadedStagesData:",{requestedWeek:h.weekNumber,currentWeekNumber:P,previousWeekNumber:X,weeksInMeta:c.length});const le=h.weekNumber===P,ae=h.weekNumber===X;let se=null;if(le)se=L.value.currentWeek.newTicketsByStages,console.log("[TASK-070] Requested week is current week, checking currentWeek data:",se?`Array(${se.length})`:"null");else if(ae)se=L.value.previousWeek.newTicketsByStages,console.log("[TASK-070] Requested week is previous week, checking previousWeek data:",se?`Array(${se.length})`:"null");else return console.log("[TASK-070] Requested week",h.weekNumber,"is neither current nor previous, no preloaded data available"),null;return Array.isArray(se)&&se.length>0?(console.log("[TASK-070] Using preloaded stages data for week",h.weekNumber,":",se.length,"stages"),se):(console.log("[TASK-070] No preloaded stages data for week",h.weekNumber,", will use API fallback"),null)}function R(h){var se;if(!h)return null;const c=L.value.weeks.get(h.weekNumber);if(c!=null&&c.carryoverTicketsByDuration&&Array.isArray(c.carryoverTicketsByDuration))return console.log("[PERF-OPTIMIZATION] Using preloaded carryover data for week",h.weekNumber,":",c.carryoverTicketsByDuration.length,"categories"),c.carryoverTicketsByDuration;const P=((se=o.value)==null?void 0:se.weeks)||[],X=P.length>0?P[P.length-1].weekNumber:o.value.weekNumber,ae=h.weekNumber===X?L.value.currentWeek.carryoverTicketsByDuration:L.value.previousWeek.carryoverTicketsByDuration;return Array.isArray(ae)&&ae.length>0?(console.log("[TASK-070] Using fallback preloaded carryover data for week",h.weekNumber,":",ae.length,"categories"),ae):(console.log("[PERF-ISSUE] No preloaded carryover data for week",h.weekNumber,", will use slow API fallback"),null)}async function b(h){if(!(!h||h.length===0)){console.log("[PERF-OPTIMIZATION] Starting background preload for",h.length,"weeks");for(const c of h)try{await new Promise(le=>setTimeout(le,500)),console.log("[PERF-OPTIMIZATION] Preloading data for week",c.weekNumber);const P=await Ee({product:"1C",periodMode:"weeks",weekStartUtc:c.weekStartUtc,weekEndUtc:c.weekEndUtc,includeNewTicketsByStages:!0,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!1}),X={newTicketsByStages:P.data.newTicketsByStages||null,carryoverTicketsByDuration:P.data.carryoverTicketsByDuration||null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null,weekMeta:c};L.value.weeks.set(c.weekNumber,X),console.log("[PERF-OPTIMIZATION] Successfully preloaded data for week",c.weekNumber)}catch(P){console.warn("[PERF-OPTIMIZATION] Failed to preload data for week",c.weekNumber,":",P)}console.log("[PERF-OPTIMIZATION] Background preload completed")}}function U(h){var le;if(!h||!o.value)return null;const c=((le=o.value)==null?void 0:le.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber;return h.weekNumber===P&&l.value.responsible||null}function V(h){var se;if(!h){const B=l.value.responsibleCreatedThisWeek;return console.log("[TASK-070] getResponsibleCreatedThisWeek: weekMeta is null, using chartData:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:B?Object.keys(B).length:0}),B?Array.isArray(B)?B:Object.values(B):null}if(!o.value)return console.log("[TASK-070] getResponsibleCreatedThisWeek: chartMeta is null"),null;const c=((se=o.value)==null?void 0:se.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber,X=c.length>=2?c[c.length-2].weekNumber:null,le=h.weekNumber===P,ae=h.weekNumber===X;if(console.log("[TASK-070] getResponsibleCreatedThisWeek:",{requestedWeek:h.weekNumber,currentWeekNumber:P,previousWeekNumber:X,isCurrentWeek:le,isPreviousWeek:ae}),le){const B=l.value.responsibleCreatedThisWeek;return console.log("[TASK-070] getResponsibleCreatedThisWeek: current week data:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:B?Object.keys(B).length:0}),B?Array.isArray(B)?B:Object.values(B):null}if(ae){const B=L.value.previousWeek.responsibleCreatedThisWeek;return console.log("[TASK-070] getResponsibleCreatedThisWeek: previous week data:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:0,data:B}),B||null}return console.log("[TASK-070] getResponsibleCreatedThisWeek: week",h.weekNumber,"is neither current nor previous, no preloaded data"),null}function F(h){var se;if(!h){const B=l.value.responsibleCreatedOtherWeek;return console.log("[TASK-070] getResponsibleCreatedOtherWeek: weekMeta is null, using chartData:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:B?Object.keys(B).length:0}),B?Array.isArray(B)?B:Object.values(B):null}if(!o.value)return console.log("[TASK-070] getResponsibleCreatedOtherWeek: chartMeta is null"),null;const c=((se=o.value)==null?void 0:se.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber,X=c.length>=2?c[c.length-2].weekNumber:null,le=h.weekNumber===P,ae=h.weekNumber===X;if(console.log("[TASK-070] getResponsibleCreatedOtherWeek:",{requestedWeek:h.weekNumber,currentWeekNumber:P,previousWeekNumber:X,isCurrentWeek:le,isPreviousWeek:ae}),le){const B=l.value.responsibleCreatedOtherWeek;return console.log("[TASK-070] getResponsibleCreatedOtherWeek: current week data:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:B?Object.keys(B).length:0}),B?Array.isArray(B)?B:Object.values(B):null}if(ae){const B=L.value.previousWeek.responsibleCreatedOtherWeek;return console.log("[TASK-070] getResponsibleCreatedOtherWeek: previous week data:",{hasData:!!B,isArray:Array.isArray(B),dataLength:Array.isArray(B)?B.length:0,data:B}),B||null}return console.log("[TASK-070] getResponsibleCreatedOtherWeek: week",h.weekNumber,"is neither current nor previous, no preloaded data"),null}function x(h){var se;if(!h||!o.value)return null;const c=((se=o.value)==null?void 0:se.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber,X=c.length>=2?c[c.length-2].weekNumber:null,le=h.weekNumber===P,ae=h.weekNumber===X;if(le)return l.value.closedTicketsCreatedThisWeek??null;if(ae&&l.value.weeksData){const B=l.value.weeksData.find(j=>j.weekNumber===X);return(B==null?void 0:B.closedTicketsCreatedThisWeek)??null}return null}function q(h){var se;if(!h||!o.value)return null;const c=((se=o.value)==null?void 0:se.weeks)||[],P=c.length>0?c[c.length-1].weekNumber:o.value.weekNumber,X=c.length>=2?c[c.length-2].weekNumber:null,le=h.weekNumber===P,ae=h.weekNumber===X;if(le)return l.value.closedTicketsCreatedOtherWeek??null;if(ae&&l.value.weeksData){const B=l.value.weeksData.find(j=>j.weekNumber===X);return(B==null?void 0:B.closedTicketsCreatedOtherWeek)??null}return null}function Z(h){S.value.stages=h}function re(h){S.value.employees=h}function ve(h){S.value.dateRange=h}function fe(h){S.value.customDateRange=h}function A(h){if(!["weeks","months"].includes(h)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",h);return}h!==O.value&&(O.value=h,h==="weeks"?g():h==="months"&&(e.value=!1))}function n(h){const{mode:c}=h.detail;["weeks","months"].includes(c)&&A(c)}function i(){S.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},$()}function $(){O.value==="weeks"&&g()}function N(h){["weeks","months"].includes(h)&&(O.value=h)}function H(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",p.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",O.value),p.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",p.value),console.log("[DEBUG] isLoading after:",e.value),Wt(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),w()})}function w(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",O.value),console.log("[DEBUG] showPeriodModeInfo:",p.value),console.log("[DEBUG] isLoading:",e.value),(!O.value||!["weeks","months"].includes(O.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),O.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",O.value),Wt(()=>{console.log("[DEBUG] nextTick callback, periodMode:",O.value),console.log("[DEBUG] isLoading in nextTick:",e.value),O.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),g()):O.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function Y(h=null){var c,P,X;h?D.value=h:D.value={weekNumber:((c=o.value)==null?void 0:c.weekNumber)||null,weekStartUtc:((P=o.value)==null?void 0:P.weekStartUtc)||null,weekEndUtc:((X=o.value)==null?void 0:X.weekEndUtc)||null},d.value=!0}function oe(h=null){var c,P,X;h?D.value=h:D.value={weekNumber:((c=o.value)==null?void 0:c.weekNumber)||null,weekStartUtc:((P=o.value)==null?void 0:P.weekStartUtc)||null,weekEndUtc:((X=o.value)==null?void 0:X.weekEndUtc)||null},k.value=!0}function _(h=null){var c,P,X;h?D.value=h:D.value={weekNumber:((c=o.value)==null?void 0:c.weekNumber)||null,weekStartUtc:((P=o.value)==null?void 0:P.weekStartUtc)||null,weekEndUtc:((X=o.value)==null?void 0:X.weekEndUtc)||null},m.value=!0}ct(()=>{try{const h="graph-admission-closure-period-mode-info-shown";localStorage.getItem(h)&&localStorage.removeItem(h);const c="graph-admission-closure-period-mode";localStorage.getItem(c)&&localStorage.removeItem(c)}catch(h){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",h)}window.addEventListener("period-mode-change",n)}),Ot(()=>{window.removeEventListener("period-mode-change",n)});function v(){const h=new Date,c=new Date(Date.UTC(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate())),P=c.getUTCDay(),X=c.getUTCDate()-P+(P===0?-6:1),le=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),X,0,0,0)),ae=new Date(le);return ae.setUTCDate(ae.getUTCDate()+6),ae.setUTCHours(23,59,59,999),{weekStartUtc:le.toISOString(),weekEndUtc:ae.toISOString()}}return(h,c)=>{var X,le,ae,se,B,j,ce,ke,K,he,Ae,Se,Te,Q,ie,de,Ce,Pe;const P=Mt("router-link");return y(),f("div",Ac,[ue($e,{name:"fade",mode:"out-in"},{default:ge(()=>[e.value?(y(),f("div",Sc,[r("div",Dc,[c[3]||(c[3]=r("div",{class:"preloader-spinner"},[r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"})],-1)),c[4]||(c[4]=r("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),r("p",Nc," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+C(O.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),c[5]||(c[5]=r("div",{class:"preloader-dots"},[r("span",{class:"dot"}),r("span",{class:"dot"}),r("span",{class:"dot"})],-1))])])):!p.value&&!e.value?(y(),f("div",Ec,[O.value==="months"?(y(),De(Bn,{key:0})):(y(),f("div",Oc,[r("div",Bc,[r("div",Ic,[r("div",Mc,[r("button",{class:"btn-back-link",type:"button",onClick:E,"aria-label":M.value,"aria-disabled":!I.value,"data-fallback":!I.value,disabled:te.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,Uc),r("nav",Rc,[ue(P,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ge(()=>[...c[6]||(c[6]=[we(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),c[8]||(c[8]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),ue(P,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ge(()=>[...c[7]||(c[7]=[we(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),c[9]||(c[9]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),c[10]||(c[10]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),c[11]||(c[11]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),c[12]||(c[12]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",Pc,[r("div",xc,[ue(Rt,{stages:S.value.stages,employees:S.value.employees,dateRange:S.value.dateRange,customDateRange:S.value.customDateRange,hasActiveFilters:G.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":O.value,"onUpdate:stages":Z,"onUpdate:employees":re,"onUpdate:dateRange":ve,"onUpdate:customDateRange":fe,"onUpdate:periodMode":A,onReset:i,onApply:$},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),r("div",Lc,[a.value?(y(),De(Ut,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:a.value.message},null,8,["message"])):(y(),De(Gs,{key:1,meta:o.value,data:l.value,onOpenResponsible:oe,onOpenStages:Y,onOpenCarryover:_},null,8,["meta","data"]))])])]))])):ne("",!0)]),_:1}),ue(ki,{"is-visible":k.value,responsible:U(D.value)||l.value.responsible||[],"closed-tickets-created-this-week":x(D.value)??l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":q(D.value)??l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":V(D.value)||l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":F(D.value)||l.value.responsibleCreatedOtherWeek||[],"week-number":((X=D.value)==null?void 0:X.weekNumber)||((le=o.value)==null?void 0:le.weekNumber)||null,"week-start-utc":((ae=D.value)==null?void 0:ae.weekStartUtc)||((se=o.value)==null?void 0:se.weekStartUtc)||null,"week-end-utc":((B=D.value)==null?void 0:B.weekEndUtc)||((j=o.value)==null?void 0:j.weekEndUtc)||null,onClose:c[0]||(c[0]=xe=>{k.value=!1,D.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),ue(Hi,{"is-visible":d.value,"week-number":((ce=D.value)==null?void 0:ce.weekNumber)||((ke=o.value)==null?void 0:ke.weekNumber)||null,"week-start-utc":((K=D.value)==null?void 0:K.weekStartUtc)||((he=o.value)==null?void 0:he.weekStartUtc)||null,"week-end-utc":((Ae=D.value)==null?void 0:Ae.weekEndUtc)||((Se=o.value)==null?void 0:Se.weekEndUtc)||null,"preloaded-data":u(D.value),onClose:c[1]||(c[1]=xe=>{d.value=!1,D.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),ue($c,{"is-visible":m.value,"week-number":((Te=D.value)==null?void 0:Te.weekNumber)||((Q=o.value)==null?void 0:Q.weekNumber)||null,"week-start-utc":((ie=D.value)==null?void 0:ie.weekStartUtc)||((de=o.value)==null?void 0:de.weekStartUtc)||null,"week-end-utc":((Ce=D.value)==null?void 0:Ce.weekEndUtc)||((Pe=o.value)==null?void 0:Pe.weekEndUtc)||null,"preloaded-data":R(D.value),onClose:c[2]||(c[2]=xe=>{m.value=!1,D.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),p.value?(y(),De(pr,{key:0,"is-visible":p.value,"current-mode":O.value,onClose:H,onSelectMode:N},null,8,["is-visible","current-mode"])):ne("",!0)])}}},zc=Oe(Fc,[["__scopeId","data-v-e7c9193c"]]);export{zc as default};
