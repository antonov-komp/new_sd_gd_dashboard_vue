const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ticketListUtils-BfZdaHqX.js","./priority-config-Cgj3k7Hd.js","./main-Dm2Xb-zi.js","./main-DFwah1ox.css","./priority-config-Bxxce_5E.css","./ticket-mapper-Bsi8pmNY.js"])))=>i.map(i=>d[i]);
var Gt=Object.defineProperty;var Ft=(o,t,e)=>t in o?Gt(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var et=(o,t,e)=>Ft(o,typeof t!="symbol"?t+"":t,e);import{_ as we,g as Z,G as Te,m as ot,H as Wt,f as _e,o as g,j as re,k as ue,a as _,d as te,b as r,y as fe,n as ke,B as ge,I as Ht,J as Ye,K as he,L as Vt,M as At,N as He,O as Kt,P as Yt,Q as zt,R as jt,S as qt,U as Zt,V as Xt,W as Jt,X as rt,c as q,Y as C,t as $,F as ne,e as ce,Z as Xe,$ as Qt,x as er,l as $e,a0 as tr,z as Dt,r as St,a1 as Et,a2 as Re,T as Je,a3 as Oe,a4 as bt}from"./main-Dm2Xb-zi.js";import{F as Bt}from"./FiltersPanel-DHs2zE4w.js";import{L as Pe,D as rr,B as ar}from"./index-aMYBsX-0.js";import{g as wt,a as sr,b as Ct,D as or,T as Qe,c as nt}from"./priority-config-Cgj3k7Hd.js";const nr={key:0,class:"modal-overlay"},lr={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},ir={class:"modal-body"},cr={class:"mode-description"},dr={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:o=>["weeks","months"].includes(o)}},emits:["close","start-loading","select-mode"],setup(o,{emit:t}){const e=o,a=t,s=Z(e.currentMode);function l(m){if(!["weeks","months"].includes(m)){console.warn("[PeriodModeInfoModal] Invalid mode:",m);return}s.value=m,console.log("[DEBUG Modal] handleModeSelect: mode =",m),console.log("[DEBUG Modal] Emitting select-mode event"),a("select-mode",m),console.log("[DEBUG Modal] Emitting close event"),a("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),a("start-loading")},100)}function u(){console.log("[DEBUG Modal] handleClose called, selectedMode =",s.value),console.log("[DEBUG Modal] Emitting select-mode event with",s.value),a("select-mode",s.value),console.log("[DEBUG Modal] Emitting close event"),a("close")}function d(m){m.key==="Escape"&&e.isVisible&&u()}return Te(()=>e.currentMode,m=>{["weeks","months"].includes(m)&&(s.value=m)}),ot(()=>{e.isVisible&&document.addEventListener("keydown",d)}),Wt(()=>{document.removeEventListener("keydown",d)}),Te(()=>e.isVisible,m=>{m?(document.addEventListener("keydown",d),s.value=e.currentMode):document.removeEventListener("keydown",d)}),(m,p)=>(g(),_e(Ht,{to:"body"},[re(ge,{name:"modal-fade"},{default:ue(()=>[o.isVisible?(g(),_("div",nr,[r("div",lr,[r("div",{class:"modal-header"},[p[2]||(p[2]=r("h2",{id:"modal-title",class:"modal-title"},[r("span",{class:"modal-icon"},"‚ÑπÔ∏è"),fe(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),r("button",{class:"modal-close-btn",onClick:u,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),r("div",ir,[p[5]||(p[5]=r("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),r("div",cr,[r("button",{class:ke(["mode-item mode-item--clickable",{"mode-item--selected":s.value==="weeks"}]),onClick:p[0]||(p[0]=D=>l("weeks")),type:"button"},[...p[3]||(p[3]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìÖ"),r("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),r("button",{class:ke(["mode-item mode-item--clickable",{"mode-item--selected":s.value==="months"}]),onClick:p[1]||(p[1]=D=>l("months")),type:"button"},[...p[4]||(p[4]=[r("div",{class:"mode-header"},[r("span",{class:"mode-icon"},"üìä"),r("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),r("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):te("",!0)]),_:1})]))}},ur=we(dr,[["__scopeId","data-v-4a42a9a6"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Tt=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var o=window.screen;if(o)return(o.deviceXDPI||1)/(o.logicalXDPI||1)}return 1}(),Ve={toTextLines:function(o){var t=[],e;for(o=[].concat(o);o.length;)e=o.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?o.push.apply(o,e):He(o)||t.unshift(""+e);return t},textSize:function(o,t,e){var a=[].concat(t),s=a.length,l=o.font,u=0,d;for(o.font=e.string,d=0;d<s;++d)u=Math.max(o.measureText(a[d]).width,u);return o.font=l,{height:s*e.lineHeight,width:u}},bound:function(o,t,e){return Math.max(o,Math.min(t,e))},arrayDiff:function(o,t){var e=o.slice(),a=[],s,l,u,d;for(s=0,u=t.length;s<u;++s)d=t[s],l=e.indexOf(d),l===-1?a.push([d,1]):e.splice(l,1);for(s=0,u=e.length;s<u;++s)a.push([e[s],-1]);return a},rasterize:function(o){return Math.round(o*Tt)/Tt}};function tt(o,t){var e=t.x,a=t.y;if(e===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var s=o.x-e,l=o.y-a,u=Math.sqrt(s*s+l*l);return{x:u?s/u:0,y:u?l/u:-1}}function kr(o,t,e,a,s){switch(s){case"center":e=a=0;break;case"bottom":e=0,a=1;break;case"right":e=1,a=0;break;case"left":e=-1,a=0;break;case"top":e=0,a=-1;break;case"start":e=-e,a=-a;break;case"end":break;default:s*=Math.PI/180,e=Math.cos(s),a=Math.sin(s);break}return{x:o,y:t,vx:e,vy:a}}var vr=0,Nt=1,Ut=2,It=4,Mt=8;function ze(o,t,e){var a=vr;return o<e.left?a|=Nt:o>e.right&&(a|=Ut),t<e.top?a|=Mt:t>e.bottom&&(a|=It),a}function hr(o,t){for(var e=o.x0,a=o.y0,s=o.x1,l=o.y1,u=ze(e,a,t),d=ze(s,l,t),m,p,D;!(!(u|d)||u&d);)m=u||d,m&Mt?(p=e+(s-e)*(t.top-a)/(l-a),D=t.top):m&It?(p=e+(s-e)*(t.bottom-a)/(l-a),D=t.bottom):m&Ut?(D=a+(l-a)*(t.right-e)/(s-e),p=t.right):m&Nt&&(D=a+(l-a)*(t.left-e)/(s-e),p=t.left),m===u?(e=p,a=D,u=ze(e,a,t)):(s=p,l=D,d=ze(s,l,t));return{x0:e,x1:s,y0:a,y1:l}}function je(o,t){var e=t.anchor,a=o,s,l;return t.clamp&&(a=hr(a,t.area)),e==="start"?(s=a.x0,l=a.y0):e==="end"?(s=a.x1,l=a.y1):(s=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),kr(s,l,o.vx,o.vy,t.align)}var qe={arc:function(o,t){var e=(o.startAngle+o.endAngle)/2,a=Math.cos(e),s=Math.sin(e),l=o.innerRadius,u=o.outerRadius;return je({x0:o.x+a*l,y0:o.y+s*l,x1:o.x+a*u,y1:o.y+s*u,vx:a,vy:s},t)},point:function(o,t){var e=tt(o,t.origin),a=e.x*o.options.radius,s=e.y*o.options.radius;return je({x0:o.x-a,y0:o.y-s,x1:o.x+a,y1:o.y+s,vx:e.x,vy:e.y},t)},bar:function(o,t){var e=tt(o,t.origin),a=o.x,s=o.y,l=0,u=0;return o.horizontal?(a=Math.min(o.x,o.base),l=Math.abs(o.base-o.x)):(s=Math.min(o.y,o.base),u=Math.abs(o.base-o.y)),je({x0:a,y0:s+u,x1:a+l,y1:s,vx:e.x,vy:e.y},t)},fallback:function(o,t){var e=tt(o,t.origin);return je({x0:o.x,y0:o.y,x1:o.x+(o.width||0),y1:o.y+(o.height||0),vx:e.x,vy:e.y},t)}},Ce=Ve.rasterize;function yr(o){var t=o.borderWidth||0,e=o.padding,a=o.size.height,s=o.size.width,l=-s/2,u=-a/2;return{frame:{x:l-e.left-t,y:u-e.top-t,w:s+e.width+t*2,h:a+e.height+t*2},text:{x:l,y:u,w:s,h:a}}}function mr(o,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var a=e.getBasePixel();return o.horizontal?{x:a,y:null}:{x:null,y:a}}function pr(o){return o instanceof jt?qe.arc:o instanceof qt?qe.point:o instanceof Zt?qe.bar:qe.fallback}function gr(o,t,e,a,s,l){var u=Math.PI/2;if(l){var d=Math.min(l,s/2,a/2),m=t+d,p=e+d,D=t+a-d,O=e+s-d;o.moveTo(t,p),m<D&&p<O?(o.arc(m,p,d,-Math.PI,-u),o.arc(D,p,d,-u,0),o.arc(D,O,d,0,u),o.arc(m,O,d,u,Math.PI)):m<D?(o.moveTo(m,e),o.arc(D,p,d,-u,u),o.arc(m,p,d,u,Math.PI+u)):p<O?(o.arc(m,p,d,-Math.PI,0),o.arc(m,O,d,0,Math.PI)):o.arc(m,p,d,-Math.PI,Math.PI),o.closePath(),o.moveTo(t,e)}else o.rect(t,e,a,s)}function fr(o,t,e){var a=e.backgroundColor,s=e.borderColor,l=e.borderWidth;!a&&(!s||!l)||(o.beginPath(),gr(o,Ce(t.x)+l/2,Ce(t.y)+l/2,Ce(t.w)-l,Ce(t.h)-l,e.borderRadius),o.closePath(),a&&(o.fillStyle=a,o.fill()),s&&l&&(o.strokeStyle=s,o.lineWidth=l,o.lineJoin="miter",o.stroke()))}function _r(o,t,e){var a=e.lineHeight,s=o.w,l=o.x,u=o.y+a/2;return t==="center"?l+=s/2:(t==="end"||t==="right")&&(l+=s),{h:a,w:s,x:l,y:u}}function br(o,t,e){var a=o.shadowBlur,s=e.stroked,l=Ce(e.x),u=Ce(e.y),d=Ce(e.w);s&&o.strokeText(t,l,u,d),e.filled&&(a&&s&&(o.shadowBlur=0),o.fillText(t,l,u,d),a&&s&&(o.shadowBlur=a))}function wr(o,t,e,a){var s=a.textAlign,l=a.color,u=!!l,d=a.font,m=t.length,p=a.textStrokeColor,D=a.textStrokeWidth,O=p&&D,Q;if(!(!m||!u&&!O))for(e=_r(e,s,d),o.font=d.string,o.textAlign=s,o.textBaseline="middle",o.shadowBlur=a.textShadowBlur,o.shadowColor=a.textShadowColor,u&&(o.fillStyle=l),O&&(o.lineJoin="round",o.lineWidth=D,o.strokeStyle=p),Q=0,m=t.length;Q<m;++Q)br(o,t[Q],{stroked:O,filled:u,w:e.w,x:e.x,y:e.y+e.h*Q})}var Ot=function(o,t,e,a){var s=this;s._config=o,s._index=a,s._model=null,s._rects=null,s._ctx=t,s._el=e};Ye(Ot.prototype,{_modelize:function(o,t,e,a){var s=this,l=s._index,u=Kt(he([e.font,{}],a,l)),d=he([e.color,Yt.color],a,l);return{align:he([e.align,"center"],a,l),anchor:he([e.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:he([e.backgroundColor,null],a,l),borderColor:he([e.borderColor,null],a,l),borderRadius:he([e.borderRadius,0],a,l),borderWidth:he([e.borderWidth,0],a,l),clamp:he([e.clamp,!1],a,l),clip:he([e.clip,!1],a,l),color:d,display:o,font:u,lines:t,offset:he([e.offset,4],a,l),opacity:he([e.opacity,1],a,l),origin:mr(s._el,a),padding:zt(he([e.padding,4],a,l)),positioner:pr(s._el),rotation:he([e.rotation,0],a,l)*(Math.PI/180),size:Ve.textSize(s._ctx,t,u),textAlign:he([e.textAlign,"start"],a,l),textShadowBlur:he([e.textShadowBlur,0],a,l),textShadowColor:he([e.textShadowColor,d],a,l),textStrokeColor:he([e.textStrokeColor,d],a,l),textStrokeWidth:he([e.textStrokeWidth,0],a,l)}},update:function(o){var t=this,e=null,a=null,s=t._index,l=t._config,u,d,m,p=he([l.display,!0],o,s);p&&(u=o.dataset.data[s],d=Vt(At(l.formatter,[u,o]),u),m=He(d)?[]:Ve.toTextLines(d),m.length&&(e=t._modelize(p,m,l,o),a=yr(e))),t._model=e,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(o,t){var e=this,a=o.ctx,s=e._model,l=e._rects,u;this.visible()&&(a.save(),s.clip&&(u=s.area,a.beginPath(),a.rect(u.left,u.top,u.right-u.left,u.bottom-u.top),a.clip()),a.globalAlpha=Ve.bound(0,s.opacity,1),a.translate(Ce(t.x),Ce(t.y)),a.rotate(s.rotation),fr(a,l.frame,s),wr(a,s.lines,l.text,s),a.restore())}});var Cr=Number.MIN_SAFE_INTEGER||-9007199254740991,Tr=Number.MAX_SAFE_INTEGER||9007199254740991;function Fe(o,t,e){var a=Math.cos(e),s=Math.sin(e),l=t.x,u=t.y;return{x:l+a*(o.x-l)-s*(o.y-u),y:u+s*(o.x-l)+a*(o.y-u)}}function $t(o,t){var e=Tr,a=Cr,s=t.origin,l,u,d,m,p;for(l=0;l<o.length;++l)u=o[l],d=u.x-s.x,m=u.y-s.y,p=t.vx*d+t.vy*m,e=Math.min(e,p),a=Math.max(a,p);return{min:e,max:a}}function Ze(o,t){var e=t.x-o.x,a=t.y-o.y,s=Math.sqrt(e*e+a*a);return{vx:(t.x-o.x)/s,vy:(t.y-o.y)/s,origin:o,ln:s}}var Rt=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};Ye(Rt.prototype,{center:function(){var o=this._rect;return{x:o.x+o.w/2,y:o.y+o.h/2}},update:function(o,t,e){this._rotation=e,this._rect={x:t.x+o.x,y:t.y+o.y,w:t.w,h:t.h}},contains:function(o){var t=this,e=1,a=t._rect;return o=Fe(o,t.center(),-t._rotation),!(o.x<a.x-e||o.y<a.y-e||o.x>a.x+a.w+e*2||o.y>a.y+a.h+e*2)},intersects:function(o){var t=this._points(),e=o._points(),a=[Ze(t[0],t[1]),Ze(t[0],t[3])],s,l,u;for(this._rotation!==o._rotation&&a.push(Ze(e[0],e[1]),Ze(e[0],e[3])),s=0;s<a.length;++s)if(l=$t(t,a[s]),u=$t(e,a[s]),l.max<u.min||u.max<l.min)return!1;return!0},_points:function(){var o=this,t=o._rect,e=o._rotation,a=o.center();return[Fe({x:t.x,y:t.y},a,e),Fe({x:t.x+t.w,y:t.y},a,e),Fe({x:t.x+t.w,y:t.y+t.h},a,e),Fe({x:t.x,y:t.y+t.h},a,e)]}});function Pt(o,t,e){var a=t.positioner(o,t),s=a.vx,l=a.vy;if(!s&&!l)return{x:a.x,y:a.y};var u=e.w,d=e.h,m=t.rotation,p=Math.abs(u/2*Math.cos(m))+Math.abs(d/2*Math.sin(m)),D=Math.abs(u/2*Math.sin(m))+Math.abs(d/2*Math.cos(m)),O=1/Math.max(Math.abs(s),Math.abs(l));return p*=s*O,D*=l*O,p+=t.offset*s,D+=t.offset*l,{x:a.x+p,y:a.y+D}}function $r(o,t){var e,a,s,l;for(e=o.length-1;e>=0;--e)for(s=o[e].$layout,a=e-1;a>=0&&s._visible;--a)l=o[a].$layout,l._visible&&s._box.intersects(l._box)&&t(s,l);return o}function Wr(o){var t,e,a,s,l,u,d;for(t=0,e=o.length;t<e;++t)a=o[t],s=a.$layout,s._visible&&(d=new Proxy(a._el,{get:(m,p)=>m.getProps([p],!0)[p]}),l=a.geometry(),u=Pt(d,a.model(),l),s._box.update(u,l,a.rotation()));return $r(o,function(m,p){var D=m._hidable,O=p._hidable;D&&O||O?p._visible=!1:D&&(m._visible=!1)})}var Ke={prepare:function(o){var t=[],e,a,s,l,u;for(e=0,s=o.length;e<s;++e)for(a=0,l=o[e].length;a<l;++a)u=o[e][a],t.push(u),u.$layout={_box:new Rt,_hidable:!1,_visible:!0,_set:e,_idx:u._index};return t.sort(function(d,m){var p=d.$layout,D=m.$layout;return p._idx===D._idx?D._set-p._set:D._idx-p._idx}),this.update(t),t},update:function(o){var t=!1,e,a,s,l,u;for(e=0,a=o.length;e<a;++e)s=o[e],l=s.model(),u=s.$layout,u._hidable=l&&l.display==="auto",u._visible=s.visible(),t|=u._hidable;t&&Wr(o)},lookup:function(o,t){var e,a;for(e=o.length-1;e>=0;--e)if(a=o[e].$layout,a&&a._visible&&a._box.contains(t))return o[e];return null},draw:function(o,t){var e,a,s,l,u,d;for(e=0,a=t.length;e<a;++e)s=t[e],l=s.$layout,l._visible&&(u=s.geometry(),d=Pt(s._el,s.model(),u),l._box.update(d,u,s.rotation()),s.draw(o,d))}},Ar=function(o){if(He(o))return null;var t=o,e,a,s;if(Xt(o))if(!He(o.label))t=o.label;else if(!He(o.r))t=o.r;else for(t="",e=Object.keys(o),s=0,a=e.length;s<a;++s)t+=(s!==0?", ":"")+e[s]+": "+o[e[s]];return""+t},Dr={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:Ar,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},pe="$datalabels",xt="$default";function Sr(o,t){var e=o.datalabels,a={},s=[],l,u;return e===!1?null:(e===!0&&(e={}),t=Ye({},[t,e]),l=t.labels||{},u=Object.keys(l),delete t.labels,u.length?u.forEach(function(d){l[d]&&s.push(Ye({},[t,l[d],{_key:d}]))}):s.push(t),a=s.reduce(function(d,m){return Jt(m.listeners||{},function(p,D){d[D]=d[D]||{},d[D][m._key||xt]=p}),delete m.listeners,d},{}),{labels:s,listeners:a})}function at(o,t,e,a){if(t){var s=e.$context,l=e.$groups,u;t[l._set]&&(u=t[l._set][l._key],u&&At(u,[s,a])===!0&&(o[pe]._dirty=!0,e.update(s)))}}function Er(o,t,e,a,s){var l,u;!e&&!a||(e?a?e!==a&&(u=l=!0):u=!0:l=!0,u&&at(o,t.leave,e,s),l&&at(o,t.enter,a,s))}function Br(o,t){var e=o[pe],a=e._listeners,s,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Ke.lookup(e._labels,t);else if(t.type!=="mouseout")return;s=e._hovered,e._hovered=l,Er(o,a,s,l,t)}}function Nr(o,t){var e=o[pe],a=e._listeners.click,s=a&&Ke.lookup(e._labels,t);s&&at(o,a,s,t)}var Lt={id:"datalabels",defaults:Dr,beforeInit:function(o){o[pe]={_actives:[]}},beforeUpdate:function(o){var t=o[pe];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(o,t,e){var a=t.index,s=o[pe],l=s._datasets[a]=[],u=o.isDatasetVisible(a),d=o.data.datasets[a],m=Sr(d,e),p=t.meta.data||[],D=o.ctx,O,Q,J,N,B,T,h,c;for(D.save(),O=0,J=p.length;O<J;++O)if(h=p[O],h[pe]=[],u&&h&&o.getDataVisibility(O)&&!h.skip)for(Q=0,N=m.labels.length;Q<N;++Q)B=m.labels[Q],T=B._key,c=new Ot(B,D,h,O),c.$groups={_set:a,_key:T||xt},c.$context={active:!1,chart:o,dataIndex:O,dataset:d,datasetIndex:a},c.update(c.$context),h[pe].push(c),l.push(c);D.restore(),Ye(s._listeners,m.listeners,{merger:function(w,A,I){A[w]=A[w]||{},A[w][t.index]=I[w],s._listened=!0}})},afterUpdate:function(o){o[pe]._labels=Ke.prepare(o[pe]._datasets)},afterDatasetsDraw:function(o){Ke.draw(o,o[pe]._labels)},beforeEvent:function(o,t){if(o[pe]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":Br(o,e);break;case"click":Nr(o,e);break}}},afterEvent:function(o){var t=o[pe],e=t._actives,a=t._actives=o.getActiveElements(),s=Ve.arrayDiff(e,a),l,u,d,m,p,D,O;for(l=0,u=s.length;l<u;++l)if(p=s[l],p[1])for(O=p[0].element[pe]||[],d=0,m=O.length;d<m;++d)D=O[d],D.$context.active=p[1]===1,D.update(D.$context);(t._dirty||s.length)&&(Ke.update(t._labels),o.render()),delete t._dirty}};const Ur={class:"ac-chart"},Ir={class:"ac-chart__header"},Mr={class:"ac-chart__subtitle"},Or={class:"ac-chart__controls"},Rr={class:"chart-type-selector"},Pr=["onClick"],xr={class:"chart-type-icon"},Lr={class:"chart-type-label"},Gr={class:"ac-chart__summary"},Fr={class:"summary-week-block summary-week-block--current"},Hr={class:"summary-week-block__title"},Vr={class:"summary-week-block__title-week"},Kr={key:0,class:"summary-week-block__title-dates"},Yr={class:"summary-week-block__cards"},zr={class:"summary-card__value-wrapper"},jr={class:"summary-card__value"},qr=["title"],Zr={class:"percentage-indicator__arrow"},Xr={class:"percentage-indicator__value"},Jr={class:"percentage-indicator__label"},Qr={class:"summary-card__value-wrapper"},ea={class:"summary-card__value-main"},ta=["title"],ra={class:"percentage-indicator__arrow"},aa={class:"percentage-indicator__value"},sa={class:"percentage-indicator__label"},oa={class:"summary-card__breakdown"},na={class:"breakdown-item breakdown-item--this-week"},la={class:"breakdown-item__value"},ia={class:"breakdown-item breakdown-item--other-week"},ca={class:"breakdown-item__value"},da={class:"summary-card__value-wrapper"},ua={class:"summary-card__value-main"},ka=["title"],va={class:"percentage-indicator__arrow"},ha={class:"percentage-indicator__value"},ya={class:"percentage-indicator__label"},ma={class:"summary-card__breakdown"},pa={class:"breakdown-item breakdown-item--this-week"},ga={class:"breakdown-item__value"},fa={class:"breakdown-item breakdown-item--previous-week"},_a={class:"breakdown-item__value"},ba={class:"breakdown-item breakdown-item--older"},wa={class:"breakdown-item__value"},Ca={class:"summary-card summary-card--stages"},Ta={class:"summary-card__tags"},$a={key:0,class:"stage-tag stage-tag--empty"},Wa={key:0,class:"summary-week-divider"},Aa={key:1,class:"summary-week-block summary-week-block--previous"},Da={class:"summary-week-block__title"},Sa={class:"summary-week-block__title-week"},Ea={key:0,class:"summary-week-block__title-dates"},Ba={class:"summary-week-block__cards"},Na={class:"summary-card__value-wrapper"},Ua={class:"summary-card__values-comparison"},Ia={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Ma={class:"summary-card__value"},Oa={class:"value-label"},Ra={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Pa={class:"summary-card__value summary-card__value--current-week"},xa={class:"value-label"},La=["title"],Ga={class:"percentage-indicator__arrow"},Fa={class:"percentage-indicator__value"},Ha={class:"percentage-indicator__label"},Va={class:"summary-card__value-wrapper"},Ka={class:"summary-card__values-comparison"},Ya={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},za={class:"summary-card__value-main"},ja={class:"value-label"},qa={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Za={class:"summary-card__value-main summary-card__value-main--current-week"},Xa={class:"value-label"},Ja=["title"],Qa={class:"percentage-indicator__arrow"},es={class:"percentage-indicator__value"},ts={class:"percentage-indicator__label"},rs={class:"summary-card__breakdown"},as={class:"breakdown-item breakdown-item--this-week"},ss={class:"breakdown-item__value"},os={class:"breakdown-item breakdown-item--other-week"},ns={class:"breakdown-item__value"},ls={class:"summary-card__value-wrapper"},is={class:"summary-card__values-comparison"},cs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ds={class:"summary-card__value-main"},us={class:"value-label"},ks={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},vs={class:"summary-card__value-main summary-card__value-main--current-week"},hs={class:"value-label"},ys=["title"],ms={class:"percentage-indicator__arrow"},ps={class:"percentage-indicator__value"},gs={class:"percentage-indicator__label"},fs={class:"summary-card__breakdown"},_s={class:"breakdown-item breakdown-item--this-week"},bs={class:"breakdown-item__value"},ws={class:"breakdown-item breakdown-item--previous-week"},Cs={class:"breakdown-item__value"},Ts={class:"breakdown-item breakdown-item--older"},$s={class:"breakdown-item__value"},Ws={class:"summary-card summary-card--stages summary-card--previous"},As={class:"summary-card__tags"},Ds={key:0,class:"stage-tag stage-tag--empty"},Ss={class:"ac-chart__body"},Es={key:0,class:"split-charts-container"},Bs={class:"chart-wrapper chart-wrapper--left"},Ns={class:"chart-canvas-wrapper"},Us={class:"chart-wrapper chart-wrapper--right"},Is={class:"chart-canvas-wrapper"},Ms={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0],carryoverCreatedOtherWeek:[0]},stagesByWeek:[],stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(o,{emit:t}){rt.register(Lt);const e=o,a=t,s=q(()=>{var n;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>=2?k[k.length-2]:null}),l=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],u=Z("line"),d={color:"#111827",font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:k=>{var n;return((n=k==null?void 0:k.dataset)==null?void 0:n.borderColor)||"#111827"},borderWidth:1,borderRadius:4,padding:4,offset:8,formatter:k=>k==null||isNaN(k)?"":h(k),display:k=>{var R,K,P,z;if(((K=(R=k==null?void 0:k.chart)==null?void 0:R.config)==null?void 0:K.type)!=="line")return!1;const E=(z=(P=k==null?void 0:k.dataset)==null?void 0:P.data)==null?void 0:z[k.dataIndex];return E!=null&&!isNaN(E)&&isFinite(E)}};q(()=>{var k;return((k=e.meta)==null?void 0:k.weekNumber)??"‚Äî"});const m=()=>{var n,E;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>0?k.map(R=>`–ù–µ–¥–µ–ª—è ${R.weekNumber}`):[(E=e.meta)!=null&&E.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function p(k,n,E,R=.3,K=0){if(!n)return((f,i)=>{const y=parseInt(f.slice(1,3),16),W=parseInt(f.slice(3,5),16),F=parseInt(f.slice(5,7),16);return`rgba(${y}, ${W}, ${F}, ${i})`})(E,R);const P=(V,f)=>{const i=parseInt(V.slice(1,3),16),y=parseInt(V.slice(3,5),16),W=parseInt(V.slice(5,7),16);return`rgba(${i}, ${y}, ${W}, ${f})`},z=k.createLinearGradient(0,n.bottom,0,n.top);return z.addColorStop(0,P(E,R)),z.addColorStop(1,P(E,K)),z}const D=q(()=>{var P,z,V,f;const k=m(),n=Array.isArray((P=e.data.series)==null?void 0:P.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],E=Array.isArray((z=e.data.series)==null?void 0:z.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],R=Array.isArray((V=e.data.series)==null?void 0:V.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],K=Array.isArray((f=e.data.series)==null?void 0:f.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:k,datasets:[{label:"–ù–æ–≤—ã–µ",data:n,backgroundColor:i=>{const y=i.chart,{ctx:W,chartArea:F}=y;return p(W,F,C.primary)},borderColor:C.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.primary,pointBackgroundColor:C.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:C.primary,borderColor:C.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:E,backgroundColor:i=>{const y=i.chart,{ctx:W,chartArea:F}=y;return p(W,F,C.success)},borderColor:C.success,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.success,pointBackgroundColor:C.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:C.success,borderColor:C.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:R,backgroundColor:C.successLight,borderColor:C.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.successLight,pointBackgroundColor:C.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.successLight,borderColor:C.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:K,backgroundColor:C.warning,borderColor:C.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.warning,borderColor:C.warning}}]}}),O=q(()=>{var P,z,V,f,i;const k=m(),n=Array.isArray((P=e.data.series)==null?void 0:P.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],E=Array.isArray((z=e.data.series)==null?void 0:z.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],R=Array.isArray((V=e.data.series)==null?void 0:V.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],K=Array.isArray((f=e.data.series)==null?void 0:f.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((i=e.data.series)==null?void 0:i.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:k,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:n,backgroundColor:y=>{const W=y.chart,{ctx:F,chartArea:ee}=W;return p(F,ee,C.carryover)},borderColor:C.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryover,pointBackgroundColor:C.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:C.carryover,borderColor:C.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:E,backgroundColor:C.carryoverLight,borderColor:C.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverLight,pointBackgroundColor:C.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverLight,borderColor:C.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:R,backgroundColor:C.warning,borderColor:C.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:K,backgroundColor:C.carryoverDark,borderColor:C.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverDark,pointBackgroundColor:C.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverDark,borderColor:C.carryoverDark}}]}}),Q=q(()=>{var y,W,F,ee,le,oe,se,de,ye,me,ie;const k=((y=e.meta)==null?void 0:y.weeks)||[],n=k.length>0?k.map(be=>`–ù–µ–¥–µ–ª—è ${be.weekNumber}`):[(W=e.meta)!=null&&W.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],E=Array.isArray((F=e.data.series)==null?void 0:F.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],R=Array.isArray((ee=e.data.series)==null?void 0:ee.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],K=Array.isArray((le=e.data.series)==null?void 0:le.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],P=Array.isArray((oe=e.data.series)==null?void 0:oe.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],z=Array.isArray((se=e.data.series)==null?void 0:se.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],V=Array.isArray((de=e.data.series)==null?void 0:de.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],f=Array.isArray((ye=e.data.series)==null?void 0:ye.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],i=Array.isArray((me=e.data.series)==null?void 0:me.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((ie=e.data.series)==null?void 0:ie.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:n,datasets:[{label:"–ù–æ–≤—ã–µ",data:E,backgroundColor:C.primary,borderColor:C.primary,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.primary,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.primary,pointBackgroundColor:C.primary,datalabels:{...d,anchor:"end",align:"top",offset:10,color:C.primary,borderColor:C.primary}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:R,backgroundColor:C.success,borderColor:C.success,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.success,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.success,pointBackgroundColor:C.success,datalabels:{...d,anchor:"start",align:"bottom",offset:10,color:C.success,borderColor:C.success}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:K,backgroundColor:C.successLight,borderColor:C.successLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.successLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.successLight,pointBackgroundColor:C.successLight,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.successLight,borderColor:C.successLight}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:P,backgroundColor:C.warning,borderColor:C.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"bottom",offset:8,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:z,backgroundColor:C.carryover,borderColor:C.carryover,tension:.3,fill:!1,pointRadius:4,pointBorderWidth:1,pointBorderColor:C.carryover,pointHoverRadius:6,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryover,pointBackgroundColor:C.carryover,datalabels:{...d,anchor:"end",align:"top",offset:4,color:C.carryover,borderColor:C.carryover}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:V,backgroundColor:C.carryoverLight,borderColor:C.carryoverLight,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverLight,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverLight,pointBackgroundColor:C.carryoverLight,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverLight,borderColor:C.carryoverLight}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:f,backgroundColor:C.warning,borderColor:C.warning,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.warning,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.warning,pointBackgroundColor:C.warning,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.warning,borderColor:C.warning}},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:i,backgroundColor:C.carryoverDark,borderColor:C.carryoverDark,tension:.3,fill:!1,borderDash:[5,5],pointRadius:3,pointBorderWidth:1,pointBorderColor:C.carryoverDark,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointHoverBackgroundColor:C.carryoverDark,pointBackgroundColor:C.carryoverDark,datalabels:{...d,anchor:"end",align:"top",offset:6,color:C.carryoverDark,borderColor:C.carryoverDark}}]}}),J=q(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[C.primary,C.success,C.carryover],borderWidth:1}]})),N=q(()=>{switch(u.value){case"line":return Pe;case"bar":return ar;case"doughnut":return rr;default:return Pe}}),B=q(()=>u.value==="doughnut"?J.value:Q.value),T=k=>{if(!k)return"‚Äî";try{return new Date(k).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return k}};function h(k){return k==null||isNaN(k)?"0":k>=1e3?k.toLocaleString("ru-RU"):k.toString()}function c(k){const n=k%10,E=k%100;return E>=11&&E<=14?"—Ç–∏–∫–µ—Ç–æ–≤":n===1?"—Ç–∏–∫–µ—Ç":n>=2&&n<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const w=q(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{datalabels:{...d,anchor:"end",align:"top"},tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:k=>{var z,V,f,i,y,W;if(!k||k.length===0)return"";const n=(z=k[0])==null?void 0:z.dataIndex,E=((V=e.meta)==null?void 0:V.weeks)||[];if(E.length>0&&n!==void 0&&E[n]){const F=E[n];return`–ù–µ–¥–µ–ª—è ${F.weekNumber} (${T(F.weekStartUtc)} ‚Äî ${T(F.weekEndUtc)})`}const R=(f=e.meta)==null?void 0:f.weekNumber,K=(i=e.meta)==null?void 0:i.weekStartUtc,P=(y=e.meta)==null?void 0:y.weekEndUtc;return R&&K&&P?`–ù–µ–¥–µ–ª—è ${R} (${T(K)} ‚Äî ${T(P)})`:((W=k[0])==null?void 0:W.label)||""},label:k=>{const n=k.parsed.y,E=k.dataset.label||"";if(n==null||isNaN(n))return`${E}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const R=h(n),K=c(n);return`${E}: ${R} ${K}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:k=>rt.defaults.plugins.legend.labels.generateLabels(k).map((E,R)=>{const K=k.data.datasets[R],P=k.getDatasetMeta(R),z=K.borderDash&&Array.isArray(K.borderDash)&&K.borderDash.length>0||K.borderWidth===2||K.fill===!1;return P.hidden?(E.fontColor="#9ca3af",E.textDecoration="line-through",E.opacity=.5):z?E.fontColor="#6b7280":E.fontColor="#111827",E})},onClick:(k,n)=>{const E=n.datasetIndex;if(E==null){console.warn("[Legend] Invalid datasetIndex:",E);return}const R=k.chart;if(!R){console.warn("[Legend] Chart not found");return}const K=R.getDatasetMeta(E);if(!K){console.warn("[Legend] Dataset meta not found for index:",E);return}K.hidden=!K.hidden,R.update("active")},onHover:(k,n)=>{k.native&&k.native.target&&(k.native.target.style.cursor="pointer")},onLeave:(k,n)=>{k.native&&k.native.target&&(k.native.target.style.cursor="default")}}},scales:u.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:k=>k==null||isNaN(k)?"0":h(k)},title:{display:!1},grid:{color:k=>{if(!k||!k.tick||k.tick.value===void 0)return"#e5e7eb";const n=k.tick.value;return isNaN(n)||!isFinite(n)?"#e5e7eb":n===0||n%5===0?"#d1d5db":"#e5e7eb"},lineWidth:k=>{if(!k||!k.tick||k.tick.value===void 0)return 1;const n=k.tick.value;return isNaN(n)||!isFinite(n)?1:n===0||n%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),A=q(()=>{var k,n,E,R,K,P,z,V;if((k=e.data)!=null&&k.series){const f=e.data.series,i=Math.max((Array.isArray(f.new)?f.new.length:0)-1,(Array.isArray(f.closed)?f.closed.length:0)-1,(Array.isArray(f.closedCreatedThisWeek)?f.closedCreatedThisWeek.length:0)-1,(Array.isArray(f.closedCreatedOtherWeek)?f.closedCreatedOtherWeek.length:0)-1,(Array.isArray(f.carryover)?f.carryover.length:0)-1,(Array.isArray(f.carryoverCreatedThisWeek)?f.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(f.carryoverCreatedPreviousWeek)?f.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(f.carryoverCreatedOlder)?f.carryoverCreatedOlder.length:0)-1,(Array.isArray(f.carryoverCreatedOtherWeek)?f.carryoverCreatedOtherWeek.length:0)-1,-1);if(i>=0){const y={newTickets:Array.isArray(f.new)&&f.new[i]!==void 0?f.new[i]:0,closedTickets:Array.isArray(f.closed)&&f.closed[i]!==void 0?f.closed[i]:0,closedTicketsCreatedThisWeek:Array.isArray(f.closedCreatedThisWeek)&&f.closedCreatedThisWeek[i]!==void 0?f.closedCreatedThisWeek[i]:0,closedTicketsCreatedOtherWeek:Array.isArray(f.closedCreatedOtherWeek)&&f.closedCreatedOtherWeek[i]!==void 0?f.closedCreatedOtherWeek[i]:0,carryoverTickets:Array.isArray(f.carryover)&&f.carryover[i]!==void 0?f.carryover[i]:0,carryoverTicketsCreatedThisWeek:Array.isArray(f.carryoverCreatedThisWeek)&&f.carryoverCreatedThisWeek[i]!==void 0?f.carryoverCreatedThisWeek[i]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(f.carryoverCreatedPreviousWeek)&&f.carryoverCreatedPreviousWeek[i]!==void 0?f.carryoverCreatedPreviousWeek[i]:0,carryoverTicketsCreatedOlder:Array.isArray(f.carryoverCreatedOlder)&&f.carryoverCreatedOlder[i]!==void 0?f.carryoverCreatedOlder[i]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(f.carryoverCreatedOtherWeek)&&f.carryoverCreatedOtherWeek[i]!==void 0?f.carryoverCreatedOtherWeek[i]:0};if(y.carryoverTickets>0&&console.log("[DEBUG currentWeekData]",{total:y.carryoverTickets,thisWeek:y.carryoverTicketsCreatedThisWeek,previousWeek:y.carryoverTicketsCreatedPreviousWeek,older:y.carryoverTicketsCreatedOlder,otherWeek:y.carryoverTicketsCreatedOtherWeek,sum:y.carryoverTicketsCreatedThisWeek+y.carryoverTicketsCreatedPreviousWeek+y.carryoverTicketsCreatedOlder,lastIndex:i,series:{carryoverCreatedPreviousWeek:f.carryoverCreatedPreviousWeek,carryoverCreatedOlder:f.carryoverCreatedOlder,carryoverCreatedPreviousWeekLength:(n=f.carryoverCreatedPreviousWeek)==null?void 0:n.length,carryoverCreatedOlderLength:(E=f.carryoverCreatedOlder)==null?void 0:E.length,carryoverCreatedPreviousWeekLast:(R=f.carryoverCreatedPreviousWeek)==null?void 0:R[i],carryoverCreatedOlderLast:(K=f.carryoverCreatedOlder)==null?void 0:K[i]},currentWeek:e.data.currentWeek,data:{carryoverTicketsCreatedPreviousWeek:e.data.carryoverTicketsCreatedPreviousWeek,carryoverTicketsCreatedOlder:e.data.carryoverTicketsCreatedOlder}}),y.newTickets>0||y.closedTickets>0||y.carryoverTickets>0)return y}}if((P=e.data)!=null&&P.currentWeek&&typeof e.data.currentWeek=="object"){const f=e.data.currentWeek;if((f.newTickets??0)>0||(f.closedTickets??0)>0||(f.carryoverTickets??0)>0)return f}if((z=e.data)!=null&&z.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const f=e.data.weeksData[e.data.weeksData.length-1];if((f.newTickets??0)>0||(f.closedTickets??0)>0||(f.carryoverTickets??0)>0)return f}if((V=e.data)!=null&&V.series){const f=e.data.series,i=Math.max((Array.isArray(f.new)?f.new.length:0)-1,(Array.isArray(f.closed)?f.closed.length:0)-1,(Array.isArray(f.carryover)?f.carryover.length:0)-1,-1);if(i>=0)return{newTickets:Array.isArray(f.new)&&f.new[i]!==void 0?f.new[i]:0,closedTickets:Array.isArray(f.closed)&&f.closed[i]!==void 0?f.closed[i]:0,closedTicketsCreatedThisWeek:Array.isArray(f.closedCreatedThisWeek)&&f.closedCreatedThisWeek[i]!==void 0?f.closedCreatedThisWeek[i]:0,closedTicketsCreatedOtherWeek:Array.isArray(f.closedCreatedOtherWeek)&&f.closedCreatedOtherWeek[i]!==void 0?f.closedCreatedOtherWeek[i]:0,carryoverTickets:Array.isArray(f.carryover)&&f.carryover[i]!==void 0?f.carryover[i]:0,carryoverTicketsCreatedThisWeek:Array.isArray(f.carryoverCreatedThisWeek)&&f.carryoverCreatedThisWeek[i]!==void 0?f.carryoverCreatedThisWeek[i]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(f.carryoverCreatedPreviousWeek)&&f.carryoverCreatedPreviousWeek[i]!==void 0?f.carryoverCreatedPreviousWeek[i]:0,carryoverTicketsCreatedOlder:Array.isArray(f.carryoverCreatedOlder)&&f.carryoverCreatedOlder[i]!==void 0?f.carryoverCreatedOlder[i]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(f.carryoverCreatedOtherWeek)&&f.carryoverCreatedOtherWeek[i]!==void 0?f.carryoverCreatedOtherWeek[i]:0}}return e.data||{}}),I=q(()=>{var n,E,R,K,P,z,V,f,i,y;const k=((n=e.meta)==null?void 0:n.weeks)||[];return k.length>0?k[k.length-1]:{weekNumber:((R=(E=e.meta)==null?void 0:E.currentWeek)==null?void 0:R.weekNumber)??((K=e.meta)==null?void 0:K.weekNumber)??null,weekStartUtc:((z=(P=e.meta)==null?void 0:P.currentWeek)==null?void 0:z.weekStartUtc)??((V=e.meta)==null?void 0:V.weekStartUtc)??null,weekEndUtc:((i=(f=e.meta)==null?void 0:f.currentWeek)==null?void 0:i.weekEndUtc)??((y=e.meta)==null?void 0:y.weekEndUtc)??null}}),S=q(()=>{var k,n,E,R,K,P,z,V,f;if((k=e.data)!=null&&k.series){const i=e.data.series,y=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.closedCreatedThisWeek)?i.closedCreatedThisWeek.length:0)-1,(Array.isArray(i.closedCreatedOtherWeek)?i.closedCreatedOtherWeek.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,(Array.isArray(i.carryoverCreatedThisWeek)?i.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(i.carryoverCreatedPreviousWeek)?i.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(i.carryoverCreatedOlder)?i.carryoverCreatedOlder.length:0)-1,(Array.isArray(i.carryoverCreatedOtherWeek)?i.carryoverCreatedOtherWeek.length:0)-1,-1);if(y>=1){const W=y-1,F=(E=(n=e.meta)==null?void 0:n.weeks)==null?void 0:E[W],ee={weekNumber:(F==null?void 0:F.weekNumber)??null,weekStartUtc:(F==null?void 0:F.weekStartUtc)??null,weekEndUtc:(F==null?void 0:F.weekEndUtc)??null,newTickets:Array.isArray(i.new)&&i.new[W]!==void 0?i.new[W]:0,closedTickets:Array.isArray(i.closed)&&i.closed[W]!==void 0?i.closed[W]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[W]!==void 0?i.closedCreatedThisWeek[W]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[W]!==void 0?i.closedCreatedOtherWeek[W]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[W]!==void 0?i.carryover[W]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[W]!==void 0?i.carryoverCreatedThisWeek[W]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(i.carryoverCreatedPreviousWeek)&&i.carryoverCreatedPreviousWeek[W]!==void 0?i.carryoverCreatedPreviousWeek[W]:0,carryoverTicketsCreatedOlder:Array.isArray(i.carryoverCreatedOlder)&&i.carryoverCreatedOlder[W]!==void 0?i.carryoverCreatedOlder[W]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[W]!==void 0?i.carryoverCreatedOtherWeek[W]:0};if(ee.newTickets>0||ee.closedTickets>0||ee.carryoverTickets>0)return ee}}if((R=e.data)!=null&&R.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const i=e.data.weeksData.length-2,y=e.data.weeksData[i],W=(P=(K=e.meta)==null?void 0:K.weeks)==null?void 0:P[i];if((y.newTickets??0)>0||(y.closedTickets??0)>0||(y.carryoverTickets??0)>0)return{weekNumber:y.weekNumber??(W==null?void 0:W.weekNumber)??null,weekStartUtc:(W==null?void 0:W.weekStartUtc)??null,weekEndUtc:(W==null?void 0:W.weekEndUtc)??null,newTickets:y.newTickets??0,closedTickets:y.closedTickets??0,closedTicketsCreatedThisWeek:y.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:y.closedTicketsCreatedOtherWeek??0,carryoverTickets:y.carryoverTickets??0,carryoverTicketsCreatedThisWeek:y.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:y.carryoverTicketsCreatedOtherWeek??0}}if((z=e.data)!=null&&z.series){const i=e.data.series,y=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,-1);if(y>=1){const W=y-1,F=(f=(V=e.meta)==null?void 0:V.weeks)==null?void 0:f[W];return{weekNumber:(F==null?void 0:F.weekNumber)??null,weekStartUtc:(F==null?void 0:F.weekStartUtc)??null,weekEndUtc:(F==null?void 0:F.weekEndUtc)??null,newTickets:Array.isArray(i.new)&&i.new[W]!==void 0?i.new[W]:0,closedTickets:Array.isArray(i.closed)&&i.closed[W]!==void 0?i.closed[W]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[W]!==void 0?i.closedCreatedThisWeek[W]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[W]!==void 0?i.closedCreatedOtherWeek[W]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[W]!==void 0?i.carryover[W]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[W]!==void 0?i.carryoverCreatedThisWeek[W]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(i.carryoverCreatedPreviousWeek)&&i.carryoverCreatedPreviousWeek[W]!==void 0?i.carryoverCreatedPreviousWeek[W]:0,carryoverTicketsCreatedOlder:Array.isArray(i.carryoverCreatedOlder)&&i.carryoverCreatedOlder[W]!==void 0?i.carryoverCreatedOlder[W]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[W]!==void 0?i.carryoverCreatedOtherWeek[W]:0}}}return null}),G=q(()=>{var n;const k=(n=e.data)==null?void 0:n.stagesByWeek;return Array.isArray(k)?k:null}),U=q(()=>{var n;const k=G.value;if(k&&k.length>0){const E=k.length-1,R=k[E];if(Array.isArray(R))return R}return((n=e.data)==null?void 0:n.stages)??[]}),M=q(()=>{const k=G.value;if(k&&k.length>=2){const n=k.length-2,E=k[n];if(Array.isArray(E))return E}return[]}),H=q(()=>{var k;return(k=S.value)!=null&&k.weekNumber?`–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –Ω–µ–¥–µ–ª–∏ ${S.value.weekNumber}`:"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"});function Y(k,n){if(typeof k!="number"||isNaN(k)||n==null||typeof n!="number"||isNaN(n)||n===0)return null;if(k===n)return 0;const E=(k-n)/n*100;return!isFinite(E)||isNaN(E)?null:E}function x(k){return k==null||isNaN(k)?"":`${k>=0?"+":""}${k.toFixed(1)}%`}const X=q(()=>{var k,n,E;if((k=e.data)!=null&&k.series){const R=e.data.series,K=Math.max((Array.isArray(R.new)?R.new.length:0)-1,(Array.isArray(R.closed)?R.closed.length:0)-1,(Array.isArray(R.carryover)?R.carryover.length:0)-1,-1);if(K>=2){const P=K-2,z=(E=(n=e.meta)==null?void 0:n.weeks)==null?void 0:E[P];return{weekNumber:(z==null?void 0:z.weekNumber)??null,newTickets:Array.isArray(R.new)&&R.new[P]!==void 0?R.new[P]:0,closedTickets:Array.isArray(R.closed)&&R.closed[P]!==void 0?R.closed[P]:0,carryoverTickets:Array.isArray(R.carryover)&&R.carryover[P]!==void 0?R.carryover[P]:0}}}return null}),b=q(()=>{const k=A.value,n=S.value;return!k||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:Y(k.newTickets??0,n.newTickets??0),closedTickets:Y(k.closedTickets??0,n.closedTickets??0),carryoverTickets:Y(k.carryoverTickets??0,n.carryoverTickets??0)}}),v=q(()=>{const k=S.value,n=X.value;return!k||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:Y(k.newTickets??0,n.newTickets??0),closedTickets:Y(k.closedTickets??0,n.closedTickets??0),carryoverTickets:Y(k.carryoverTickets??0,n.carryoverTickets??0)}});function L(k,n){if(!k||!n)return"";try{const E=new Date(k),R=new Date(n),K=E.getUTCDate(),P=E.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),z=E.getUTCFullYear(),V=R.getUTCDate(),f=R.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),i=R.getUTCFullYear();return z===i&&P===f?`${K} ‚Äî ${V} ${P}`:z===i?`${K} ${P} ‚Äî ${V} ${f}`:`${K} ${P} ${z} ‚Äî ${V} ${f} ${i}`}catch(E){return console.error("[formatWeekDates] Error:",E),""}}const j=k=>{const n=A.value,E=(n==null?void 0:n.newTickets)??0,R=(n==null?void 0:n.closedTickets)??0,K=(n==null?void 0:n.carryoverTickets)??0,P=I.value;k==="new"&&E>0?a("open-stages",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="closed"&&R>0?a("open-responsible",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="carryover"&&K>0&&a("open-carryover",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc})},ae=k=>{const n=S.value;if(!n)return;const E=(n==null?void 0:n.newTickets)??0,R=(n==null?void 0:n.closedTickets)??0,K=(n==null?void 0:n.carryoverTickets)??0,P=s.value;P&&(k==="new"&&E>0?a("open-stages",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="closed"&&R>0?a("open-responsible",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}):k==="carryover"&&K>0&&a("open-carryover",{weekNumber:P.weekNumber,weekStartUtc:P.weekStartUtc,weekEndUtc:P.weekEndUtc}))};return(k,n)=>{var E,R,K,P,z,V,f,i,y,W,F,ee,le,oe,se,de,ye,me,ie,be,Ae,De,Se,Ee,Be,Ne,Ue,Ie,Me,xe,Le,Ge,lt,it,ct,dt,ut,kt,vt,ht,yt,mt,pt,gt,ft,_t;return g(),_("div",Ur,[r("header",Ir,[r("div",null,[n[6]||(n[6]=r("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),r("p",Mr," –ù–µ–¥–µ–ª—è "+$(((R=(E=o.meta)==null?void 0:E.currentWeek)==null?void 0:R.weekNumber)??((K=o.meta)==null?void 0:K.weekNumber)??"‚Äî")+" ¬∑ "+$((((z=(P=o.meta)==null?void 0:P.currentWeek)==null?void 0:z.weekStartUtc)??((V=o.meta)==null?void 0:V.weekStartUtc))||"‚Äî")+" ‚Äî "+$((((i=(f=o.meta)==null?void 0:f.currentWeek)==null?void 0:i.weekEndUtc)??((y=o.meta)==null?void 0:y.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),r("div",Or,[r("div",Rr,[(g(),_(ne,null,ce(l,ve=>r("button",{key:ve.value,class:ke(["chart-type-btn",{active:u.value===ve.value}]),onClick:vc=>u.value=ve.value},[r("span",xr,$(ve.icon),1),r("span",Lr,$(ve.label),1)],10,Pr)),64))])])]),r("section",Gr,[r("div",Fr,[r("h3",Hr,[n[7]||(n[7]=r("span",{class:"summary-week-block__title-text"},"–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Vr," –ù–µ–¥–µ–ª—è "+$(I.value.weekNumber??"‚Äî"),1),I.value.weekStartUtc?(g(),_("span",Kr,$(L(I.value.weekStartUtc,I.value.weekEndUtc)),1)):te("",!0)]),r("div",Yr,[r("div",{class:"summary-card summary-card--new",onClick:n[0]||(n[0]=ve=>j("new"))},[n[8]||(n[8]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",zr,[r("div",jr,$(((W=A.value)==null?void 0:W.newTickets)??0),1),b.value.newTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",b.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((F=S.value)==null?void 0:F.weekNumber)??"‚Äî"}): ${x(b.value.newTickets)}`},[r("span",Zr,$(b.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",Xr,$(x(b.value.newTickets)),1),r("span",Jr,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((ee=S.value)==null?void 0:ee.weekNumber)??"‚Äî"),1)],10,qr)):te("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown",onClick:n[1]||(n[1]=ve=>j("closed"))},[n[13]||(n[13]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Qr,[r("div",ea,$(((le=A.value)==null?void 0:le.closedTickets)??0),1),b.value.closedTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",b.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((oe=S.value)==null?void 0:oe.weekNumber)??"‚Äî"}): ${x(b.value.closedTickets)}`},[r("span",ra,$(b.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",aa,$(x(b.value.closedTickets)),1),r("span",sa,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((se=S.value)==null?void 0:se.weekNumber)??"‚Äî"),1)],10,ta)):te("",!0)]),r("div",oa,[r("div",na,[n[9]||(n[9]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",la,$(((de=A.value)==null?void 0:de.closedTicketsCreatedThisWeek)??0),1),n[10]||(n[10]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",ia,[n[11]||(n[11]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ca,$(((ye=A.value)==null?void 0:ye.closedTicketsCreatedOtherWeek)??0),1),n[12]||(n[12]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown",onClick:n[2]||(n[2]=ve=>j("carryover"))},[n[20]||(n[20]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",da,[r("div",ua,$(((me=A.value)==null?void 0:me.carryoverTickets)??0),1),b.value.carryoverTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",b.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ie=S.value)==null?void 0:ie.weekNumber)??"‚Äî"}): ${x(b.value.carryoverTickets)}`},[r("span",va,$(b.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",ha,$(x(b.value.carryoverTickets)),1),r("span",ya,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((be=S.value)==null?void 0:be.weekNumber)??"‚Äî"),1)],10,ka)):te("",!0)]),r("div",ma,[r("div",pa,[n[14]||(n[14]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",ga,$(((Ae=A.value)==null?void 0:Ae.carryoverTicketsCreatedThisWeek)??0),1),n[15]||(n[15]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",fa,[n[16]||(n[16]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",_a,$(((De=A.value)==null?void 0:De.carryoverTicketsCreatedPreviousWeek)??0),1),n[17]||(n[17]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",ba,[n[18]||(n[18]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",wa,$(((Se=A.value)==null?void 0:Se.carryoverTicketsCreatedOlder)??0),1),n[19]||(n[19]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",Ca,[n[21]||(n[21]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",Ta,[(g(!0),_(ne,null,ce(U.value,ve=>(g(),_("span",{key:ve.stageId,class:"stage-tag"},$(ve.stageName||ve.stageId)+" ‚Äî "+$(ve.count),1))),128)),!U.value||U.value.length===0?(g(),_("span",$a," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):te("",!0)])])])]),S.value?(g(),_("div",Wa,[...n[22]||(n[22]=[r("div",{class:"summary-week-divider__line"},null,-1),r("div",{class:"summary-week-divider__label"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)])])):te("",!0),S.value?(g(),_("div",Aa,[r("h3",Da,[n[23]||(n[23]=r("span",{class:"summary-week-block__title-text"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),r("span",Sa," –ù–µ–¥–µ–ª—è "+$(S.value.weekNumber??"‚Äî"),1),S.value.weekStartUtc?(g(),_("span",Ea,$(L(S.value.weekStartUtc,S.value.weekEndUtc)),1)):te("",!0)]),r("div",Ba,[r("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:n[3]||(n[3]=ve=>ae("new"))},[n[24]||(n[24]=r("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Na,[r("div",Ua,[r("div",Ia,[r("div",Ma,$(((Ee=S.value)==null?void 0:Ee.newTickets)??0),1),r("span",Oa,"–ù–µ–¥–µ–ª—è "+$(((Be=S.value)==null?void 0:Be.weekNumber)??"‚Äî"),1)]),r("div",Ra,[r("div",Pa,$(((Ne=X.value)==null?void 0:Ne.newTickets)??0),1),r("span",xa,"–ù–µ–¥–µ–ª—è "+$(((Ue=X.value)==null?void 0:Ue.weekNumber)??"‚Äî"),1)])]),v.value.newTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",v.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Ie=X.value)==null?void 0:Ie.weekNumber)??"‚Äî"}): ${x(v.value.newTickets)}`},[r("span",Ga,$(v.value.newTickets>=0?"‚Üë":"‚Üì"),1),r("span",Fa,$(x(v.value.newTickets)),1),r("span",Ha,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((Me=X.value)==null?void 0:Me.weekNumber)??"‚Äî"),1)],10,La)):te("",!0)])]),r("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:n[4]||(n[4]=ve=>ae("closed"))},[n[29]||(n[29]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("div",Va,[r("div",Ka,[r("div",Ya,[r("div",za,$(((xe=S.value)==null?void 0:xe.closedTickets)??0),1),r("span",ja,"–ù–µ–¥–µ–ª—è "+$(((Le=S.value)==null?void 0:Le.weekNumber)??"‚Äî"),1)]),r("div",qa,[r("div",Za,$(((Ge=X.value)==null?void 0:Ge.closedTickets)??0),1),r("span",Xa,"–ù–µ–¥–µ–ª—è "+$(((lt=X.value)==null?void 0:lt.weekNumber)??"‚Äî"),1)])]),v.value.closedTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",v.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((it=X.value)==null?void 0:it.weekNumber)??"‚Äî"}): ${x(v.value.closedTickets)}`},[r("span",Qa,$(v.value.closedTickets>=0?"‚Üë":"‚Üì"),1),r("span",es,$(x(v.value.closedTickets)),1),r("span",ts,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((ct=X.value)==null?void 0:ct.weekNumber)??"‚Äî"),1)],10,Ja)):te("",!0)]),r("div",rs,[r("div",as,[n[25]||(n[25]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",ss,$(((dt=S.value)==null?void 0:dt.closedTicketsCreatedThisWeek)??0),1),n[26]||(n[26]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),r("div",os,[n[27]||(n[27]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",ns,$(((ut=S.value)==null?void 0:ut.closedTicketsCreatedOtherWeek)??0),1),n[28]||(n[28]=r("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),r("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:n[5]||(n[5]=ve=>ae("carryover"))},[n[36]||(n[36]=r("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),r("div",ls,[r("div",is,[r("div",cs,[r("div",ds,$(((kt=S.value)==null?void 0:kt.carryoverTickets)??0),1),r("span",us,"–ù–µ–¥–µ–ª—è "+$(((vt=S.value)==null?void 0:vt.weekNumber)??"‚Äî"),1)]),r("div",ks,[r("div",vs,$(((ht=X.value)==null?void 0:ht.carryoverTickets)??0),1),r("span",hs,"–ù–µ–¥–µ–ª—è "+$(((yt=X.value)==null?void 0:yt.weekNumber)??"‚Äî"),1)])]),v.value.carryoverTickets!==null?(g(),_("div",{key:0,class:ke(["percentage-indicator",v.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((mt=X.value)==null?void 0:mt.weekNumber)??"‚Äî"}): ${x(v.value.carryoverTickets)}`},[r("span",ms,$(v.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),r("span",ps,$(x(v.value.carryoverTickets)),1),r("span",gs,"–∫ –Ω–µ–¥–µ–ª–µ "+$(((pt=X.value)==null?void 0:pt.weekNumber)??"‚Äî"),1)],10,ys)):te("",!0)]),r("div",fs,[r("div",_s,[n[30]||(n[30]=r("span",{class:"breakdown-item__icon"},"‚úì",-1)),r("span",bs,$(((gt=S.value)==null?void 0:gt.carryoverTicketsCreatedThisWeek)??0),1),n[31]||(n[31]=r("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",ws,[n[32]||(n[32]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",Cs,$(((ft=S.value)==null?void 0:ft.carryoverTicketsCreatedPreviousWeek)??0),1),n[33]||(n[33]=r("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),r("div",Ts,[n[34]||(n[34]=r("span",{class:"breakdown-item__icon"},"‚Üª",-1)),r("span",$s,$(((_t=S.value)==null?void 0:_t.carryoverTicketsCreatedOlder)??0),1),n[35]||(n[35]=r("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),r("div",Ws,[n[37]||(n[37]=r("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",As,[(g(!0),_(ne,null,ce(M.value,ve=>(g(),_("span",{key:ve.stageId,class:"stage-tag"},$(ve.stageName||ve.stageId)+" ‚Äî "+$(ve.count),1))),128)),!M.value||M.value.length===0?(g(),_("span",Ds,$(H.value),1)):te("",!0)])])])])):te("",!0)]),r("div",Ss,[u.value==="line"?(g(),_("div",Es,[r("div",Bs,[n[38]||(n[38]=r("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Ns,[re(Xe(Pe),{data:D.value,options:w.value},null,8,["data","options"])])]),r("div",Us,[n[39]||(n[39]=r("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),r("div",Is,[re(Xe(Pe),{data:O.value,options:w.value},null,8,["data","options"])])])])):(g(),_e(Qt(N.value),{key:1,data:B.value,options:w.value},null,8,["data","options"]))])])}}},Os=we(Ms,[["__scopeId","data-v-3666e13a"]]),Rs={class:"summary-cards-months"},Ps={class:"summary-card summary-card--new"},xs={class:"card-content"},Ls={class:"card-main-value"},Gs=["title"],Fs={class:"card-month-breakdown"},Hs={class:"month-name"},Vs={class:"month-value"},Ks={key:0,class:"month-item month-item--empty"},Ys={class:"summary-card summary-card--closed"},zs={class:"card-content"},js={class:"card-main-value"},qs=["title"],Zs={class:"card-month-breakdown-hierarchical"},Xs={class:"month-header"},Js={class:"month-name"},Qs={class:"month-value"},eo={class:"month-breakdown"},to={class:"breakdown-item breakdown-this-week"},ro={class:"breakdown-value"},ao={class:"breakdown-item breakdown-other-week"},so={class:"breakdown-value"},oo={key:0,class:"month-item-hierarchical month-item--empty"},no={class:"summary-card summary-card--carryover"},lo={class:"card-content"},io={class:"card-current-value"},co={class:"current-value"},uo=["title"],ko={class:"card-month-breakdown"},vo={class:"month-name"},ho={class:"month-value"},yo={key:0,class:"month-item month-item--empty"},mo={class:"summary-card summary-card--stages"},po={class:"card-content"},go={class:"stages-list"},fo={class:"stage-icon"},_o={class:"stage-name"},bo={class:"stage-value"},wo={key:0,class:"stage-item stage-item--empty"},Co={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(o){const t=o;function e(T){return T==null||isNaN(T)?"0":T>=1e6?(T/1e6).toFixed(1)+"M":T>=1e3?T.toLocaleString("ru-RU"):T.toString()}function a(T){return T==null||isNaN(T)?"":`${T>=0?"+":""}${T.toFixed(1)}%`}function s(T,h){if(typeof T!="number"||isNaN(T)||h==null||typeof h!="number"||isNaN(h)||h===0)return null;if(T===h)return 0;const c=(T-h)/h*100;return!isFinite(c)||isNaN(c)?null:c}const l=q(()=>{var T;return((T=t.data)==null?void 0:T.newTickets)||0}),u=q(()=>e(l.value)),d=q(()=>{var T;return((T=t.data)==null?void 0:T.newTicketsByMonth)||[]}),m=q(()=>{var T;return((T=t.data)==null?void 0:T.closedTicketsByMonth)||[]}),p=q(()=>{var T;return((T=t.data)==null?void 0:T.carryoverTicketsByMonth)||[]}),D=q(()=>{const T=p.value;if(T.length===0)return 0;const h=T[T.length-1];return(h==null?void 0:h.count)||0}),O=q(()=>{var c,w,A,I;const T=typeof((c=t.data)==null?void 0:c.newTickets)=="number"?t.data.newTickets:parseInt((w=t.data)==null?void 0:w.newTickets)||0,h=(I=(A=t.data)==null?void 0:A.previousPeriodData)==null?void 0:I.newTickets;return s(T,h)}),Q=q(()=>{var c,w,A,I;const T=typeof((c=t.data)==null?void 0:c.closedTickets)=="number"?t.data.closedTickets:parseInt((w=t.data)==null?void 0:w.closedTickets)||0,h=(I=(A=t.data)==null?void 0:A.previousPeriodData)==null?void 0:I.closedTickets;return s(T,h)}),J=q(()=>{var w;const T=D.value,h=p.value,c=h.length>0?((w=h[0])==null?void 0:w.count)||0:null;return s(T,c)});function N(T){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[T]||""}function B(T){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[T]||"‚Ä¢"}return(T,h)=>(g(),_("div",Rs,[r("div",Ps,[h[0]||(h[0]=r("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),r("div",xs,[r("div",Ls,[fe($(u.value)+" ",1),O.value!==null?(g(),_("span",{key:0,class:ke(["percentage-badge",O.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(O.value)}`},$(a(O.value)),11,Gs)):te("",!0)]),r("div",Fs,[(g(!0),_(ne,null,ce(d.value,c=>(g(),_("div",{key:`new-${c.month}`,class:"month-item"},[r("span",Hs,$(c.monthName)+":",1),r("span",Vs,$(e(c.count)),1)]))),128)),d.value.length===0?(g(),_("div",Ks," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):te("",!0)])])]),r("div",Ys,[h[5]||(h[5]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),r("div",zs,[r("div",js,[fe($(e(o.data.closedTickets||0))+" ",1),Q.value!==null?(g(),_("span",{key:0,class:ke(["percentage-badge",Q.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(Q.value)}`},$(a(Q.value)),11,qs)):te("",!0)]),r("div",Zs,[(g(!0),_(ne,null,ce(m.value,c=>(g(),_("div",{key:`closed-${c.month}`,class:"month-item-hierarchical"},[r("div",Xs,[r("span",Js,$(c.monthName)+":",1),r("span",Qs,$(e(c.count||0)),1)]),r("div",eo,[r("div",to,[h[1]||(h[1]=r("span",{class:"breakdown-icon"},"‚úì",-1)),h[2]||(h[2]=r("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",ro,$(e(c.closedCreatedThisWeek||0)),1)]),r("div",ao,[h[3]||(h[3]=r("span",{class:"breakdown-icon"},"‚Üª",-1)),h[4]||(h[4]=r("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),r("span",so,$(e(c.closedCreatedOtherWeek||0)),1)])])]))),128)),m.value.length===0?(g(),_("div",oo," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):te("",!0)])])]),r("div",no,[h[7]||(h[7]=r("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),h[8]||(h[8]=r("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),r("div",lo,[r("div",io,[h[6]||(h[6]=r("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),r("span",co,[fe($(e(D.value))+" ",1),J.value!==null?(g(),_("span",{key:0,class:ke(["percentage-badge",J.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(J.value)}`},$(a(J.value)),11,uo)):te("",!0)])]),r("div",ko,[(g(!0),_(ne,null,ce(p.value,c=>(g(),_("div",{key:`carryover-${c.month}`,class:"month-item"},[r("span",vo,$(c.monthName)+":",1),r("span",ho,$(e(c.count||0)),1)]))),128)),p.value.length===0?(g(),_("div",yo," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):te("",!0)])])]),r("div",mo,[h[10]||(h[10]=r("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r("div",po,[r("div",go,[(g(!0),_(ne,null,ce(o.data.stages||[],c=>(g(),_("div",{key:c.stageId,class:ke(["stage-item",N(c.stageId)])},[r("span",fo,$(B(c.stageId)),1),r("span",_o,$(c.stageName||c.stageId)+":",1),r("span",bo,$(e(c.count||0)),1)],2))),128)),!o.data.stages||o.data.stages.length===0?(g(),_("div",wo,[...h[9]||(h[9]=[r("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):te("",!0)])])])]))}},To=we(Co,[["__scopeId","data-v-15d88b90"]]),$o={class:"line-chart-months"},Wo={class:"chart-section"},Ao={class:"chart-title"},Do={key:0,class:"chart-period"},So={class:"chart-wrapper"},Eo={class:"chart-container"},Bo={class:"chart-summary"},No={class:"summary-numbers"},Uo={class:"summary-row"},Io={class:"summary-values"},Mo={class:"summary-row"},Oo={class:"summary-values"},Ro={class:"summary-analysis"},Po=["innerHTML"],xo={class:"chart-section"},Lo={class:"chart-title"},Go={key:0,class:"chart-period"},Fo={class:"chart-wrapper"},Ho={class:"chart-container"},Vo={class:"chart-analysis"},Ko={class:"analysis-content"},Yo=["innerHTML"],zo={class:"chart-table-section"},jo={class:"chart-table-wrapper"},qo={class:"data-table"},Zo={class:"data-row data-row--new"},Xo={class:"data-row data-row--closed"},Jo={class:"data-row data-row--carryover"},Qo={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(o){rt.register(Lt);const t=o;function e(N){return N==null||isNaN(N)?"0":N>=1e3?N.toLocaleString("ru-RU"):N.toString()}const a=q(()=>{var B,T,h;const N=new Set;return(B=t.data.newTicketsByMonth)==null||B.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),(T=t.data.closedTicketsByMonth)==null||T.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),(h=t.data.carryoverTicketsByMonth)==null||h.forEach(c=>{c.weeks&&Array.isArray(c.weeks)&&c.weeks.forEach(w=>{w&&w.weekNumber&&N.add(w.weekNumber)})}),Array.from(N).sort((c,w)=>c-w)}),s=q(()=>{const N=t.data.newTicketsByMonth||[],B=N.map(c=>c.monthName||`–ú–µ—Å—è—Ü ${c.month}`),T=N.map(c=>c.count||0),h=(t.data.closedTicketsByMonth||[]).map(c=>c.count||0);return{labels:B,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:C.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:C.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:C.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:h,borderColor:C.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:C.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:C.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=q(()=>{const N=t.data.carryoverTicketsByMonth||[],B=N.map(h=>h.monthName||`–ú–µ—Å—è—Ü ${h.month}`),T=N.map(h=>h.count||0);return{labels:B,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:T,borderColor:C.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:C.carryover}}]}}),u={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(N,B)=>N==null||isNaN(N)?"":N.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(N){const B=N.dataset.data[N.dataIndex];return B!=null&&!isNaN(B)&&isFinite(B)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function d(N){if(!N||N.length===0)return null;const B=N[0],T=N[N.length-1];if(!B||!T)return null;const h=B.monthName||`–ú–µ—Å—è—Ü ${B.month}`,c=T.monthName||`–ú–µ—Å—è—Ü ${T.month}`,w=B.year||new Date().getFullYear();return`${h} ‚Äî ${c} ${w}`}const m=q(()=>{var N;return d(((N=t.data)==null?void 0:N.newTicketsByMonth)||[])}),p=q(()=>{var N;return d(((N=t.data)==null?void 0:N.carryoverTicketsByMonth)||[])}),D=q(()=>{var c,w;const N=((c=t.data)==null?void 0:c.newTicketsByMonth)||[],B=((w=t.data)==null?void 0:w.closedTicketsByMonth)||[];if(N.length===0)return{new:"‚Äî",closed:"‚Äî"};const T=N.map(A=>`${e(A.count||0)} (${A.monthName||A.month})`).join(" ‚Üí "),h=B.map(A=>`${e(A.count||0)} (${A.monthName||A.month})`).join(" ‚Üí ");return{new:T,closed:h}}),O=q(()=>{var w,A;const N=((w=t.data)==null?void 0:w.newTicketsByMonth)||[],B=((A=t.data)==null?void 0:A.closedTicketsByMonth)||[];if(N.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const T=[],h=[],c=[];if(N.length>=2){const I=N[0],S=N[1],G=N[2];if(S&&I&&typeof I.count=="number"&&typeof S.count=="number"){const U=I.monthName||I.month,M=S.monthName||S.month,H=e(I.count||0),Y=e(S.count||0);if(I.count>0){const x=(S.count-I.count)/I.count*100;if(isFinite(x)&&!isNaN(x)){const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",b=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",j=x>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${U}) –¥–æ ${Y} (${M}) ‚Äî <span style="color: ${j}; font-weight: 600;">${v}${b.toFixed(1)}%</span>`)}}else I.count===0&&S.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${Y} (${M})`)}if(G&&S&&typeof S.count=="number"&&typeof G.count=="number"){const U=S.monthName||S.month,M=G.monthName||G.month,H=e(S.count||0),Y=e(G.count||0);if(S.count>0){const x=(G.count-S.count)/S.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${U}) ‚Üí ${Y} (${M}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",b=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",j=x>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${U}) –¥–æ ${Y} (${M}) ‚Äî <span style="color: ${j}; font-weight: 600;">${v}${b.toFixed(1)}%</span>`)}}else S.count===0&&G.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${Y} (${M})`)}}if(B.length>=2){const I=B[0],S=B[1],G=B[2];if(S&&I&&typeof I.count=="number"&&typeof S.count=="number"){const U=I.monthName||I.month,M=S.monthName||S.month,H=e(I.count||0),Y=e(S.count||0);if(I.count>0){const x=(S.count-I.count)/I.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)c.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${U}) ‚Üí ${Y} (${M}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",b=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",j=x>=0?"#28a745":"#dc3545";c.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${U}) –¥–æ ${Y} (${M}) ‚Äî <span style="color: ${j}; font-weight: 600;">${v}${b.toFixed(1)}%</span>`)}}else I.count===0&&S.count>0&&c.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${U}) –¥–æ ${Y} (${M})`)}if(G&&S&&typeof S.count=="number"&&typeof G.count=="number"){const U=S.monthName||S.month,M=G.monthName||G.month,H=e(S.count||0),Y=e(G.count||0);if(S.count>0){const x=(G.count-S.count)/S.count*100;if(isFinite(x)&&!isNaN(x))if(Math.abs(x)<.1)c.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${H} (${U}) ‚Üí ${Y} (${M}) ‚Äî 0.0%`);else{const X=x>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",b=Math.abs(x),v=x>=0?"+":"-",L=x>=0?"#28a745":"#dc3545",j=x>=0?"#28a745":"#dc3545";c.push(`  ‚Ä¢ <span style="color: ${L}; font-weight: 600;">${X}</span> —Å ${H} (${U}) –¥–æ ${Y} (${M}) ‚Äî <span style="color: ${j}; font-weight: 600;">${v}${b.toFixed(1)}%</span>`)}}else S.count===0&&G.count>0&&c.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${U}) –¥–æ ${Y} (${M})`)}}if(h.length>0&&(T.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...h)),c.length>0&&(T.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),T.push(...c)),N.length>=3&&B.length>=3){const I=N[0],S=N[N.length-1],G=B[0],U=B[B.length-1],M=I.count||0,H=S.count||0,Y=G.count||0,x=U.count||0;if(M>0&&Y>0){const X=(H-M)/M*100,b=(x-Y)/Y*100;if(isFinite(X)&&isFinite(b)){const v=I.monthName||I.month,L=S.monthName||S.month,j=G.monthName||G.month,ae=U.monthName||U.month,k=X>=0?"#28a745":"#dc3545",n=X>=0?"#28a745":"#dc3545",E=b>=0?"#28a745":"#dc3545",R=b>=0?"#28a745":"#dc3545";T.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),T.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${k}; font-weight: 600;">${X>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(M)} (${v}) –¥–æ ${e(H)} (${L}) ‚Äî <span style="color: ${n}; font-weight: 600;">${X>=0?"+":"-"}${Math.abs(X).toFixed(1)}%</span>`),T.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${E}; font-weight: 600;">${b>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(Y)} (${j}) –¥–æ ${e(x)} (${ae}) ‚Äî <span style="color: ${R}; font-weight: 600;">${b>=0?"+":"-"}${Math.abs(b).toFixed(1)}%</span>`)}}}return T.length>0?T:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),Q=q(()=>{var c;const N=((c=t.data)==null?void 0:c.carryoverTicketsByMonth)||[];if(N.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const B=[],T=[],h=N.filter(w=>w&&typeof w.count=="number").map(w=>`${e(w.count||0)} (${w.monthName||w.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(h&&B.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${h}`),N.length>=2){const w=N[0],A=N[1],I=N[2];if(A&&w&&typeof w.count=="number"&&typeof A.count=="number"){const S=w.monthName||w.month,G=A.monthName||A.month,U=e(w.count||0),M=e(A.count||0);if(w.count>0){const H=(A.count-w.count)/w.count*100;if(isFinite(H)&&!isNaN(H))if(Math.abs(H)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${U} (${S}) ‚Üí ${M} (${G}) ‚Äî 0.0%`);else{const Y=H>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(H),X=H>=0?"+":"-",b=H>=0?"#28a745":"#dc3545",v=H>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${b}; font-weight: 600;">${Y}</span> —Å ${U} (${S}) –¥–æ ${M} (${G}) ‚Äî <span style="color: ${v}; font-weight: 600;">${X}${x.toFixed(1)}%</span>`)}}else w.count===0&&A.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${S}) –¥–æ ${M} (${G})`)}if(I&&A&&typeof A.count=="number"&&typeof I.count=="number"){const S=A.monthName||A.month,G=I.monthName||I.month,U=e(A.count||0),M=e(I.count||0);if(A.count>0){const H=(I.count-A.count)/A.count*100;if(isFinite(H)&&!isNaN(H))if(Math.abs(H)<.1)T.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${U} (${S}) ‚Üí ${M} (${G}) ‚Äî 0.0%`);else{const Y=H>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(H),X=H>=0?"+":"-",b=H>=0?"#28a745":"#dc3545",v=H>=0?"#28a745":"#dc3545";T.push(`  ‚Ä¢ <span style="color: ${b}; font-weight: 600;">${Y}</span> —Å ${U} (${S}) –¥–æ ${M} (${G}) ‚Äî <span style="color: ${v}; font-weight: 600;">${X}${x.toFixed(1)}%</span>`)}}else A.count===0&&I.count>0&&T.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${S}) –¥–æ ${M} (${G})`)}}if(T.length>0&&(B.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),B.push(...T)),N.length>=3){const w=N[0],A=N[N.length-1];if(w&&A&&typeof w.count=="number"&&typeof A.count=="number"){const I=w.count||0,S=A.count||0,G=w.monthName||w.month,U=A.monthName||A.month,M=e(I),H=e(S);if(I>0){const Y=(S-I)/I*100;if(isFinite(Y)&&!isNaN(Y))if(Math.abs(Y)<1)B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${M} (${G}) ‚Üí ${H} (${U}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const x=Y>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",X=Math.abs(Y),b=Y>=0?"+":"-",v=Y>=0?"#28a745":"#dc3545",L=Y>=0?"#28a745":"#dc3545";B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ <span style="color: ${v}; font-weight: 600;">${x}</span> —Å ${M} (${G}) –¥–æ ${H} (${U}) ‚Äî <span style="color: ${L}; font-weight: 600;">${b}${X.toFixed(1)}%</span>`)}}else I===0&&S>0?(B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${G}) –¥–æ ${H} (${U})`)):I>0&&S===0&&(B.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),B.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${M} (${G}) –¥–æ 0 (${U})`))}}return B.length>0?B:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function J(N,B){let T=[];switch(N){case"new":T=t.data.newTicketsByMonth||[];break;case"closed":T=t.data.closedTicketsByMonth||[];break;case"carryover":T=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const h of T){if(!h.weeks||!Array.isArray(h.weeks))continue;const c=h.weeks.find(w=>w&&w.weekNumber===B);if(c){const w=c.count||0;return w>0?e(w):"-"}}return"-"}return(N,B)=>(g(),_("div",$o,[r("div",Wo,[r("h3",Ao,[B[0]||(B[0]=fe(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),m.value?(g(),_("span",Do,"("+$(m.value)+")",1)):te("",!0)]),r("div",So,[r("div",Eo,[re(Xe(Pe),{data:s.value,options:u},null,8,["data"])]),r("div",Bo,[B[3]||(B[3]=r("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),r("div",No,[r("div",Uo,[B[1]||(B[1]=r("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),r("span",Io,$(D.value.new),1)]),r("div",Mo,[B[2]||(B[2]=r("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),r("span",Oo,$(D.value.closed),1)])]),r("div",Ro,[(g(!0),_(ne,null,ce(O.value,(T,h)=>(g(),_("p",{key:h,innerHTML:T},null,8,Po))),128))])])])]),r("div",xo,[r("h3",Lo,[B[4]||(B[4]=fe(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),p.value?(g(),_("span",Go,"("+$(p.value)+")",1)):te("",!0)]),r("div",Fo,[r("div",Ho,[re(Xe(Pe),{data:l.value,options:u},null,8,["data"])]),r("div",Vo,[B[5]||(B[5]=r("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),r("div",Ko,[(g(!0),_(ne,null,ce(Q.value,(T,h)=>(g(),_("p",{key:h,innerHTML:T},null,8,Yo))),128))])])])]),r("div",zo,[B[10]||(B[10]=r("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),r("div",jo,[r("table",qo,[r("thead",null,[r("tr",null,[B[6]||(B[6]=r("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(g(!0),_(ne,null,ce(a.value,T=>(g(),_("th",{key:`week-${T}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+$(T),1))),128))])]),r("tbody",null,[r("tr",Zo,[B[7]||(B[7]=r("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(g(!0),_(ne,null,ce(a.value,T=>(g(),_("td",{key:`new-${T}`,class:"week-data-cell"},$(J("new",T)),1))),128))]),r("tr",Xo,[B[8]||(B[8]=r("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(g(!0),_(ne,null,ce(a.value,T=>(g(),_("td",{key:`closed-${T}`,class:"week-data-cell"},$(J("closed",T)),1))),128))]),r("tr",Jo,[B[9]||(B[9]=r("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(g(!0),_(ne,null,ce(a.value,T=>(g(),_("td",{key:`carryover-${T}`,class:"week-data-cell"},$(J("carryover",T)),1))),128))])])])])])]))}},en=we(Qo,[["__scopeId","data-v-31a3d565"]]),tn={class:"months-preloader"},rn={class:"preloader-content"},an={class:"progress-container"},sn={class:"progress-bar"},on={class:"progress-text"},nn={class:"preloader-message"},ln={class:"stages-list"},cn={class:"stage-icon"},dn={class:"stage-text"},un={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:o=>o>=0&&o<=100},currentStage:{type:String,default:""}},setup(o){const t=o,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function a(l){return t.progress>=e[l].threshold}function s(l){const u=e[l].threshold,d=l>0?e[l-1].threshold:0;return t.progress>=d&&t.progress<u}return(l,u)=>(g(),_("div",tn,[r("div",rn,[u[0]||(u[0]=er('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),r("div",an,[r("div",sn,[r("div",{class:"progress-fill",style:$e({width:`${o.progress}%`})},null,4)]),r("div",on,$(Math.round(o.progress))+"%",1)]),r("p",nn,$(o.currentStage),1),r("div",ln,[(g(),_(ne,null,ce(e,(d,m)=>r("div",{key:m,class:ke(["stage-item",{"stage-completed":a(m),"stage-current":s(m)}])},[r("span",cn,$(a(m)?"‚úì":s(m)?"‚Üí":"‚óã"),1),r("span",dn,$(d.label),1)],2)),64))])])]))}},kn=we(un,[["__scopeId","data-v-b571fe67"]]),vn="/api/graph-1c-admission-closure.php";function hn(o){var a,s,l,u,d,m,p,D,O,Q,J,N,B,T,h,c,w,A,I,S,G,U,M,H,Y,x,X,b,v,L,j,ae,k,n,E,R,K,P,z,V,f,i,y,W,F,ee,le,oe,se,de,ye,me,ie,be,Ae,De,Se,Ee,Be,Ne,Ue,Ie,Me,xe,Le,Ge;if(!o)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0]},weeksData:[],stagesByWeek:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=o.data||o.result||o,e=t.meta||o.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((a=t.data)==null?void 0:a.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:t.data.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:t.data.carryoverTicketsCreatedOlder??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0}),newTickets:((l=(s=t.data)==null?void 0:s.currentWeek)==null?void 0:l.newTickets)??((u=t.data)==null?void 0:u.newTickets)??t.newTickets??0,closedTickets:((m=(d=t.data)==null?void 0:d.currentWeek)==null?void 0:m.closedTickets)??((p=t.data)==null?void 0:p.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((O=(D=t.data)==null?void 0:D.currentWeek)==null?void 0:O.closedTicketsCreatedThisWeek)??((Q=t.data)==null?void 0:Q.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((N=(J=t.data)==null?void 0:J.currentWeek)==null?void 0:N.closedTicketsCreatedOtherWeek)??((B=t.data)==null?void 0:B.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((h=(T=t.data)==null?void 0:T.currentWeek)==null?void 0:h.carryoverTickets)??((c=t.data)==null?void 0:c.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((A=(w=t.data)==null?void 0:w.currentWeek)==null?void 0:A.carryoverTicketsCreatedThisWeek)??((I=t.data)==null?void 0:I.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((G=(S=t.data)==null?void 0:S.currentWeek)==null?void 0:G.carryoverTicketsCreatedOtherWeek)??((U=t.data)==null?void 0:U.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:((H=(M=t.data)==null?void 0:M.currentWeek)==null?void 0:H.carryoverTicketsCreatedPreviousWeek)??((Y=t.data)==null?void 0:Y.carryoverTicketsCreatedPreviousWeek)??t.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:((X=(x=t.data)==null?void 0:x.currentWeek)==null?void 0:X.carryoverTicketsCreatedOlder)??((b=t.data)==null?void 0:b.carryoverTicketsCreatedOlder)??t.carryoverTicketsCreatedOlder??0,series:{new:((L=(v=t.data)==null?void 0:v.series)==null?void 0:L.new)??((j=t.series)==null?void 0:j.new)??[0],closed:((k=(ae=t.data)==null?void 0:ae.series)==null?void 0:k.closed)??((n=t.series)==null?void 0:n.closed)??[0],closedCreatedThisWeek:((R=(E=t.data)==null?void 0:E.series)==null?void 0:R.closedCreatedThisWeek)??((K=t.series)==null?void 0:K.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((z=(P=t.data)==null?void 0:P.series)==null?void 0:z.closedCreatedOtherWeek)??((V=t.series)==null?void 0:V.closedCreatedOtherWeek)??[0],carryover:((i=(f=t.data)==null?void 0:f.series)==null?void 0:i.carryover)??((y=t.series)==null?void 0:y.carryover)??[0],carryoverCreatedThisWeek:((F=(W=t.data)==null?void 0:W.series)==null?void 0:F.carryoverCreatedThisWeek)??((ee=t.series)==null?void 0:ee.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((oe=(le=t.data)==null?void 0:le.series)==null?void 0:oe.carryoverCreatedOtherWeek)??((se=t.series)==null?void 0:se.carryoverCreatedOtherWeek)??[0],carryoverCreatedPreviousWeek:((ye=(de=t.data)==null?void 0:de.series)==null?void 0:ye.carryoverCreatedPreviousWeek)??((me=t.series)==null?void 0:me.carryoverCreatedPreviousWeek)??[0],carryoverCreatedOlder:((be=(ie=t.data)==null?void 0:ie.series)==null?void 0:be.carryoverCreatedOlder)??((Ae=t.series)==null?void 0:Ae.carryoverCreatedOlder)??[0]},weeksData:((De=t.data)==null?void 0:De.weeksData)??t.weeksData??[],stagesByWeek:((Se=t.data)==null?void 0:Se.stagesByWeek)??t.stagesByWeek??[],stages:((Ee=t.data)==null?void 0:Ee.stages)??t.stages??[],responsible:((Be=t.data)==null?void 0:Be.responsible)??t.responsible??[],responsibleCreatedThisWeek:((Ne=t.data)==null?void 0:Ne.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((Ue=t.data)==null?void 0:Ue.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Ie=t.data)==null?void 0:Ie.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Me=t.data)==null?void 0:Me.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((xe=t.data)==null?void 0:xe.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((Le=t.data)==null?void 0:Le.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ge=t.data)==null?void 0:Ge.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function We(o={}){const{endpoint:t=vn,product:e="1C",weekStartUtc:a=null,weekEndUtc:s=null,periodMode:l="weeks",useCache:u=!0,forceRefresh:d=!1,includeTickets:m=!1,includeNewTicketsByStages:p=!1,includeCarryoverTickets:D=!0,includeCarryoverTicketsByDuration:O=!1}=o,Q={product:e,weekStartUtc:a,weekEndUtc:s,periodMode:l,useCache:u,forceRefresh:d,includeTickets:m,includeNewTicketsByStages:p,includeCarryoverTickets:D,includeCarryoverTicketsByDuration:O},J=tr(t),N=await fetch(J,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(Q)});if(!N.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${N.status})`);const B=await N.json();if((B==null?void 0:B.success)===!1)throw new Error(B.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return hn(B)}const yn={class:"ac-dashboard-months"},mn={key:"content"},pn={class:"dashboard-header"},gn={class:"header-content"},fn={class:"breadcrumbs-row"},_n=["aria-label","aria-disabled","data-fallback","disabled"],bn={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},wn={class:"dashboard-layout"},Cn={class:"filters-container"},Tn={class:"chart-container"},$n={__name:"GraphAdmissionClosureMonthsDashboard",setup(o){const t=Dt(),e=Z(!0),a=Z(0),s=Z("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),l=Z(null),u=Z(null),d=Z({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),m=Z(!1),p=q(()=>typeof window>"u"?!1:window.history.length>1),D=q(()=>p.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),O={name:"dashboard-sector-1c"};function Q(U){var M;if((M=U==null?void 0:U.preventDefault)==null||M.call(U),!m.value){m.value=!0;try{if(p.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(O)}finally{m.value=!1}}}const J=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),N=q(()=>{const U=J.value.customDateRange.startDate||J.value.customDateRange.endDate,M=J.value.employees.length===1&&J.value.employees.includes("all");return U||!M});async function B(U,M,H=500){const Y=a.value,x=10,X=(U-Y)/x,b=H/x;for(let v=0;v<x;v++)await new Promise(L=>setTimeout(L,b)),a.value=Math.min(Y+X*(v+1),U);a.value=U,s.value=M}async function T(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,a.value=0,s.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let U=null,M=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await B(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const H=Date.now(),Y=2e4;U=setInterval(()=>{const v=Date.now()-H,L=Math.min(5+v/Y*85,90);a.value=L,L<35?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":L<65?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":L<85?s.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":s.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),M=setTimeout(()=>{U&&(clearInterval(U),U=null)},Y+1e4);const x=await We({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(M),U&&(clearInterval(U),U=null),a.value=90,s.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await B(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",x);const{meta:X,data:b}=x;u.value=X,d.value=b,console.log("[DEBUG MonthsDashboard] Data set, meta:",X,"data keys:",Object.keys(b)),await new Promise(v=>setTimeout(v,200))}catch(H){U&&(clearInterval(U),U=null),M&&(clearTimeout(M),M=null),console.error("[DEBUG MonthsDashboard] API call failed:",H),l.value=H instanceof Error?H:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",H),a.value=100,s.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function h(U){J.value.stages=U}function c(U){J.value.employees=U}function w(U){J.value.dateRange=U}function A(U){J.value.customDateRange=U}function I(){J.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},S()}function S(){T()}function G(U){if(!["weeks","months"].includes(U)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",U);return}U==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:U}}))}return ot(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),T()}),(U,M)=>{const H=St("router-link");return g(),_("div",yn,[re(ge,{name:"fade",mode:"out-in"},{default:ue(()=>[e.value?(g(),_e(kn,{key:"preloader",progress:a.value,"current-stage":s.value},null,8,["progress","current-stage"])):(g(),_("div",mn,[r("div",pn,[r("div",gn,[r("div",fn,[r("button",{class:"btn-back-link",type:"button",onClick:Q,"aria-label":D.value,"aria-disabled":!p.value,"data-fallback":!p.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,_n),r("nav",bn,[re(H,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ue(()=>[...M[0]||(M[0]=[fe(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),M[2]||(M[2]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),re(H,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ue(()=>[...M[1]||(M[1]=[fe(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),M[3]||(M[3]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),M[4]||(M[4]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),M[5]||(M[5]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),M[6]||(M[6]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",wn,[r("div",Cn,[re(Bt,{stages:J.value.stages,employees:J.value.employees,dateRange:J.value.dateRange,customDateRange:J.value.customDateRange,hasActiveFilters:N.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":h,"onUpdate:employees":c,"onUpdate:dateRange":w,"onUpdate:customDateRange":A,"onUpdate:periodMode":G,onReset:I,onApply:S},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),r("div",Tn,[l.value?(g(),_e(Et,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(g(),_(ne,{key:1},[re(To,{data:d.value},null,8,["data"]),re(en,{data:d.value,meta:u.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},Wn=we($n,[["__scopeId","data-v-fe3ca7ed"]]);class st{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const a=await this.getEmployeesByIds(e);return console.log("Loaded employees:",a.length),{stages:this.groupTicketsByStages(t,a),employees:a,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const a of t){console.log(`Loading tickets for stage: ${a}`);const s=await this.getTicketsByStage(a);e.push(...s),console.log(`Loaded ${s.length} tickets for stage ${a}`)}return e}static async getTicketsByStage(t){const e=[];let a=0;const s=50;let l=!0;for(;l;)try{const d=await Re.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:a,useOriginalUfNames:"Y"});let m=[];d&&d.result&&(Array.isArray(d.result)?m=d.result:d.result.items&&Array.isArray(d.result.items)?m=d.result.items:d.result.data&&Array.isArray(d.result.data)&&(m=d.result.data)),m.length>0?(e.push(...m),a+=m.length,l=m.length===s):l=!1}catch(d){console.error(`Error loading tickets batch for stage ${t} (start: ${a}):`,d),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const u=e.filter(d=>{const m=d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product||d.ufCrm7TypeProduct||d.UF_CRM_7_TYPE_PRODUCT||d.uf_crm_7_type_product;return Array.isArray(m)?m.includes(this.SECTOR_TAG):typeof m=="object"&&m!==null?m.value===this.SECTOR_TAG||m===this.SECTOR_TAG:m===this.SECTOR_TAG});return console.log(`Filtered ${u.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),u}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(a=>{const s=a.assignedById||a.assignedByIdId||a.ASSIGNED_BY_ID||a.assignedById||a.assignedById&&typeof a.assignedById=="object"&&(a.assignedById.id||a.assignedById.ID)||a.assignedById&&typeof a.assignedById=="object"&&a.assignedById.value;if(s){const l=parseInt(s);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await Re.call("user.get",{filter:{ID:t}});let a=[];return e&&e.result&&(Array.isArray(e.result)?a=e.result:console.warn("Unexpected user.get result format:",e)),a.map(s=>({id:parseInt(s.ID||s.id||0),name:`${s.NAME||s.name||""} ${s.LAST_NAME||s.lastName||""}`.trim()||s.EMAIL||s.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:s.WORK_POSITION||s.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:s.EMAIL||s.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const a=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(s=>({...s,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(s=>({...s,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(s=>({...s,tickets:[]}))}];return t.forEach(s=>{const l=this.mapStageId(s.stageId||s.STAGE_ID||""),u=a.find(d=>d.id===l);if(u){const d=s.assignedById||s.ASSIGNED_BY_ID||null,m=d?parseInt(d):null;if(m){let p=u.employees.find(D=>D.id===m);p||(p={id:m,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${m}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},u.employees.push(p)),p.tickets.push(this.mapTicket(s))}}}),a}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),a=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",s=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,u=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",d=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",m=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,p=wt(m),D=sr(p);return{id:e,title:a,priorityId:p.id,priorityLabel:p.label,priorityColors:D,priority:p.id,priorityBitrixValue:p.bitrixValue||null,status:this.mapStatus(s),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(s),createdAt:u,modifiedAt:d,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return wt(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=Ct(t);if(e&&e.bitrixValue)return e.bitrixValue;const a={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return a[t]?a[t]:Ct(or).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(a=>!(a.assignedById||a.ASSIGNED_BY_ID)).forEach(a=>{const s=this.mapStageId(a.stageId||a.STAGE_ID||"");e[s]&&e[s].push(this.mapTicket(a))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,a){try{const s=this.mapStageIdToBitrix(a);return(await Re.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:s}})).result===!0}catch(s){throw console.error("Error assigning ticket:",s),s}}static async createTicket(t){try{const e=await Re.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await Re.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await Re.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(a){throw console.error("Error adding comment:",a),a}}}et(st,"ENTITY_TYPE_ID",140),et(st,"SECTOR_TAG","1C");const An={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Dn={class:"modal"},Sn={key:0,class:"modal__tabs"},En={key:"level-0-categories",class:"level-0"},Bn={class:"modal__header"},Nn={class:"modal__title"},Un={key:0},In={class:"modal__body"},Mn={class:"categories-list"},On=["onClick"],Rn={class:"category-item"},Pn={class:"category-item__icon"},xn={key:0},Ln={key:1},Gn={class:"category-item__content"},Fn={class:"category-item__label"},Hn={class:"category-item__count"},Vn={key:0,class:"category-item__arrow"},Kn={class:"modal__footer"},Yn={key:"level-1-categories",class:"level-1"},zn={class:"modal__header"},jn={class:"modal__body"},qn={key:"loading",class:"loading-names"},Zn={key:"empty",class:"modal__empty"},Xn={key:"list",class:"responsible-list"},Jn=["onClick"],Qn={class:"responsible-list__name"},el={class:"responsible-list__count"},tl={key:0,class:"responsible-list__arrow"},rl={class:"modal__footer"},al={key:"level-2-categories",class:"level-2"},sl={class:"modal__header"},ol={class:"modal__title"},nl={class:"modal__body"},ll={key:"loading",class:"loading-state"},il={key:"error",class:"error-state"},cl={class:"error-message"},dl={key:"empty",class:"empty-state"},ul={key:"tickets",class:"tickets-list-container"},kl={key:"level-0-employees",class:"level-0"},vl={class:"modal__header"},hl={class:"modal__title"},yl={key:0},ml={class:"modal__body"},pl={key:"loading",class:"loading-names"},gl={key:"empty",class:"modal__empty"},fl={key:"list",class:"responsible-list"},_l=["onClick"],bl={class:"responsible-list__name"},wl={class:"responsible-list__count"},Cl={key:0,class:"responsible-list__arrow"},Tl={class:"modal__footer"},$l={key:"level-1-employees",class:"level-1"},Wl={class:"modal__header"},Al={class:"modal__title"},Dl={class:"modal__body"},Sl={class:"categories-list"},El=["onClick"],Bl={class:"category-item"},Nl={class:"category-item__icon"},Ul={key:0},Il={key:1},Ml={class:"category-item__content"},Ol={class:"category-item__label"},Rl={class:"category-item__count"},Pl={key:0,class:"category-item__arrow"},xl={class:"modal__footer"},Ll={key:"level-2-employees",class:"level-2"},Gl={class:"modal__header"},Fl={class:"modal__title"},Hl={class:"modal__body"},Vl={key:"loading",class:"loading-state"},Kl={key:"error",class:"error-state"},Yl={class:"error-message"},zl={key:"empty",class:"empty-state"},jl={class:"empty-state-message"},ql={key:"tickets",class:"tickets-list-container"},Zl={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(o){const t=o,e=Z(0),a=Z("categories"),s=Z(null),l=Z(null),u=Z(null),d=Z([]),m=Z(!1),p=Z(null),D=Z([]),O=Z([]),Q=Z(!1),J=q(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),N=q(()=>{const b=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(v=>{const L=v.id??"unassigned";b.has(L)||b.set(L,{id:v.id,name:v.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const j=b.get(L);j.thisWeekCount=v.count??0,j.thisWeekTickets=v.tickets||[],j.totalCount+=j.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(v=>{const L=v.id??"unassigned";b.has(L)||b.set(L,{id:v.id,name:v.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const j=b.get(L);j.otherWeekCount=v.count??0,j.otherWeekTickets=v.tickets||[],j.totalCount+=j.otherWeekCount}),Array.from(b.values())}),B=q(()=>{if(!l.value)return[];const b=l.value.thisWeekTickets||[],v=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:b.length,otherWeekTickets:v.length,employee:l.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.thisWeekCount??0,tickets:b,employeeId:l.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.otherWeekCount??0,tickets:v,employeeId:l.value.id}]}),T=q(()=>(O.value||[]).length>0);async function h(b){const v=b.filter(L=>L.id!==null&&L.id!==void 0).map(L=>L.id);if(v.length===0)return b;try{const L=await st.getEmployeesByIds(v),j=new Map;return L.forEach(ae=>{j.set(ae.id,ae.name)}),b.map(ae=>ae.id&&j.has(ae.id)?{...ae,name:j.get(ae.id)}:ae)}catch(L){return console.error("[ResponsibleModal] Error enriching names:",L),b}}Te([()=>a.value,()=>N.value],async([b,v])=>{if(!(b!=="employees"||e.value!==0)){if(!v||v.length===0){O.value=[];return}Q.value=!0;try{O.value=await h(v)}catch(L){console.error("[ResponsibleModal] Error loading employee names:",L),O.value=v}finally{Q.value=!1}}},{immediate:!0}),Te(()=>t.responsible,async b=>{if(!(e.value!==0||s.value||a.value!=="categories")){if(!b||b.length===0){D.value=[];return}Q.value=!0;try{D.value=await h(b)}catch(v){console.error("[ResponsibleModal] Error loading employee names:",v),D.value=b}finally{Q.value=!1}}},{immediate:!1});const c=q(()=>(D.value||[]).length>0);function w(b){a.value!==b&&(a.value=b,e.value=0,s.value=null,l.value=null,u.value=null,d.value=[],p.value=null,D.value=[],O.value=[])}async function A(b){if(!(!b||b.count===0)){s.value=b,e.value=1,Q.value=!0;try{D.value=await h(b.responsible)}catch(v){console.error("[ResponsibleModal] Error loading employee names:",v),D.value=b.responsible}finally{Q.value=!1}}}async function I(b,v=null){var L,j;!b||!b.id||b.totalCount===0||(v&&v.currentTarget&&(v.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{v.currentTarget&&(v.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:b.id,name:b.name,thisWeekCount:b.thisWeekCount,otherWeekCount:b.otherWeekCount,thisWeekTickets:((L=b.thisWeekTickets)==null?void 0:L.length)||0,otherWeekTickets:((j=b.otherWeekTickets)==null?void 0:j.length)||0,employee:b}),l.value={...b,thisWeekTickets:b.thisWeekTickets||[],otherWeekTickets:b.otherWeekTickets||[]},e.value=1)}async function S(b){var L;if(!b||b.count===0)return;u.value=b,e.value=2;const v=b.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:b.id,label:b.label,count:b.count,ticketsInGradation:v.length,selectedEmployee:(L=l.value)==null?void 0:L.id}),v.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",v.length),await G(v)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await U(b))}async function G(b){m.value=!0,p.value=null;try{try{const{prepareTicketsForDisplay:v}=await Oe(async()=>{const{prepareTicketsForDisplay:L}=await import("./ticketListUtils-BfZdaHqX.js").then(j=>j.t);return{prepareTicketsForDisplay:L}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await v(b,null,null)}catch(v){console.error("[ResponsibleModal] Error preparing tickets:",v),d.value=b}d.value.length===0&&(p.value=null)}catch(v){p.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",v),d.value=[]}finally{m.value=!1}}async function U(b){m.value=!0,p.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const v=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),L=b.id==="this-week"?v.data.responsibleCreatedThisWeek:v.data.responsibleCreatedOtherWeek,j=L==null?void 0:L.find(k=>k.id===l.value.id),ae=(j==null?void 0:j.tickets)||[];try{const{prepareTicketsForDisplay:k}=await Oe(async()=>{const{prepareTicketsForDisplay:n}=await import("./ticketListUtils-BfZdaHqX.js").then(E=>E.t);return{prepareTicketsForDisplay:n}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await k(ae,null,null)}catch(k){console.error("[ResponsibleModal] Error preparing tickets:",k),d.value=ae}d.value.length===0&&(p.value=null)}catch(v){p.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",v),d.value=[]}finally{m.value=!1}}async function M(b,v=null){!b||!b.id||b.count===0||(v&&v.currentTarget&&(v.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{v.currentTarget&&(v.currentTarget.style.transform="")},150)),l.value=b,e.value=2,await H(b.id))}async function H(b){var v,L,j,ae,k,n,E,R,K,P;m.value=!0,p.value=null;try{let z=[];if(console.log("[ResponsibleModal] loadEmployeeTickets called:",{employeeId:b,selectedCategory:(v=s.value)==null?void 0:v.id,hasSelectedCategory:!!s.value,hasResponsible:!!((L=s.value)!=null&&L.responsible),responsibleCount:((ae=(j=s.value)==null?void 0:j.responsible)==null?void 0:ae.length)||0}),s.value&&s.value.responsible){const V=s.value.responsible.find(f=>f.id===b);console.log("[ResponsibleModal] Employee found in category:",{employee:V,hasTickets:!!(V!=null&&V.tickets),ticketsCount:((k=V==null?void 0:V.tickets)==null?void 0:k.length)||0}),z=(V==null?void 0:V.tickets)||[]}if(z.length===0&&t.weekStartUtc&&t.weekEndUtc){console.log("[ResponsibleModal] Tickets not found in category, loading from API");const V=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0});console.log("[ResponsibleModal] API response:",{hasResponsibleCreatedThisWeek:!!V.data.responsibleCreatedThisWeek,hasResponsibleCreatedOtherWeek:!!V.data.responsibleCreatedOtherWeek,thisWeekCount:((n=V.data.responsibleCreatedThisWeek)==null?void 0:n.length)||0,otherWeekCount:((E=V.data.responsibleCreatedOtherWeek)==null?void 0:E.length)||0});const f=((R=s.value)==null?void 0:R.id)==="created-this-week"?V.data.responsibleCreatedThisWeek:V.data.responsibleCreatedOtherWeek;console.log("[ResponsibleModal] Category data:",{categoryId:(K=s.value)==null?void 0:K.id,categoryDataCount:(f==null?void 0:f.length)||0});const i=f==null?void 0:f.find(y=>y.id===b);console.log("[ResponsibleModal] Employee found in API response:",{employee:i,hasTickets:!!(i!=null&&i.tickets),ticketsCount:((P=i==null?void 0:i.tickets)==null?void 0:P.length)||0}),z=(i==null?void 0:i.tickets)||[]}try{const{prepareTicketsForDisplay:V}=await Oe(async()=>{const{prepareTicketsForDisplay:f}=await import("./ticketListUtils-BfZdaHqX.js").then(i=>i.t);return{prepareTicketsForDisplay:f}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);d.value=await V(z,null,null)}catch(V){console.error("[ResponsibleModal] Error preparing tickets:",V),d.value=z}d.value.length===0&&(p.value=null)}catch(z){p.value=z.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",z),d.value=[]}finally{m.value=!1}}function Y(){e.value===2?(e.value=1,a.value==="categories"?l.value=null:u.value=null,d.value=[],p.value=null):e.value===1&&(e.value=0,a.value==="categories"?(s.value=null,D.value=[]):l.value=null)}function x(b){const v=nt(b.id);window.open(v,"_blank")}function X(){a.value==="employees"&&u.value?G(u.value.tickets):a.value==="categories"&&l.value&&H(l.value.id)}return Te(()=>t.isVisible,b=>{var v,L;if(b){console.log("[TASK-070] ResponsibleModal opened for week",t.weekNumber),console.log("[TASK-070] ResponsibleModal data:",{weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,responsibleCreatedThisWeek:((v=t.responsibleCreatedThisWeek)==null?void 0:v.length)||0,responsibleCreatedOtherWeek:((L=t.responsibleCreatedOtherWeek)==null?void 0:L.length)||0,closedTicketsCreatedThisWeek:t.closedTicketsCreatedThisWeek,closedTicketsCreatedOtherWeek:t.closedTicketsCreatedOtherWeek});const j=t.weekNumber;j&&console.log("[TASK-070] ResponsibleModal: Week number",j)}else e.value=0,a.value="categories",s.value=null,l.value=null,u.value=null,d.value=[],p.value=null,D.value=[],O.value=[]}),(b,v)=>o.isVisible?(g(),_("div",An,[r("div",Dn,[e.value===0?(g(),_("div",Sn,[r("button",{class:ke(["modal__tab",{"modal__tab--active":a.value==="categories"}]),onClick:v[0]||(v[0]=L=>w("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),r("button",{class:ke(["modal__tab",{"modal__tab--active":a.value==="employees"}]),onClick:v[1]||(v[1]=L=>w("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):te("",!0),re(ge,{name:"level",mode:"out-in"},{default:ue(()=>{var L,j,ae,k;return[a.value==="categories"&&e.value===0?(g(),_("div",En,[r("header",Bn,[r("h3",Nn,[v[12]||(v[12]=fe(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(g(),_("span",Un," ¬∑ –ù–µ–¥–µ–ª—è "+$(o.weekNumber),1)):te("",!0)]),r("button",{class:"modal__close",onClick:v[2]||(v[2]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",In,[r("ul",Mn,[(g(!0),_(ne,null,ce(J.value,n=>(g(),_("li",{key:n.id,class:ke(["categories-list__item",{"categories-list__item--clickable":n.count>0}]),onClick:E=>A(n)},[r("div",Rn,[r("div",Pn,[n.id==="created-this-week"?(g(),_("span",xn,"‚úì")):(g(),_("span",Ln,"‚Üª"))]),r("div",Gn,[r("div",Fn,$(n.label),1),r("div",Hn,$(n.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),n.count>0?(g(),_("span",Vn,"‚Üí")):te("",!0)])],10,On))),128))])]),r("footer",Kn,[r("button",{class:"btn",onClick:v[3]||(v[3]=n=>b.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===1?(g(),_("div",Yn,[r("header",zn,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),v[13]||(v[13]=r("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r("button",{class:"modal__close",onClick:v[4]||(v[4]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",jn,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>[Q.value?(g(),_("div",qn,[...v[14]||(v[14]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):c.value?(g(),_("ul",Xn,[(g(!0),_(ne,null,ce(D.value,n=>(g(),_("li",{key:n.id||n.name,class:ke(["responsible-list__item",{"responsible-list__item--clickable":n.id&&n.count>0}]),onClick:E=>M(n,E),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",Qn,$(n.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",el,$(n.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),n.id&&n.count>0?(g(),_("span",tl,"‚Üí")):te("",!0)],10,Jn))),128))])):(g(),_("p",Zn,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),r("footer",rl,[r("button",{class:"btn",onClick:v[5]||(v[5]=n=>b.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===2?(g(),_("div",al,[r("header",sl,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",ol,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+$(((L=l.value)==null?void 0:L.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:v[6]||(v[6]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",nl,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>[m.value?(g(),_("div",ll,[...v[15]||(v[15]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(g(),_("div",il,[v[16]||(v[16]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),v[17]||(v[17]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",cl,$(p.value),1),r("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(g(),_("div",dl,[...v[18]||(v[18]=[r("div",{class:"empty-state-icon"},"üìã",-1),r("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(g(),_("div",ul,[re(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ue(()=>[(g(!0),_(ne,null,ce(d.value,(n,E)=>(g(),_e(Qe,{key:n.id,ticket:n,draggable:!1,style:$e({"--ticket-index":E}),onClick:x},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):a.value==="employees"&&e.value===0?(g(),_("div",kl,[r("header",vl,[r("h3",hl,[v[19]||(v[19]=fe(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(g(),_("span",yl," ¬∑ –ù–µ–¥–µ–ª—è "+$(o.weekNumber),1)):te("",!0)]),r("button",{class:"modal__close",onClick:v[7]||(v[7]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",ml,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>[Q.value?(g(),_("div",pl,[...v[20]||(v[20]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):T.value?(g(),_("ul",fl,[(g(!0),_(ne,null,ce(O.value,n=>(g(),_("li",{key:n.id||n.name,class:ke(["responsible-list__item",{"responsible-list__item--clickable":n.id&&n.totalCount>0}]),onClick:E=>I(n,E),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[r("span",bl,$(n.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),r("span",wl,$(n.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),n.id&&n.totalCount>0?(g(),_("span",Cl,"‚Üí")):te("",!0)],10,_l))),128))])):(g(),_("p",gl,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),r("footer",Tl,[r("button",{class:"btn",onClick:v[8]||(v[8]=n=>b.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===1?(g(),_("div",$l,[r("header",Wl,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Al,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+$(((j=l.value)==null?void 0:j.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:v[9]||(v[9]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Dl,[r("ul",Sl,[(g(!0),_(ne,null,ce(B.value,n=>(g(),_("li",{key:n.id,class:ke(["categories-list__item",{"categories-list__item--clickable":n.count>0}]),onClick:E=>S(n)},[r("div",Bl,[r("div",Nl,[n.id==="this-week"?(g(),_("span",Ul,"‚úì")):(g(),_("span",Il,"‚Üª"))]),r("div",Ml,[r("div",Ol,$(n.label),1),r("div",Rl,$(n.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),n.count>0?(g(),_("span",Pl,"‚Üí")):te("",!0)])],10,El))),128))])]),r("footer",xl,[r("button",{class:"btn",onClick:v[10]||(v[10]=n=>b.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===2?(g(),_("div",Ll,[r("header",Gl,[r("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Fl," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+$(((ae=l.value)==null?void 0:ae.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+$(((k=u.value)==null?void 0:k.label)||"")+") ",1),r("button",{class:"modal__close",onClick:v[11]||(v[11]=n=>b.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Hl,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>{var n;return[m.value?(g(),_("div",Vl,[...v[21]||(v[21]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):p.value?(g(),_("div",Kl,[v[22]||(v[22]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),v[23]||(v[23]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Yl,$(p.value),1),r("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(g(),_("div",zl,[v[24]||(v[24]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",jl,$(a.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((n=u.value)==null?void 0:n.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(g(),_("div",ql,[re(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ue(()=>[(g(!0),_(ne,null,ce(d.value,(E,R)=>(g(),_e(Qe,{key:E.id,ticket:E,draggable:!1,style:$e({"--ticket-index":R}),onClick:x},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):te("",!0)]}),_:1})])])):te("",!0)}},Xl=we(Zl,[["__scopeId","data-v-19def5bc"]]),Jl={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Ql={class:"modal"},ei={key:"level-1",class:"level-1"},ti={class:"modal__header"},ri={class:"modal__title"},ai={key:0},si={class:"modal__body"},oi={key:"loading",class:"loading-names"},ni={key:"empty",class:"modal__empty"},li={key:"list",class:"stages-list"},ii=["onClick"],ci={class:"stages-list__name"},di={class:"stages-list__count"},ui={key:0,class:"stages-list__arrow"},ki={class:"modal__footer"},vi={key:"level-2",class:"level-2"},hi={class:"modal__header"},yi={class:"modal__title"},mi={class:"modal__body"},pi={key:"loading",class:"loading-state"},gi={key:"error",class:"error-state"},fi={class:"error-message"},_i={key:"empty",class:"empty-state"},bi={class:"empty-state-message"},wi={key:"tickets",class:"tickets-list-container"},Ci={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,a=Z(1),s=Z(null),l=Z([]),u=Z(!1),d=Z(!1),m=Z(null),p=Z([]),D=q(()=>p.value.length>0&&p.value.some(h=>h.count>0));async function O(){var h;if(console.log("[TASK-070] StagesModal: loadStages called",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),!e.weekStartUtc||!e.weekEndUtc){console.warn("[TASK-070] StagesModal: Missing week boundaries, cannot load stages"),p.value=[];return}d.value=!0,m.value=null;try{console.log("[TASK-070] StagesModal: Fetching stages from API...");const c=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});console.log("[TASK-070] StagesModal: API response received",{hasNewTicketsByStages:!!c.data.newTicketsByStages,stagesCount:((h=c.data.newTicketsByStages)==null?void 0:h.length)||0}),p.value=c.data.newTicketsByStages||[],p.value.length===0?console.warn("[TASK-070] StagesModal: API returned empty stages array for week",e.weekNumber):console.log("[TASK-070] StagesModal: Stages loaded successfully",p.value.length,"stages")}catch(c){m.value=c.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[TASK-070] StagesModal: Error loading stages:",c),p.value=[]}finally{d.value=!1}}async function Q(h,c=null){!h||h.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),s.value=h,a.value=2,await J(h.stageId))}async function J(h){var c;u.value=!0,m.value=null;try{const w=p.value.find(G=>G.stageId===h);if(w&&Array.isArray(w.tickets)&&w.tickets.length>0){console.log("[TASK-070] StagesModal: Using preloaded tickets for stage",h,"count:",w.tickets.length);const G=w.tickets;try{const{prepareTicketsForDisplay:U}=await Oe(async()=>{const{prepareTicketsForDisplay:M}=await import("./ticketListUtils-BfZdaHqX.js").then(H=>H.t);return{prepareTicketsForDisplay:M}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await U(G,null,null)}catch(U){console.error("[TASK-070] StagesModal: Error preparing tickets:",U),l.value=G}u.value=!1;return}if(console.log("[TASK-070] StagesModal: Tickets not preloaded, loading from API for stage",h),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const I=(c=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:c.find(G=>G.stageId===h),S=(I==null?void 0:I.tickets)||[];try{const{prepareTicketsForDisplay:G}=await Oe(async()=>{const{prepareTicketsForDisplay:U}=await import("./ticketListUtils-BfZdaHqX.js").then(M=>M.t);return{prepareTicketsForDisplay:U}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await G(S,null,null)}catch(G){console.error("[StagesModal] Error preparing tickets:",G),l.value=S}l.value.length===0&&(m.value=null)}catch(w){m.value=w.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",w),l.value=[]}finally{u.value=!1}}function N(){a.value=1,s.value=null,l.value=[],m.value=null}function B(h){const c=nt(h.id);window.open(c,"_blank")}function T(){s.value&&J(s.value.stageId)}return Te(()=>e.isVisible,async h=>{h?(a.value=1,s.value=null,l.value=[],m.value=null,console.log("[TASK-070] StagesModal opened:",{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,preloadedData:e.preloadedData?Array.isArray(e.preloadedData)?`Array(${e.preloadedData.length})`:typeof e.preloadedData:"null"}),e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] StagesModal: Using preloaded data, stages count:",e.preloadedData.length),e.preloadedData.every(w=>w.stageId&&w.stageName&&typeof w.count=="number")?(p.value=e.preloadedData,d.value=!1,console.log("[TASK-070] StagesModal: Preloaded data set, stages:",p.value.length)):(console.warn("[TASK-070] StagesModal: Invalid preloaded data structure, falling back to API"),await O())):(console.log("[TASK-070] StagesModal: No preloaded data, loading from API",{weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}),await O())):(a.value=1,s.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),Te([()=>e.weekNumber,()=>e.preloadedData],async([h,c])=>{e.isVisible&&h&&(c&&Array.isArray(c)&&c.length>0?c.every(A=>A.stageId&&A.stageName&&typeof A.count=="number")?(console.log("[TASK-070] StagesModal: Week changed, updating with preloaded data for week",h),p.value=c,d.value=!1):(console.log("[TASK-070] StagesModal: Week changed, invalid preloaded data, loading from API for week",h),await O()):(console.log("[TASK-070] StagesModal: Week changed, loading from API for week",h),await O()))}),(h,c)=>o.isVisible?(g(),_("div",Jl,[r("div",Ql,[re(ge,{name:"level",mode:"out-in"},{default:ue(()=>{var w;return[a.value===1?(g(),_("div",ei,[r("header",ti,[r("h3",ri,[c[3]||(c[3]=fe(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),o.weekNumber?(g(),_("span",ai," ¬∑ –ù–µ–¥–µ–ª—è "+$(o.weekNumber),1)):te("",!0)]),r("button",{class:"modal__close",onClick:c[0]||(c[0]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",si,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>[d.value?(g(),_("div",oi,[...c[4]||(c[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):D.value?(g(),_("ul",li,[(g(!0),_(ne,null,ce(p.value,A=>(g(),_("li",{key:A.stageId,class:ke(["stages-list__item",{"stages-list__item--clickable":A.count>0}]),style:$e({"--stage-color":A.color}),onClick:I=>Q(A,I),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[r("span",{class:"stages-list__color",style:$e({backgroundColor:A.color})},null,4),r("span",ci,$(A.stageName),1),r("span",di,$(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.count>0?(g(),_("span",ui,"‚Üí")):te("",!0)],14,ii))),128))])):(g(),_("p",ni," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",ki,[r("button",{class:"btn",onClick:c[1]||(c[1]=A=>h.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(g(),_("div",vi,[r("header",hi,[r("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",yi," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+$(((w=s.value)==null?void 0:w.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:c[2]||(c[2]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",mi,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>{var A;return[u.value?(g(),_("div",pi,[...c[5]||(c[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(g(),_("div",gi,[c[6]||(c[6]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",fi,$(m.value),1),r("button",{class:"btn btn-retry",onClick:T},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(g(),_("div",_i,[c[8]||(c[8]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",bi," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+$((A=s.value)==null?void 0:A.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(g(),_("div",wi,[re(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ue(()=>[(g(!0),_(ne,null,ce(l.value,(I,S)=>(g(),_e(Qe,{key:I.id,ticket:I,draggable:!1,style:$e({"--ticket-index":S}),onClick:B},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):te("",!0)]}),_:1})])])):te("",!0)}},Ti=we(Ci,[["__scopeId","data-v-00403024"]]),$i={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Wi={class:"modal"},Ai={key:"level-1",class:"level-1"},Di={class:"modal__header"},Si={class:"modal__title"},Ei={key:0},Bi={class:"modal__body"},Ni={key:"loading",class:"loading-names"},Ui={key:"empty",class:"modal__empty"},Ii={key:"list",class:"duration-list"},Mi=["onClick"],Oi={class:"duration-list__name"},Ri={class:"duration-list__count"},Pi={key:0,class:"duration-list__arrow"},xi={class:"modal__footer"},Li={key:"level-2",class:"level-2"},Gi={class:"modal__header"},Fi={class:"modal__title"},Hi={class:"modal__body"},Vi={key:"loading",class:"loading-state"},Ki={key:"error",class:"error-state"},Yi={class:"error-message"},zi={key:"empty",class:"empty-state"},ji={class:"empty-state-message"},qi={key:"tickets",class:"tickets-list-container"},Zi={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null},preloadedData:{type:Array,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,a=Z(1),s=Z(null),l=Z([]),u=Z(!1),d=Z(!1),m=Z(null),p=Z([]),D=q(()=>p.value.length>0&&p.value.some(h=>h.count>0));async function O(){if(!e.weekStartUtc||!e.weekEndUtc){p.value=[];return}d.value=!0,m.value=null;try{const h=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});p.value=h.data.carryoverTicketsByDuration||[]}catch(h){m.value=h.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",h),p.value=[]}finally{d.value=!1}}async function Q(h,c=null){!h||h.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),s.value=h,a.value=2,await J(h.durationCategory))}async function J(h){var c;u.value=!0,m.value=null;try{const w=p.value.find(G=>G.durationCategory===h);if(w&&Array.isArray(w.tickets)&&w.tickets.length>0){console.log("[TASK-070] CarryoverDurationModal: Using preloaded tickets for category",h,"count:",w.tickets.length);const G=w.tickets;try{const{prepareTicketsForDisplay:U}=await Oe(async()=>{const{prepareTicketsForDisplay:M}=await import("./ticketListUtils-BfZdaHqX.js").then(H=>H.t);return{prepareTicketsForDisplay:M}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await U(G,null,null)}catch(U){console.error("[TASK-070] CarryoverDurationModal: Error preparing tickets:",U),l.value=G}u.value=!1;return}if(console.log("[TASK-070] CarryoverDurationModal: Tickets not preloaded, loading from API for category",h),!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const I=(c=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:c.find(G=>G.durationCategory===h),S=(I==null?void 0:I.tickets)||[];try{const{prepareTicketsForDisplay:G}=await Oe(async()=>{const{prepareTicketsForDisplay:U}=await import("./ticketListUtils-BfZdaHqX.js").then(M=>M.t);return{prepareTicketsForDisplay:U}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await G(S,null,null)}catch(G){console.error("[CarryoverDurationModal] Error preparing tickets:",G),l.value=S}l.value.length===0&&(m.value=null)}catch(w){m.value=w.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",w),l.value=[]}finally{u.value=!1}}function N(){a.value=1,s.value=null,l.value=[],m.value=null}function B(h){const c=nt(h.id);window.open(c,"_blank")}function T(){s.value&&J(s.value.durationCategory)}return Te(()=>e.isVisible,async h=>{h?(a.value=1,s.value=null,l.value=[],m.value=null,e.preloadedData&&Array.isArray(e.preloadedData)&&e.preloadedData.length>0?(console.log("[TASK-070] CarryoverDurationModal: Using preloaded data, categories count:",e.preloadedData.length),e.preloadedData.every(w=>w.durationCategory&&w.durationLabel&&typeof w.count=="number")?(p.value=e.preloadedData,d.value=!1):(console.warn("[TASK-070] CarryoverDurationModal: Invalid preloaded data structure, falling back to API"),await O())):(console.log("[TASK-070] CarryoverDurationModal: No preloaded data, loading from API"),await O())):(a.value=1,s.value=null,l.value=[],m.value=null,p.value=[])},{immediate:!1}),Te([()=>e.weekNumber,()=>e.preloadedData],async([h,c])=>{e.isVisible&&h&&(c&&Array.isArray(c)&&c.length>0?c.every(A=>A.durationCategory&&A.durationLabel&&typeof A.count=="number")?(console.log("[TASK-070] CarryoverDurationModal: Week changed, updating with preloaded data for week",h),p.value=c,d.value=!1):(console.log("[TASK-070] CarryoverDurationModal: Week changed, invalid preloaded data, loading from API for week",h),await O()):(console.log("[TASK-070] CarryoverDurationModal: Week changed, loading from API for week",h),await O()))}),(h,c)=>o.isVisible?(g(),_("div",$i,[r("div",Wi,[re(ge,{name:"level",mode:"out-in"},{default:ue(()=>{var w;return[a.value===1?(g(),_("div",Ai,[r("header",Di,[r("h3",Si,[c[3]||(c[3]=fe(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),o.weekNumber?(g(),_("span",Ei," ¬∑ –ù–µ–¥–µ–ª—è "+$(o.weekNumber),1)):te("",!0)]),r("button",{class:"modal__close",onClick:c[0]||(c[0]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Bi,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>[d.value?(g(),_("div",Ni,[...c[4]||(c[4]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):D.value?(g(),_("ul",Ii,[(g(!0),_(ne,null,ce(p.value,A=>(g(),_("li",{key:A.durationCategory,class:ke(["duration-list__item",{"duration-list__item--clickable":A.count>0}]),style:$e({"--duration-color":A.color}),onClick:I=>Q(A,I),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[r("span",{class:"duration-list__color",style:$e({backgroundColor:A.color})},null,4),r("span",Oi,$(A.durationLabel),1),r("span",Ri,$(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.count>0?(g(),_("span",Pi,"‚Üí")):te("",!0)],14,Mi))),128))])):(g(),_("p",Ui," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),r("footer",xi,[r("button",{class:"btn",onClick:c[1]||(c[1]=A=>h.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(g(),_("div",Li,[r("header",Gi,[r("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r("h3",Fi," –¢–∏–∫–µ—Ç—ã: "+$(((w=s.value)==null?void 0:w.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),r("button",{class:"modal__close",onClick:c[2]||(c[2]=A=>h.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),r("section",Hi,[re(ge,{name:"loading",mode:"out-in"},{default:ue(()=>{var A;return[u.value?(g(),_("div",Vi,[...c[5]||(c[5]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(g(),_("div",Ki,[c[6]||(c[6]=r("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=r("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),r("p",Yi,$(m.value),1),r("button",{class:"btn btn-retry",onClick:T},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(g(),_("div",zi,[c[8]||(c[8]=r("div",{class:"empty-state-icon"},"üìã",-1)),r("p",ji," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+$((A=s.value)==null?void 0:A.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(g(),_("div",qi,[re(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:ue(()=>[(g(!0),_(ne,null,ce(l.value,(I,S)=>(g(),_e(Qe,{key:I.id,ticket:I,draggable:!1,style:$e({"--ticket-index":S}),onClick:B},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):te("",!0)]}),_:1})])])):te("",!0)}},Xi=we(Zi,[["__scopeId","data-v-0d406e97"]]),Ji={class:"ac-dashboard"},Qi={key:"preloader",class:"chart-preloader"},ec={class:"preloader-content"},tc={class:"preloader-message"},rc={key:"content"},ac={key:1,class:"weeks-dashboard"},sc={class:"dashboard-header"},oc={class:"header-content"},nc={class:"breadcrumbs-row"},lc=["aria-label","aria-disabled","data-fallback","disabled"],ic={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},cc={class:"dashboard-layout"},dc={class:"filters-container"},uc={class:"chart-container"},kc={__name:"GraphAdmissionClosureDashboard",setup(o){const t=Dt(),e=Z(!1),a=Z(null),s=Z(null),l=Z({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),u=Z(!1),d=Z(!1),m=Z(!1),p=Z(!0),D=Z(null),O=Z({currentWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null},previousWeek:{newTicketsByStages:null,carryoverTicketsByDuration:null,responsibleCreatedThisWeek:null,responsibleCreatedOtherWeek:null}}),Q=q(()=>{var y;const i=((y=s.value)==null?void 0:y.weeks)||[];return i.length>=2?i[i.length-2]:null}),J=Z(!1),N=q(()=>typeof window>"u"?!1:window.history.length>1),B=q(()=>N.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),T={name:"dashboard-sector-1c"};function h(i){var y;if((y=i==null?void 0:i.preventDefault)==null||y.call(i),!J.value){J.value=!0;try{if(N.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(T)}finally{J.value=!1}}}const c=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),w=Z("weeks"),A=q(()=>{const i=c.value.customDateRange.startDate||c.value.customDateRange.endDate,y=c.value.employees.length===1&&c.value.employees.includes("all");return i||!y});async function I(){if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",w.value),console.log("[DEBUG] isLoading before:",e.value),w.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,a.value=null;const i=new Promise(y=>setTimeout(y,300));try{console.log("[DEBUG] Starting API call");const y=f(),W=y.weekStartUtc,F=y.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:W,weekEndUtc:F});const[ee,le]=await Promise.all([i,We({product:"1C",periodMode:"weeks",weekStartUtc:W,weekEndUtc:F,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTicketsByDuration:!0})]);console.log("[DEBUG] API call successful, result:",le);const{meta:oe,data:se,carryoverDebug:de}=le;if(s.value=oe,l.value=se,console.log("[DEBUG] Data set, meta:",oe,"data keys:",Object.keys(se)),se.newTicketsByStages&&(O.value.currentWeek.newTicketsByStages=se.newTicketsByStages,console.log("[TASK-070] Preloaded newTicketsByStages for current week:",se.newTicketsByStages.length,"stages")),se.carryoverTicketsByDuration&&(O.value.currentWeek.carryoverTicketsByDuration=se.carryoverTicketsByDuration,console.log("[TASK-070] Preloaded carryoverTicketsByDuration for current week:",se.carryoverTicketsByDuration.length,"categories")),se.responsibleCreatedThisWeek&&(O.value.currentWeek.responsibleCreatedThisWeek=se.responsibleCreatedThisWeek),se.responsibleCreatedOtherWeek&&(O.value.currentWeek.responsibleCreatedOtherWeek=se.responsibleCreatedOtherWeek),de&&(console.log("[CARRYOVER-DEBUG] ========================================"),console.log("[CARRYOVER-DEBUG] Total:",de.total),console.log("[CARRYOVER-DEBUG] ThisWeek:",de.thisWeek),console.log("[CARRYOVER-DEBUG] PreviousWeek:",de.previousWeek),console.log("[CARRYOVER-DEBUG] Older:",de.older),console.log("[CARRYOVER-DEBUG] Sum:",de.sum,"(expected:",de.total,")"),console.log("[CARRYOVER-DEBUG] Series:",de.series),console.log("[CARRYOVER-DEBUG] CurrentWeekData:",de.currentWeekData),console.log("[CARRYOVER-DEBUG] WeeksData:",de.weeksData),console.log("[CARRYOVER-DEBUG] Full object:",de),console.log("[CARRYOVER-DEBUG] ========================================")),Q.value){const ye=Q.value.weekStartUtc,me=Q.value.weekEndUtc;console.log("[TASK-070] Starting preload for previous week:",{weekNumber:Q.value.weekNumber,weekStartUtc:ye,weekEndUtc:me}),We({product:"1C",periodMode:"weeks",weekStartUtc:ye,weekEndUtc:me,includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTicketsByDuration:!0}).then(ie=>{console.log("[TASK-070] Preload successful for previous week"),ie.data.newTicketsByStages&&(O.value.previousWeek.newTicketsByStages=ie.data.newTicketsByStages,console.log("[TASK-070] Preloaded newTicketsByStages for previous week:",ie.data.newTicketsByStages.length,"stages")),ie.data.carryoverTicketsByDuration&&(O.value.previousWeek.carryoverTicketsByDuration=ie.data.carryoverTicketsByDuration,console.log("[TASK-070] Preloaded carryoverTicketsByDuration for previous week:",ie.data.carryoverTicketsByDuration.length,"categories")),ie.data.responsibleCreatedThisWeek&&(O.value.previousWeek.responsibleCreatedThisWeek=ie.data.responsibleCreatedThisWeek),ie.data.responsibleCreatedOtherWeek&&(O.value.previousWeek.responsibleCreatedOtherWeek=ie.data.responsibleCreatedOtherWeek)}).catch(ie=>{console.warn("[TASK-070] Failed to preload previous week data (non-critical):",ie)})}}catch(y){console.error("[DEBUG] API call failed:",y),a.value=y instanceof Error?y:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",y)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function S(i){var se;if(!i||!s.value)return console.log("[TASK-070] getPreloadedStagesData: Missing weekMeta or chartMeta"),null;const y=((se=s.value)==null?void 0:se.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber,F=y.length>=2?y[y.length-2].weekNumber:null;console.log("[TASK-070] getPreloadedStagesData:",{requestedWeek:i.weekNumber,currentWeekNumber:W,previousWeekNumber:F,weeksInMeta:y.length});const ee=i.weekNumber===W,le=i.weekNumber===F;let oe=null;if(ee)oe=O.value.currentWeek.newTicketsByStages,console.log("[TASK-070] Requested week is current week, checking currentWeek data:",oe?`Array(${oe.length})`:"null");else if(le)oe=O.value.previousWeek.newTicketsByStages,console.log("[TASK-070] Requested week is previous week, checking previousWeek data:",oe?`Array(${oe.length})`:"null");else return console.log("[TASK-070] Requested week",i.weekNumber,"is neither current nor previous, no preloaded data available"),null;return Array.isArray(oe)&&oe.length>0?(console.log("[TASK-070] Using preloaded stages data for week",i.weekNumber,":",oe.length,"stages"),oe):(console.log("[TASK-070] No preloaded stages data for week",i.weekNumber,", will use API fallback"),null)}function G(i){var le;if(!i||!s.value)return null;const y=((le=s.value)==null?void 0:le.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber,ee=i.weekNumber===W?O.value.currentWeek.carryoverTicketsByDuration:O.value.previousWeek.carryoverTicketsByDuration;return Array.isArray(ee)&&ee.length>0?(console.log("[TASK-070] Using preloaded carryover data for week",i.weekNumber,":",ee.length,"categories"),ee):(console.log("[TASK-070] No preloaded carryover data for week",i.weekNumber,", will use API fallback"),null)}function U(i){var ee;if(!i||!s.value)return null;const y=((ee=s.value)==null?void 0:ee.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===W&&l.value.responsible||null}function M(i){var ee;if(!i||!s.value)return null;const y=((ee=s.value)==null?void 0:ee.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===W?l.value.responsibleCreatedThisWeek||null:O.value.previousWeek.responsibleCreatedThisWeek||null}function H(i){var ee;if(!i||!s.value)return null;const y=((ee=s.value)==null?void 0:ee.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===W?l.value.responsibleCreatedOtherWeek||null:O.value.previousWeek.responsibleCreatedOtherWeek||null}function Y(i){var ee;if(!i||!s.value)return null;const y=((ee=s.value)==null?void 0:ee.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===W?l.value.closedTicketsCreatedThisWeek??null:null}function x(i){var ee;if(!i||!s.value)return null;const y=((ee=s.value)==null?void 0:ee.weeks)||[],W=y.length>0?y[y.length-1].weekNumber:s.value.weekNumber;return i.weekNumber===W?l.value.closedTicketsCreatedOtherWeek??null:null}function X(i){c.value.stages=i}function b(i){c.value.employees=i}function v(i){c.value.dateRange=i}function L(i){c.value.customDateRange=i}function j(i){if(!["weeks","months"].includes(i)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",i);return}i!==w.value&&(w.value=i,I())}function ae(i){const{mode:y}=i.detail;["weeks","months"].includes(y)&&j(y)}function k(){c.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},n()}function n(){I()}function E(i){["weeks","months"].includes(i)&&(w.value=i)}function R(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",p.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",w.value),p.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",p.value),console.log("[DEBUG] isLoading after:",e.value),bt(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),K()})}function K(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",w.value),console.log("[DEBUG] showPeriodModeInfo:",p.value),console.log("[DEBUG] isLoading:",e.value),(!w.value||!["weeks","months"].includes(w.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),w.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",w.value),bt(()=>{console.log("[DEBUG] nextTick callback, periodMode:",w.value),console.log("[DEBUG] isLoading in nextTick:",e.value),w.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),I()):w.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function P(i=null){var y,W,F;i?D.value=i:D.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:((W=s.value)==null?void 0:W.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},d.value=!0}function z(i=null){var y,W,F;i?D.value=i:D.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:((W=s.value)==null?void 0:W.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},u.value=!0}function V(i=null){var y,W,F;i?D.value=i:D.value={weekNumber:((y=s.value)==null?void 0:y.weekNumber)||null,weekStartUtc:((W=s.value)==null?void 0:W.weekStartUtc)||null,weekEndUtc:((F=s.value)==null?void 0:F.weekEndUtc)||null},m.value=!0}ot(()=>{try{const i="graph-admission-closure-period-mode-info-shown";localStorage.getItem(i)&&localStorage.removeItem(i);const y="graph-admission-closure-period-mode";localStorage.getItem(y)&&localStorage.removeItem(y)}catch(i){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",i)}window.addEventListener("period-mode-change",ae)}),Wt(()=>{window.removeEventListener("period-mode-change",ae)});function f(){const i=new Date,y=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate())),W=y.getUTCDay(),F=y.getUTCDate()-W+(W===0?-6:1),ee=new Date(Date.UTC(y.getUTCFullYear(),y.getUTCMonth(),F,0,0,0)),le=new Date(ee);return le.setUTCDate(le.getUTCDate()+6),le.setUTCHours(23,59,59,999),{weekStartUtc:ee.toISOString(),weekEndUtc:le.toISOString()}}return(i,y)=>{var F,ee,le,oe,se,de,ye,me,ie,be,Ae,De,Se,Ee,Be,Ne,Ue,Ie;const W=St("router-link");return g(),_("div",Ji,[re(ge,{name:"fade",mode:"out-in"},{default:ue(()=>[e.value?(g(),_("div",Qi,[r("div",ec,[y[3]||(y[3]=r("div",{class:"preloader-spinner"},[r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"}),r("div",{class:"spinner-ring"})],-1)),y[4]||(y[4]=r("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),r("p",tc," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+$(w.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),y[5]||(y[5]=r("div",{class:"preloader-dots"},[r("span",{class:"dot"}),r("span",{class:"dot"}),r("span",{class:"dot"})],-1))])])):!p.value&&!e.value?(g(),_("div",rc,[w.value==="months"?(g(),_e(Wn,{key:0})):(g(),_("div",ac,[r("div",sc,[r("div",oc,[r("div",nc,[r("button",{class:"btn-back-link",type:"button",onClick:h,"aria-label":B.value,"aria-disabled":!N.value,"data-fallback":!N.value,disabled:J.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,lc),r("nav",ic,[re(W,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ue(()=>[...y[6]||(y[6]=[fe(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),y[8]||(y[8]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),re(W,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ue(()=>[...y[7]||(y[7]=[fe(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),y[9]||(y[9]=r("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),y[10]||(y[10]=r("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),y[11]||(y[11]=r("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),y[12]||(y[12]=r("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),r("div",cc,[r("div",dc,[re(Bt,{stages:c.value.stages,employees:c.value.employees,dateRange:c.value.dateRange,customDateRange:c.value.customDateRange,hasActiveFilters:A.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":w.value,"onUpdate:stages":X,"onUpdate:employees":b,"onUpdate:dateRange":v,"onUpdate:customDateRange":L,"onUpdate:periodMode":j,onReset:k,onApply:n},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),r("div",uc,[a.value?(g(),_e(Et,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:a.value.message},null,8,["message"])):(g(),_e(Os,{key:1,meta:s.value,data:l.value,onOpenResponsible:z,onOpenStages:P,onOpenCarryover:V},null,8,["meta","data"]))])])]))])):te("",!0)]),_:1}),re(Xl,{"is-visible":u.value,responsible:U(D.value)||l.value.responsible||[],"closed-tickets-created-this-week":Y(D.value)??l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":x(D.value)??l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":M(D.value)||l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":H(D.value)||l.value.responsibleCreatedOtherWeek||[],"week-number":((F=D.value)==null?void 0:F.weekNumber)||((ee=s.value)==null?void 0:ee.weekNumber)||null,"week-start-utc":((le=D.value)==null?void 0:le.weekStartUtc)||((oe=s.value)==null?void 0:oe.weekStartUtc)||null,"week-end-utc":((se=D.value)==null?void 0:se.weekEndUtc)||((de=s.value)==null?void 0:de.weekEndUtc)||null,onClose:y[0]||(y[0]=Me=>{u.value=!1,D.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),re(Ti,{"is-visible":d.value,"week-number":((ye=D.value)==null?void 0:ye.weekNumber)||((me=s.value)==null?void 0:me.weekNumber)||null,"week-start-utc":((ie=D.value)==null?void 0:ie.weekStartUtc)||((be=s.value)==null?void 0:be.weekStartUtc)||null,"week-end-utc":((Ae=D.value)==null?void 0:Ae.weekEndUtc)||((De=s.value)==null?void 0:De.weekEndUtc)||null,"preloaded-data":S(D.value),onClose:y[1]||(y[1]=Me=>{d.value=!1,D.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),re(Xi,{"is-visible":m.value,"week-number":((Se=D.value)==null?void 0:Se.weekNumber)||((Ee=s.value)==null?void 0:Ee.weekNumber)||null,"week-start-utc":((Be=D.value)==null?void 0:Be.weekStartUtc)||((Ne=s.value)==null?void 0:Ne.weekStartUtc)||null,"week-end-utc":((Ue=D.value)==null?void 0:Ue.weekEndUtc)||((Ie=s.value)==null?void 0:Ie.weekEndUtc)||null,"preloaded-data":G(D.value),onClose:y[2]||(y[2]=Me=>{m.value=!1,D.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc","preloaded-data"]),p.value?(g(),_e(ur,{key:0,"is-visible":p.value,"current-mode":w.value,onClose:R,onSelectMode:E},null,8,["is-visible","current-mode"])):te("",!0)])}}},fc=we(kc,[["__scopeId","data-v-9a1c63c1"]]);export{fc as default};
