import{_ as K,c as r,b as m,o as i,a as e,t as y,F as D,e as N,n as p,g as C,d as h,M as V}from"./main-CSNaPKs2.js";const R={name:"WebhookLogDetails",props:{log:{type:Object,default:null}},emits:["close"],setup(c,{emit:s}){const g=C(!1),o=C(null),b=C(!1),k=C(!1),n=5e4,d=2e5,w=h(()=>M.value>d),P=h(()=>F.value>d),A=async t=>{g.value=!1,o.value=null;try{if(!navigator.clipboard)throw new Error("Clipboard API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è");await navigator.clipboard.writeText(t),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch(a){console.error("Failed to copy:",a),o.value=a.message;try{const l=document.createElement("textarea");l.value=t,l.style.position="fixed",l.style.left="-999999px",document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch{o.value="–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å"}}},z=()=>{if(!(!c.log||!c.log.payload))try{const t=_(c.log.payload,2);A(t)}catch(t){console.error("[WebhookLogDetails] Error copying payload:",t),o.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ payload"}},I=(t,a)=>{try{const l=`${t}: ${typeof a=="object"?_(a,2):a}`;A(l)}catch(l){console.error("[WebhookLogDetails] Error copying field:",l),o.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—è"}},B=h(()=>c.log?{timestamp:c.log.timestamp,event:c.log.event,category:c.log.category,ip:c.log.ip}:{}),W=t=>{if(!t)return"N/A";try{return new Date(t).toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return t}},T=t=>({tasks:"–ó–∞–¥–∞—á–∏","smart-processes":"–°–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å—ã",errors:"–û—à–∏–±–∫–∏"})[t]||t,O=t=>`category-${t}`,j=t=>t!=null&&t.startsWith("ONTASK")?"event-task":t!=null&&t.startsWith("ONCRMDYNAMIC")?"event-smart-process":"event-other",J=t=>t.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),x=t=>{if(t==null)return"N/A";if(typeof t=="object")try{return _(t,2)}catch{return"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞]"}return String(t)},E=new WeakMap,_=(t,a=2)=>{const l=new WeakSet;return JSON.stringify(t,(u,f)=>{if(typeof f=="object"&&f!==null){if(l.has(f))return"[Circular]";l.add(f)}return f},a)},L=(t,a=null,l=!1)=>{if(!t)return"N/A";try{if(E.has(t)&&!l){const v=E.get(t);if(v.maxSize===a&&v.showFull===l)return v.result}const u=_(t,2),f=new Blob([u]).size;let S;return a&&f>a&&!l?S=u.substring(0,a)+`

... [JSON –æ–±—Ä–µ–∑–∞–Ω, –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞]`:S=u,f<1e5&&E.set(t,{result:S,maxSize:a,showFull:l,size:f}),S}catch(u){return console.error("[WebhookLogDetails] Error formatting JSON:",u),`[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON: ${u.message}]`}},M=h(()=>{var t;if(!((t=c.log)!=null&&t.payload))return 0;try{const a=performance.now(),l=_(c.log.payload),u=performance.now()-a;return u>100?(console.warn("[WebhookLogDetails] Payload stringify took too long:",u,"ms"),d+1):new Blob([l]).size}catch(a){return console.warn("[WebhookLogDetails] Error calculating payload size:",a),d+1}}),F=h(()=>{var t;if(!((t=c.log)!=null&&t.metadata))return 0;try{const a=_(c.log.metadata);return new Blob([a]).size}catch(a){return console.warn("[WebhookLogDetails] Error calculating metadata size:",a),0}}),X=h(()=>{var t;if(!((t=c.log)!=null&&t.payload))return"N/A";if(w.value)return"";try{return L(c.log.payload,b.value?null:n,b.value)}catch(a){return console.error("[WebhookLogDetails] Error formatting payload:",a),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è payload]"}}),Y=h(()=>{var t;if(!((t=c.log)!=null&&t.metadata))return"N/A";if(P.value)return"";try{return L(c.log.metadata,k.value?null:n,k.value)}catch(a){return console.error("[WebhookLogDetails] Error formatting metadata:",a),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è metadata]"}}),Z=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`;return V(()=>c.log,()=>{b.value=!1,k.value=!1},{immediate:!0}),{copySuccess:g,copyError:o,copyToClipboard:A,copyFullPayload:z,copyField:I,mainInfo:B,formatTimestamp:W,getCategoryLabel:T,getCategoryClass:O,getEventClass:j,formatKey:J,formatValue:x,formatJson:L,formattedPayload:X,formattedMetadata:Y,payloadSize:M,metadataSize:F,showFullPayload:b,showFullMetadata:k,MAX_DISPLAY_SIZE:n,isPayloadTooLarge:w,isMetadataTooLarge:P,formatBytes:Z,handleClose:()=>{s("close")}}}},U={key:0,class:"webhook-log-details"},q={class:"details-header"},G={class:"header-actions"},H={class:"details-content"},Q={key:0,class:"copy-success-message"},$={key:1,class:"copy-error-message"},tt={class:"details-section"},ot={class:"info-grid"},et={class:"info-value-wrapper"},at={key:0},st={key:1},nt={key:2},lt={key:3},rt=["onClick"],it={key:2,class:"details-section"},ct={class:"info-grid"},dt={class:"details-section"},yt={class:"section-header"},gt={class:"section-actions"},ut={key:0,class:"size-warning"},ft={class:"json-container"},mt={key:0,class:"json-content"},ht={key:1,class:"payload-too-large"},_t={key:3,class:"details-section"},bt={class:"section-header"},kt={class:"section-actions"},St={key:0,class:"size-warning"},vt={class:"json-container"},Ct={key:0,class:"json-content"},wt={key:1,class:"payload-too-large"},At={class:"details-footer"};function Et(c,s,g,o,b,k){return g.log?(i(),r("div",U,[e("div",q,[s[7]||(s[7]=e("h3",null,"–î–µ—Ç–∞–ª–∏ –ª–æ–≥–∞ –≤–µ–±—Ö—É–∫–∞",-1)),e("div",G,[e("button",{onClick:s[0]||(s[0]=(...n)=>o.copyFullPayload&&o.copyFullPayload(...n)),class:"btn-copy",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON "),e("button",{onClick:s[1]||(s[1]=(...n)=>o.handleClose&&o.handleClose(...n)),class:"btn-close"},"√ó")])]),e("div",H,[o.copySuccess?(i(),r("div",Q," ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! ")):m("",!0),o.copyError?(i(),r("div",$," ‚ùå "+y(o.copyError),1)):m("",!0),e("div",tt,[s[8]||(s[8]=e("h4",null,"–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),e("div",ot,[(i(!0),r(D,null,N(o.mainInfo,(n,d)=>(i(),r("div",{key:d,class:"info-item"},[e("label",null,y(o.formatKey(d))+":",1),e("div",et,[d==="event"?(i(),r("span",at,[e("span",{class:p(["event-badge",o.getEventClass(n)])},y(n),3)])):d==="category"?(i(),r("span",st,[e("span",{class:p(["category-badge",o.getCategoryClass(n)])},y(o.getCategoryLabel(n)),3)])):d==="timestamp"?(i(),r("span",nt,y(o.formatTimestamp(n)),1)):(i(),r("span",lt,y(n||"N/A"),1)),e("button",{onClick:w=>o.copyField(d,n),class:"btn-copy-field",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ"}," üìã ",8,rt)])]))),128))])]),g.log.details&&Object.keys(g.log.details).length>0?(i(),r("div",it,[s[9]||(s[9]=e("h4",null,"–î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è",-1)),e("div",ct,[(i(!0),r(D,null,N(g.log.details,(n,d)=>(i(),r("div",{key:d,class:"info-item"},[e("label",null,y(o.formatKey(d))+":",1),e("span",null,y(o.formatValue(n)),1)]))),128))])])):m("",!0),e("div",dt,[e("div",yt,[s[10]||(s[10]=e("h4",null,"–ü–æ–ª–Ω—ã–π payload",-1)),e("div",gt,[o.payloadSize>o.MAX_DISPLAY_SIZE?(i(),r("span",ut," –ë–æ–ª—å—à–æ–π JSON ("+y(o.formatBytes(o.payloadSize))+") ",1)):m("",!0),o.payloadSize>o.MAX_DISPLAY_SIZE&&!o.showFullPayload?(i(),r("button",{key:1,onClick:s[2]||(s[2]=n=>o.showFullPayload=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):m("",!0),e("button",{onClick:s[3]||(s[3]=(...n)=>o.copyFullPayload&&o.copyFullPayload(...n)),class:"btn-copy-section",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ")])]),e("div",ft,[o.isPayloadTooLarge?(i(),r("div",ht,[e("p",null,"‚ö†Ô∏è Payload —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+y(o.formatBytes(o.payloadSize))+")",1),s[11]||(s[11]=e("p",null,'–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏.',-1)),e("button",{onClick:s[4]||(s[4]=(...n)=>o.copyFullPayload&&o.copyFullPayload(...n)),class:"btn-copy-section"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å payload ")])):(i(),r("pre",mt,y(o.formattedPayload),1))])]),g.log.metadata?(i(),r("div",_t,[e("div",bt,[s[12]||(s[12]=e("h4",null,"–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ",-1)),e("div",kt,[o.metadataSize>o.MAX_DISPLAY_SIZE?(i(),r("span",St," –ë–æ–ª—å—à–æ–π JSON ("+y(o.formatBytes(o.metadataSize))+") ",1)):m("",!0),o.metadataSize>o.MAX_DISPLAY_SIZE&&!o.showFullMetadata?(i(),r("button",{key:1,onClick:s[5]||(s[5]=n=>o.showFullMetadata=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):m("",!0)])]),e("div",vt,[o.isMetadataTooLarge?(i(),r("div",wt,[e("p",null,"‚ö†Ô∏è Metadata —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+y(o.formatBytes(o.metadataSize))+")",1),s[13]||(s[13]=e("p",null,"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.",-1))])):(i(),r("pre",Ct,y(o.formattedMetadata),1))])])):m("",!0)]),e("div",At,[e("button",{onClick:s[6]||(s[6]=(...n)=>o.handleClose&&o.handleClose(...n)),class:"btn-close-details"},"–ó–∞–∫—Ä—ã—Ç—å")])])):m("",!0)}const Mt=K(R,[["render",Et],["__scopeId","data-v-3db52a2c"]]);export{Mt as default};
