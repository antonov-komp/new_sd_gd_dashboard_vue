const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ticketListUtils-BcsiqEcO.js","assets/priority-config-Cd77jKxU.js","assets/main-7hsq_shQ.js","assets/main-hkNOQW78.css","assets/priority-config-Bxxce_5E.css","assets/ticket-mapper-CftTNKOk.js"])))=>i.map(i=>d[i]);
var Pe=Object.defineProperty;var Fe=(g,s,t)=>s in g?Pe(g,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):g[s]=t;var ye=(g,s,t)=>Fe(g,typeof s!="symbol"?s+"":s,t);import{_ as Q,g as A,G as te,m as _e,H as Oe,f as X,o as l,j as N,k as x,a as i,d as F,b as e,y as ae,n as K,B as J,I as Ge,c as L,J as B,t as b,F as z,e as j,K as ke,L as Ve,x as Ye,l as se,z as Be,r as Re,S as Ne,T as ve,M as ue}from"./main-7hsq_shQ.js";import{F as Le}from"./FiltersPanel-CKkevrYb.js";import{L as ne,D as xe,B as ze}from"./index-C-xEQ_hS.js";import{B as le,g as Me,a as je,b as Ue,D as He,T as he,c as pe}from"./priority-config-Cd77jKxU.js";const qe={key:0,class:"modal-overlay"},Ze={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},Je={class:"modal-body"},Ke={class:"mode-description"},Xe={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:g=>["weeks","months"].includes(g)}},emits:["close","start-loading","select-mode"],setup(g,{emit:s}){const t=g,n=s,c=A(t.currentMode);function k(d){if(!["weeks","months"].includes(d)){console.warn("[PeriodModeInfoModal] Invalid mode:",d);return}c.value=d,n("select-mode",d),n("close"),setTimeout(()=>{n("start-loading")},100)}function D(){n("select-mode",c.value),n("close"),setTimeout(()=>{n("start-loading")},100)}function h(d){d.key==="Escape"&&t.isVisible&&D()}return te(()=>t.currentMode,d=>{["weeks","months"].includes(d)&&(c.value=d)}),_e(()=>{t.isVisible&&document.addEventListener("keydown",h)}),Oe(()=>{document.removeEventListener("keydown",h)}),te(()=>t.isVisible,d=>{d?(document.addEventListener("keydown",h),c.value=t.currentMode):document.removeEventListener("keydown",h)}),(d,v)=>(l(),X(Ge,{to:"body"},[N(J,{name:"modal-fade"},{default:x(()=>[g.isVisible?(l(),i("div",qe,[e("div",Ze,[e("div",{class:"modal-header"},[v[2]||(v[2]=e("h2",{id:"modal-title",class:"modal-title"},[e("span",{class:"modal-icon"},"‚ÑπÔ∏è"),ae(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),e("button",{class:"modal-close-btn",onClick:D,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),e("div",Je,[v[5]||(v[5]=e("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),e("div",Ke,[e("button",{class:K(["mode-item mode-item--clickable",{"mode-item--selected":c.value==="weeks"}]),onClick:v[0]||(v[0]=y=>k("weeks")),type:"button"},[...v[3]||(v[3]=[e("div",{class:"mode-header"},[e("span",{class:"mode-icon"},"üìÖ"),e("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),e("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),e("button",{class:K(["mode-item mode-item--clickable",{"mode-item--selected":c.value==="months"}]),onClick:v[1]||(v[1]=y=>k("months")),type:"button"},[...v[4]||(v[4]=[e("div",{class:"mode-header"},[e("span",{class:"mode-icon"},"üìä"),e("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),e("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):F("",!0)]),_:1})]))}},Qe=Q(Xe,[["__scopeId","data-v-b2a86226"]]),et={class:"ac-chart"},tt={class:"ac-chart__header"},st={class:"ac-chart__subtitle"},at={class:"ac-chart__controls"},rt={class:"chart-type-selector"},ot=["onClick"],lt={class:"chart-type-icon"},nt={class:"chart-type-label"},it={class:"ac-chart__summary"},dt={class:"summary-card__value"},ct={class:"summary-card__value-main"},ut={class:"summary-card__breakdown"},kt={class:"breakdown-item breakdown-item--this-week"},vt={class:"breakdown-item__value"},ht={class:"breakdown-item breakdown-item--other-week"},yt={class:"breakdown-item__value"},mt={class:"summary-card__value-main"},_t={class:"summary-card__breakdown"},pt={class:"breakdown-item breakdown-item--this-week"},gt={class:"breakdown-item__value"},bt={class:"breakdown-item breakdown-item--other-week"},ft={class:"breakdown-item__value"},wt={class:"summary-card summary-card--stages"},Tt={class:"summary-card__tags"},Ct={key:0,class:"stage-tag stage-tag--empty"},$t={class:"ac-chart__body"},Wt={key:0,class:"split-charts-container"},Dt={class:"chart-wrapper chart-wrapper--left"},Et={class:"chart-canvas-wrapper"},At={class:"chart-wrapper chart-wrapper--right"},It={class:"chart-canvas-wrapper"},St={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(g,{emit:s}){const t=g,n=s,c=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],k=A("line");L(()=>{var m;return((m=t.meta)==null?void 0:m.weekNumber)??"‚Äî"});const D=()=>{var o,I;const m=((o=t.meta)==null?void 0:o.weeks)||[];return m.length>0?m.map(f=>`–ù–µ–¥–µ–ª—è ${f.weekNumber}`):[(I=t.meta)!=null&&I.weekNumber?`–ù–µ–¥–µ–ª—è ${t.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]},h=L(()=>{var _,R,W,S;const m=D(),o=Array.isArray((_=t.data.series)==null?void 0:_.new)&&t.data.series.new.length>0?t.data.series.new:[t.data.newTickets??0],I=Array.isArray((R=t.data.series)==null?void 0:R.closed)&&t.data.series.closed.length>0?t.data.series.closed:[t.data.closedTickets??0],f=Array.isArray((W=t.data.series)==null?void 0:W.closedCreatedThisWeek)&&t.data.series.closedCreatedThisWeek.length>0?t.data.series.closedCreatedThisWeek:[t.data.closedTicketsCreatedThisWeek??0],u=Array.isArray((S=t.data.series)==null?void 0:S.closedCreatedOtherWeek)&&t.data.series.closedCreatedOtherWeek.length>0?t.data.series.closedCreatedOtherWeek:[t.data.closedTicketsCreatedOtherWeek??0];return{labels:m,datasets:[{label:"–ù–æ–≤—ã–µ",data:o,backgroundColor:B.primary,borderColor:B.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:I,backgroundColor:B.success,borderColor:B.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:f,backgroundColor:B.successLight,borderColor:B.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:u,backgroundColor:B.warning,borderColor:B.warning,tension:.3,fill:!1,borderDash:[5,5]}]}}),d=L(()=>{var u,_,R;const m=D(),o=Array.isArray((u=t.data.series)==null?void 0:u.carryover)&&t.data.series.carryover.length>0?t.data.series.carryover:[t.data.carryoverTickets??0],I=Array.isArray((_=t.data.series)==null?void 0:_.carryoverCreatedThisWeek)&&t.data.series.carryoverCreatedThisWeek.length>0?t.data.series.carryoverCreatedThisWeek:[t.data.carryoverTicketsCreatedThisWeek??0],f=Array.isArray((R=t.data.series)==null?void 0:R.carryoverCreatedOtherWeek)&&t.data.series.carryoverCreatedOtherWeek.length>0?t.data.series.carryoverCreatedOtherWeek:[t.data.carryoverTicketsCreatedOtherWeek??0];return{labels:m,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:o,backgroundColor:B.carryover,borderColor:B.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:I,backgroundColor:B.carryoverLight,borderColor:B.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:f,backgroundColor:B.carryoverDark,borderColor:B.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),v=L(()=>{var G,V,H,Z,r,a,T,E,O;const m=((G=t.meta)==null?void 0:G.weeks)||[],o=m.length>0?m.map(M=>`–ù–µ–¥–µ–ª—è ${M.weekNumber}`):[(V=t.meta)!=null&&V.weekNumber?`–ù–µ–¥–µ–ª—è ${t.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],I=Array.isArray((H=t.data.series)==null?void 0:H.new)&&t.data.series.new.length>0?t.data.series.new:[t.data.newTickets??0],f=Array.isArray((Z=t.data.series)==null?void 0:Z.closed)&&t.data.series.closed.length>0?t.data.series.closed:[t.data.closedTickets??0],u=Array.isArray((r=t.data.series)==null?void 0:r.closedCreatedThisWeek)&&t.data.series.closedCreatedThisWeek.length>0?t.data.series.closedCreatedThisWeek:[t.data.closedTicketsCreatedThisWeek??0],_=Array.isArray((a=t.data.series)==null?void 0:a.closedCreatedOtherWeek)&&t.data.series.closedCreatedOtherWeek.length>0?t.data.series.closedCreatedOtherWeek:[t.data.closedTicketsCreatedOtherWeek??0],R=Array.isArray((T=t.data.series)==null?void 0:T.carryover)&&t.data.series.carryover.length>0?t.data.series.carryover:[t.data.carryoverTickets??0],W=Array.isArray((E=t.data.series)==null?void 0:E.carryoverCreatedThisWeek)&&t.data.series.carryoverCreatedThisWeek.length>0?t.data.series.carryoverCreatedThisWeek:[t.data.carryoverTicketsCreatedThisWeek??0],S=Array.isArray((O=t.data.series)==null?void 0:O.carryoverCreatedOtherWeek)&&t.data.series.carryoverCreatedOtherWeek.length>0?t.data.series.carryoverCreatedOtherWeek:[t.data.carryoverTicketsCreatedOtherWeek??0];return{labels:o,datasets:[{label:"–ù–æ–≤—ã–µ",data:I,backgroundColor:B.primary,borderColor:B.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:f,backgroundColor:B.success,borderColor:B.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:u,backgroundColor:B.successLight,borderColor:B.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:_,backgroundColor:B.warning,borderColor:B.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:R,backgroundColor:B.carryover,borderColor:B.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:W,backgroundColor:B.carryoverLight,borderColor:B.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:S,backgroundColor:B.carryoverDark,borderColor:B.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),y=L(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[t.data.newTickets??0,t.data.closedTickets??0,t.data.carryoverTickets??0],backgroundColor:[B.primary,B.success,B.carryover],borderWidth:1}]})),C=L(()=>{switch(k.value){case"line":return ne;case"bar":return ze;case"doughnut":return xe;default:return ne}}),p=L(()=>k.value==="doughnut"?y.value:v.value),$=m=>{if(!m)return"‚Äî";try{return new Date(m).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return m}},Y=L(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,plugins:{tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12,callbacks:{title:m=>{var R,W,S,G,V,H;const o=(R=m[0])==null?void 0:R.dataIndex,I=((W=t.meta)==null?void 0:W.weeks)||[];if(I.length>0&&o!==void 0&&I[o]){const Z=I[o];return`–ù–µ–¥–µ–ª—è ${Z.weekNumber} (${$(Z.weekStartUtc)} ‚Äî ${$(Z.weekEndUtc)})`}const f=(S=t.meta)==null?void 0:S.weekNumber,u=(G=t.meta)==null?void 0:G.weekStartUtc,_=(V=t.meta)==null?void 0:V.weekEndUtc;return f&&u&&_?`–ù–µ–¥–µ–ª—è ${f} (${$(u)} ‚Äî ${$(_)})`:((H=m[0])==null?void 0:H.label)||""}}},legend:{position:"top",labels:{font:{size:15,weight:"500"},padding:16,boxWidth:20,boxHeight:12}}},scales:k.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},title:{display:!1},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10},title:{display:!1},grid:{lineWidth:1.5}}}})),U=L(()=>{var m,o,I,f;if((m=t.data)!=null&&m.series){const u=t.data.series,_=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,-1);if(_>=0){const R={newTickets:Array.isArray(u.new)&&u.new[_]!==void 0?u.new[_]:0,closedTickets:Array.isArray(u.closed)&&u.closed[_]!==void 0?u.closed[_]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[_]!==void 0?u.closedCreatedThisWeek[_]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[_]!==void 0?u.closedCreatedOtherWeek[_]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[_]!==void 0?u.carryover[_]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[_]!==void 0?u.carryoverCreatedThisWeek[_]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[_]!==void 0?u.carryoverCreatedOtherWeek[_]:0};if(R.newTickets>0||R.closedTickets>0||R.carryoverTickets>0)return R}}if((o=t.data)!=null&&o.currentWeek&&typeof t.data.currentWeek=="object"){const u=t.data.currentWeek;if((u.newTickets??0)>0||(u.closedTickets??0)>0||(u.carryoverTickets??0)>0)return u}if((I=t.data)!=null&&I.weeksData&&Array.isArray(t.data.weeksData)&&t.data.weeksData.length>0){const u=t.data.weeksData[t.data.weeksData.length-1];if((u.newTickets??0)>0||(u.closedTickets??0)>0||(u.carryoverTickets??0)>0)return u}if((f=t.data)!=null&&f.series){const u=t.data.series,_=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,-1);if(_>=0)return{newTickets:Array.isArray(u.new)&&u.new[_]!==void 0?u.new[_]:0,closedTickets:Array.isArray(u.closed)&&u.closed[_]!==void 0?u.closed[_]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[_]!==void 0?u.closedCreatedThisWeek[_]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[_]!==void 0?u.closedCreatedOtherWeek[_]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[_]!==void 0?u.carryover[_]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[_]!==void 0?u.carryoverCreatedThisWeek[_]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[_]!==void 0?u.carryoverCreatedOtherWeek[_]:0}}return t.data||{}}),P=m=>{var _;const o=U.value,I=(o==null?void 0:o.newTickets)??0,f=(o==null?void 0:o.closedTickets)??0,u=(o==null?void 0:o.carryoverTickets)??0;m==="new"&&I>0?n("open-stages"):m==="closed"&&f>0?(((_=t.data)==null?void 0:_.responsible)||[]).length>0&&n("open-responsible"):m==="carryover"&&u>0&&n("open-carryover")};return(m,o)=>{var I,f,u,_,R,W,S,G,V,H,Z,r,a,T,E,O;return l(),i("div",et,[e("header",tt,[e("div",null,[o[3]||(o[3]=e("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),e("p",st," –ù–µ–¥–µ–ª—è "+b(((f=(I=g.meta)==null?void 0:I.currentWeek)==null?void 0:f.weekNumber)??((u=g.meta)==null?void 0:u.weekNumber)??"‚Äî")+" ¬∑ "+b((((R=(_=g.meta)==null?void 0:_.currentWeek)==null?void 0:R.weekStartUtc)??((W=g.meta)==null?void 0:W.weekStartUtc))||"‚Äî")+" ‚Äî "+b((((G=(S=g.meta)==null?void 0:S.currentWeek)==null?void 0:G.weekEndUtc)??((V=g.meta)==null?void 0:V.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),e("div",at,[e("div",rt,[(l(),i(z,null,j(c,M=>e("button",{key:M.value,class:K(["chart-type-btn",{active:k.value===M.value}]),onClick:w=>k.value=M.value},[e("span",lt,b(M.icon),1),e("span",nt,b(M.label),1)],10,ot)),64))])])]),e("section",it,[e("div",{class:"summary-card summary-card--new",onClick:o[0]||(o[0]=M=>P("new"))},[o[4]||(o[4]=e("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",dt,b(((H=U.value)==null?void 0:H.newTickets)??0),1)]),e("div",{class:"summary-card summary-card--closed-breakdown",onClick:o[1]||(o[1]=M=>P("closed"))},[o[9]||(o[9]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",ct,b(((Z=U.value)==null?void 0:Z.closedTickets)??0),1),e("div",ut,[e("div",kt,[o[5]||(o[5]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",vt,b(((r=U.value)==null?void 0:r.closedTicketsCreatedThisWeek)??0),1),o[6]||(o[6]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),e("div",ht,[o[7]||(o[7]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",yt,b(((a=U.value)==null?void 0:a.closedTicketsCreatedOtherWeek)??0),1),o[8]||(o[8]=e("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),e("div",{class:"summary-card summary-card--carryover-breakdown",onClick:o[2]||(o[2]=M=>P("carryover"))},[o[14]||(o[14]=e("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),e("div",mt,b(((T=U.value)==null?void 0:T.carryoverTickets)??0),1),e("div",_t,[e("div",pt,[o[10]||(o[10]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",gt,b(((E=U.value)==null?void 0:E.carryoverTicketsCreatedThisWeek)??0),1),o[11]||(o[11]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),e("div",bt,[o[12]||(o[12]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",ft,b(((O=U.value)==null?void 0:O.carryoverTicketsCreatedOtherWeek)??0),1),o[13]||(o[13]=e("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö",-1))])])]),e("div",wt,[o[15]||(o[15]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("div",Tt,[(l(!0),i(z,null,j(g.data.stages||[],M=>(l(),i("span",{key:M.stageId,class:"stage-tag"},b(M.stageName||M.stageId)+" ‚Äî "+b(M.count),1))),128)),!g.data.stages||g.data.stages.length===0?(l(),i("span",Ct," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):F("",!0)])])]),e("div",$t,[k.value==="line"?(l(),i("div",Wt,[e("div",Dt,[o[16]||(o[16]=e("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",Et,[N(ke(ne),{data:h.value,options:Y.value},null,8,["data","options"])])]),e("div",At,[o[17]||(o[17]=e("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",It,[N(ke(ne),{data:d.value,options:Y.value},null,8,["data","options"])])])])):(l(),X(Ve(C.value),{key:1,data:p.value,options:Y.value},null,8,["data","options"]))])])}}},Mt=Q(St,[["__scopeId","data-v-73ab5a50"]]),Ut={class:"summary-cards-months"},Ot={class:"summary-card summary-card--new"},Bt={class:"card-content"},Rt={class:"card-main-value"},Nt={class:"card-month-breakdown"},Lt={class:"month-name"},Pt={class:"month-value"},Ft={key:0,class:"month-item month-item--empty"},Gt={class:"summary-card summary-card--closed"},Vt={class:"card-content"},Yt={class:"card-main-value"},xt={class:"card-month-breakdown-hierarchical"},zt={class:"month-header"},jt={class:"month-name"},Ht={class:"month-value"},qt={class:"month-breakdown"},Zt={class:"breakdown-item breakdown-this-week"},Jt={class:"breakdown-value"},Kt={class:"breakdown-item breakdown-other-week"},Xt={class:"breakdown-value"},Qt={key:0,class:"month-item-hierarchical month-item--empty"},es={class:"summary-card summary-card--carryover"},ts={class:"card-content"},ss={class:"card-main-value"},as={class:"card-month-breakdown"},rs={class:"month-name"},os={class:"month-value"},ls={key:0,class:"month-item month-item--empty"},ns={class:"summary-card summary-card--stages"},is={class:"card-content"},ds={class:"stages-list"},cs={class:"stage-icon"},us={class:"stage-name"},ks={class:"stage-value"},vs={key:0,class:"stage-item stage-item--empty"},hs={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(g){const s=g;function t(y){return y==null||isNaN(y)?"0":y>=1e6?(y/1e6).toFixed(1)+"M":y>=1e3?y.toLocaleString("ru-RU"):y.toString()}const n=L(()=>{var y;return((y=s.data)==null?void 0:y.newTickets)||0}),c=L(()=>t(n.value)),k=L(()=>{var y;return((y=s.data)==null?void 0:y.newTicketsByMonth)||[]}),D=L(()=>{var y;return((y=s.data)==null?void 0:y.closedTicketsByMonth)||[]}),h=L(()=>{var y;return((y=s.data)==null?void 0:y.carryoverTicketsByMonth)||[]});function d(y){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[y]||""}function v(y){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[y]||"‚Ä¢"}return(y,C)=>(l(),i("div",Ut,[e("div",Ot,[C[0]||(C[0]=e("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),e("div",Bt,[e("div",Rt,b(c.value),1),e("div",Nt,[(l(!0),i(z,null,j(k.value,p=>(l(),i("div",{key:`new-${p.month}`,class:"month-item"},[e("span",Lt,b(p.monthName)+":",1),e("span",Pt,b(t(p.count)),1)]))),128)),k.value.length===0?(l(),i("div",Ft," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):F("",!0)])])]),e("div",Gt,[C[5]||(C[5]=e("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),e("div",Vt,[e("div",Yt,b(t(g.data.closedTickets||0)),1),e("div",xt,[(l(!0),i(z,null,j(D.value,p=>(l(),i("div",{key:`closed-${p.month}`,class:"month-item-hierarchical"},[e("div",zt,[e("span",jt,b(p.monthName)+":",1),e("span",Ht,b(t(p.count||0)),1)]),e("div",qt,[e("div",Zt,[C[1]||(C[1]=e("span",{class:"breakdown-icon"},"‚úì",-1)),C[2]||(C[2]=e("span",{class:"breakdown-label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π:",-1)),e("span",Jt,b(t(p.closedCreatedThisWeek||0)),1)]),e("div",Kt,[C[3]||(C[3]=e("span",{class:"breakdown-icon"},"‚Üª",-1)),C[4]||(C[4]=e("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π:",-1)),e("span",Xt,b(t(p.closedCreatedOtherWeek||0)),1)])])]))),128)),D.value.length===0?(l(),i("div",Qt," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):F("",!0)])])]),e("div",es,[C[6]||(C[6]=e("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),e("div",ts,[e("div",ss,b(t(g.data.carryoverTickets||0)),1),e("div",as,[(l(!0),i(z,null,j(h.value,p=>(l(),i("div",{key:`carryover-${p.month}`,class:"month-item"},[e("span",rs,b(p.monthName)+":",1),e("span",os,b(t(p.count||0)),1)]))),128)),h.value.length===0?(l(),i("div",ls," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):F("",!0)])])]),e("div",ns,[C[8]||(C[8]=e("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("div",is,[e("div",ds,[(l(!0),i(z,null,j(g.data.stages||[],p=>(l(),i("div",{key:p.stageId,class:K(["stage-item",d(p.stageId)])},[e("span",cs,b(v(p.stageId)),1),e("span",us,b(p.stageName||p.stageId)+":",1),e("span",ks,b(t(p.count||0)),1)],2))),128)),!g.data.stages||g.data.stages.length===0?(l(),i("div",vs,[...C[7]||(C[7]=[e("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):F("",!0)])])])]))}},ys=Q(hs,[["__scopeId","data-v-7325e15b"]]),ms={class:"line-chart-months"},_s={class:"chart-section"},ps={class:"chart-container"},gs={class:"chart-section"},bs={class:"chart-container"},fs={class:"chart-table-section"},ws={class:"chart-table-wrapper"},Ts={class:"data-table"},Cs={class:"data-row data-row--new"},$s={class:"data-row data-row--closed"},Ws={class:"data-row data-row--carryover"},Ds={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(g){const s=g;function t(d){return d==null||isNaN(d)?"0":d>=1e3?d.toLocaleString("ru-RU"):d.toString()}const n=L(()=>{var v,y,C;const d=new Set;return(v=s.data.newTicketsByMonth)==null||v.forEach(p=>{p.weeks&&Array.isArray(p.weeks)&&p.weeks.forEach($=>{$&&$.weekNumber&&d.add($.weekNumber)})}),(y=s.data.closedTicketsByMonth)==null||y.forEach(p=>{p.weeks&&Array.isArray(p.weeks)&&p.weeks.forEach($=>{$&&$.weekNumber&&d.add($.weekNumber)})}),(C=s.data.carryoverTicketsByMonth)==null||C.forEach(p=>{p.weeks&&Array.isArray(p.weeks)&&p.weeks.forEach($=>{$&&$.weekNumber&&d.add($.weekNumber)})}),Array.from(d).sort((p,$)=>p-$)}),c=L(()=>{const d=s.data.newTicketsByMonth||[],v=d.map(p=>p.monthName||`–ú–µ—Å—è—Ü ${p.month}`),y=d.map(p=>p.count||0),C=(s.data.closedTicketsByMonth||[]).map(p=>p.count||0);return{labels:v,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:y,borderColor:B.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:C,borderColor:B.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1}]}}),k=L(()=>{const d=s.data.carryoverTicketsByMonth||[],v=d.map(C=>C.monthName||`–ú–µ—Å—è—Ü ${C.month}`),y=d.map(C=>C.count||0);return{labels:v,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:y,borderColor:B.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1}]}}),D={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function h(d,v){let y=[];switch(d){case"new":y=s.data.newTicketsByMonth||[];break;case"closed":y=s.data.closedTicketsByMonth||[];break;case"carryover":y=s.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const C of y){if(!C.weeks||!Array.isArray(C.weeks))continue;const p=C.weeks.find($=>$&&$.weekNumber===v);if(p){const $=p.count||0;return $>0?t($):"-"}}return"-"}return(d,v)=>(l(),i("div",ms,[e("div",_s,[v[0]||(v[0]=e("h3",{class:"chart-title"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",ps,[N(ke(ne),{data:c.value,options:D},null,8,["data"])])]),e("div",gs,[v[1]||(v[1]=e("h3",{class:"chart-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",bs,[N(ke(ne),{data:k.value,options:D},null,8,["data"])])]),e("div",fs,[v[6]||(v[6]=e("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),e("div",ws,[e("table",Ts,[e("thead",null,[e("tr",null,[v[2]||(v[2]=e("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(l(!0),i(z,null,j(n.value,y=>(l(),i("th",{key:`week-${y}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+b(y),1))),128))])]),e("tbody",null,[e("tr",Cs,[v[3]||(v[3]=e("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(l(!0),i(z,null,j(n.value,y=>(l(),i("td",{key:`new-${y}`,class:"week-data-cell"},b(h("new",y)),1))),128))]),e("tr",$s,[v[4]||(v[4]=e("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(l(!0),i(z,null,j(n.value,y=>(l(),i("td",{key:`closed-${y}`,class:"week-data-cell"},b(h("closed",y)),1))),128))]),e("tr",Ws,[v[5]||(v[5]=e("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(l(!0),i(z,null,j(n.value,y=>(l(),i("td",{key:`carryover-${y}`,class:"week-data-cell"},b(h("carryover",y)),1))),128))])])])])])]))}},Es=Q(Ds,[["__scopeId","data-v-f048a2de"]]),As={class:"months-preloader"},Is={class:"preloader-content"},Ss={class:"progress-container"},Ms={class:"progress-bar"},Us={class:"progress-text"},Os={class:"preloader-message"},Bs={class:"stages-list"},Rs={class:"stage-icon"},Ns={class:"stage-text"},Ls={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:g=>g>=0&&g<=100},currentStage:{type:String,default:""}},setup(g){const s=g,t=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:10},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–∫—Ç—è–±—Ä—å...",threshold:40},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–æ—è–±—Ä—å...",threshold:70},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–∫–∞–±—Ä—å...",threshold:90},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:95},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function n(k){return s.progress>=t[k].threshold}function c(k){const D=t[k].threshold,h=k>0?t[k-1].threshold:0;return s.progress>=h&&s.progress<D}return(k,D)=>(l(),i("div",As,[e("div",Is,[D[0]||(D[0]=Ye('<div class="preloader-spinner" data-v-23ab71eb><div class="spinner-ring" data-v-23ab71eb></div><div class="spinner-ring" data-v-23ab71eb></div><div class="spinner-ring" data-v-23ab71eb></div></div><h3 class="preloader-title" data-v-23ab71eb>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),e("div",Ss,[e("div",Ms,[e("div",{class:"progress-fill",style:se({width:`${g.progress}%`})},null,4)]),e("div",Us,b(Math.round(g.progress))+"%",1)]),e("p",Os,b(g.currentStage),1),e("div",Bs,[(l(),i(z,null,j(t,(h,d)=>e("div",{key:d,class:K(["stage-item",{"stage-completed":n(d),"stage-current":c(d)}])},[e("span",Rs,b(n(d)?"‚úì":c(d)?"‚Üí":"‚óã"),1),e("span",Ns,b(h.label),1)],2)),64))])])]))}},Ps=Q(Ls,[["__scopeId","data-v-23ab71eb"]]),Fs="/api/graph-1c-admission-closure.php";function Gs(g){var n,c,k,D,h,d,v,y,C,p,$,Y,U,P,m,o,I,f,u,_,R,W,S,G,V,H,Z,r,a,T,E,O,M,w,q,oe,ie,de,ce,ee,ge,be,fe,we,Te,Ce,$e,We,De,Ee,Ae,Ie,Se;if(!g)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},weeksData:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const s=g.data||g.result||g,t=s.meta||g.meta||null;return{meta:{...t,currentWeek:(t==null?void 0:t.currentWeek)||(t?{weekNumber:t.weekNumber,weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc}:null),weeks:(t==null?void 0:t.weeks)||[]},data:{currentWeek:((n=s.data)==null?void 0:n.currentWeek)||(s.data?{newTickets:s.data.newTickets??0,closedTickets:s.data.closedTickets??0,closedTicketsCreatedThisWeek:s.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:s.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:s.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:s.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:s.data.carryoverTicketsCreatedOtherWeek??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0}),newTickets:((k=(c=s.data)==null?void 0:c.currentWeek)==null?void 0:k.newTickets)??((D=s.data)==null?void 0:D.newTickets)??s.newTickets??0,closedTickets:((d=(h=s.data)==null?void 0:h.currentWeek)==null?void 0:d.closedTickets)??((v=s.data)==null?void 0:v.closedTickets)??s.closedTickets??0,closedTicketsCreatedThisWeek:((C=(y=s.data)==null?void 0:y.currentWeek)==null?void 0:C.closedTicketsCreatedThisWeek)??((p=s.data)==null?void 0:p.closedTicketsCreatedThisWeek)??s.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((Y=($=s.data)==null?void 0:$.currentWeek)==null?void 0:Y.closedTicketsCreatedOtherWeek)??((U=s.data)==null?void 0:U.closedTicketsCreatedOtherWeek)??s.closedTicketsCreatedOtherWeek??0,carryoverTickets:((m=(P=s.data)==null?void 0:P.currentWeek)==null?void 0:m.carryoverTickets)??((o=s.data)==null?void 0:o.carryoverTickets)??s.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((f=(I=s.data)==null?void 0:I.currentWeek)==null?void 0:f.carryoverTicketsCreatedThisWeek)??((u=s.data)==null?void 0:u.carryoverTicketsCreatedThisWeek)??s.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((R=(_=s.data)==null?void 0:_.currentWeek)==null?void 0:R.carryoverTicketsCreatedOtherWeek)??((W=s.data)==null?void 0:W.carryoverTicketsCreatedOtherWeek)??s.carryoverTicketsCreatedOtherWeek??0,series:{new:((G=(S=s.data)==null?void 0:S.series)==null?void 0:G.new)??((V=s.series)==null?void 0:V.new)??[0],closed:((Z=(H=s.data)==null?void 0:H.series)==null?void 0:Z.closed)??((r=s.series)==null?void 0:r.closed)??[0],closedCreatedThisWeek:((T=(a=s.data)==null?void 0:a.series)==null?void 0:T.closedCreatedThisWeek)??((E=s.series)==null?void 0:E.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((M=(O=s.data)==null?void 0:O.series)==null?void 0:M.closedCreatedOtherWeek)??((w=s.series)==null?void 0:w.closedCreatedOtherWeek)??[0],carryover:((oe=(q=s.data)==null?void 0:q.series)==null?void 0:oe.carryover)??((ie=s.series)==null?void 0:ie.carryover)??[0],carryoverCreatedThisWeek:((ce=(de=s.data)==null?void 0:de.series)==null?void 0:ce.carryoverCreatedThisWeek)??((ee=s.series)==null?void 0:ee.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((be=(ge=s.data)==null?void 0:ge.series)==null?void 0:be.carryoverCreatedOtherWeek)??((fe=s.series)==null?void 0:fe.carryoverCreatedOtherWeek)??[0]},weeksData:((we=s.data)==null?void 0:we.weeksData)??s.weeksData??[],stages:((Te=s.data)==null?void 0:Te.stages)??s.stages??[],responsible:((Ce=s.data)==null?void 0:Ce.responsible)??s.responsible??[],responsibleCreatedThisWeek:(($e=s.data)==null?void 0:$e.responsibleCreatedThisWeek)??s.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((We=s.data)==null?void 0:We.responsibleCreatedOtherWeek)??s.responsibleCreatedOtherWeek??[],newTicketsByStages:((De=s.data)==null?void 0:De.newTicketsByStages)??s.newTicketsByStages??null,carryoverTicketsByDuration:((Ee=s.data)==null?void 0:Ee.carryoverTicketsByDuration)??s.carryoverTicketsByDuration??null,newTicketsByMonth:((Ae=s.data)==null?void 0:Ae.newTicketsByMonth)??s.newTicketsByMonth??[],closedTicketsByMonth:((Ie=s.data)==null?void 0:Ie.closedTicketsByMonth)??s.closedTicketsByMonth??[],carryoverTicketsByMonth:((Se=s.data)==null?void 0:Se.carryoverTicketsByMonth)??s.carryoverTicketsByMonth??[]}}}async function re(g={}){const{endpoint:s=Fs,product:t="1C",weekStartUtc:n=null,weekEndUtc:c=null,periodMode:k="weeks",useCache:D=!0,forceRefresh:h=!1,includeTickets:d=!1,includeNewTicketsByStages:v=!1,includeCarryoverTickets:y=!0,includeCarryoverTicketsByDuration:C=!1}=g,$=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product:t,weekStartUtc:n,weekEndUtc:c,periodMode:k,useCache:D,forceRefresh:h,includeTickets:d,includeNewTicketsByStages:v,includeCarryoverTickets:y,includeCarryoverTicketsByDuration:C})});if(!$.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${$.status})`);const Y=await $.json();if((Y==null?void 0:Y.success)===!1)throw new Error(Y.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return Gs(Y)}const Vs={class:"ac-dashboard-months"},Ys={key:"content"},xs={class:"dashboard-header"},zs={class:"header-content"},js={class:"breadcrumbs-row"},Hs=["aria-label","aria-disabled","data-fallback","disabled"],qs={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Zs={class:"dashboard-layout"},Js={class:"filters-container"},Ks={class:"chart-container"},Xs={__name:"GraphAdmissionClosureMonthsDashboard",setup(g){const s=Be(),t=A(!0),n=A(0),c=A("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),k=A(null),D=A(null),h=A({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]}),d=A(!1),v=L(()=>typeof window>"u"?!1:window.history.length>1),y=L(()=>v.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),C={name:"dashboard-sector-1c"};function p(W){var S;if((S=W==null?void 0:W.preventDefault)==null||S.call(W),!d.value){d.value=!0;try{if(v.value){s.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),s.push(C)}finally{d.value=!1}}}const $=A({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),Y=L(()=>{const W=$.value.customDateRange.startDate||$.value.customDateRange.endDate,S=$.value.employees.length===1&&$.value.employees.includes("all");return W||!S});async function U(W,S,G=500){const V=n.value,H=10,Z=(W-V)/H,r=G/H;for(let a=0;a<H;a++)await new Promise(T=>setTimeout(T,r)),n.value=Math.min(V+Z*(a+1),W);n.value=W,c.value=S}async function P(){t.value=!0,k.value=null,n.value=0,c.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...";try{await U(10,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",300),await U(40,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–∫—Ç—è–±—Ä—å...",800),await U(70,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–æ—è–±—Ä—å...",800),await U(90,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–∫–∞–±—Ä—å...",800),await U(95,"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",400);const W=await re({product:"1C",periodMode:"months",includeTickets:!0});await U(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300);const{meta:S,data:G}=W;D.value=S,h.value=G,await new Promise(V=>setTimeout(V,200))}catch(W){k.value=W instanceof Error?W:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",W),n.value=100}finally{t.value=!1}}function m(W){$.value.stages=W}function o(W){$.value.employees=W}function I(W){$.value.dateRange=W}function f(W){$.value.customDateRange=W}function u(){$.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},_()}function _(){P()}function R(W){if(!["weeks","months"].includes(W)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",W);return}if(W==="weeks"){try{localStorage.setItem("graph-admission-closure-period-mode",W)}catch(S){console.warn("[GraphAdmissionClosureMonthsDashboard] Failed to save mode to localStorage:",S)}window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:W}}))}}return _e(()=>{P()}),(W,S)=>{const G=Re("router-link");return l(),i("div",Vs,[N(J,{name:"fade",mode:"out-in"},{default:x(()=>[t.value?(l(),X(Ps,{key:"preloader",progress:n.value,"current-stage":c.value},null,8,["progress","current-stage"])):(l(),i("div",Ys,[e("div",xs,[e("div",zs,[e("div",js,[e("button",{class:"btn-back-link",type:"button",onClick:p,"aria-label":y.value,"aria-disabled":!v.value,"data-fallback":!v.value,disabled:d.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,Hs),e("nav",qs,[N(G,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:x(()=>[...S[0]||(S[0]=[ae(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),S[2]||(S[2]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),N(G,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:x(()=>[...S[1]||(S[1]=[ae(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),S[3]||(S[3]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),S[4]||(S[4]=e("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),S[5]||(S[5]=e("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),S[6]||(S[6]=e("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),e("div",Zs,[e("div",Js,[N(Le,{stages:$.value.stages,employees:$.value.employees,dateRange:$.value.dateRange,customDateRange:$.value.customDateRange,hasActiveFilters:Y.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":m,"onUpdate:employees":o,"onUpdate:dateRange":I,"onUpdate:customDateRange":f,"onUpdate:periodMode":R,onReset:u,onApply:_},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),e("div",Ks,[k.value?(l(),X(Ne,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:k.value.message},null,8,["message"])):(l(),i(z,{key:1},[N(ys,{data:h.value},null,8,["data"]),N(Es,{data:h.value,meta:D.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},Qs=Q(Xs,[["__scopeId","data-v-b1ceb18a"]]);class me{static async getSectorData(){try{const s=await this.getAllTickets();console.log("Total tickets loaded:",s.length);const t=this.extractUniqueEmployeeIds(s);console.log("Unique employee IDs:",t);const n=await this.getEmployeesByIds(t);return console.log("Loaded employees:",n.length),{stages:this.groupTicketsByStages(s,n),employees:n,zeroPointTickets:this.getZeroPointTickets(s)}}catch(s){throw console.error("Error getting sector data:",s),s}}static async getAllTickets(){const s=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],t=[];for(const n of s){console.log(`Loading tickets for stage: ${n}`);const c=await this.getTicketsByStage(n);t.push(...c),console.log(`Loaded ${c.length} tickets for stage ${n}`)}return t}static async getTicketsByStage(s){const t=[];let n=0;const c=50;let k=!0;for(;k;)try{const h=await le.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:s},select:["*"],order:{id:"DESC"},start:n,useOriginalUfNames:"Y"});let d=[];h&&h.result&&(Array.isArray(h.result)?d=h.result:h.result.items&&Array.isArray(h.result.items)?d=h.result.items:h.result.data&&Array.isArray(h.result.data)&&(d=h.result.data)),d.length>0?(t.push(...d),n+=d.length,k=d.length===c):k=!1}catch(h){console.error(`Error loading tickets batch for stage ${s} (start: ${n}):`,h),k=!1}t.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(t[0],null,2)),console.log("Sample ticket keys:",Object.keys(t[0])),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}));const D=t.filter(h=>{const d=h.UF_CRM_7_TYPE_PRODUCT||h.uf_crm_7_type_product||h.ufCrm7TypeProduct||h.UF_CRM_7_TYPE_PRODUCT||h.uf_crm_7_type_product;return Array.isArray(d)?d.includes(this.SECTOR_TAG):typeof d=="object"&&d!==null?d.value===this.SECTOR_TAG||d===this.SECTOR_TAG:d===this.SECTOR_TAG});return console.log(`Filtered ${D.length} tickets from ${t.length} for stage ${s} (sector tag: ${this.SECTOR_TAG})`),D}static extractUniqueEmployeeIds(s){if(!Array.isArray(s))return[];const t=new Set;return s.forEach(n=>{const c=n.assignedById||n.assignedByIdId||n.ASSIGNED_BY_ID||n.assignedById||n.assignedById&&typeof n.assignedById=="object"&&(n.assignedById.id||n.assignedById.ID)||n.assignedById&&typeof n.assignedById=="object"&&n.assignedById.value;if(c){const k=parseInt(c);k&&!isNaN(k)&&k>0&&t.add(k)}}),s.length>0&&(console.log("Sample ticket for employee extraction:",s[0]),console.log("Sample ticket assignedById variants:",{assignedById:s[0].assignedById,assignedByIdId:s[0].assignedByIdId,ASSIGNED_BY_ID:s[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(t))),Array.from(t)}static async getEmployeesByIds(s){if(!Array.isArray(s)||s.length===0)return[];try{const t=await le.call("user.get",{filter:{ID:s}});let n=[];return t&&t.result&&(Array.isArray(t.result)?n=t.result:console.warn("Unexpected user.get result format:",t)),n.map(c=>({id:parseInt(c.ID||c.id||0),name:`${c.NAME||c.name||""} ${c.LAST_NAME||c.lastName||""}`.trim()||c.EMAIL||c.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:c.WORK_POSITION||c.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:c.EMAIL||c.email||"",tickets:[]}))}catch(t){return console.error("Error getting employees by IDs:",t),[]}}static groupTicketsByStages(s,t){Array.isArray(s)||(console.warn("Tickets is not an array:",s),s=[]),Array.isArray(t)||(console.warn("Employees is not an array:",t),t=[]);const n=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:t.map(c=>({...c,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:t.map(c=>({...c,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:t.map(c=>({...c,tickets:[]}))}];return s.forEach(c=>{const k=this.mapStageId(c.stageId||c.STAGE_ID||""),D=n.find(h=>h.id===k);if(D){const h=c.assignedById||c.ASSIGNED_BY_ID||null,d=h?parseInt(h):null;if(d){let v=D.employees.find(y=>y.id===d);v||(v={id:d,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${d}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},D.employees.push(v)),v.tickets.push(this.mapTicket(c))}}}),n}static mapStageId(s){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[s]||"formed"}static mapStageIdToBitrix(s){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[s]||"DT140_12:UC_0VHWE2"}static mapTicket(s){const t=parseInt(s.id||s.ID||0),n=s.title||s.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",c=s.stageId||s.STAGE_ID||"",k=s.assignedById||s.ASSIGNED_BY_ID||null,D=s.createdTime||s.CREATED_DATE||s.CREATED_TIME||"",h=s.updatedTime||s.MODIFY_DATE||s.UPDATED_TIME||"",d=s.UF_CRM_7_UF_PRIORITY||s.uf_crm_7_uf_priority||s.ufCrm7UfPriority||s.UF_CRM_7_UF_PRIORITY||s.uf_crm_7_uf_priority||s.priority||s.PRIORITY||null,v=Me(d),y=je(v);return{id:t,title:n,priorityId:v.id,priorityLabel:v.label,priorityColors:y,priority:v.id,priorityBitrixValue:v.bitrixValue||null,status:this.mapStatus(c),assigneeId:k?parseInt(k):null,stageId:this.mapStageId(c),createdAt:D,modifiedAt:h,amount:s.opportunity||s.OPPORTUNITY||0,currency:s.currencyId||s.CURRENCY_ID||"RUB",description:s.comments||s.COMMENTS||""}}static mapPriority(s){return Me(s).id}static mapPriorityToBitrix(s){if(s&&typeof s=="object")return s.bitrixValue||null;const t=Ue(s);if(t&&t.bitrixValue)return t.bitrixValue;const n={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return n[s]?n[s]:Ue(He).bitrixValue}static mapStatus(s){return"in_progress"}static getZeroPointTickets(s){const t={formed:[],review:[],execution:[]};return Array.isArray(s)?(s.filter(n=>!(n.assignedById||n.ASSIGNED_BY_ID)).forEach(n=>{const c=this.mapStageId(n.stageId||n.STAGE_ID||"");t[c]&&t[c].push(this.mapTicket(n))}),t):(console.warn("Tickets is not an array in getZeroPointTickets:",s),t)}static async assignTicket(s,t,n){try{const c=this.mapStageIdToBitrix(n);return(await le.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:s,fields:{assignedById:t,stageId:c}})).result===!0}catch(c){throw console.error("Error assigning ticket:",c),c}}static async createTicket(s){try{const t=await le.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:s.title,assignedById:s.employeeId,stageId:this.mapStageIdToBitrix(s.stageId)}});return t.result?parseInt(t.result):0}catch(t){throw console.error("Error creating ticket:",t),t}}static async getTicket(s){try{const t=await le.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:s});return this.mapTicket(t.result)}catch(t){throw console.error("Error getting ticket:",t),t}}static async addComment(s,t){try{return(await le.call("crm.timeline.comment.add",{fields:{entityId:s,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:t}})).result!==void 0}catch(n){throw console.error("Error adding comment:",n),n}}}ye(me,"ENTITY_TYPE_ID",140),ye(me,"SECTOR_TAG","1C");const ea={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},ta={class:"modal"},sa={key:0,class:"modal__tabs"},aa={key:"level-0-categories",class:"level-0"},ra={class:"modal__header"},oa={class:"modal__title"},la={key:0},na={class:"modal__body"},ia={class:"categories-list"},da=["onClick"],ca={class:"category-item"},ua={class:"category-item__icon"},ka={key:0},va={key:1},ha={class:"category-item__content"},ya={class:"category-item__label"},ma={class:"category-item__count"},_a={key:0,class:"category-item__arrow"},pa={class:"modal__footer"},ga={key:"level-1-categories",class:"level-1"},ba={class:"modal__header"},fa={class:"modal__body"},wa={key:"loading",class:"loading-names"},Ta={key:"empty",class:"modal__empty"},Ca={key:"list",class:"responsible-list"},$a=["onClick"],Wa={class:"responsible-list__name"},Da={class:"responsible-list__count"},Ea={key:0,class:"responsible-list__arrow"},Aa={class:"modal__footer"},Ia={key:"level-2-categories",class:"level-2"},Sa={class:"modal__header"},Ma={class:"modal__title"},Ua={class:"modal__body"},Oa={key:"loading",class:"loading-state"},Ba={key:"error",class:"error-state"},Ra={class:"error-message"},Na={key:"empty",class:"empty-state"},La={key:"tickets",class:"tickets-list-container"},Pa={key:"level-0-employees",class:"level-0"},Fa={class:"modal__header"},Ga={class:"modal__title"},Va={key:0},Ya={class:"modal__body"},xa={key:"loading",class:"loading-names"},za={key:"empty",class:"modal__empty"},ja={key:"list",class:"responsible-list"},Ha=["onClick"],qa={class:"responsible-list__name"},Za={class:"responsible-list__count"},Ja={key:0,class:"responsible-list__arrow"},Ka={class:"modal__footer"},Xa={key:"level-1-employees",class:"level-1"},Qa={class:"modal__header"},er={class:"modal__title"},tr={class:"modal__body"},sr={class:"categories-list"},ar=["onClick"],rr={class:"category-item"},or={class:"category-item__icon"},lr={key:0},nr={key:1},ir={class:"category-item__content"},dr={class:"category-item__label"},cr={class:"category-item__count"},ur={key:0,class:"category-item__arrow"},kr={class:"modal__footer"},vr={key:"level-2-employees",class:"level-2"},hr={class:"modal__header"},yr={class:"modal__title"},mr={class:"modal__body"},_r={key:"loading",class:"loading-state"},pr={key:"error",class:"error-state"},gr={class:"error-message"},br={key:"empty",class:"empty-state"},fr={class:"empty-state-message"},wr={key:"tickets",class:"tickets-list-container"},Tr={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(g){const s=g,t=A(0),n=A("categories"),c=A(null),k=A(null),D=A(null),h=A([]),d=A(!1),v=A(null),y=A([]),C=A([]),p=A(!1),$=L(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:s.closedTicketsCreatedThisWeek??0,responsible:s.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:s.closedTicketsCreatedOtherWeek??0,responsible:s.responsibleCreatedOtherWeek??[]}]),Y=L(()=>{const r=new Map;return(s.responsibleCreatedThisWeek||[]).forEach(a=>{const T=a.id??"unassigned";r.has(T)||r.set(T,{id:a.id,name:a.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const E=r.get(T);E.thisWeekCount=a.count??0,E.thisWeekTickets=a.tickets||[],E.totalCount+=E.thisWeekCount}),(s.responsibleCreatedOtherWeek||[]).forEach(a=>{const T=a.id??"unassigned";r.has(T)||r.set(T,{id:a.id,name:a.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const E=r.get(T);E.otherWeekCount=a.count??0,E.otherWeekTickets=a.tickets||[],E.totalCount+=E.otherWeekCount}),Array.from(r.values())}),U=L(()=>{if(!k.value)return[];const r=k.value.thisWeekTickets||[],a=k.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:k.value.id,name:k.value.name,thisWeekCount:k.value.thisWeekCount,otherWeekCount:k.value.otherWeekCount,thisWeekTickets:r.length,otherWeekTickets:a.length,employee:k.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:k.value.thisWeekCount??0,tickets:r,employeeId:k.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:k.value.otherWeekCount??0,tickets:a,employeeId:k.value.id}]}),P=L(()=>(C.value||[]).length>0);async function m(r){const a=r.filter(T=>T.id!==null&&T.id!==void 0).map(T=>T.id);if(a.length===0)return r;try{const T=await me.getEmployeesByIds(a),E=new Map;return T.forEach(O=>{E.set(O.id,O.name)}),r.map(O=>O.id&&E.has(O.id)?{...O,name:E.get(O.id)}:O)}catch(T){return console.error("[ResponsibleModal] Error enriching names:",T),r}}te([()=>n.value,()=>Y.value],async([r,a])=>{if(!(r!=="employees"||t.value!==0)){if(!a||a.length===0){C.value=[];return}p.value=!0;try{C.value=await m(a)}catch(T){console.error("[ResponsibleModal] Error loading employee names:",T),C.value=a}finally{p.value=!1}}},{immediate:!0}),te(()=>s.responsible,async r=>{if(!(t.value!==0||c.value||n.value!=="categories")){if(!r||r.length===0){y.value=[];return}p.value=!0;try{y.value=await m(r)}catch(a){console.error("[ResponsibleModal] Error loading employee names:",a),y.value=r}finally{p.value=!1}}},{immediate:!1});const o=L(()=>(y.value||[]).length>0);function I(r){n.value!==r&&(n.value=r,t.value=0,c.value=null,k.value=null,D.value=null,h.value=[],v.value=null,y.value=[],C.value=[])}async function f(r){if(!(!r||r.count===0)){c.value=r,t.value=1,p.value=!0;try{y.value=await m(r.responsible)}catch(a){console.error("[ResponsibleModal] Error loading employee names:",a),y.value=r.responsible}finally{p.value=!1}}}async function u(r,a=null){var T,E;!r||!r.id||r.totalCount===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:r.id,name:r.name,thisWeekCount:r.thisWeekCount,otherWeekCount:r.otherWeekCount,thisWeekTickets:((T=r.thisWeekTickets)==null?void 0:T.length)||0,otherWeekTickets:((E=r.otherWeekTickets)==null?void 0:E.length)||0,employee:r}),k.value={...r,thisWeekTickets:r.thisWeekTickets||[],otherWeekTickets:r.otherWeekTickets||[]},t.value=1)}async function _(r){var T;if(!r||r.count===0)return;D.value=r,t.value=2;const a=r.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:r.id,label:r.label,count:r.count,ticketsInGradation:a.length,selectedEmployee:(T=k.value)==null?void 0:T.id}),a.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",a.length),await R(a)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await W(r))}async function R(r){d.value=!0,v.value=null;try{try{const{prepareTicketsForDisplay:a}=await ue(async()=>{const{prepareTicketsForDisplay:T}=await import("./ticketListUtils-BcsiqEcO.js").then(E=>E.t);return{prepareTicketsForDisplay:T}},__vite__mapDeps([0,1,2,3,4,5]));h.value=await a(r,null,null)}catch(a){console.error("[ResponsibleModal] Error preparing tickets:",a),h.value=r}h.value.length===0&&(v.value=null)}catch(a){v.value=a.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",a),h.value=[]}finally{d.value=!1}}async function W(r){d.value=!0,v.value=null;try{if(!s.weekStartUtc||!s.weekEndUtc||!k.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const a=await re({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeTickets:!0}),T=r.id==="this-week"?a.data.responsibleCreatedThisWeek:a.data.responsibleCreatedOtherWeek,E=T==null?void 0:T.find(M=>M.id===k.value.id),O=(E==null?void 0:E.tickets)||[];try{const{prepareTicketsForDisplay:M}=await ue(async()=>{const{prepareTicketsForDisplay:w}=await import("./ticketListUtils-BcsiqEcO.js").then(q=>q.t);return{prepareTicketsForDisplay:w}},__vite__mapDeps([0,1,2,3,4,5]));h.value=await M(O,null,null)}catch(M){console.error("[ResponsibleModal] Error preparing tickets:",M),h.value=O}h.value.length===0&&(v.value=null)}catch(a){v.value=a.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",a),h.value=[]}finally{d.value=!1}}async function S(r,a=null){!r||!r.id||r.count===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),k.value=r,t.value=2,await G(r.id))}async function G(r){var a;d.value=!0,v.value=null;try{let T=[];if(c.value&&c.value.responsible){const E=c.value.responsible.find(O=>O.id===r);T=(E==null?void 0:E.tickets)||[]}if(T.length===0&&s.weekStartUtc&&s.weekEndUtc){const E=await re({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeTickets:!0}),O=((a=c.value)==null?void 0:a.id)==="created-this-week"?E.data.responsibleCreatedThisWeek:E.data.responsibleCreatedOtherWeek,M=O==null?void 0:O.find(w=>w.id===r);T=(M==null?void 0:M.tickets)||[]}try{const{prepareTicketsForDisplay:E}=await ue(async()=>{const{prepareTicketsForDisplay:O}=await import("./ticketListUtils-BcsiqEcO.js").then(M=>M.t);return{prepareTicketsForDisplay:O}},__vite__mapDeps([0,1,2,3,4,5]));h.value=await E(T,null,null)}catch(E){console.error("[ResponsibleModal] Error preparing tickets:",E),h.value=T}h.value.length===0&&(v.value=null)}catch(T){v.value=T.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",T),h.value=[]}finally{d.value=!1}}function V(){t.value===2?(t.value=1,n.value==="categories"?k.value=null:D.value=null,h.value=[],v.value=null):t.value===1&&(t.value=0,n.value==="categories"?(c.value=null,y.value=[]):k.value=null)}function H(r){const a=pe(r.id);window.open(a,"_blank")}function Z(){n.value==="employees"&&D.value?R(D.value.tickets):n.value==="categories"&&k.value&&G(k.value.id)}return te(()=>s.isVisible,r=>{r||(t.value=0,n.value="categories",c.value=null,k.value=null,D.value=null,h.value=[],v.value=null,y.value=[],C.value=[])}),(r,a)=>g.isVisible?(l(),i("div",ea,[e("div",ta,[t.value===0?(l(),i("div",sa,[e("button",{class:K(["modal__tab",{"modal__tab--active":n.value==="categories"}]),onClick:a[0]||(a[0]=T=>I("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),e("button",{class:K(["modal__tab",{"modal__tab--active":n.value==="employees"}]),onClick:a[1]||(a[1]=T=>I("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):F("",!0),N(J,{name:"level",mode:"out-in"},{default:x(()=>{var T,E,O,M;return[n.value==="categories"&&t.value===0?(l(),i("div",aa,[e("header",ra,[e("h3",oa,[a[12]||(a[12]=ae(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),g.weekNumber?(l(),i("span",la," ¬∑ –ù–µ–¥–µ–ª—è "+b(g.weekNumber),1)):F("",!0)]),e("button",{class:"modal__close",onClick:a[2]||(a[2]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",na,[e("ul",ia,[(l(!0),i(z,null,j($.value,w=>(l(),i("li",{key:w.id,class:K(["categories-list__item",{"categories-list__item--clickable":w.count>0}]),onClick:q=>f(w)},[e("div",ca,[e("div",ua,[w.id==="created-this-week"?(l(),i("span",ka,"‚úì")):(l(),i("span",va,"‚Üª"))]),e("div",ha,[e("div",ya,b(w.label),1),e("div",ma,b(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),w.count>0?(l(),i("span",_a,"‚Üí")):F("",!0)])],10,da))),128))])]),e("footer",pa,[e("button",{class:"btn",onClick:a[3]||(a[3]=w=>r.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value==="categories"&&t.value===1?(l(),i("div",ga,[e("header",ba,[e("button",{class:"btn-back",onClick:V,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a[13]||(a[13]=e("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("button",{class:"modal__close",onClick:a[4]||(a[4]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",fa,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>[p.value?(l(),i("div",wa,[...a[14]||(a[14]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):o.value?(l(),i("ul",Ca,[(l(!0),i(z,null,j(y.value,w=>(l(),i("li",{key:w.id||w.name,class:K(["responsible-list__item",{"responsible-list__item--clickable":w.id&&w.count>0}]),onClick:q=>S(w,q),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",Wa,b(w.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",Da,b(w.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.id&&w.count>0?(l(),i("span",Ea,"‚Üí")):F("",!0)],10,$a))),128))])):(l(),i("p",Ta,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),e("footer",Aa,[e("button",{class:"btn",onClick:a[5]||(a[5]=w=>r.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value==="categories"&&t.value===2?(l(),i("div",Ia,[e("header",Sa,[e("button",{class:"btn-back",onClick:V,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",Ma,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((T=k.value)==null?void 0:T.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[6]||(a[6]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ua,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>[d.value?(l(),i("div",Oa,[...a[15]||(a[15]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):v.value?(l(),i("div",Ba,[a[16]||(a[16]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[17]||(a[17]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",Ra,b(v.value),1),e("button",{class:"btn btn-retry",onClick:Z},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):h.value.length===0?(l(),i("div",Na,[...a[18]||(a[18]=[e("div",{class:"empty-state-icon"},"üìã",-1),e("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(l(),i("div",La,[N(ve,{name:"ticket",tag:"div",class:"tickets-list"},{default:x(()=>[(l(!0),i(z,null,j(h.value,(w,q)=>(l(),X(he,{key:w.id,ticket:w,draggable:!1,style:se({"--ticket-index":q}),onClick:H},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):n.value==="employees"&&t.value===0?(l(),i("div",Pa,[e("header",Fa,[e("h3",Ga,[a[19]||(a[19]=ae(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),g.weekNumber?(l(),i("span",Va," ¬∑ –ù–µ–¥–µ–ª—è "+b(g.weekNumber),1)):F("",!0)]),e("button",{class:"modal__close",onClick:a[7]||(a[7]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ya,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>[p.value?(l(),i("div",xa,[...a[20]||(a[20]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):P.value?(l(),i("ul",ja,[(l(!0),i(z,null,j(C.value,w=>(l(),i("li",{key:w.id||w.name,class:K(["responsible-list__item",{"responsible-list__item--clickable":w.id&&w.totalCount>0}]),onClick:q=>u(w,q),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",qa,b(w.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",Za,b(w.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.id&&w.totalCount>0?(l(),i("span",Ja,"‚Üí")):F("",!0)],10,Ha))),128))])):(l(),i("p",za,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),e("footer",Ka,[e("button",{class:"btn",onClick:a[8]||(a[8]=w=>r.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value==="employees"&&t.value===1?(l(),i("div",Xa,[e("header",Qa,[e("button",{class:"btn-back",onClick:V,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",er,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((E=k.value)==null?void 0:E.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[9]||(a[9]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",tr,[e("ul",sr,[(l(!0),i(z,null,j(U.value,w=>(l(),i("li",{key:w.id,class:K(["categories-list__item",{"categories-list__item--clickable":w.count>0}]),onClick:q=>_(w)},[e("div",rr,[e("div",or,[w.id==="this-week"?(l(),i("span",lr,"‚úì")):(l(),i("span",nr,"‚Üª"))]),e("div",ir,[e("div",dr,b(w.label),1),e("div",cr,b(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),w.count>0?(l(),i("span",ur,"‚Üí")):F("",!0)])],10,ar))),128))])]),e("footer",kr,[e("button",{class:"btn",onClick:a[10]||(a[10]=w=>r.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value==="employees"&&t.value===2?(l(),i("div",vr,[e("header",hr,[e("button",{class:"btn-back",onClick:V,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",yr," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((O=k.value)==null?void 0:O.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+b(((M=D.value)==null?void 0:M.label)||"")+") ",1),e("button",{class:"modal__close",onClick:a[11]||(a[11]=w=>r.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",mr,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>{var w;return[d.value?(l(),i("div",_r,[...a[21]||(a[21]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):v.value?(l(),i("div",pr,[a[22]||(a[22]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[23]||(a[23]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",gr,b(v.value),1),e("button",{class:"btn btn-retry",onClick:Z},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):h.value.length===0?(l(),i("div",br,[a[24]||(a[24]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",fr,b(n.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((w=D.value)==null?void 0:w.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(l(),i("div",wr,[N(ve,{name:"ticket",tag:"div",class:"tickets-list"},{default:x(()=>[(l(!0),i(z,null,j(h.value,(q,oe)=>(l(),X(he,{key:q.id,ticket:q,draggable:!1,style:se({"--ticket-index":oe}),onClick:H},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):F("",!0)]}),_:1})])])):F("",!0)}},Cr=Q(Tr,[["__scopeId","data-v-3b229bb4"]]),$r={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Wr={class:"modal"},Dr={key:"level-1",class:"level-1"},Er={class:"modal__header"},Ar={class:"modal__title"},Ir={key:0},Sr={class:"modal__body"},Mr={key:"loading",class:"loading-names"},Ur={key:"empty",class:"modal__empty"},Or={key:"list",class:"stages-list"},Br=["onClick"],Rr={class:"stages-list__name"},Nr={class:"stages-list__count"},Lr={key:0,class:"stages-list__arrow"},Pr={class:"modal__footer"},Fr={key:"level-2",class:"level-2"},Gr={class:"modal__header"},Vr={class:"modal__title"},Yr={class:"modal__body"},xr={key:"loading",class:"loading-state"},zr={key:"error",class:"error-state"},jr={class:"error-message"},Hr={key:"empty",class:"empty-state"},qr={class:"empty-state-message"},Zr={key:"tickets",class:"tickets-list-container"},Jr={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(g,{emit:s}){const t=g,n=A(1),c=A(null),k=A([]),D=A(!1),h=A(!1),d=A(null),v=A([]),y=L(()=>v.value.length>0&&v.value.some(m=>m.count>0));async function C(){if(!t.weekStartUtc||!t.weekEndUtc){v.value=[];return}h.value=!0,d.value=null;try{const m=await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeNewTicketsByStages:!0});v.value=m.data.newTicketsByStages||[]}catch(m){d.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",m),v.value=[]}finally{h.value=!1}}async function p(m,o=null){!m||m.count===0||(o&&o.currentTarget&&(o.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{o.currentTarget&&(o.currentTarget.style.transform="")},150)),c.value=m,n.value=2,await $(m.stageId))}async function $(m){var o;D.value=!0,d.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const f=(o=(await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:o.find(_=>_.stageId===m),u=(f==null?void 0:f.tickets)||[];try{const{prepareTicketsForDisplay:_}=await ue(async()=>{const{prepareTicketsForDisplay:R}=await import("./ticketListUtils-BcsiqEcO.js").then(W=>W.t);return{prepareTicketsForDisplay:R}},__vite__mapDeps([0,1,2,3,4,5]));k.value=await _(u,null,null)}catch(_){console.error("[StagesModal] Error preparing tickets:",_),k.value=u}k.value.length===0&&(d.value=null)}catch(I){d.value=I.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",I),k.value=[]}finally{D.value=!1}}function Y(){n.value=1,c.value=null,k.value=[],d.value=null}function U(m){const o=pe(m.id);window.open(o,"_blank")}function P(){c.value&&$(c.value.stageId)}return te(()=>t.isVisible,m=>{m?C():(n.value=1,c.value=null,k.value=[],d.value=null,v.value=[])}),te([()=>t.weekStartUtc,()=>t.weekEndUtc],()=>{t.isVisible&&C()}),(m,o)=>g.isVisible?(l(),i("div",$r,[e("div",Wr,[N(J,{name:"level",mode:"out-in"},{default:x(()=>{var I;return[n.value===1?(l(),i("div",Dr,[e("header",Er,[e("h3",Ar,[o[3]||(o[3]=ae(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),g.weekNumber?(l(),i("span",Ir," ¬∑ –ù–µ–¥–µ–ª—è "+b(g.weekNumber),1)):F("",!0)]),e("button",{class:"modal__close",onClick:o[0]||(o[0]=f=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Sr,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>[h.value?(l(),i("div",Mr,[...o[4]||(o[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):y.value?(l(),i("ul",Or,[(l(!0),i(z,null,j(v.value,f=>(l(),i("li",{key:f.stageId,class:K(["stages-list__item",{"stages-list__item--clickable":f.count>0}]),style:se({"--stage-color":f.color}),onClick:u=>p(f,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[e("span",{class:"stages-list__color",style:se({backgroundColor:f.color})},null,4),e("span",Rr,b(f.stageName),1),e("span",Nr,b(f.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),f.count>0?(l(),i("span",Lr,"‚Üí")):F("",!0)],14,Br))),128))])):(l(),i("p",Ur," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",Pr,[e("button",{class:"btn",onClick:o[1]||(o[1]=f=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value===2?(l(),i("div",Fr,[e("header",Gr,[e("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",Vr," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+b(((I=c.value)==null?void 0:I.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:o[2]||(o[2]=f=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Yr,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>{var f;return[D.value?(l(),i("div",xr,[...o[5]||(o[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):d.value?(l(),i("div",zr,[o[6]||(o[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),o[7]||(o[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",jr,b(d.value),1),e("button",{class:"btn btn-retry",onClick:P},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(l(),i("div",Hr,[o[8]||(o[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",qr," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+b((f=c.value)==null?void 0:f.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(l(),i("div",Zr,[N(ve,{name:"ticket",tag:"div",class:"tickets-list"},{default:x(()=>[(l(!0),i(z,null,j(k.value,(u,_)=>(l(),X(he,{key:u.id,ticket:u,draggable:!1,style:se({"--ticket-index":_}),onClick:U},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):F("",!0)]}),_:1})])])):F("",!0)}},Kr=Q(Jr,[["__scopeId","data-v-4af0cfce"]]),Xr={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Qr={class:"modal"},eo={key:"level-1",class:"level-1"},to={class:"modal__header"},so={class:"modal__title"},ao={key:0},ro={class:"modal__body"},oo={key:"loading",class:"loading-names"},lo={key:"empty",class:"modal__empty"},no={key:"list",class:"duration-list"},io=["onClick"],co={class:"duration-list__name"},uo={class:"duration-list__count"},ko={key:0,class:"duration-list__arrow"},vo={class:"modal__footer"},ho={key:"level-2",class:"level-2"},yo={class:"modal__header"},mo={class:"modal__title"},_o={class:"modal__body"},po={key:"loading",class:"loading-state"},go={key:"error",class:"error-state"},bo={class:"error-message"},fo={key:"empty",class:"empty-state"},wo={class:"empty-state-message"},To={key:"tickets",class:"tickets-list-container"},Co={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(g,{emit:s}){const t=g,n=A(1),c=A(null),k=A([]),D=A(!1),h=A(!1),d=A(null),v=A([]),y=L(()=>v.value.length>0&&v.value.some(m=>m.count>0));async function C(){if(!t.weekStartUtc||!t.weekEndUtc){v.value=[];return}h.value=!0,d.value=null;try{const m=await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});v.value=m.data.carryoverTicketsByDuration||[]}catch(m){d.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",m),v.value=[]}finally{h.value=!1}}async function p(m,o=null){!m||m.count===0||(o&&o.currentTarget&&(o.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{o.currentTarget&&(o.currentTarget.style.transform="")},150)),c.value=m,n.value=2,await $(m.durationCategory))}async function $(m){var o;D.value=!0,d.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const f=(o=(await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:o.find(_=>_.durationCategory===m),u=(f==null?void 0:f.tickets)||[];try{const{prepareTicketsForDisplay:_}=await ue(async()=>{const{prepareTicketsForDisplay:R}=await import("./ticketListUtils-BcsiqEcO.js").then(W=>W.t);return{prepareTicketsForDisplay:R}},__vite__mapDeps([0,1,2,3,4,5]));k.value=await _(u,null,null)}catch(_){console.error("[CarryoverDurationModal] Error preparing tickets:",_),k.value=u}k.value.length===0&&(d.value=null)}catch(I){d.value=I.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",I),k.value=[]}finally{D.value=!1}}function Y(){n.value=1,c.value=null,k.value=[],d.value=null}function U(m){const o=pe(m.id);window.open(o,"_blank")}function P(){c.value&&$(c.value.durationCategory)}return te(()=>t.isVisible,m=>{m?C():(n.value=1,c.value=null,k.value=[],d.value=null,v.value=[])}),te([()=>t.weekStartUtc,()=>t.weekEndUtc],()=>{t.isVisible&&C()}),(m,o)=>g.isVisible?(l(),i("div",Xr,[e("div",Qr,[N(J,{name:"level",mode:"out-in"},{default:x(()=>{var I;return[n.value===1?(l(),i("div",eo,[e("header",to,[e("h3",so,[o[3]||(o[3]=ae(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),g.weekNumber?(l(),i("span",ao," ¬∑ –ù–µ–¥–µ–ª—è "+b(g.weekNumber),1)):F("",!0)]),e("button",{class:"modal__close",onClick:o[0]||(o[0]=f=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ro,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>[h.value?(l(),i("div",oo,[...o[4]||(o[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):y.value?(l(),i("ul",no,[(l(!0),i(z,null,j(v.value,f=>(l(),i("li",{key:f.durationCategory,class:K(["duration-list__item",{"duration-list__item--clickable":f.count>0}]),style:se({"--duration-color":f.color}),onClick:u=>p(f,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[e("span",{class:"duration-list__color",style:se({backgroundColor:f.color})},null,4),e("span",co,b(f.durationLabel),1),e("span",uo,b(f.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),f.count>0?(l(),i("span",ko,"‚Üí")):F("",!0)],14,io))),128))])):(l(),i("p",lo," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",vo,[e("button",{class:"btn",onClick:o[1]||(o[1]=f=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):n.value===2?(l(),i("div",ho,[e("header",yo,[e("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",mo," –¢–∏–∫–µ—Ç—ã: "+b(((I=c.value)==null?void 0:I.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:o[2]||(o[2]=f=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",_o,[N(J,{name:"loading",mode:"out-in"},{default:x(()=>{var f;return[D.value?(l(),i("div",po,[...o[5]||(o[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):d.value?(l(),i("div",go,[o[6]||(o[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),o[7]||(o[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",bo,b(d.value),1),e("button",{class:"btn btn-retry",onClick:P},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(l(),i("div",fo,[o[8]||(o[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",wo," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+b((f=c.value)==null?void 0:f.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(l(),i("div",To,[N(ve,{name:"ticket",tag:"div",class:"tickets-list"},{default:x(()=>[(l(!0),i(z,null,j(k.value,(u,_)=>(l(),X(he,{key:u.id,ticket:u,draggable:!1,style:se({"--ticket-index":_}),onClick:U},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):F("",!0)]}),_:1})])])):F("",!0)}},$o=Q(Co,[["__scopeId","data-v-c26f06c2"]]),Wo={class:"ac-dashboard"},Do={key:"preloader",class:"chart-preloader"},Eo={class:"preloader-content"},Ao={class:"preloader-message"},Io={key:"content"},So={key:1,class:"weeks-dashboard"},Mo={class:"dashboard-header"},Uo={class:"header-content"},Oo={class:"breadcrumbs-row"},Bo=["aria-label","aria-disabled","data-fallback","disabled"],Ro={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},No={class:"dashboard-layout"},Lo={class:"filters-container"},Po={class:"chart-container"},Fo={__name:"GraphAdmissionClosureDashboard",setup(g){const s=Be(),t=A(!1),n=A(null),c=A(null),k=A({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),D=A(!1),h=A(!1),d=A(!1),v=A(!1),y=A(!1),C=L(()=>typeof window>"u"?!1:window.history.length>1),p=L(()=>C.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),$={name:"dashboard-sector-1c"};function Y(r){var a;if((a=r==null?void 0:r.preventDefault)==null||a.call(r),!y.value){y.value=!0;try{if(C.value){s.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),s.push($)}finally{y.value=!1}}}const U=A({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),P=A("weeks"),m=L(()=>{const r=U.value.customDateRange.startDate||U.value.customDateRange.endDate,a=U.value.employees.length===1&&U.value.employees.includes("all");return r||!a});async function o(){if(P.value!=="weeks")return;t.value=!0,n.value=null;const r=new Promise(a=>setTimeout(a,300));try{const a=Z(),T=a.weekStartUtc,E=a.weekEndUtc,[O,M]=await Promise.all([r,re({product:"1C",periodMode:"weeks",weekStartUtc:T,weekEndUtc:E,includeTickets:!0})]),{meta:w,data:q}=M;c.value=w,k.value=q}catch(a){n.value=a instanceof Error?a:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",a)}finally{t.value=!1}}function I(r){U.value.stages=r}function f(r){U.value.employees=r}function u(r){U.value.dateRange=r}function _(r){U.value.customDateRange=r}function R(r){if(!["weeks","months"].includes(r)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",r);return}if(r!==P.value){P.value=r;try{localStorage.setItem("graph-admission-closure-period-mode",r)}catch(a){console.warn("[GraphAdmissionClosureDashboard] Failed to save mode to localStorage:",a)}o()}}function W(r){const{mode:a}=r.detail;["weeks","months"].includes(a)&&R(a)}function S(){U.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},G()}function G(){o()}function V(r){if(["weeks","months"].includes(r)){P.value=r;try{localStorage.setItem("graph-admission-closure-period-mode",r)}catch(a){console.warn("[GraphAdmissionClosureDashboard] Failed to save mode to localStorage:",a)}}}function H(){o()}_e(()=>{try{const r=localStorage.getItem("graph-admission-closure-period-mode");(r==="weeks"||r==="months")&&(P.value=r)}catch(r){console.warn("[GraphAdmissionClosureDashboard] Failed to read from localStorage:",r)}window.addEventListener("period-mode-change",W),v.value=!0}),Oe(()=>{window.removeEventListener("period-mode-change",W)});function Z(){const r=new Date,a=new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())),T=a.getUTCDay(),E=a.getUTCDate()-T+(T===0?-6:1),O=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),E,0,0,0)),M=new Date(O);return M.setUTCDate(M.getUTCDate()+6),M.setUTCHours(23,59,59,999),{weekStartUtc:O.toISOString(),weekEndUtc:M.toISOString()}}return(r,a)=>{var E,O,M,w,q,oe,ie,de,ce;const T=Re("router-link");return l(),i("div",Wo,[N(J,{name:"fade",mode:"out-in"},{default:x(()=>[t.value?(l(),i("div",Do,[e("div",Eo,[a[7]||(a[7]=e("div",{class:"preloader-spinner"},[e("div",{class:"spinner-ring"}),e("div",{class:"spinner-ring"}),e("div",{class:"spinner-ring"})],-1)),a[8]||(a[8]=e("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),e("p",Ao," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+b(P.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),a[9]||(a[9]=e("div",{class:"preloader-dots"},[e("span",{class:"dot"}),e("span",{class:"dot"}),e("span",{class:"dot"})],-1))])])):v.value?F("",!0):(l(),i("div",Io,[P.value==="months"?(l(),X(Qs,{key:0})):(l(),i("div",So,[e("div",Mo,[e("div",Uo,[e("div",Oo,[e("button",{class:"btn-back-link",type:"button",onClick:Y,"aria-label":p.value,"aria-disabled":!C.value,"data-fallback":!C.value,disabled:y.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,Bo),e("nav",Ro,[N(T,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:x(()=>[...a[10]||(a[10]=[ae(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),a[12]||(a[12]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),N(T,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:x(()=>[...a[11]||(a[11]=[ae(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),a[13]||(a[13]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),a[14]||(a[14]=e("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),a[15]||(a[15]=e("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),a[16]||(a[16]=e("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),e("div",No,[e("div",Lo,[N(Le,{stages:U.value.stages,employees:U.value.employees,dateRange:U.value.dateRange,customDateRange:U.value.customDateRange,hasActiveFilters:m.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":P.value,"onUpdate:stages":I,"onUpdate:employees":f,"onUpdate:dateRange":u,"onUpdate:customDateRange":_,"onUpdate:periodMode":R,onReset:S,onApply:G},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),e("div",Po,[n.value?(l(),X(Ne,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:n.value.message},null,8,["message"])):(l(),X(Mt,{key:1,meta:c.value,data:k.value,onOpenResponsible:a[0]||(a[0]=ee=>D.value=!0),onOpenStages:a[1]||(a[1]=ee=>h.value=!0),onOpenCarryover:a[2]||(a[2]=ee=>d.value=!0)},null,8,["meta","data"]))])])]))]))]),_:1}),N(Cr,{"is-visible":D.value,responsible:k.value.responsible||[],"closed-tickets-created-this-week":k.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":k.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":k.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":k.value.responsibleCreatedOtherWeek||[],"week-number":((E=c.value)==null?void 0:E.weekNumber)||null,"week-start-utc":((O=c.value)==null?void 0:O.weekStartUtc)||null,"week-end-utc":((M=c.value)==null?void 0:M.weekEndUtc)||null,onClose:a[3]||(a[3]=ee=>D.value=!1)},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),N(Kr,{"is-visible":h.value,"week-number":((w=c.value)==null?void 0:w.weekNumber)||null,"week-start-utc":((q=c.value)==null?void 0:q.weekStartUtc)||null,"week-end-utc":((oe=c.value)==null?void 0:oe.weekEndUtc)||null,onClose:a[4]||(a[4]=ee=>h.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),N($o,{"is-visible":d.value,"week-number":((ie=c.value)==null?void 0:ie.weekNumber)||null,"week-start-utc":((de=c.value)==null?void 0:de.weekStartUtc)||null,"week-end-utc":((ce=c.value)==null?void 0:ce.weekEndUtc)||null,onClose:a[5]||(a[5]=ee=>d.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),v.value?(l(),X(Qe,{key:0,"is-visible":v.value,"current-mode":P.value,onClose:a[6]||(a[6]=ee=>v.value=!1),onStartLoading:H,onSelectMode:V},null,8,["is-visible","current-mode"])):F("",!0)])}}},jo=Q(Fo,[["__scopeId","data-v-7fba529a"]]);export{jo as default};
