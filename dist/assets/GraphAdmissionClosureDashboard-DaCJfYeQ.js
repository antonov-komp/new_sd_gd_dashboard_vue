const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ticketListUtils-L6jW_GPY.js","./priority-config-BeZsfhN5.js","./main-qqDNAnoR.js","./main-DFwah1ox.css","./priority-config-Bxxce_5E.css","./ticket-mapper-DjKz0bYM.js"])))=>i.map(i=>d[i]);
var Ot=Object.defineProperty;var Bt=(o,t,e)=>t in o?Ot(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var Qe=(o,t,e)=>Bt(o,typeof t!="symbol"?t+"":t,e);import{_ as _e,g as Y,G as pe,m as st,H as gt,f as ie,o as _,j as J,k as te,a as g,d as Z,b as a,y as le,n as ae,B as ne,I as Rt,c as j,J as V,K as bt,t as C,F as Q,e as ee,L as Xe,M as Pt,N as He,O as re,P as xt,Q as wt,R as Ge,S as Lt,U as Gt,V as Ft,W as Vt,X as Yt,Y as Ht,Z as jt,$ as zt,x as qt,l as ge,a0 as Zt,z as Ct,r as Tt,a1 as $t,a2 as Ae,T as Je,a3 as Fe,a4 as yt}from"./main-qqDNAnoR.js";import{F as Wt}from"./FiltersPanel-TIkx_Hl_.js";import{L as De,D as Xt,B as Jt}from"./index-DROik3_d.js";import{g as mt,a as Kt,b as _t,D as Qt,T as Ke,c as rt}from"./priority-config-BeZsfhN5.js";const ea={key:0,class:"modal-overlay"},ta={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},aa={class:"modal-body"},sa={class:"mode-description"},ra={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:o=>["weeks","months"].includes(o)}},emits:["close","start-loading","select-mode"],setup(o,{emit:t}){const e=o,s=t,n=Y(e.currentMode);function l(m){if(!["weeks","months"].includes(m)){console.warn("[PeriodModeInfoModal] Invalid mode:",m);return}n.value=m,console.log("[DEBUG Modal] handleModeSelect: mode =",m),console.log("[DEBUG Modal] Emitting select-mode event"),s("select-mode",m),console.log("[DEBUG Modal] Emitting close event"),s("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),s("start-loading")},100)}function c(){console.log("[DEBUG Modal] handleClose called, selectedMode =",n.value),console.log("[DEBUG Modal] Emitting select-mode event with",n.value),s("select-mode",n.value),console.log("[DEBUG Modal] Emitting close event"),s("close")}function k(m){m.key==="Escape"&&e.isVisible&&c()}return pe(()=>e.currentMode,m=>{["weeks","months"].includes(m)&&(n.value=m)}),st(()=>{e.isVisible&&document.addEventListener("keydown",k)}),gt(()=>{document.removeEventListener("keydown",k)}),pe(()=>e.isVisible,m=>{m?(document.addEventListener("keydown",k),n.value=e.currentMode):document.removeEventListener("keydown",k)}),(m,f)=>(_(),ie(Rt,{to:"body"},[J(ne,{name:"modal-fade"},{default:te(()=>[o.isVisible?(_(),g("div",ea,[a("div",ta,[a("div",{class:"modal-header"},[f[2]||(f[2]=a("h2",{id:"modal-title",class:"modal-title"},[a("span",{class:"modal-icon"},"‚ÑπÔ∏è"),le(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),a("button",{class:"modal-close-btn",onClick:c,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),a("div",aa,[f[5]||(f[5]=a("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),a("div",sa,[a("button",{class:ae(["mode-item mode-item--clickable",{"mode-item--selected":n.value==="weeks"}]),onClick:f[0]||(f[0]=E=>l("weeks")),type:"button"},[...f[3]||(f[3]=[a("div",{class:"mode-header"},[a("span",{class:"mode-icon"},"üìÖ"),a("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),a("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),a("button",{class:ae(["mode-item mode-item--clickable",{"mode-item--selected":n.value==="months"}]),onClick:f[1]||(f[1]=E=>l("months")),type:"button"},[...f[4]||(f[4]=[a("div",{class:"mode-header"},[a("span",{class:"mode-icon"},"üìä"),a("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),a("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):Z("",!0)]),_:1})]))}},oa=_e(ra,[["__scopeId","data-v-4a42a9a6"]]),na={class:"ac-chart"},la={class:"ac-chart__header"},ia={class:"ac-chart__subtitle"},ca={class:"ac-chart__controls"},da={class:"chart-type-selector"},ua=["onClick"],va={class:"chart-type-icon"},ka={class:"chart-type-label"},ha={class:"ac-chart__summary"},ya={class:"summary-week-block summary-week-block--current"},ma={class:"summary-week-block__title"},_a={class:"summary-week-block__title-week"},fa={key:0,class:"summary-week-block__title-dates"},pa={class:"summary-week-block__cards"},ga={class:"summary-card__value-wrapper"},ba={class:"summary-card__value"},wa=["title"],Ca={class:"percentage-indicator__arrow"},Ta={class:"percentage-indicator__value"},$a={class:"percentage-indicator__label"},Wa={class:"summary-card__value-wrapper"},Aa={class:"summary-card__value-main"},Da=["title"],Ea={class:"percentage-indicator__arrow"},Ua={class:"percentage-indicator__value"},Na={class:"percentage-indicator__label"},Sa={class:"summary-card__breakdown"},Ia={class:"breakdown-item breakdown-item--this-week"},Ma={class:"breakdown-item__value"},Oa={class:"breakdown-item breakdown-item--other-week"},Ba={class:"breakdown-item__value"},Ra={class:"summary-card__value-wrapper"},Pa={class:"summary-card__value-main"},xa=["title"],La={class:"percentage-indicator__arrow"},Ga={class:"percentage-indicator__value"},Fa={class:"percentage-indicator__label"},Va={class:"summary-card__breakdown"},Ya={class:"breakdown-item breakdown-item--this-week"},Ha={class:"breakdown-item__value"},ja={class:"breakdown-item breakdown-item--previous-week"},za={class:"breakdown-item__value"},qa={class:"breakdown-item breakdown-item--older"},Za={class:"breakdown-item__value"},Xa={class:"summary-card summary-card--stages"},Ja={class:"summary-card__tags"},Ka={key:0,class:"stage-tag stage-tag--empty"},Qa={key:0,class:"summary-week-divider"},es={key:1,class:"summary-week-block summary-week-block--previous"},ts={class:"summary-week-block__title"},as={class:"summary-week-block__title-week"},ss={key:0,class:"summary-week-block__title-dates"},rs={class:"summary-week-block__cards"},os={class:"summary-card__value-wrapper"},ns={class:"summary-card__values-comparison"},ls={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},is={class:"summary-card__value"},cs={class:"value-label"},ds={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},us={class:"summary-card__value summary-card__value--current-week"},vs={class:"value-label"},ks=["title"],hs={class:"percentage-indicator__arrow"},ys={class:"percentage-indicator__value"},ms={class:"percentage-indicator__label"},_s={class:"summary-card__value-wrapper"},fs={class:"summary-card__values-comparison"},ps={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},gs={class:"summary-card__value-main"},bs={class:"value-label"},ws={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Cs={class:"summary-card__value-main summary-card__value-main--current-week"},Ts={class:"value-label"},$s=["title"],Ws={class:"percentage-indicator__arrow"},As={class:"percentage-indicator__value"},Ds={class:"percentage-indicator__label"},Es={class:"summary-card__breakdown"},Us={class:"breakdown-item breakdown-item--this-week"},Ns={class:"breakdown-item__value"},Ss={class:"breakdown-item breakdown-item--other-week"},Is={class:"breakdown-item__value"},Ms={class:"summary-card__value-wrapper"},Os={class:"summary-card__values-comparison"},Bs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Rs={class:"summary-card__value-main"},Ps={class:"value-label"},xs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Ls={class:"summary-card__value-main summary-card__value-main--current-week"},Gs={class:"value-label"},Fs=["title"],Vs={class:"percentage-indicator__arrow"},Ys={class:"percentage-indicator__value"},Hs={class:"percentage-indicator__label"},js={class:"summary-card__breakdown"},zs={class:"breakdown-item breakdown-item--this-week"},qs={class:"breakdown-item__value"},Zs={class:"breakdown-item breakdown-item--previous-week"},Xs={class:"breakdown-item__value"},Js={class:"breakdown-item breakdown-item--older"},Ks={class:"breakdown-item__value"},Qs={class:"summary-card summary-card--stages summary-card--previous"},er={class:"summary-card__tags"},tr={key:0,class:"stage-tag stage-tag--empty"},ar={class:"ac-chart__body"},sr={key:0,class:"split-charts-container"},rr={class:"chart-wrapper chart-wrapper--left"},or={class:"chart-canvas-wrapper"},nr={class:"chart-wrapper chart-wrapper--right"},lr={class:"chart-canvas-wrapper"},ir={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0],carryoverCreatedOtherWeek:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(o,{emit:t}){const e=o,s=t,n=j(()=>{var r;const i=((r=e.meta)==null?void 0:r.weeks)||[];return i.length>=2?i[i.length-2]:null}),l=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],c=Y("line");j(()=>{var i;return((i=e.meta)==null?void 0:i.weekNumber)??"‚Äî"});const k=()=>{var r,p;const i=((r=e.meta)==null?void 0:r.weeks)||[];return i.length>0?i.map(T=>`–ù–µ–¥–µ–ª—è ${T.weekNumber}`):[(p=e.meta)!=null&&p.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function m(i,r,p,T=.3,O=0){if(!r)return((y,u)=>{const P=parseInt(y.slice(1,3),16),M=parseInt(y.slice(3,5),16),H=parseInt(y.slice(5,7),16);return`rgba(${P}, ${M}, ${H}, ${u})`})(p,T);const w=(R,y)=>{const u=parseInt(R.slice(1,3),16),P=parseInt(R.slice(3,5),16),M=parseInt(R.slice(5,7),16);return`rgba(${u}, ${P}, ${M}, ${y})`},d=i.createLinearGradient(0,r.bottom,0,r.top);return d.addColorStop(0,w(p,T)),d.addColorStop(1,w(p,O)),d}const f=j(()=>{var w,d,R,y;const i=k(),r=Array.isArray((w=e.data.series)==null?void 0:w.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],p=Array.isArray((d=e.data.series)==null?void 0:d.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],T=Array.isArray((R=e.data.series)==null?void 0:R.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],O=Array.isArray((y=e.data.series)==null?void 0:y.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:i,datasets:[{label:"–ù–æ–≤—ã–µ",data:r,backgroundColor:u=>{const P=u.chart,{ctx:M,chartArea:H}=P;return m(M,H,V.primary)},borderColor:V.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.primary},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:p,backgroundColor:u=>{const P=u.chart,{ctx:M,chartArea:H}=P;return m(M,H,V.success)},borderColor:V.success,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.success},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:T,backgroundColor:V.successLight,borderColor:V.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.successLight},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:O,backgroundColor:V.warning,borderColor:V.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.warning}]}}),E=j(()=>{var w,d,R,y,u;const i=k(),r=Array.isArray((w=e.data.series)==null?void 0:w.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],p=Array.isArray((d=e.data.series)==null?void 0:d.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],T=Array.isArray((R=e.data.series)==null?void 0:R.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],O=Array.isArray((y=e.data.series)==null?void 0:y.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((u=e.data.series)==null?void 0:u.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:i,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:r,backgroundColor:P=>{const M=P.chart,{ctx:H,chartArea:K}=M;return m(H,K,V.carryover)},borderColor:V.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.carryover},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:p,backgroundColor:V.carryoverLight,borderColor:V.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.carryoverLight},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:T,backgroundColor:V.warning,borderColor:V.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.warning},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:O,backgroundColor:V.carryoverDark,borderColor:V.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:V.carryoverDark}]}}),x=j(()=>{var P,M,H,K,ce,de,ue,ve,ke,he,ye;const i=((P=e.meta)==null?void 0:P.weeks)||[],r=i.length>0?i.map(me=>`–ù–µ–¥–µ–ª—è ${me.weekNumber}`):[(M=e.meta)!=null&&M.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],p=Array.isArray((H=e.data.series)==null?void 0:H.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],T=Array.isArray((K=e.data.series)==null?void 0:K.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],O=Array.isArray((ce=e.data.series)==null?void 0:ce.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],w=Array.isArray((de=e.data.series)==null?void 0:de.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],d=Array.isArray((ue=e.data.series)==null?void 0:ue.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],R=Array.isArray((ve=e.data.series)==null?void 0:ve.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],y=Array.isArray((ke=e.data.series)==null?void 0:ke.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],u=Array.isArray((he=e.data.series)==null?void 0:he.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((ye=e.data.series)==null?void 0:ye.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:r,datasets:[{label:"–ù–æ–≤—ã–µ",data:p,backgroundColor:V.primary,borderColor:V.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:T,backgroundColor:V.success,borderColor:V.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:O,backgroundColor:V.successLight,borderColor:V.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:w,backgroundColor:V.warning,borderColor:V.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:d,backgroundColor:V.carryover,borderColor:V.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:R,backgroundColor:V.carryoverLight,borderColor:V.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–µ–π)",data:y,backgroundColor:V.warning,borderColor:V.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –Ω–µ–¥–µ–ª—è–º–∏)",data:u,backgroundColor:V.carryoverDark,borderColor:V.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),z=j(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[V.primary,V.success,V.carryover],borderWidth:1}]})),q=j(()=>{switch(c.value){case"line":return De;case"bar":return Jt;case"doughnut":return Xt;default:return De}}),N=j(()=>c.value==="doughnut"?z.value:x.value),W=i=>{if(!i)return"‚Äî";try{return new Date(i).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return i}};function b(i){return i==null||isNaN(i)?"0":i>=1e3?i.toLocaleString("ru-RU"):i.toString()}function v(i){const r=i%10,p=i%100;return p>=11&&p<=14?"—Ç–∏–∫–µ—Ç–æ–≤":r===1?"—Ç–∏–∫–µ—Ç":r>=2&&r<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const h=j(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:i=>{var d,R,y,u,P,M;if(!i||i.length===0)return"";const r=(d=i[0])==null?void 0:d.dataIndex,p=((R=e.meta)==null?void 0:R.weeks)||[];if(p.length>0&&r!==void 0&&p[r]){const H=p[r];return`–ù–µ–¥–µ–ª—è ${H.weekNumber} (${W(H.weekStartUtc)} ‚Äî ${W(H.weekEndUtc)})`}const T=(y=e.meta)==null?void 0:y.weekNumber,O=(u=e.meta)==null?void 0:u.weekStartUtc,w=(P=e.meta)==null?void 0:P.weekEndUtc;return T&&O&&w?`–ù–µ–¥–µ–ª—è ${T} (${W(O)} ‚Äî ${W(w)})`:((M=i[0])==null?void 0:M.label)||""},label:i=>{const r=i.parsed.y,p=i.dataset.label||"";if(r==null||isNaN(r))return`${p}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const T=b(r),O=v(r);return`${p}: ${T} ${O}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:i=>bt.defaults.plugins.legend.labels.generateLabels(i).map((p,T)=>{const O=i.data.datasets[T],w=i.getDatasetMeta(T),d=O.borderDash&&Array.isArray(O.borderDash)&&O.borderDash.length>0||O.borderWidth===2||O.fill===!1;return w.hidden?(p.fontColor="#9ca3af",p.textDecoration="line-through",p.opacity=.5):d?p.fontColor="#6b7280":p.fontColor="#111827",p})},onClick:(i,r)=>{const p=r.datasetIndex;if(p==null){console.warn("[Legend] Invalid datasetIndex:",p);return}const T=i.chart;if(!T){console.warn("[Legend] Chart not found");return}const O=T.getDatasetMeta(p);if(!O){console.warn("[Legend] Dataset meta not found for index:",p);return}O.hidden=!O.hidden,T.update("active")},onHover:(i,r)=>{i.native&&i.native.target&&(i.native.target.style.cursor="pointer")},onLeave:(i,r)=>{i.native&&i.native.target&&(i.native.target.style.cursor="default")}}},scales:c.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:i=>i==null||isNaN(i)?"0":b(i)},title:{display:!1},grid:{color:i=>{if(!i||!i.tick||i.tick.value===void 0)return"#e5e7eb";const r=i.tick.value;return isNaN(r)||!isFinite(r)?"#e5e7eb":r===0||r%5===0?"#d1d5db":"#e5e7eb"},lineWidth:i=>{if(!i||!i.tick||i.tick.value===void 0)return 1;const r=i.tick.value;return isNaN(r)||!isFinite(r)?1:r===0||r%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),$=j(()=>{var i,r,p,T,O,w,d,R;if((i=e.data)!=null&&i.series){const y=e.data.series,u=Math.max((Array.isArray(y.new)?y.new.length:0)-1,(Array.isArray(y.closed)?y.closed.length:0)-1,(Array.isArray(y.closedCreatedThisWeek)?y.closedCreatedThisWeek.length:0)-1,(Array.isArray(y.closedCreatedOtherWeek)?y.closedCreatedOtherWeek.length:0)-1,(Array.isArray(y.carryover)?y.carryover.length:0)-1,(Array.isArray(y.carryoverCreatedThisWeek)?y.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(y.carryoverCreatedPreviousWeek)?y.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(y.carryoverCreatedOlder)?y.carryoverCreatedOlder.length:0)-1,(Array.isArray(y.carryoverCreatedOtherWeek)?y.carryoverCreatedOtherWeek.length:0)-1,-1);if(u>=0){const P={newTickets:Array.isArray(y.new)&&y.new[u]!==void 0?y.new[u]:0,closedTickets:Array.isArray(y.closed)&&y.closed[u]!==void 0?y.closed[u]:0,closedTicketsCreatedThisWeek:Array.isArray(y.closedCreatedThisWeek)&&y.closedCreatedThisWeek[u]!==void 0?y.closedCreatedThisWeek[u]:0,closedTicketsCreatedOtherWeek:Array.isArray(y.closedCreatedOtherWeek)&&y.closedCreatedOtherWeek[u]!==void 0?y.closedCreatedOtherWeek[u]:0,carryoverTickets:Array.isArray(y.carryover)&&y.carryover[u]!==void 0?y.carryover[u]:0,carryoverTicketsCreatedThisWeek:Array.isArray(y.carryoverCreatedThisWeek)&&y.carryoverCreatedThisWeek[u]!==void 0?y.carryoverCreatedThisWeek[u]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(y.carryoverCreatedPreviousWeek)&&y.carryoverCreatedPreviousWeek[u]!==void 0?y.carryoverCreatedPreviousWeek[u]:0,carryoverTicketsCreatedOlder:Array.isArray(y.carryoverCreatedOlder)&&y.carryoverCreatedOlder[u]!==void 0?y.carryoverCreatedOlder[u]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(y.carryoverCreatedOtherWeek)&&y.carryoverCreatedOtherWeek[u]!==void 0?y.carryoverCreatedOtherWeek[u]:0};if(P.carryoverTickets>0&&console.log("[DEBUG currentWeekData]",{total:P.carryoverTickets,thisWeek:P.carryoverTicketsCreatedThisWeek,previousWeek:P.carryoverTicketsCreatedPreviousWeek,older:P.carryoverTicketsCreatedOlder,otherWeek:P.carryoverTicketsCreatedOtherWeek,sum:P.carryoverTicketsCreatedThisWeek+P.carryoverTicketsCreatedPreviousWeek+P.carryoverTicketsCreatedOlder,lastIndex:u,series:{carryoverCreatedPreviousWeek:y.carryoverCreatedPreviousWeek,carryoverCreatedOlder:y.carryoverCreatedOlder,carryoverCreatedPreviousWeekLength:(r=y.carryoverCreatedPreviousWeek)==null?void 0:r.length,carryoverCreatedOlderLength:(p=y.carryoverCreatedOlder)==null?void 0:p.length,carryoverCreatedPreviousWeekLast:(T=y.carryoverCreatedPreviousWeek)==null?void 0:T[u],carryoverCreatedOlderLast:(O=y.carryoverCreatedOlder)==null?void 0:O[u]},currentWeek:e.data.currentWeek,data:{carryoverTicketsCreatedPreviousWeek:e.data.carryoverTicketsCreatedPreviousWeek,carryoverTicketsCreatedOlder:e.data.carryoverTicketsCreatedOlder}}),P.newTickets>0||P.closedTickets>0||P.carryoverTickets>0)return P}}if((w=e.data)!=null&&w.currentWeek&&typeof e.data.currentWeek=="object"){const y=e.data.currentWeek;if((y.newTickets??0)>0||(y.closedTickets??0)>0||(y.carryoverTickets??0)>0)return y}if((d=e.data)!=null&&d.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const y=e.data.weeksData[e.data.weeksData.length-1];if((y.newTickets??0)>0||(y.closedTickets??0)>0||(y.carryoverTickets??0)>0)return y}if((R=e.data)!=null&&R.series){const y=e.data.series,u=Math.max((Array.isArray(y.new)?y.new.length:0)-1,(Array.isArray(y.closed)?y.closed.length:0)-1,(Array.isArray(y.carryover)?y.carryover.length:0)-1,-1);if(u>=0)return{newTickets:Array.isArray(y.new)&&y.new[u]!==void 0?y.new[u]:0,closedTickets:Array.isArray(y.closed)&&y.closed[u]!==void 0?y.closed[u]:0,closedTicketsCreatedThisWeek:Array.isArray(y.closedCreatedThisWeek)&&y.closedCreatedThisWeek[u]!==void 0?y.closedCreatedThisWeek[u]:0,closedTicketsCreatedOtherWeek:Array.isArray(y.closedCreatedOtherWeek)&&y.closedCreatedOtherWeek[u]!==void 0?y.closedCreatedOtherWeek[u]:0,carryoverTickets:Array.isArray(y.carryover)&&y.carryover[u]!==void 0?y.carryover[u]:0,carryoverTicketsCreatedThisWeek:Array.isArray(y.carryoverCreatedThisWeek)&&y.carryoverCreatedThisWeek[u]!==void 0?y.carryoverCreatedThisWeek[u]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(y.carryoverCreatedPreviousWeek)&&y.carryoverCreatedPreviousWeek[u]!==void 0?y.carryoverCreatedPreviousWeek[u]:0,carryoverTicketsCreatedOlder:Array.isArray(y.carryoverCreatedOlder)&&y.carryoverCreatedOlder[u]!==void 0?y.carryoverCreatedOlder[u]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(y.carryoverCreatedOtherWeek)&&y.carryoverCreatedOtherWeek[u]!==void 0?y.carryoverCreatedOtherWeek[u]:0}}return e.data||{}}),D=j(()=>{var r,p,T,O,w,d,R,y,u,P;const i=((r=e.meta)==null?void 0:r.weeks)||[];return i.length>0?i[i.length-1]:{weekNumber:((T=(p=e.meta)==null?void 0:p.currentWeek)==null?void 0:T.weekNumber)??((O=e.meta)==null?void 0:O.weekNumber)??null,weekStartUtc:((d=(w=e.meta)==null?void 0:w.currentWeek)==null?void 0:d.weekStartUtc)??((R=e.meta)==null?void 0:R.weekStartUtc)??null,weekEndUtc:((u=(y=e.meta)==null?void 0:y.currentWeek)==null?void 0:u.weekEndUtc)??((P=e.meta)==null?void 0:P.weekEndUtc)??null}}),A=j(()=>{var i,r,p,T,O,w,d,R,y;if((i=e.data)!=null&&i.series){const u=e.data.series,P=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.closedCreatedThisWeek)?u.closedCreatedThisWeek.length:0)-1,(Array.isArray(u.closedCreatedOtherWeek)?u.closedCreatedOtherWeek.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,(Array.isArray(u.carryoverCreatedThisWeek)?u.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(u.carryoverCreatedPreviousWeek)?u.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(u.carryoverCreatedOlder)?u.carryoverCreatedOlder.length:0)-1,(Array.isArray(u.carryoverCreatedOtherWeek)?u.carryoverCreatedOtherWeek.length:0)-1,-1);if(P>=1){const M=P-1,H=(p=(r=e.meta)==null?void 0:r.weeks)==null?void 0:p[M],K={weekNumber:(H==null?void 0:H.weekNumber)??null,weekStartUtc:(H==null?void 0:H.weekStartUtc)??null,weekEndUtc:(H==null?void 0:H.weekEndUtc)??null,newTickets:Array.isArray(u.new)&&u.new[M]!==void 0?u.new[M]:0,closedTickets:Array.isArray(u.closed)&&u.closed[M]!==void 0?u.closed[M]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[M]!==void 0?u.closedCreatedThisWeek[M]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[M]!==void 0?u.closedCreatedOtherWeek[M]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[M]!==void 0?u.carryover[M]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[M]!==void 0?u.carryoverCreatedThisWeek[M]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(u.carryoverCreatedPreviousWeek)&&u.carryoverCreatedPreviousWeek[M]!==void 0?u.carryoverCreatedPreviousWeek[M]:0,carryoverTicketsCreatedOlder:Array.isArray(u.carryoverCreatedOlder)&&u.carryoverCreatedOlder[M]!==void 0?u.carryoverCreatedOlder[M]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[M]!==void 0?u.carryoverCreatedOtherWeek[M]:0};if(K.newTickets>0||K.closedTickets>0||K.carryoverTickets>0)return K}}if((T=e.data)!=null&&T.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const u=e.data.weeksData.length-2,P=e.data.weeksData[u],M=(w=(O=e.meta)==null?void 0:O.weeks)==null?void 0:w[u];if((P.newTickets??0)>0||(P.closedTickets??0)>0||(P.carryoverTickets??0)>0)return{weekNumber:P.weekNumber??(M==null?void 0:M.weekNumber)??null,weekStartUtc:(M==null?void 0:M.weekStartUtc)??null,weekEndUtc:(M==null?void 0:M.weekEndUtc)??null,newTickets:P.newTickets??0,closedTickets:P.closedTickets??0,closedTicketsCreatedThisWeek:P.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:P.closedTicketsCreatedOtherWeek??0,carryoverTickets:P.carryoverTickets??0,carryoverTicketsCreatedThisWeek:P.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:P.carryoverTicketsCreatedOtherWeek??0}}if((d=e.data)!=null&&d.series){const u=e.data.series,P=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,-1);if(P>=1){const M=P-1,H=(y=(R=e.meta)==null?void 0:R.weeks)==null?void 0:y[M];return{weekNumber:(H==null?void 0:H.weekNumber)??null,weekStartUtc:(H==null?void 0:H.weekStartUtc)??null,weekEndUtc:(H==null?void 0:H.weekEndUtc)??null,newTickets:Array.isArray(u.new)&&u.new[M]!==void 0?u.new[M]:0,closedTickets:Array.isArray(u.closed)&&u.closed[M]!==void 0?u.closed[M]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[M]!==void 0?u.closedCreatedThisWeek[M]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[M]!==void 0?u.closedCreatedOtherWeek[M]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[M]!==void 0?u.carryover[M]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[M]!==void 0?u.carryoverCreatedThisWeek[M]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(u.carryoverCreatedPreviousWeek)&&u.carryoverCreatedPreviousWeek[M]!==void 0?u.carryoverCreatedPreviousWeek[M]:0,carryoverTicketsCreatedOlder:Array.isArray(u.carryoverCreatedOlder)&&u.carryoverCreatedOlder[M]!==void 0?u.carryoverCreatedOlder[M]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[M]!==void 0?u.carryoverCreatedOtherWeek[M]:0}}}return null});function S(i,r){if(typeof i!="number"||isNaN(i)||r==null||typeof r!="number"||isNaN(r)||r===0)return null;if(i===r)return 0;const p=(i-r)/r*100;return!isFinite(p)||isNaN(p)?null:p}function G(i){return i==null||isNaN(i)?"":`${i>=0?"+":""}${i.toFixed(1)}%`}const U=j(()=>{var i,r,p;if((i=e.data)!=null&&i.series){const T=e.data.series,O=Math.max((Array.isArray(T.new)?T.new.length:0)-1,(Array.isArray(T.closed)?T.closed.length:0)-1,(Array.isArray(T.carryover)?T.carryover.length:0)-1,-1);if(O>=2){const w=O-2,d=(p=(r=e.meta)==null?void 0:r.weeks)==null?void 0:p[w];return{weekNumber:(d==null?void 0:d.weekNumber)??null,newTickets:Array.isArray(T.new)&&T.new[w]!==void 0?T.new[w]:0,closedTickets:Array.isArray(T.closed)&&T.closed[w]!==void 0?T.closed[w]:0,carryoverTickets:Array.isArray(T.carryover)&&T.carryover[w]!==void 0?T.carryover[w]:0}}}return null}),I=j(()=>{const i=$.value,r=A.value;return!i||!r?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:S(i.newTickets??0,r.newTickets??0),closedTickets:S(i.closedTickets??0,r.closedTickets??0),carryoverTickets:S(i.carryoverTickets??0,r.carryoverTickets??0)}}),B=j(()=>{const i=A.value,r=U.value;return!i||!r?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:S(i.newTickets??0,r.newTickets??0),closedTickets:S(i.closedTickets??0,r.closedTickets??0),carryoverTickets:S(i.carryoverTickets??0,r.carryoverTickets??0)}});function F(i,r){if(!i||!r)return"";try{const p=new Date(i),T=new Date(r),O=p.getUTCDate(),w=p.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),d=p.getUTCFullYear(),R=T.getUTCDate(),y=T.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),u=T.getUTCFullYear();return d===u&&w===y?`${O} ‚Äî ${R} ${w}`:d===u?`${O} ${w} ‚Äî ${R} ${y}`:`${O} ${w} ${d} ‚Äî ${R} ${y} ${u}`}catch(p){return console.error("[formatWeekDates] Error:",p),""}}const L=i=>{var d;const r=$.value,p=(r==null?void 0:r.newTickets)??0,T=(r==null?void 0:r.closedTickets)??0,O=(r==null?void 0:r.carryoverTickets)??0,w=D.value;i==="new"&&p>0?s("open-stages",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):i==="closed"&&T>0?(((d=e.data)==null?void 0:d.responsible)||[]).length>0&&s("open-responsible",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):i==="carryover"&&O>0&&s("open-carryover",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc})},X=i=>{const r=A.value;if(!r)return;const p=(r==null?void 0:r.newTickets)??0,T=(r==null?void 0:r.closedTickets)??0,O=(r==null?void 0:r.carryoverTickets)??0,w=n.value;w&&(i==="new"&&p>0?s("open-stages",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):i==="closed"&&T>0?s("open-responsible",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}):i==="carryover"&&O>0&&s("open-carryover",{weekNumber:w.weekNumber,weekStartUtc:w.weekStartUtc,weekEndUtc:w.weekEndUtc}))};return(i,r)=>{var p,T,O,w,d,R,y,u,P,M,H,K,ce,de,ue,ve,ke,he,ye,me,be,we,Ce,Te,$e,Ee,Ue,Ne,Se,Ie,Me,Oe,Be,Re,Pe,xe,ot,nt,lt,it,ct,dt,ut,vt,kt,ht;return _(),g("div",na,[a("header",la,[a("div",null,[r[6]||(r[6]=a("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),a("p",ia," –ù–µ–¥–µ–ª—è "+C(((T=(p=o.meta)==null?void 0:p.currentWeek)==null?void 0:T.weekNumber)??((O=o.meta)==null?void 0:O.weekNumber)??"‚Äî")+" ¬∑ "+C((((d=(w=o.meta)==null?void 0:w.currentWeek)==null?void 0:d.weekStartUtc)??((R=o.meta)==null?void 0:R.weekStartUtc))||"‚Äî")+" ‚Äî "+C((((u=(y=o.meta)==null?void 0:y.currentWeek)==null?void 0:u.weekEndUtc)??((P=o.meta)==null?void 0:P.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),a("div",ca,[a("div",da,[(_(),g(Q,null,ee(l,se=>a("button",{key:se.value,class:ae(["chart-type-btn",{active:c.value===se.value}]),onClick:ic=>c.value=se.value},[a("span",va,C(se.icon),1),a("span",ka,C(se.label),1)],10,ua)),64))])])]),a("section",ha,[a("div",ya,[a("h3",ma,[r[7]||(r[7]=a("span",{class:"summary-week-block__title-text"},"–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),a("span",_a," –ù–µ–¥–µ–ª—è "+C(D.value.weekNumber??"‚Äî"),1),D.value.weekStartUtc?(_(),g("span",fa,C(F(D.value.weekStartUtc,D.value.weekEndUtc)),1)):Z("",!0)]),a("div",pa,[a("div",{class:"summary-card summary-card--new",onClick:r[0]||(r[0]=se=>L("new"))},[r[8]||(r[8]=a("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a("div",ga,[a("div",ba,C(((M=$.value)==null?void 0:M.newTickets)??0),1),I.value.newTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",I.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((H=A.value)==null?void 0:H.weekNumber)??"‚Äî"}): ${G(I.value.newTickets)}`},[a("span",Ca,C(I.value.newTickets>=0?"‚Üë":"‚Üì"),1),a("span",Ta,C(G(I.value.newTickets)),1),a("span",$a,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((K=A.value)==null?void 0:K.weekNumber)??"‚Äî"),1)],10,wa)):Z("",!0)])]),a("div",{class:"summary-card summary-card--closed-breakdown",onClick:r[1]||(r[1]=se=>L("closed"))},[r[13]||(r[13]=a("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a("div",Wa,[a("div",Aa,C(((ce=$.value)==null?void 0:ce.closedTickets)??0),1),I.value.closedTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",I.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((de=A.value)==null?void 0:de.weekNumber)??"‚Äî"}): ${G(I.value.closedTickets)}`},[a("span",Ea,C(I.value.closedTickets>=0?"‚Üë":"‚Üì"),1),a("span",Ua,C(G(I.value.closedTickets)),1),a("span",Na,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((ue=A.value)==null?void 0:ue.weekNumber)??"‚Äî"),1)],10,Da)):Z("",!0)]),a("div",Sa,[a("div",Ia,[r[9]||(r[9]=a("span",{class:"breakdown-item__icon"},"‚úì",-1)),a("span",Ma,C(((ve=$.value)==null?void 0:ve.closedTicketsCreatedThisWeek)??0),1),r[10]||(r[10]=a("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),a("div",Oa,[r[11]||(r[11]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",Ba,C(((ke=$.value)==null?void 0:ke.closedTicketsCreatedOtherWeek)??0),1),r[12]||(r[12]=a("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),a("div",{class:"summary-card summary-card--carryover-breakdown",onClick:r[2]||(r[2]=se=>L("carryover"))},[r[20]||(r[20]=a("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),a("div",Ra,[a("div",Pa,C(((he=$.value)==null?void 0:he.carryoverTickets)??0),1),I.value.carryoverTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",I.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ye=A.value)==null?void 0:ye.weekNumber)??"‚Äî"}): ${G(I.value.carryoverTickets)}`},[a("span",La,C(I.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),a("span",Ga,C(G(I.value.carryoverTickets)),1),a("span",Fa,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((me=A.value)==null?void 0:me.weekNumber)??"‚Äî"),1)],10,xa)):Z("",!0)]),a("div",Va,[a("div",Ya,[r[14]||(r[14]=a("span",{class:"breakdown-item__icon"},"‚úì",-1)),a("span",Ha,C(((be=$.value)==null?void 0:be.carryoverTicketsCreatedThisWeek)??0),1),r[15]||(r[15]=a("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),a("div",ja,[r[16]||(r[16]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",za,C(((we=$.value)==null?void 0:we.carryoverTicketsCreatedPreviousWeek)??0),1),r[17]||(r[17]=a("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),a("div",qa,[r[18]||(r[18]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",Za,C(((Ce=$.value)==null?void 0:Ce.carryoverTicketsCreatedOlder)??0),1),r[19]||(r[19]=a("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),a("div",Xa,[r[21]||(r[21]=a("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),a("div",Ja,[(_(!0),g(Q,null,ee(o.data.stages||[],se=>(_(),g("span",{key:se.stageId,class:"stage-tag"},C(se.stageName||se.stageId)+" ‚Äî "+C(se.count),1))),128)),!o.data.stages||o.data.stages.length===0?(_(),g("span",Ka," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])])]),A.value?(_(),g("div",Qa,[...r[22]||(r[22]=[a("div",{class:"summary-week-divider__line"},null,-1),a("div",{class:"summary-week-divider__label"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)])])):Z("",!0),A.value?(_(),g("div",es,[a("h3",ts,[r[23]||(r[23]=a("span",{class:"summary-week-block__title-text"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),a("span",as," –ù–µ–¥–µ–ª—è "+C(A.value.weekNumber??"‚Äî"),1),A.value.weekStartUtc?(_(),g("span",ss,C(F(A.value.weekStartUtc,A.value.weekEndUtc)),1)):Z("",!0)]),a("div",rs,[a("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:r[3]||(r[3]=se=>X("new"))},[r[24]||(r[24]=a("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a("div",os,[a("div",ns,[a("div",ls,[a("div",is,C(((Te=A.value)==null?void 0:Te.newTickets)??0),1),a("span",cs,"–ù–µ–¥–µ–ª—è "+C((($e=A.value)==null?void 0:$e.weekNumber)??"‚Äî"),1)]),a("div",ds,[a("div",us,C(((Ee=U.value)==null?void 0:Ee.newTickets)??0),1),a("span",vs,"–ù–µ–¥–µ–ª—è "+C(((Ue=U.value)==null?void 0:Ue.weekNumber)??"‚Äî"),1)])]),B.value.newTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",B.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Ne=U.value)==null?void 0:Ne.weekNumber)??"‚Äî"}): ${G(B.value.newTickets)}`},[a("span",hs,C(B.value.newTickets>=0?"‚Üë":"‚Üì"),1),a("span",ys,C(G(B.value.newTickets)),1),a("span",ms,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((Se=U.value)==null?void 0:Se.weekNumber)??"‚Äî"),1)],10,ks)):Z("",!0)])]),a("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:r[4]||(r[4]=se=>X("closed"))},[r[29]||(r[29]=a("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a("div",_s,[a("div",fs,[a("div",ps,[a("div",gs,C(((Ie=A.value)==null?void 0:Ie.closedTickets)??0),1),a("span",bs,"–ù–µ–¥–µ–ª—è "+C(((Me=A.value)==null?void 0:Me.weekNumber)??"‚Äî"),1)]),a("div",ws,[a("div",Cs,C(((Oe=U.value)==null?void 0:Oe.closedTickets)??0),1),a("span",Ts,"–ù–µ–¥–µ–ª—è "+C(((Be=U.value)==null?void 0:Be.weekNumber)??"‚Äî"),1)])]),B.value.closedTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",B.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Re=U.value)==null?void 0:Re.weekNumber)??"‚Äî"}): ${G(B.value.closedTickets)}`},[a("span",Ws,C(B.value.closedTickets>=0?"‚Üë":"‚Üì"),1),a("span",As,C(G(B.value.closedTickets)),1),a("span",Ds,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((Pe=U.value)==null?void 0:Pe.weekNumber)??"‚Äî"),1)],10,$s)):Z("",!0)]),a("div",Es,[a("div",Us,[r[25]||(r[25]=a("span",{class:"breakdown-item__icon"},"‚úì",-1)),a("span",Ns,C(((xe=A.value)==null?void 0:xe.closedTicketsCreatedThisWeek)??0),1),r[26]||(r[26]=a("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),a("div",Ss,[r[27]||(r[27]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",Is,C(((ot=A.value)==null?void 0:ot.closedTicketsCreatedOtherWeek)??0),1),r[28]||(r[28]=a("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),a("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:r[5]||(r[5]=se=>X("carryover"))},[r[36]||(r[36]=a("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),a("div",Ms,[a("div",Os,[a("div",Bs,[a("div",Rs,C(((nt=A.value)==null?void 0:nt.carryoverTickets)??0),1),a("span",Ps,"–ù–µ–¥–µ–ª—è "+C(((lt=A.value)==null?void 0:lt.weekNumber)??"‚Äî"),1)]),a("div",xs,[a("div",Ls,C(((it=U.value)==null?void 0:it.carryoverTickets)??0),1),a("span",Gs,"–ù–µ–¥–µ–ª—è "+C(((ct=U.value)==null?void 0:ct.weekNumber)??"‚Äî"),1)])]),B.value.carryoverTickets!==null?(_(),g("div",{key:0,class:ae(["percentage-indicator",B.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((dt=U.value)==null?void 0:dt.weekNumber)??"‚Äî"}): ${G(B.value.carryoverTickets)}`},[a("span",Vs,C(B.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),a("span",Ys,C(G(B.value.carryoverTickets)),1),a("span",Hs,"–∫ –Ω–µ–¥–µ–ª–µ "+C(((ut=U.value)==null?void 0:ut.weekNumber)??"‚Äî"),1)],10,Fs)):Z("",!0)]),a("div",js,[a("div",zs,[r[30]||(r[30]=a("span",{class:"breakdown-item__icon"},"‚úì",-1)),a("span",qs,C(((vt=A.value)==null?void 0:vt.carryoverTicketsCreatedThisWeek)??0),1),r[31]||(r[31]=a("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),a("div",Zs,[r[32]||(r[32]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",Xs,C(((kt=A.value)==null?void 0:kt.carryoverTicketsCreatedPreviousWeek)??0),1),r[33]||(r[33]=a("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏",-1))]),a("div",Js,[r[34]||(r[34]=a("span",{class:"breakdown-item__icon"},"‚Üª",-1)),a("span",Ks,C(((ht=A.value)==null?void 0:ht.carryoverTicketsCreatedOlder)??0),1),r[35]||(r[35]=a("span",{class:"breakdown-item__label"},"–æ—Å—Ç–∞–ª—å–Ω—ã–µ",-1))])])]),a("div",Qs,[r[37]||(r[37]=a("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),a("div",er,[(_(!0),g(Q,null,ee(o.data.stages||[],se=>(_(),g("span",{key:se.stageId,class:"stage-tag"},C(se.stageName||se.stageId)+" ‚Äî "+C(se.count),1))),128)),!o.data.stages||o.data.stages.length===0?(_(),g("span",tr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])])])):Z("",!0)]),a("div",ar,[c.value==="line"?(_(),g("div",sr,[a("div",rr,[r[38]||(r[38]=a("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),a("div",or,[J(Xe(De),{data:f.value,options:h.value},null,8,["data","options"])])]),a("div",nr,[r[39]||(r[39]=a("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),a("div",lr,[J(Xe(De),{data:E.value,options:h.value},null,8,["data","options"])])])])):(_(),ie(Pt(q.value),{key:1,data:N.value,options:h.value},null,8,["data","options"]))])])}}},cr=_e(ir,[["__scopeId","data-v-4449d176"]]),dr={class:"summary-cards-months"},ur={class:"summary-card summary-card--new"},vr={class:"card-content"},kr={class:"card-main-value"},hr=["title"],yr={class:"card-month-breakdown"},mr={class:"month-name"},_r={class:"month-value"},fr={key:0,class:"month-item month-item--empty"},pr={class:"summary-card summary-card--closed"},gr={class:"card-content"},br={class:"card-main-value"},wr=["title"],Cr={class:"card-month-breakdown-hierarchical"},Tr={class:"month-header"},$r={class:"month-name"},Wr={class:"month-value"},Ar={class:"month-breakdown"},Dr={class:"breakdown-item breakdown-this-week"},Er={class:"breakdown-value"},Ur={class:"breakdown-item breakdown-other-week"},Nr={class:"breakdown-value"},Sr={key:0,class:"month-item-hierarchical month-item--empty"},Ir={class:"summary-card summary-card--carryover"},Mr={class:"card-content"},Or={class:"card-current-value"},Br={class:"current-value"},Rr=["title"],Pr={class:"card-month-breakdown"},xr={class:"month-name"},Lr={class:"month-value"},Gr={key:0,class:"month-item month-item--empty"},Fr={class:"summary-card summary-card--stages"},Vr={class:"card-content"},Yr={class:"stages-list"},Hr={class:"stage-icon"},jr={class:"stage-name"},zr={class:"stage-value"},qr={key:0,class:"stage-item stage-item--empty"},Zr={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(o){const t=o;function e(b){return b==null||isNaN(b)?"0":b>=1e6?(b/1e6).toFixed(1)+"M":b>=1e3?b.toLocaleString("ru-RU"):b.toString()}function s(b){return b==null||isNaN(b)?"":`${b>=0?"+":""}${b.toFixed(1)}%`}function n(b,v){if(typeof b!="number"||isNaN(b)||v==null||typeof v!="number"||isNaN(v)||v===0)return null;if(b===v)return 0;const h=(b-v)/v*100;return!isFinite(h)||isNaN(h)?null:h}const l=j(()=>{var b;return((b=t.data)==null?void 0:b.newTickets)||0}),c=j(()=>e(l.value)),k=j(()=>{var b;return((b=t.data)==null?void 0:b.newTicketsByMonth)||[]}),m=j(()=>{var b;return((b=t.data)==null?void 0:b.closedTicketsByMonth)||[]}),f=j(()=>{var b;return((b=t.data)==null?void 0:b.carryoverTicketsByMonth)||[]}),E=j(()=>{const b=f.value;if(b.length===0)return 0;const v=b[b.length-1];return(v==null?void 0:v.count)||0}),x=j(()=>{var h,$,D,A;const b=typeof((h=t.data)==null?void 0:h.newTickets)=="number"?t.data.newTickets:parseInt(($=t.data)==null?void 0:$.newTickets)||0,v=(A=(D=t.data)==null?void 0:D.previousPeriodData)==null?void 0:A.newTickets;return n(b,v)}),z=j(()=>{var h,$,D,A;const b=typeof((h=t.data)==null?void 0:h.closedTickets)=="number"?t.data.closedTickets:parseInt(($=t.data)==null?void 0:$.closedTickets)||0,v=(A=(D=t.data)==null?void 0:D.previousPeriodData)==null?void 0:A.closedTickets;return n(b,v)}),q=j(()=>{var $;const b=E.value,v=f.value,h=v.length>0?(($=v[0])==null?void 0:$.count)||0:null;return n(b,h)});function N(b){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[b]||""}function W(b){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[b]||"‚Ä¢"}return(b,v)=>(_(),g("div",dr,[a("div",ur,[v[0]||(v[0]=a("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),a("div",vr,[a("div",kr,[le(C(c.value)+" ",1),x.value!==null?(_(),g("span",{key:0,class:ae(["percentage-badge",x.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(x.value)}`},C(s(x.value)),11,hr)):Z("",!0)]),a("div",yr,[(_(!0),g(Q,null,ee(k.value,h=>(_(),g("div",{key:`new-${h.month}`,class:"month-item"},[a("span",mr,C(h.monthName)+":",1),a("span",_r,C(e(h.count)),1)]))),128)),k.value.length===0?(_(),g("div",fr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),a("div",pr,[v[5]||(v[5]=a("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),a("div",gr,[a("div",br,[le(C(e(o.data.closedTickets||0))+" ",1),z.value!==null?(_(),g("span",{key:0,class:ae(["percentage-badge",z.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(z.value)}`},C(s(z.value)),11,wr)):Z("",!0)]),a("div",Cr,[(_(!0),g(Q,null,ee(m.value,h=>(_(),g("div",{key:`closed-${h.month}`,class:"month-item-hierarchical"},[a("div",Tr,[a("span",$r,C(h.monthName)+":",1),a("span",Wr,C(e(h.count||0)),1)]),a("div",Ar,[a("div",Dr,[v[1]||(v[1]=a("span",{class:"breakdown-icon"},"‚úì",-1)),v[2]||(v[2]=a("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),a("span",Er,C(e(h.closedCreatedThisWeek||0)),1)]),a("div",Ur,[v[3]||(v[3]=a("span",{class:"breakdown-icon"},"‚Üª",-1)),v[4]||(v[4]=a("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),a("span",Nr,C(e(h.closedCreatedOtherWeek||0)),1)])])]))),128)),m.value.length===0?(_(),g("div",Sr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),a("div",Ir,[v[7]||(v[7]=a("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),v[8]||(v[8]=a("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),a("div",Mr,[a("div",Or,[v[6]||(v[6]=a("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),a("span",Br,[le(C(e(E.value))+" ",1),q.value!==null?(_(),g("span",{key:0,class:ae(["percentage-badge",q.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(q.value)}`},C(s(q.value)),11,Rr)):Z("",!0)])]),a("div",Pr,[(_(!0),g(Q,null,ee(f.value,h=>(_(),g("div",{key:`carryover-${h.month}`,class:"month-item"},[a("span",xr,C(h.monthName)+":",1),a("span",Lr,C(e(h.count||0)),1)]))),128)),f.value.length===0?(_(),g("div",Gr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),a("div",Fr,[v[10]||(v[10]=a("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),a("div",Vr,[a("div",Yr,[(_(!0),g(Q,null,ee(o.data.stages||[],h=>(_(),g("div",{key:h.stageId,class:ae(["stage-item",N(h.stageId)])},[a("span",Hr,C(W(h.stageId)),1),a("span",jr,C(h.stageName||h.stageId)+":",1),a("span",zr,C(e(h.count||0)),1)],2))),128)),!o.data.stages||o.data.stages.length===0?(_(),g("div",qr,[...v[9]||(v[9]=[a("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):Z("",!0)])])])]))}},Xr=_e(Zr,[["__scopeId","data-v-15d88b90"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var ft=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var o=window.screen;if(o)return(o.deviceXDPI||1)/(o.logicalXDPI||1)}return 1}(),Ve={toTextLines:function(o){var t=[],e;for(o=[].concat(o);o.length;)e=o.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?o.push.apply(o,e):Ge(o)||t.unshift(""+e);return t},textSize:function(o,t,e){var s=[].concat(t),n=s.length,l=o.font,c=0,k;for(o.font=e.string,k=0;k<n;++k)c=Math.max(o.measureText(s[k]).width,c);return o.font=l,{height:n*e.lineHeight,width:c}},bound:function(o,t,e){return Math.max(o,Math.min(t,e))},arrayDiff:function(o,t){var e=o.slice(),s=[],n,l,c,k;for(n=0,c=t.length;n<c;++n)k=t[n],l=e.indexOf(k),l===-1?s.push([k,1]):e.splice(l,1);for(n=0,c=e.length;n<c;++n)s.push([e[n],-1]);return s},rasterize:function(o){return Math.round(o*ft)/ft}};function et(o,t){var e=t.x,s=t.y;if(e===null)return{x:0,y:-1};if(s===null)return{x:1,y:0};var n=o.x-e,l=o.y-s,c=Math.sqrt(n*n+l*l);return{x:c?n/c:0,y:c?l/c:-1}}function Jr(o,t,e,s,n){switch(n){case"center":e=s=0;break;case"bottom":e=0,s=1;break;case"right":e=1,s=0;break;case"left":e=-1,s=0;break;case"top":e=0,s=-1;break;case"start":e=-e,s=-s;break;case"end":break;default:n*=Math.PI/180,e=Math.cos(n),s=Math.sin(n);break}return{x:o,y:t,vx:e,vy:s}}var Kr=0,At=1,Dt=2,Et=4,Ut=8;function je(o,t,e){var s=Kr;return o<e.left?s|=At:o>e.right&&(s|=Dt),t<e.top?s|=Ut:t>e.bottom&&(s|=Et),s}function Qr(o,t){for(var e=o.x0,s=o.y0,n=o.x1,l=o.y1,c=je(e,s,t),k=je(n,l,t),m,f,E;!(!(c|k)||c&k);)m=c||k,m&Ut?(f=e+(n-e)*(t.top-s)/(l-s),E=t.top):m&Et?(f=e+(n-e)*(t.bottom-s)/(l-s),E=t.bottom):m&Dt?(E=s+(l-s)*(t.right-e)/(n-e),f=t.right):m&At&&(E=s+(l-s)*(t.left-e)/(n-e),f=t.left),m===c?(e=f,s=E,c=je(e,s,t)):(n=f,l=E,k=je(n,l,t));return{x0:e,x1:n,y0:s,y1:l}}function ze(o,t){var e=t.anchor,s=o,n,l;return t.clamp&&(s=Qr(s,t.area)),e==="start"?(n=s.x0,l=s.y0):e==="end"?(n=s.x1,l=s.y1):(n=(s.x0+s.x1)/2,l=(s.y0+s.y1)/2),Jr(n,l,o.vx,o.vy,t.align)}var qe={arc:function(o,t){var e=(o.startAngle+o.endAngle)/2,s=Math.cos(e),n=Math.sin(e),l=o.innerRadius,c=o.outerRadius;return ze({x0:o.x+s*l,y0:o.y+n*l,x1:o.x+s*c,y1:o.y+n*c,vx:s,vy:n},t)},point:function(o,t){var e=et(o,t.origin),s=e.x*o.options.radius,n=e.y*o.options.radius;return ze({x0:o.x-s,y0:o.y-n,x1:o.x+s,y1:o.y+n,vx:e.x,vy:e.y},t)},bar:function(o,t){var e=et(o,t.origin),s=o.x,n=o.y,l=0,c=0;return o.horizontal?(s=Math.min(o.x,o.base),l=Math.abs(o.base-o.x)):(n=Math.min(o.y,o.base),c=Math.abs(o.base-o.y)),ze({x0:s,y0:n+c,x1:s+l,y1:n,vx:e.x,vy:e.y},t)},fallback:function(o,t){var e=et(o,t.origin);return ze({x0:o.x,y0:o.y,x1:o.x+(o.width||0),y1:o.y+(o.height||0),vx:e.x,vy:e.y},t)}},fe=Ve.rasterize;function eo(o){var t=o.borderWidth||0,e=o.padding,s=o.size.height,n=o.size.width,l=-n/2,c=-s/2;return{frame:{x:l-e.left-t,y:c-e.top-t,w:n+e.width+t*2,h:s+e.height+t*2},text:{x:l,y:c,w:n,h:s}}}function to(o,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var s=e.getBasePixel();return o.horizontal?{x:s,y:null}:{x:null,y:s}}function ao(o){return o instanceof Vt?qe.arc:o instanceof Yt?qe.point:o instanceof Ht?qe.bar:qe.fallback}function so(o,t,e,s,n,l){var c=Math.PI/2;if(l){var k=Math.min(l,n/2,s/2),m=t+k,f=e+k,E=t+s-k,x=e+n-k;o.moveTo(t,f),m<E&&f<x?(o.arc(m,f,k,-Math.PI,-c),o.arc(E,f,k,-c,0),o.arc(E,x,k,0,c),o.arc(m,x,k,c,Math.PI)):m<E?(o.moveTo(m,e),o.arc(E,f,k,-c,c),o.arc(m,f,k,c,Math.PI+c)):f<x?(o.arc(m,f,k,-Math.PI,0),o.arc(m,x,k,0,Math.PI)):o.arc(m,f,k,-Math.PI,Math.PI),o.closePath(),o.moveTo(t,e)}else o.rect(t,e,s,n)}function ro(o,t,e){var s=e.backgroundColor,n=e.borderColor,l=e.borderWidth;!s&&(!n||!l)||(o.beginPath(),so(o,fe(t.x)+l/2,fe(t.y)+l/2,fe(t.w)-l,fe(t.h)-l,e.borderRadius),o.closePath(),s&&(o.fillStyle=s,o.fill()),n&&l&&(o.strokeStyle=n,o.lineWidth=l,o.lineJoin="miter",o.stroke()))}function oo(o,t,e){var s=e.lineHeight,n=o.w,l=o.x,c=o.y+s/2;return t==="center"?l+=n/2:(t==="end"||t==="right")&&(l+=n),{h:s,w:n,x:l,y:c}}function no(o,t,e){var s=o.shadowBlur,n=e.stroked,l=fe(e.x),c=fe(e.y),k=fe(e.w);n&&o.strokeText(t,l,c,k),e.filled&&(s&&n&&(o.shadowBlur=0),o.fillText(t,l,c,k),s&&n&&(o.shadowBlur=s))}function lo(o,t,e,s){var n=s.textAlign,l=s.color,c=!!l,k=s.font,m=t.length,f=s.textStrokeColor,E=s.textStrokeWidth,x=f&&E,z;if(!(!m||!c&&!x))for(e=oo(e,n,k),o.font=k.string,o.textAlign=n,o.textBaseline="middle",o.shadowBlur=s.textShadowBlur,o.shadowColor=s.textShadowColor,c&&(o.fillStyle=l),x&&(o.lineJoin="round",o.lineWidth=E,o.strokeStyle=f),z=0,m=t.length;z<m;++z)no(o,t[z],{stroked:x,filled:c,w:e.w,x:e.x,y:e.y+e.h*z})}var Nt=function(o,t,e,s){var n=this;n._config=o,n._index=s,n._model=null,n._rects=null,n._ctx=t,n._el=e};He(Nt.prototype,{_modelize:function(o,t,e,s){var n=this,l=n._index,c=Lt(re([e.font,{}],s,l)),k=re([e.color,Gt.color],s,l);return{align:re([e.align,"center"],s,l),anchor:re([e.anchor,"center"],s,l),area:s.chart.chartArea,backgroundColor:re([e.backgroundColor,null],s,l),borderColor:re([e.borderColor,null],s,l),borderRadius:re([e.borderRadius,0],s,l),borderWidth:re([e.borderWidth,0],s,l),clamp:re([e.clamp,!1],s,l),clip:re([e.clip,!1],s,l),color:k,display:o,font:c,lines:t,offset:re([e.offset,4],s,l),opacity:re([e.opacity,1],s,l),origin:to(n._el,s),padding:Ft(re([e.padding,4],s,l)),positioner:ao(n._el),rotation:re([e.rotation,0],s,l)*(Math.PI/180),size:Ve.textSize(n._ctx,t,c),textAlign:re([e.textAlign,"start"],s,l),textShadowBlur:re([e.textShadowBlur,0],s,l),textShadowColor:re([e.textShadowColor,k],s,l),textStrokeColor:re([e.textStrokeColor,k],s,l),textStrokeWidth:re([e.textStrokeWidth,0],s,l)}},update:function(o){var t=this,e=null,s=null,n=t._index,l=t._config,c,k,m,f=re([l.display,!0],o,n);f&&(c=o.dataset.data[n],k=xt(wt(l.formatter,[c,o]),c),m=Ge(k)?[]:Ve.toTextLines(k),m.length&&(e=t._modelize(f,m,l,o),s=eo(e))),t._model=e,t._rects=s},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(o,t){var e=this,s=o.ctx,n=e._model,l=e._rects,c;this.visible()&&(s.save(),n.clip&&(c=n.area,s.beginPath(),s.rect(c.left,c.top,c.right-c.left,c.bottom-c.top),s.clip()),s.globalAlpha=Ve.bound(0,n.opacity,1),s.translate(fe(t.x),fe(t.y)),s.rotate(n.rotation),ro(s,l.frame,n),lo(s,n.lines,l.text,n),s.restore())}});var io=Number.MIN_SAFE_INTEGER||-9007199254740991,co=Number.MAX_SAFE_INTEGER||9007199254740991;function Le(o,t,e){var s=Math.cos(e),n=Math.sin(e),l=t.x,c=t.y;return{x:l+s*(o.x-l)-n*(o.y-c),y:c+n*(o.x-l)+s*(o.y-c)}}function pt(o,t){var e=co,s=io,n=t.origin,l,c,k,m,f;for(l=0;l<o.length;++l)c=o[l],k=c.x-n.x,m=c.y-n.y,f=t.vx*k+t.vy*m,e=Math.min(e,f),s=Math.max(s,f);return{min:e,max:s}}function Ze(o,t){var e=t.x-o.x,s=t.y-o.y,n=Math.sqrt(e*e+s*s);return{vx:(t.x-o.x)/n,vy:(t.y-o.y)/n,origin:o,ln:n}}var St=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};He(St.prototype,{center:function(){var o=this._rect;return{x:o.x+o.w/2,y:o.y+o.h/2}},update:function(o,t,e){this._rotation=e,this._rect={x:t.x+o.x,y:t.y+o.y,w:t.w,h:t.h}},contains:function(o){var t=this,e=1,s=t._rect;return o=Le(o,t.center(),-t._rotation),!(o.x<s.x-e||o.y<s.y-e||o.x>s.x+s.w+e*2||o.y>s.y+s.h+e*2)},intersects:function(o){var t=this._points(),e=o._points(),s=[Ze(t[0],t[1]),Ze(t[0],t[3])],n,l,c;for(this._rotation!==o._rotation&&s.push(Ze(e[0],e[1]),Ze(e[0],e[3])),n=0;n<s.length;++n)if(l=pt(t,s[n]),c=pt(e,s[n]),l.max<c.min||c.max<l.min)return!1;return!0},_points:function(){var o=this,t=o._rect,e=o._rotation,s=o.center();return[Le({x:t.x,y:t.y},s,e),Le({x:t.x+t.w,y:t.y},s,e),Le({x:t.x+t.w,y:t.y+t.h},s,e),Le({x:t.x,y:t.y+t.h},s,e)]}});function It(o,t,e){var s=t.positioner(o,t),n=s.vx,l=s.vy;if(!n&&!l)return{x:s.x,y:s.y};var c=e.w,k=e.h,m=t.rotation,f=Math.abs(c/2*Math.cos(m))+Math.abs(k/2*Math.sin(m)),E=Math.abs(c/2*Math.sin(m))+Math.abs(k/2*Math.cos(m)),x=1/Math.max(Math.abs(n),Math.abs(l));return f*=n*x,E*=l*x,f+=t.offset*n,E+=t.offset*l,{x:s.x+f,y:s.y+E}}function uo(o,t){var e,s,n,l;for(e=o.length-1;e>=0;--e)for(n=o[e].$layout,s=e-1;s>=0&&n._visible;--s)l=o[s].$layout,l._visible&&n._box.intersects(l._box)&&t(n,l);return o}function vo(o){var t,e,s,n,l,c,k;for(t=0,e=o.length;t<e;++t)s=o[t],n=s.$layout,n._visible&&(k=new Proxy(s._el,{get:(m,f)=>m.getProps([f],!0)[f]}),l=s.geometry(),c=It(k,s.model(),l),n._box.update(c,l,s.rotation()));return uo(o,function(m,f){var E=m._hidable,x=f._hidable;E&&x||x?f._visible=!1:E&&(m._visible=!1)})}var Ye={prepare:function(o){var t=[],e,s,n,l,c;for(e=0,n=o.length;e<n;++e)for(s=0,l=o[e].length;s<l;++s)c=o[e][s],t.push(c),c.$layout={_box:new St,_hidable:!1,_visible:!0,_set:e,_idx:c._index};return t.sort(function(k,m){var f=k.$layout,E=m.$layout;return f._idx===E._idx?E._set-f._set:E._idx-f._idx}),this.update(t),t},update:function(o){var t=!1,e,s,n,l,c;for(e=0,s=o.length;e<s;++e)n=o[e],l=n.model(),c=n.$layout,c._hidable=l&&l.display==="auto",c._visible=n.visible(),t|=c._hidable;t&&vo(o)},lookup:function(o,t){var e,s;for(e=o.length-1;e>=0;--e)if(s=o[e].$layout,s&&s._visible&&s._box.contains(t))return o[e];return null},draw:function(o,t){var e,s,n,l,c,k;for(e=0,s=t.length;e<s;++e)n=t[e],l=n.$layout,l._visible&&(c=n.geometry(),k=It(n._el,n.model(),c),l._box.update(k,c,n.rotation()),n.draw(o,k))}},ko=function(o){if(Ge(o))return null;var t=o,e,s,n;if(jt(o))if(!Ge(o.label))t=o.label;else if(!Ge(o.r))t=o.r;else for(t="",e=Object.keys(o),n=0,s=e.length;n<s;++n)t+=(n!==0?", ":"")+e[n]+": "+o[e[n]];return""+t},ho={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:ko,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},oe="$datalabels",Mt="$default";function yo(o,t){var e=o.datalabels,s={},n=[],l,c;return e===!1?null:(e===!0&&(e={}),t=He({},[t,e]),l=t.labels||{},c=Object.keys(l),delete t.labels,c.length?c.forEach(function(k){l[k]&&n.push(He({},[t,l[k],{_key:k}]))}):n.push(t),s=n.reduce(function(k,m){return zt(m.listeners||{},function(f,E){k[E]=k[E]||{},k[E][m._key||Mt]=f}),delete m.listeners,k},{}),{labels:n,listeners:s})}function tt(o,t,e,s){if(t){var n=e.$context,l=e.$groups,c;t[l._set]&&(c=t[l._set][l._key],c&&wt(c,[n,s])===!0&&(o[oe]._dirty=!0,e.update(n)))}}function mo(o,t,e,s,n){var l,c;!e&&!s||(e?s?e!==s&&(c=l=!0):c=!0:l=!0,c&&tt(o,t.leave,e,n),l&&tt(o,t.enter,s,n))}function _o(o,t){var e=o[oe],s=e._listeners,n,l;if(!(!s.enter&&!s.leave)){if(t.type==="mousemove")l=Ye.lookup(e._labels,t);else if(t.type!=="mouseout")return;n=e._hovered,e._hovered=l,mo(o,s,n,l,t)}}function fo(o,t){var e=o[oe],s=e._listeners.click,n=s&&Ye.lookup(e._labels,t);n&&tt(o,s,n,t)}var po={id:"datalabels",defaults:ho,beforeInit:function(o){o[oe]={_actives:[]}},beforeUpdate:function(o){var t=o[oe];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(o,t,e){var s=t.index,n=o[oe],l=n._datasets[s]=[],c=o.isDatasetVisible(s),k=o.data.datasets[s],m=yo(k,e),f=t.meta.data||[],E=o.ctx,x,z,q,N,W,b,v,h;for(E.save(),x=0,q=f.length;x<q;++x)if(v=f[x],v[oe]=[],c&&v&&o.getDataVisibility(x)&&!v.skip)for(z=0,N=m.labels.length;z<N;++z)W=m.labels[z],b=W._key,h=new Nt(W,E,v,x),h.$groups={_set:s,_key:b||Mt},h.$context={active:!1,chart:o,dataIndex:x,dataset:k,datasetIndex:s},h.update(h.$context),v[oe].push(h),l.push(h);E.restore(),He(n._listeners,m.listeners,{merger:function($,D,A){D[$]=D[$]||{},D[$][t.index]=A[$],n._listened=!0}})},afterUpdate:function(o){o[oe]._labels=Ye.prepare(o[oe]._datasets)},afterDatasetsDraw:function(o){Ye.draw(o,o[oe]._labels)},beforeEvent:function(o,t){if(o[oe]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":_o(o,e);break;case"click":fo(o,e);break}}},afterEvent:function(o){var t=o[oe],e=t._actives,s=t._actives=o.getActiveElements(),n=Ve.arrayDiff(e,s),l,c,k,m,f,E,x;for(l=0,c=n.length;l<c;++l)if(f=n[l],f[1])for(x=f[0].element[oe]||[],k=0,m=x.length;k<m;++k)E=x[k],E.$context.active=f[1]===1,E.update(E.$context);(t._dirty||n.length)&&(Ye.update(t._labels),o.render()),delete t._dirty}};const go={class:"line-chart-months"},bo={class:"chart-section"},wo={class:"chart-title"},Co={key:0,class:"chart-period"},To={class:"chart-wrapper"},$o={class:"chart-container"},Wo={class:"chart-summary"},Ao={class:"summary-numbers"},Do={class:"summary-row"},Eo={class:"summary-values"},Uo={class:"summary-row"},No={class:"summary-values"},So={class:"summary-analysis"},Io=["innerHTML"],Mo={class:"chart-section"},Oo={class:"chart-title"},Bo={key:0,class:"chart-period"},Ro={class:"chart-wrapper"},Po={class:"chart-container"},xo={class:"chart-analysis"},Lo={class:"analysis-content"},Go=["innerHTML"],Fo={class:"chart-table-section"},Vo={class:"chart-table-wrapper"},Yo={class:"data-table"},Ho={class:"data-row data-row--new"},jo={class:"data-row data-row--closed"},zo={class:"data-row data-row--carryover"},qo={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(o){bt.register(po);const t=o;function e(N){return N==null||isNaN(N)?"0":N>=1e3?N.toLocaleString("ru-RU"):N.toString()}const s=j(()=>{var W,b,v;const N=new Set;return(W=t.data.newTicketsByMonth)==null||W.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&N.add($.weekNumber)})}),(b=t.data.closedTicketsByMonth)==null||b.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&N.add($.weekNumber)})}),(v=t.data.carryoverTicketsByMonth)==null||v.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&N.add($.weekNumber)})}),Array.from(N).sort((h,$)=>h-$)}),n=j(()=>{const N=t.data.newTicketsByMonth||[],W=N.map(h=>h.monthName||`–ú–µ—Å—è—Ü ${h.month}`),b=N.map(h=>h.count||0),v=(t.data.closedTicketsByMonth||[]).map(h=>h.count||0);return{labels:W,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:b,borderColor:V.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:V.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:V.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:v,borderColor:V.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:V.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:V.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=j(()=>{const N=t.data.carryoverTicketsByMonth||[],W=N.map(v=>v.monthName||`–ú–µ—Å—è—Ü ${v.month}`),b=N.map(v=>v.count||0);return{labels:W,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:b,borderColor:V.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:V.carryover}}]}}),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(N,W)=>N==null||isNaN(N)?"":N.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(N){const W=N.dataset.data[N.dataIndex];return W!=null&&!isNaN(W)&&isFinite(W)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function k(N){if(!N||N.length===0)return null;const W=N[0],b=N[N.length-1];if(!W||!b)return null;const v=W.monthName||`–ú–µ—Å—è—Ü ${W.month}`,h=b.monthName||`–ú–µ—Å—è—Ü ${b.month}`,$=W.year||new Date().getFullYear();return`${v} ‚Äî ${h} ${$}`}const m=j(()=>{var N;return k(((N=t.data)==null?void 0:N.newTicketsByMonth)||[])}),f=j(()=>{var N;return k(((N=t.data)==null?void 0:N.carryoverTicketsByMonth)||[])}),E=j(()=>{var h,$;const N=((h=t.data)==null?void 0:h.newTicketsByMonth)||[],W=(($=t.data)==null?void 0:$.closedTicketsByMonth)||[];if(N.length===0)return{new:"‚Äî",closed:"‚Äî"};const b=N.map(D=>`${e(D.count||0)} (${D.monthName||D.month})`).join(" ‚Üí "),v=W.map(D=>`${e(D.count||0)} (${D.monthName||D.month})`).join(" ‚Üí ");return{new:b,closed:v}}),x=j(()=>{var $,D;const N=(($=t.data)==null?void 0:$.newTicketsByMonth)||[],W=((D=t.data)==null?void 0:D.closedTicketsByMonth)||[];if(N.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const b=[],v=[],h=[];if(N.length>=2){const A=N[0],S=N[1],G=N[2];if(S&&A&&typeof A.count=="number"&&typeof S.count=="number"){const U=A.monthName||A.month,I=S.monthName||S.month,B=e(A.count||0),F=e(S.count||0);if(A.count>0){const L=(S.count-A.count)/A.count*100;if(isFinite(L)&&!isNaN(L)){const X=L>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(L),r=L>=0?"+":"-",p=L>=0?"#28a745":"#dc3545",T=L>=0?"#28a745":"#dc3545";v.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${B} (${U}) –¥–æ ${F} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${r}${i.toFixed(1)}%</span>`)}}else A.count===0&&S.count>0&&v.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${F} (${I})`)}if(G&&S&&typeof S.count=="number"&&typeof G.count=="number"){const U=S.monthName||S.month,I=G.monthName||G.month,B=e(S.count||0),F=e(G.count||0);if(S.count>0){const L=(G.count-S.count)/S.count*100;if(isFinite(L)&&!isNaN(L))if(Math.abs(L)<.1)v.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${B} (${U}) ‚Üí ${F} (${I}) ‚Äî 0.0%`);else{const X=L>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(L),r=L>=0?"+":"-",p=L>=0?"#28a745":"#dc3545",T=L>=0?"#28a745":"#dc3545";v.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${B} (${U}) –¥–æ ${F} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${r}${i.toFixed(1)}%</span>`)}}else S.count===0&&G.count>0&&v.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${F} (${I})`)}}if(W.length>=2){const A=W[0],S=W[1],G=W[2];if(S&&A&&typeof A.count=="number"&&typeof S.count=="number"){const U=A.monthName||A.month,I=S.monthName||S.month,B=e(A.count||0),F=e(S.count||0);if(A.count>0){const L=(S.count-A.count)/A.count*100;if(isFinite(L)&&!isNaN(L))if(Math.abs(L)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${B} (${U}) ‚Üí ${F} (${I}) ‚Äî 0.0%`);else{const X=L>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(L),r=L>=0?"+":"-",p=L>=0?"#28a745":"#dc3545",T=L>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${B} (${U}) –¥–æ ${F} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${r}${i.toFixed(1)}%</span>`)}}else A.count===0&&S.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${U}) –¥–æ ${F} (${I})`)}if(G&&S&&typeof S.count=="number"&&typeof G.count=="number"){const U=S.monthName||S.month,I=G.monthName||G.month,B=e(S.count||0),F=e(G.count||0);if(S.count>0){const L=(G.count-S.count)/S.count*100;if(isFinite(L)&&!isNaN(L))if(Math.abs(L)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${B} (${U}) ‚Üí ${F} (${I}) ‚Äî 0.0%`);else{const X=L>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(L),r=L>=0?"+":"-",p=L>=0?"#28a745":"#dc3545",T=L>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${B} (${U}) –¥–æ ${F} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${r}${i.toFixed(1)}%</span>`)}}else S.count===0&&G.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${U}) –¥–æ ${F} (${I})`)}}if(v.length>0&&(b.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),b.push(...v)),h.length>0&&(b.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),b.push(...h)),N.length>=3&&W.length>=3){const A=N[0],S=N[N.length-1],G=W[0],U=W[W.length-1],I=A.count||0,B=S.count||0,F=G.count||0,L=U.count||0;if(I>0&&F>0){const X=(B-I)/I*100,i=(L-F)/F*100;if(isFinite(X)&&isFinite(i)){const r=A.monthName||A.month,p=S.monthName||S.month,T=G.monthName||G.month,O=U.monthName||U.month,w=X>=0?"#28a745":"#dc3545",d=X>=0?"#28a745":"#dc3545",R=i>=0?"#28a745":"#dc3545",y=i>=0?"#28a745":"#dc3545";b.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),b.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${w}; font-weight: 600;">${X>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(I)} (${r}) –¥–æ ${e(B)} (${p}) ‚Äî <span style="color: ${d}; font-weight: 600;">${X>=0?"+":"-"}${Math.abs(X).toFixed(1)}%</span>`),b.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${R}; font-weight: 600;">${i>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(F)} (${T}) –¥–æ ${e(L)} (${O}) ‚Äî <span style="color: ${y}; font-weight: 600;">${i>=0?"+":"-"}${Math.abs(i).toFixed(1)}%</span>`)}}}return b.length>0?b:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),z=j(()=>{var h;const N=((h=t.data)==null?void 0:h.carryoverTicketsByMonth)||[];if(N.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const W=[],b=[],v=N.filter($=>$&&typeof $.count=="number").map($=>`${e($.count||0)} (${$.monthName||$.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(v&&W.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${v}`),N.length>=2){const $=N[0],D=N[1],A=N[2];if(D&&$&&typeof $.count=="number"&&typeof D.count=="number"){const S=$.monthName||$.month,G=D.monthName||D.month,U=e($.count||0),I=e(D.count||0);if($.count>0){const B=(D.count-$.count)/$.count*100;if(isFinite(B)&&!isNaN(B))if(Math.abs(B)<.1)b.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${U} (${S}) ‚Üí ${I} (${G}) ‚Äî 0.0%`);else{const F=B>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",L=Math.abs(B),X=B>=0?"+":"-",i=B>=0?"#28a745":"#dc3545",r=B>=0?"#28a745":"#dc3545";b.push(`  ‚Ä¢ <span style="color: ${i}; font-weight: 600;">${F}</span> —Å ${U} (${S}) –¥–æ ${I} (${G}) ‚Äî <span style="color: ${r}; font-weight: 600;">${X}${L.toFixed(1)}%</span>`)}}else $.count===0&&D.count>0&&b.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${S}) –¥–æ ${I} (${G})`)}if(A&&D&&typeof D.count=="number"&&typeof A.count=="number"){const S=D.monthName||D.month,G=A.monthName||A.month,U=e(D.count||0),I=e(A.count||0);if(D.count>0){const B=(A.count-D.count)/D.count*100;if(isFinite(B)&&!isNaN(B))if(Math.abs(B)<.1)b.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${U} (${S}) ‚Üí ${I} (${G}) ‚Äî 0.0%`);else{const F=B>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",L=Math.abs(B),X=B>=0?"+":"-",i=B>=0?"#28a745":"#dc3545",r=B>=0?"#28a745":"#dc3545";b.push(`  ‚Ä¢ <span style="color: ${i}; font-weight: 600;">${F}</span> —Å ${U} (${S}) –¥–æ ${I} (${G}) ‚Äî <span style="color: ${r}; font-weight: 600;">${X}${L.toFixed(1)}%</span>`)}}else D.count===0&&A.count>0&&b.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${S}) –¥–æ ${I} (${G})`)}}if(b.length>0&&(W.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),W.push(...b)),N.length>=3){const $=N[0],D=N[N.length-1];if($&&D&&typeof $.count=="number"&&typeof D.count=="number"){const A=$.count||0,S=D.count||0,G=$.monthName||$.month,U=D.monthName||D.month,I=e(A),B=e(S);if(A>0){const F=(S-A)/A*100;if(isFinite(F)&&!isNaN(F))if(Math.abs(F)<1)W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${I} (${G}) ‚Üí ${B} (${U}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const L=F>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",X=Math.abs(F),i=F>=0?"+":"-",r=F>=0?"#28a745":"#dc3545",p=F>=0?"#28a745":"#dc3545";W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ <span style="color: ${r}; font-weight: 600;">${L}</span> —Å ${I} (${G}) –¥–æ ${B} (${U}) ‚Äî <span style="color: ${p}; font-weight: 600;">${i}${X.toFixed(1)}%</span>`)}}else A===0&&S>0?(W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${G}) –¥–æ ${B} (${U})`)):A>0&&S===0&&(W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${I} (${G}) –¥–æ 0 (${U})`))}}return W.length>0?W:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function q(N,W){let b=[];switch(N){case"new":b=t.data.newTicketsByMonth||[];break;case"closed":b=t.data.closedTicketsByMonth||[];break;case"carryover":b=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const v of b){if(!v.weeks||!Array.isArray(v.weeks))continue;const h=v.weeks.find($=>$&&$.weekNumber===W);if(h){const $=h.count||0;return $>0?e($):"-"}}return"-"}return(N,W)=>(_(),g("div",go,[a("div",bo,[a("h3",wo,[W[0]||(W[0]=le(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),m.value?(_(),g("span",Co,"("+C(m.value)+")",1)):Z("",!0)]),a("div",To,[a("div",$o,[J(Xe(De),{data:n.value,options:c},null,8,["data"])]),a("div",Wo,[W[3]||(W[3]=a("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),a("div",Ao,[a("div",Do,[W[1]||(W[1]=a("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),a("span",Eo,C(E.value.new),1)]),a("div",Uo,[W[2]||(W[2]=a("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),a("span",No,C(E.value.closed),1)])]),a("div",So,[(_(!0),g(Q,null,ee(x.value,(b,v)=>(_(),g("p",{key:v,innerHTML:b},null,8,Io))),128))])])])]),a("div",Mo,[a("h3",Oo,[W[4]||(W[4]=le(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),f.value?(_(),g("span",Bo,"("+C(f.value)+")",1)):Z("",!0)]),a("div",Ro,[a("div",Po,[J(Xe(De),{data:l.value,options:c},null,8,["data"])]),a("div",xo,[W[5]||(W[5]=a("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),a("div",Lo,[(_(!0),g(Q,null,ee(z.value,(b,v)=>(_(),g("p",{key:v,innerHTML:b},null,8,Go))),128))])])])]),a("div",Fo,[W[10]||(W[10]=a("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),a("div",Vo,[a("table",Yo,[a("thead",null,[a("tr",null,[W[6]||(W[6]=a("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(_(!0),g(Q,null,ee(s.value,b=>(_(),g("th",{key:`week-${b}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+C(b),1))),128))])]),a("tbody",null,[a("tr",Ho,[W[7]||(W[7]=a("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(_(!0),g(Q,null,ee(s.value,b=>(_(),g("td",{key:`new-${b}`,class:"week-data-cell"},C(q("new",b)),1))),128))]),a("tr",jo,[W[8]||(W[8]=a("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(_(!0),g(Q,null,ee(s.value,b=>(_(),g("td",{key:`closed-${b}`,class:"week-data-cell"},C(q("closed",b)),1))),128))]),a("tr",zo,[W[9]||(W[9]=a("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(_(!0),g(Q,null,ee(s.value,b=>(_(),g("td",{key:`carryover-${b}`,class:"week-data-cell"},C(q("carryover",b)),1))),128))])])])])])]))}},Zo=_e(qo,[["__scopeId","data-v-31a3d565"]]),Xo={class:"months-preloader"},Jo={class:"preloader-content"},Ko={class:"progress-container"},Qo={class:"progress-bar"},en={class:"progress-text"},tn={class:"preloader-message"},an={class:"stages-list"},sn={class:"stage-icon"},rn={class:"stage-text"},on={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:o=>o>=0&&o<=100},currentStage:{type:String,default:""}},setup(o){const t=o,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function s(l){return t.progress>=e[l].threshold}function n(l){const c=e[l].threshold,k=l>0?e[l-1].threshold:0;return t.progress>=k&&t.progress<c}return(l,c)=>(_(),g("div",Xo,[a("div",Jo,[c[0]||(c[0]=qt('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),a("div",Ko,[a("div",Qo,[a("div",{class:"progress-fill",style:ge({width:`${o.progress}%`})},null,4)]),a("div",en,C(Math.round(o.progress))+"%",1)]),a("p",tn,C(o.currentStage),1),a("div",an,[(_(),g(Q,null,ee(e,(k,m)=>a("div",{key:m,class:ae(["stage-item",{"stage-completed":s(m),"stage-current":n(m)}])},[a("span",sn,C(s(m)?"‚úì":n(m)?"‚Üí":"‚óã"),1),a("span",rn,C(k.label),1)],2)),64))])])]))}},nn=_e(on,[["__scopeId","data-v-b571fe67"]]),ln="/api/graph-1c-admission-closure.php";function cn(o){var s,n,l,c,k,m,f,E,x,z,q,N,W,b,v,h,$,D,A,S,G,U,I,B,F,L,X,i,r,p,T,O,w,d,R,y,u,P,M,H,K,ce,de,ue,ve,ke,he,ye,me,be,we,Ce,Te,$e,Ee,Ue,Ne,Se,Ie,Me,Oe,Be,Re,Pe,xe;if(!o)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0]},weeksData:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=o.data||o.result||o,e=t.meta||o.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((s=t.data)==null?void 0:s.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:t.data.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:t.data.carryoverTicketsCreatedOlder??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0}),newTickets:((l=(n=t.data)==null?void 0:n.currentWeek)==null?void 0:l.newTickets)??((c=t.data)==null?void 0:c.newTickets)??t.newTickets??0,closedTickets:((m=(k=t.data)==null?void 0:k.currentWeek)==null?void 0:m.closedTickets)??((f=t.data)==null?void 0:f.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((x=(E=t.data)==null?void 0:E.currentWeek)==null?void 0:x.closedTicketsCreatedThisWeek)??((z=t.data)==null?void 0:z.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((N=(q=t.data)==null?void 0:q.currentWeek)==null?void 0:N.closedTicketsCreatedOtherWeek)??((W=t.data)==null?void 0:W.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((v=(b=t.data)==null?void 0:b.currentWeek)==null?void 0:v.carryoverTickets)??((h=t.data)==null?void 0:h.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((D=($=t.data)==null?void 0:$.currentWeek)==null?void 0:D.carryoverTicketsCreatedThisWeek)??((A=t.data)==null?void 0:A.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((G=(S=t.data)==null?void 0:S.currentWeek)==null?void 0:G.carryoverTicketsCreatedOtherWeek)??((U=t.data)==null?void 0:U.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:((B=(I=t.data)==null?void 0:I.currentWeek)==null?void 0:B.carryoverTicketsCreatedPreviousWeek)??((F=t.data)==null?void 0:F.carryoverTicketsCreatedPreviousWeek)??t.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:((X=(L=t.data)==null?void 0:L.currentWeek)==null?void 0:X.carryoverTicketsCreatedOlder)??((i=t.data)==null?void 0:i.carryoverTicketsCreatedOlder)??t.carryoverTicketsCreatedOlder??0,series:{new:((p=(r=t.data)==null?void 0:r.series)==null?void 0:p.new)??((T=t.series)==null?void 0:T.new)??[0],closed:((w=(O=t.data)==null?void 0:O.series)==null?void 0:w.closed)??((d=t.series)==null?void 0:d.closed)??[0],closedCreatedThisWeek:((y=(R=t.data)==null?void 0:R.series)==null?void 0:y.closedCreatedThisWeek)??((u=t.series)==null?void 0:u.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((M=(P=t.data)==null?void 0:P.series)==null?void 0:M.closedCreatedOtherWeek)??((H=t.series)==null?void 0:H.closedCreatedOtherWeek)??[0],carryover:((ce=(K=t.data)==null?void 0:K.series)==null?void 0:ce.carryover)??((de=t.series)==null?void 0:de.carryover)??[0],carryoverCreatedThisWeek:((ve=(ue=t.data)==null?void 0:ue.series)==null?void 0:ve.carryoverCreatedThisWeek)??((ke=t.series)==null?void 0:ke.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((ye=(he=t.data)==null?void 0:he.series)==null?void 0:ye.carryoverCreatedOtherWeek)??((me=t.series)==null?void 0:me.carryoverCreatedOtherWeek)??[0],carryoverCreatedPreviousWeek:((we=(be=t.data)==null?void 0:be.series)==null?void 0:we.carryoverCreatedPreviousWeek)??((Ce=t.series)==null?void 0:Ce.carryoverCreatedPreviousWeek)??[0],carryoverCreatedOlder:(($e=(Te=t.data)==null?void 0:Te.series)==null?void 0:$e.carryoverCreatedOlder)??((Ee=t.series)==null?void 0:Ee.carryoverCreatedOlder)??[0]},weeksData:((Ue=t.data)==null?void 0:Ue.weeksData)??t.weeksData??[],stages:((Ne=t.data)==null?void 0:Ne.stages)??t.stages??[],responsible:((Se=t.data)==null?void 0:Se.responsible)??t.responsible??[],responsibleCreatedThisWeek:((Ie=t.data)==null?void 0:Ie.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((Me=t.data)==null?void 0:Me.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Oe=t.data)==null?void 0:Oe.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Be=t.data)==null?void 0:Be.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((Re=t.data)==null?void 0:Re.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((Pe=t.data)==null?void 0:Pe.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((xe=t.data)==null?void 0:xe.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function We(o={}){const{endpoint:t=ln,product:e="1C",weekStartUtc:s=null,weekEndUtc:n=null,periodMode:l="weeks",useCache:c=!0,forceRefresh:k=!1,includeTickets:m=!1,includeNewTicketsByStages:f=!1,includeCarryoverTickets:E=!0,includeCarryoverTicketsByDuration:x=!1}=o,z={product:e,weekStartUtc:s,weekEndUtc:n,periodMode:l,useCache:c,forceRefresh:k,includeTickets:m,includeNewTicketsByStages:f,includeCarryoverTickets:E,includeCarryoverTicketsByDuration:x},q=Zt(t),N=await fetch(q,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(z)});if(!N.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${N.status})`);const W=await N.json();if((W==null?void 0:W.success)===!1)throw new Error(W.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return cn(W)}const dn={class:"ac-dashboard-months"},un={key:"content"},vn={class:"dashboard-header"},kn={class:"header-content"},hn={class:"breadcrumbs-row"},yn=["aria-label","aria-disabled","data-fallback","disabled"],mn={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},_n={class:"dashboard-layout"},fn={class:"filters-container"},pn={class:"chart-container"},gn={__name:"GraphAdmissionClosureMonthsDashboard",setup(o){const t=Ct(),e=Y(!0),s=Y(0),n=Y("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),l=Y(null),c=Y(null),k=Y({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),m=Y(!1),f=j(()=>typeof window>"u"?!1:window.history.length>1),E=j(()=>f.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),x={name:"dashboard-sector-1c"};function z(U){var I;if((I=U==null?void 0:U.preventDefault)==null||I.call(U),!m.value){m.value=!0;try{if(f.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(x)}finally{m.value=!1}}}const q=Y({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),N=j(()=>{const U=q.value.customDateRange.startDate||q.value.customDateRange.endDate,I=q.value.employees.length===1&&q.value.employees.includes("all");return U||!I});async function W(U,I,B=500){const F=s.value,L=10,X=(U-F)/L,i=B/L;for(let r=0;r<L;r++)await new Promise(p=>setTimeout(p,i)),s.value=Math.min(F+X*(r+1),U);s.value=U,n.value=I}async function b(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,s.value=0,n.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let U=null,I=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await W(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const B=Date.now(),F=2e4;U=setInterval(()=>{const r=Date.now()-B,p=Math.min(5+r/F*85,90);s.value=p,p<35?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":p<65?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":p<85?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":n.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),I=setTimeout(()=>{U&&(clearInterval(U),U=null)},F+1e4);const L=await We({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(I),U&&(clearInterval(U),U=null),s.value=90,n.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await W(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",L);const{meta:X,data:i}=L;c.value=X,k.value=i,console.log("[DEBUG MonthsDashboard] Data set, meta:",X,"data keys:",Object.keys(i)),await new Promise(r=>setTimeout(r,200))}catch(B){U&&(clearInterval(U),U=null),I&&(clearTimeout(I),I=null),console.error("[DEBUG MonthsDashboard] API call failed:",B),l.value=B instanceof Error?B:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",B),s.value=100,n.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function v(U){q.value.stages=U}function h(U){q.value.employees=U}function $(U){q.value.dateRange=U}function D(U){q.value.customDateRange=U}function A(){q.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},S()}function S(){b()}function G(U){if(!["weeks","months"].includes(U)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",U);return}U==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:U}}))}return st(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),b()}),(U,I)=>{const B=Tt("router-link");return _(),g("div",dn,[J(ne,{name:"fade",mode:"out-in"},{default:te(()=>[e.value?(_(),ie(nn,{key:"preloader",progress:s.value,"current-stage":n.value},null,8,["progress","current-stage"])):(_(),g("div",un,[a("div",vn,[a("div",kn,[a("div",hn,[a("button",{class:"btn-back-link",type:"button",onClick:z,"aria-label":E.value,"aria-disabled":!f.value,"data-fallback":!f.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,yn),a("nav",mn,[J(B,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:te(()=>[...I[0]||(I[0]=[le(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),I[2]||(I[2]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),J(B,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:te(()=>[...I[1]||(I[1]=[le(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),I[3]||(I[3]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),I[4]||(I[4]=a("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),I[5]||(I[5]=a("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),I[6]||(I[6]=a("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),a("div",_n,[a("div",fn,[J(Wt,{stages:q.value.stages,employees:q.value.employees,dateRange:q.value.dateRange,customDateRange:q.value.customDateRange,hasActiveFilters:N.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":v,"onUpdate:employees":h,"onUpdate:dateRange":$,"onUpdate:customDateRange":D,"onUpdate:periodMode":G,onReset:A,onApply:S},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),a("div",pn,[l.value?(_(),ie($t,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(_(),g(Q,{key:1},[J(Xr,{data:k.value},null,8,["data"]),J(Zo,{data:k.value,meta:c.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},bn=_e(gn,[["__scopeId","data-v-fe3ca7ed"]]);class at{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const s=await this.getEmployeesByIds(e);return console.log("Loaded employees:",s.length),{stages:this.groupTicketsByStages(t,s),employees:s,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const s of t){console.log(`Loading tickets for stage: ${s}`);const n=await this.getTicketsByStage(s);e.push(...n),console.log(`Loaded ${n.length} tickets for stage ${s}`)}return e}static async getTicketsByStage(t){const e=[];let s=0;const n=50;let l=!0;for(;l;)try{const k=await Ae.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:s,useOriginalUfNames:"Y"});let m=[];k&&k.result&&(Array.isArray(k.result)?m=k.result:k.result.items&&Array.isArray(k.result.items)?m=k.result.items:k.result.data&&Array.isArray(k.result.data)&&(m=k.result.data)),m.length>0?(e.push(...m),s+=m.length,l=m.length===n):l=!1}catch(k){console.error(`Error loading tickets batch for stage ${t} (start: ${s}):`,k),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const c=e.filter(k=>{const m=k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product||k.ufCrm7TypeProduct||k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product;return Array.isArray(m)?m.includes(this.SECTOR_TAG):typeof m=="object"&&m!==null?m.value===this.SECTOR_TAG||m===this.SECTOR_TAG:m===this.SECTOR_TAG});return console.log(`Filtered ${c.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),c}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(s=>{const n=s.assignedById||s.assignedByIdId||s.ASSIGNED_BY_ID||s.assignedById||s.assignedById&&typeof s.assignedById=="object"&&(s.assignedById.id||s.assignedById.ID)||s.assignedById&&typeof s.assignedById=="object"&&s.assignedById.value;if(n){const l=parseInt(n);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await Ae.call("user.get",{filter:{ID:t}});let s=[];return e&&e.result&&(Array.isArray(e.result)?s=e.result:console.warn("Unexpected user.get result format:",e)),s.map(n=>({id:parseInt(n.ID||n.id||0),name:`${n.NAME||n.name||""} ${n.LAST_NAME||n.lastName||""}`.trim()||n.EMAIL||n.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:n.WORK_POSITION||n.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:n.EMAIL||n.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const s=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(n=>({...n,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(n=>({...n,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(n=>({...n,tickets:[]}))}];return t.forEach(n=>{const l=this.mapStageId(n.stageId||n.STAGE_ID||""),c=s.find(k=>k.id===l);if(c){const k=n.assignedById||n.ASSIGNED_BY_ID||null,m=k?parseInt(k):null;if(m){let f=c.employees.find(E=>E.id===m);f||(f={id:m,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${m}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},c.employees.push(f)),f.tickets.push(this.mapTicket(n))}}}),s}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),s=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",n=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,c=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",k=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",m=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,f=mt(m),E=Kt(f);return{id:e,title:s,priorityId:f.id,priorityLabel:f.label,priorityColors:E,priority:f.id,priorityBitrixValue:f.bitrixValue||null,status:this.mapStatus(n),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(n),createdAt:c,modifiedAt:k,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return mt(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=_t(t);if(e&&e.bitrixValue)return e.bitrixValue;const s={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return s[t]?s[t]:_t(Qt).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(s=>!(s.assignedById||s.ASSIGNED_BY_ID)).forEach(s=>{const n=this.mapStageId(s.stageId||s.STAGE_ID||"");e[n]&&e[n].push(this.mapTicket(s))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,s){try{const n=this.mapStageIdToBitrix(s);return(await Ae.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:n}})).result===!0}catch(n){throw console.error("Error assigning ticket:",n),n}}static async createTicket(t){try{const e=await Ae.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await Ae.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await Ae.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(s){throw console.error("Error adding comment:",s),s}}}Qe(at,"ENTITY_TYPE_ID",140),Qe(at,"SECTOR_TAG","1C");const wn={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Cn={class:"modal"},Tn={key:0,class:"modal__tabs"},$n={key:"level-0-categories",class:"level-0"},Wn={class:"modal__header"},An={class:"modal__title"},Dn={key:0},En={class:"modal__body"},Un={class:"categories-list"},Nn=["onClick"],Sn={class:"category-item"},In={class:"category-item__icon"},Mn={key:0},On={key:1},Bn={class:"category-item__content"},Rn={class:"category-item__label"},Pn={class:"category-item__count"},xn={key:0,class:"category-item__arrow"},Ln={class:"modal__footer"},Gn={key:"level-1-categories",class:"level-1"},Fn={class:"modal__header"},Vn={class:"modal__body"},Yn={key:"loading",class:"loading-names"},Hn={key:"empty",class:"modal__empty"},jn={key:"list",class:"responsible-list"},zn=["onClick"],qn={class:"responsible-list__name"},Zn={class:"responsible-list__count"},Xn={key:0,class:"responsible-list__arrow"},Jn={class:"modal__footer"},Kn={key:"level-2-categories",class:"level-2"},Qn={class:"modal__header"},el={class:"modal__title"},tl={class:"modal__body"},al={key:"loading",class:"loading-state"},sl={key:"error",class:"error-state"},rl={class:"error-message"},ol={key:"empty",class:"empty-state"},nl={key:"tickets",class:"tickets-list-container"},ll={key:"level-0-employees",class:"level-0"},il={class:"modal__header"},cl={class:"modal__title"},dl={key:0},ul={class:"modal__body"},vl={key:"loading",class:"loading-names"},kl={key:"empty",class:"modal__empty"},hl={key:"list",class:"responsible-list"},yl=["onClick"],ml={class:"responsible-list__name"},_l={class:"responsible-list__count"},fl={key:0,class:"responsible-list__arrow"},pl={class:"modal__footer"},gl={key:"level-1-employees",class:"level-1"},bl={class:"modal__header"},wl={class:"modal__title"},Cl={class:"modal__body"},Tl={class:"categories-list"},$l=["onClick"],Wl={class:"category-item"},Al={class:"category-item__icon"},Dl={key:0},El={key:1},Ul={class:"category-item__content"},Nl={class:"category-item__label"},Sl={class:"category-item__count"},Il={key:0,class:"category-item__arrow"},Ml={class:"modal__footer"},Ol={key:"level-2-employees",class:"level-2"},Bl={class:"modal__header"},Rl={class:"modal__title"},Pl={class:"modal__body"},xl={key:"loading",class:"loading-state"},Ll={key:"error",class:"error-state"},Gl={class:"error-message"},Fl={key:"empty",class:"empty-state"},Vl={class:"empty-state-message"},Yl={key:"tickets",class:"tickets-list-container"},Hl={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(o){const t=o,e=Y(0),s=Y("categories"),n=Y(null),l=Y(null),c=Y(null),k=Y([]),m=Y(!1),f=Y(null),E=Y([]),x=Y([]),z=Y(!1),q=j(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),N=j(()=>{const i=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(r=>{const p=r.id??"unassigned";i.has(p)||i.set(p,{id:r.id,name:r.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const T=i.get(p);T.thisWeekCount=r.count??0,T.thisWeekTickets=r.tickets||[],T.totalCount+=T.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(r=>{const p=r.id??"unassigned";i.has(p)||i.set(p,{id:r.id,name:r.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const T=i.get(p);T.otherWeekCount=r.count??0,T.otherWeekTickets=r.tickets||[],T.totalCount+=T.otherWeekCount}),Array.from(i.values())}),W=j(()=>{if(!l.value)return[];const i=l.value.thisWeekTickets||[],r=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:i.length,otherWeekTickets:r.length,employee:l.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.thisWeekCount??0,tickets:i,employeeId:l.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.otherWeekCount??0,tickets:r,employeeId:l.value.id}]}),b=j(()=>(x.value||[]).length>0);async function v(i){const r=i.filter(p=>p.id!==null&&p.id!==void 0).map(p=>p.id);if(r.length===0)return i;try{const p=await at.getEmployeesByIds(r),T=new Map;return p.forEach(O=>{T.set(O.id,O.name)}),i.map(O=>O.id&&T.has(O.id)?{...O,name:T.get(O.id)}:O)}catch(p){return console.error("[ResponsibleModal] Error enriching names:",p),i}}pe([()=>s.value,()=>N.value],async([i,r])=>{if(!(i!=="employees"||e.value!==0)){if(!r||r.length===0){x.value=[];return}z.value=!0;try{x.value=await v(r)}catch(p){console.error("[ResponsibleModal] Error loading employee names:",p),x.value=r}finally{z.value=!1}}},{immediate:!0}),pe(()=>t.responsible,async i=>{if(!(e.value!==0||n.value||s.value!=="categories")){if(!i||i.length===0){E.value=[];return}z.value=!0;try{E.value=await v(i)}catch(r){console.error("[ResponsibleModal] Error loading employee names:",r),E.value=i}finally{z.value=!1}}},{immediate:!1});const h=j(()=>(E.value||[]).length>0);function $(i){s.value!==i&&(s.value=i,e.value=0,n.value=null,l.value=null,c.value=null,k.value=[],f.value=null,E.value=[],x.value=[])}async function D(i){if(!(!i||i.count===0)){n.value=i,e.value=1,z.value=!0;try{E.value=await v(i.responsible)}catch(r){console.error("[ResponsibleModal] Error loading employee names:",r),E.value=i.responsible}finally{z.value=!1}}}async function A(i,r=null){var p,T;!i||!i.id||i.totalCount===0||(r&&r.currentTarget&&(r.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{r.currentTarget&&(r.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:i.id,name:i.name,thisWeekCount:i.thisWeekCount,otherWeekCount:i.otherWeekCount,thisWeekTickets:((p=i.thisWeekTickets)==null?void 0:p.length)||0,otherWeekTickets:((T=i.otherWeekTickets)==null?void 0:T.length)||0,employee:i}),l.value={...i,thisWeekTickets:i.thisWeekTickets||[],otherWeekTickets:i.otherWeekTickets||[]},e.value=1)}async function S(i){var p;if(!i||i.count===0)return;c.value=i,e.value=2;const r=i.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:i.id,label:i.label,count:i.count,ticketsInGradation:r.length,selectedEmployee:(p=l.value)==null?void 0:p.id}),r.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",r.length),await G(r)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await U(i))}async function G(i){m.value=!0,f.value=null;try{try{const{prepareTicketsForDisplay:r}=await Fe(async()=>{const{prepareTicketsForDisplay:p}=await import("./ticketListUtils-L6jW_GPY.js").then(T=>T.t);return{prepareTicketsForDisplay:p}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await r(i,null,null)}catch(r){console.error("[ResponsibleModal] Error preparing tickets:",r),k.value=i}k.value.length===0&&(f.value=null)}catch(r){f.value=r.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",r),k.value=[]}finally{m.value=!1}}async function U(i){m.value=!0,f.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const r=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),p=i.id==="this-week"?r.data.responsibleCreatedThisWeek:r.data.responsibleCreatedOtherWeek,T=p==null?void 0:p.find(w=>w.id===l.value.id),O=(T==null?void 0:T.tickets)||[];try{const{prepareTicketsForDisplay:w}=await Fe(async()=>{const{prepareTicketsForDisplay:d}=await import("./ticketListUtils-L6jW_GPY.js").then(R=>R.t);return{prepareTicketsForDisplay:d}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await w(O,null,null)}catch(w){console.error("[ResponsibleModal] Error preparing tickets:",w),k.value=O}k.value.length===0&&(f.value=null)}catch(r){f.value=r.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",r),k.value=[]}finally{m.value=!1}}async function I(i,r=null){!i||!i.id||i.count===0||(r&&r.currentTarget&&(r.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{r.currentTarget&&(r.currentTarget.style.transform="")},150)),l.value=i,e.value=2,await B(i.id))}async function B(i){var r;m.value=!0,f.value=null;try{let p=[];if(n.value&&n.value.responsible){const T=n.value.responsible.find(O=>O.id===i);p=(T==null?void 0:T.tickets)||[]}if(p.length===0&&t.weekStartUtc&&t.weekEndUtc){const T=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),O=((r=n.value)==null?void 0:r.id)==="created-this-week"?T.data.responsibleCreatedThisWeek:T.data.responsibleCreatedOtherWeek,w=O==null?void 0:O.find(d=>d.id===i);p=(w==null?void 0:w.tickets)||[]}try{const{prepareTicketsForDisplay:T}=await Fe(async()=>{const{prepareTicketsForDisplay:O}=await import("./ticketListUtils-L6jW_GPY.js").then(w=>w.t);return{prepareTicketsForDisplay:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await T(p,null,null)}catch(T){console.error("[ResponsibleModal] Error preparing tickets:",T),k.value=p}k.value.length===0&&(f.value=null)}catch(p){f.value=p.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",p),k.value=[]}finally{m.value=!1}}function F(){e.value===2?(e.value=1,s.value==="categories"?l.value=null:c.value=null,k.value=[],f.value=null):e.value===1&&(e.value=0,s.value==="categories"?(n.value=null,E.value=[]):l.value=null)}function L(i){const r=rt(i.id);window.open(r,"_blank")}function X(){s.value==="employees"&&c.value?G(c.value.tickets):s.value==="categories"&&l.value&&B(l.value.id)}return pe(()=>t.isVisible,i=>{i||(e.value=0,s.value="categories",n.value=null,l.value=null,c.value=null,k.value=[],f.value=null,E.value=[],x.value=[])}),(i,r)=>o.isVisible?(_(),g("div",wn,[a("div",Cn,[e.value===0?(_(),g("div",Tn,[a("button",{class:ae(["modal__tab",{"modal__tab--active":s.value==="categories"}]),onClick:r[0]||(r[0]=p=>$("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),a("button",{class:ae(["modal__tab",{"modal__tab--active":s.value==="employees"}]),onClick:r[1]||(r[1]=p=>$("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):Z("",!0),J(ne,{name:"level",mode:"out-in"},{default:te(()=>{var p,T,O,w;return[s.value==="categories"&&e.value===0?(_(),g("div",$n,[a("header",Wn,[a("h3",An,[r[12]||(r[12]=le(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(_(),g("span",Dn," ¬∑ –ù–µ–¥–µ–ª—è "+C(o.weekNumber),1)):Z("",!0)]),a("button",{class:"modal__close",onClick:r[2]||(r[2]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",En,[a("ul",Un,[(_(!0),g(Q,null,ee(q.value,d=>(_(),g("li",{key:d.id,class:ae(["categories-list__item",{"categories-list__item--clickable":d.count>0}]),onClick:R=>D(d)},[a("div",Sn,[a("div",In,[d.id==="created-this-week"?(_(),g("span",Mn,"‚úì")):(_(),g("span",On,"‚Üª"))]),a("div",Bn,[a("div",Rn,C(d.label),1),a("div",Pn,C(d.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),d.count>0?(_(),g("span",xn,"‚Üí")):Z("",!0)])],10,Nn))),128))])]),a("footer",Ln,[a("button",{class:"btn",onClick:r[3]||(r[3]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="categories"&&e.value===1?(_(),g("div",Gn,[a("header",Fn,[a("button",{class:"btn-back",onClick:F,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r[13]||(r[13]=a("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a("button",{class:"modal__close",onClick:r[4]||(r[4]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Vn,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>[z.value?(_(),g("div",Yn,[...r[14]||(r[14]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):h.value?(_(),g("ul",jn,[(_(!0),g(Q,null,ee(E.value,d=>(_(),g("li",{key:d.id||d.name,class:ae(["responsible-list__item",{"responsible-list__item--clickable":d.id&&d.count>0}]),onClick:R=>I(d,R),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[a("span",qn,C(d.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),a("span",Zn,C(d.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),d.id&&d.count>0?(_(),g("span",Xn,"‚Üí")):Z("",!0)],10,zn))),128))])):(_(),g("p",Hn,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),a("footer",Jn,[a("button",{class:"btn",onClick:r[5]||(r[5]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="categories"&&e.value===2?(_(),g("div",Kn,[a("header",Qn,[a("button",{class:"btn-back",onClick:F,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a("h3",el,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C(((p=l.value)==null?void 0:p.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),a("button",{class:"modal__close",onClick:r[6]||(r[6]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",tl,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>[m.value?(_(),g("div",al,[...r[15]||(r[15]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(_(),g("div",sl,[r[16]||(r[16]=a("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),r[17]||(r[17]=a("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),a("p",rl,C(f.value),1),a("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(_(),g("div",ol,[...r[18]||(r[18]=[a("div",{class:"empty-state-icon"},"üìã",-1),a("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(_(),g("div",nl,[J(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:te(()=>[(_(!0),g(Q,null,ee(k.value,(d,R)=>(_(),ie(Ke,{key:d.id,ticket:d,draggable:!1,style:ge({"--ticket-index":R}),onClick:L},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):s.value==="employees"&&e.value===0?(_(),g("div",ll,[a("header",il,[a("h3",cl,[r[19]||(r[19]=le(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o.weekNumber?(_(),g("span",dl," ¬∑ –ù–µ–¥–µ–ª—è "+C(o.weekNumber),1)):Z("",!0)]),a("button",{class:"modal__close",onClick:r[7]||(r[7]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",ul,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>[z.value?(_(),g("div",vl,[...r[20]||(r[20]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):b.value?(_(),g("ul",hl,[(_(!0),g(Q,null,ee(x.value,d=>(_(),g("li",{key:d.id||d.name,class:ae(["responsible-list__item",{"responsible-list__item--clickable":d.id&&d.totalCount>0}]),onClick:R=>A(d,R),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[a("span",ml,C(d.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),a("span",_l,C(d.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),d.id&&d.totalCount>0?(_(),g("span",fl,"‚Üí")):Z("",!0)],10,yl))),128))])):(_(),g("p",kl,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),a("footer",pl,[a("button",{class:"btn",onClick:r[8]||(r[8]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="employees"&&e.value===1?(_(),g("div",gl,[a("header",bl,[a("button",{class:"btn-back",onClick:F,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a("h3",wl,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C(((T=l.value)==null?void 0:T.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),a("button",{class:"modal__close",onClick:r[9]||(r[9]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Cl,[a("ul",Tl,[(_(!0),g(Q,null,ee(W.value,d=>(_(),g("li",{key:d.id,class:ae(["categories-list__item",{"categories-list__item--clickable":d.count>0}]),onClick:R=>S(d)},[a("div",Wl,[a("div",Al,[d.id==="this-week"?(_(),g("span",Dl,"‚úì")):(_(),g("span",El,"‚Üª"))]),a("div",Ul,[a("div",Nl,C(d.label),1),a("div",Sl,C(d.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),d.count>0?(_(),g("span",Il,"‚Üí")):Z("",!0)])],10,$l))),128))])]),a("footer",Ml,[a("button",{class:"btn",onClick:r[10]||(r[10]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="employees"&&e.value===2?(_(),g("div",Ol,[a("header",Bl,[a("button",{class:"btn-back",onClick:F,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a("h3",Rl," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+C(((O=l.value)==null?void 0:O.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+C(((w=c.value)==null?void 0:w.label)||"")+") ",1),a("button",{class:"modal__close",onClick:r[11]||(r[11]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Pl,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>{var d;return[m.value?(_(),g("div",xl,[...r[21]||(r[21]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(_(),g("div",Ll,[r[22]||(r[22]=a("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),r[23]||(r[23]=a("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),a("p",Gl,C(f.value),1),a("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(_(),g("div",Fl,[r[24]||(r[24]=a("div",{class:"empty-state-icon"},"üìã",-1)),a("p",Vl,C(s.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((d=c.value)==null?void 0:d.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(_(),g("div",Yl,[J(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:te(()=>[(_(!0),g(Q,null,ee(k.value,(R,y)=>(_(),ie(Ke,{key:R.id,ticket:R,draggable:!1,style:ge({"--ticket-index":y}),onClick:L},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},jl=_e(Hl,[["__scopeId","data-v-3b229bb4"]]),zl={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},ql={class:"modal"},Zl={key:"level-1",class:"level-1"},Xl={class:"modal__header"},Jl={class:"modal__title"},Kl={key:0},Ql={class:"modal__body"},ei={key:"loading",class:"loading-names"},ti={key:"empty",class:"modal__empty"},ai={key:"list",class:"stages-list"},si=["onClick"],ri={class:"stages-list__name"},oi={class:"stages-list__count"},ni={key:0,class:"stages-list__arrow"},li={class:"modal__footer"},ii={key:"level-2",class:"level-2"},ci={class:"modal__header"},di={class:"modal__title"},ui={class:"modal__body"},vi={key:"loading",class:"loading-state"},ki={key:"error",class:"error-state"},hi={class:"error-message"},yi={key:"empty",class:"empty-state"},mi={class:"empty-state-message"},_i={key:"tickets",class:"tickets-list-container"},fi={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,s=Y(1),n=Y(null),l=Y([]),c=Y(!1),k=Y(!1),m=Y(null),f=Y([]),E=j(()=>f.value.length>0&&f.value.some(v=>v.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}k.value=!0,m.value=null;try{const v=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});f.value=v.data.newTicketsByStages||[]}catch(v){m.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",v),f.value=[]}finally{k.value=!1}}async function z(v,h=null){!v||v.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),n.value=v,s.value=2,await q(v.stageId))}async function q(v){var h;c.value=!0,m.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const D=(h=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:h.find(S=>S.stageId===v),A=(D==null?void 0:D.tickets)||[];try{const{prepareTicketsForDisplay:S}=await Fe(async()=>{const{prepareTicketsForDisplay:G}=await import("./ticketListUtils-L6jW_GPY.js").then(U=>U.t);return{prepareTicketsForDisplay:G}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await S(A,null,null)}catch(S){console.error("[StagesModal] Error preparing tickets:",S),l.value=A}l.value.length===0&&(m.value=null)}catch($){m.value=$.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",$),l.value=[]}finally{c.value=!1}}function N(){s.value=1,n.value=null,l.value=[],m.value=null}function W(v){const h=rt(v.id);window.open(h,"_blank")}function b(){n.value&&q(n.value.stageId)}return pe(()=>e.isVisible,v=>{v?x():(s.value=1,n.value=null,l.value=[],m.value=null,f.value=[])}),pe([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(v,h)=>o.isVisible?(_(),g("div",zl,[a("div",ql,[J(ne,{name:"level",mode:"out-in"},{default:te(()=>{var $;return[s.value===1?(_(),g("div",Zl,[a("header",Xl,[a("h3",Jl,[h[3]||(h[3]=le(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),o.weekNumber?(_(),g("span",Kl," ¬∑ –ù–µ–¥–µ–ª—è "+C(o.weekNumber),1)):Z("",!0)]),a("button",{class:"modal__close",onClick:h[0]||(h[0]=D=>v.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Ql,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>[k.value?(_(),g("div",ei,[...h[4]||(h[4]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):E.value?(_(),g("ul",ai,[(_(!0),g(Q,null,ee(f.value,D=>(_(),g("li",{key:D.stageId,class:ae(["stages-list__item",{"stages-list__item--clickable":D.count>0}]),style:ge({"--stage-color":D.color}),onClick:A=>z(D,A),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[a("span",{class:"stages-list__color",style:ge({backgroundColor:D.color})},null,4),a("span",ri,C(D.stageName),1),a("span",oi,C(D.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),D.count>0?(_(),g("span",ni,"‚Üí")):Z("",!0)],14,si))),128))])):(_(),g("p",ti," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),a("footer",li,[a("button",{class:"btn",onClick:h[1]||(h[1]=D=>v.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value===2?(_(),g("div",ii,[a("header",ci,[a("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a("h3",di," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+C((($=n.value)==null?void 0:$.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),a("button",{class:"modal__close",onClick:h[2]||(h[2]=D=>v.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",ui,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>{var D;return[c.value?(_(),g("div",vi,[...h[5]||(h[5]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(_(),g("div",ki,[h[6]||(h[6]=a("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=a("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),a("p",hi,C(m.value),1),a("button",{class:"btn btn-retry",onClick:b},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(_(),g("div",yi,[h[8]||(h[8]=a("div",{class:"empty-state-icon"},"üìã",-1)),a("p",mi," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+C((D=n.value)==null?void 0:D.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(_(),g("div",_i,[J(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:te(()=>[(_(!0),g(Q,null,ee(l.value,(A,S)=>(_(),ie(Ke,{key:A.id,ticket:A,draggable:!1,style:ge({"--ticket-index":S}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},pi=_e(fi,[["__scopeId","data-v-4af0cfce"]]),gi={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},bi={class:"modal"},wi={key:"level-1",class:"level-1"},Ci={class:"modal__header"},Ti={class:"modal__title"},$i={key:0},Wi={class:"modal__body"},Ai={key:"loading",class:"loading-names"},Di={key:"empty",class:"modal__empty"},Ei={key:"list",class:"duration-list"},Ui=["onClick"],Ni={class:"duration-list__name"},Si={class:"duration-list__count"},Ii={key:0,class:"duration-list__arrow"},Mi={class:"modal__footer"},Oi={key:"level-2",class:"level-2"},Bi={class:"modal__header"},Ri={class:"modal__title"},Pi={class:"modal__body"},xi={key:"loading",class:"loading-state"},Li={key:"error",class:"error-state"},Gi={class:"error-message"},Fi={key:"empty",class:"empty-state"},Vi={class:"empty-state-message"},Yi={key:"tickets",class:"tickets-list-container"},Hi={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(o,{emit:t}){const e=o,s=Y(1),n=Y(null),l=Y([]),c=Y(!1),k=Y(!1),m=Y(null),f=Y([]),E=j(()=>f.value.length>0&&f.value.some(v=>v.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}k.value=!0,m.value=null;try{const v=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});f.value=v.data.carryoverTicketsByDuration||[]}catch(v){m.value=v.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",v),f.value=[]}finally{k.value=!1}}async function z(v,h=null){!v||v.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),n.value=v,s.value=2,await q(v.durationCategory))}async function q(v){var h;c.value=!0,m.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const D=(h=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:h.find(S=>S.durationCategory===v),A=(D==null?void 0:D.tickets)||[];try{const{prepareTicketsForDisplay:S}=await Fe(async()=>{const{prepareTicketsForDisplay:G}=await import("./ticketListUtils-L6jW_GPY.js").then(U=>U.t);return{prepareTicketsForDisplay:G}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await S(A,null,null)}catch(S){console.error("[CarryoverDurationModal] Error preparing tickets:",S),l.value=A}l.value.length===0&&(m.value=null)}catch($){m.value=$.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",$),l.value=[]}finally{c.value=!1}}function N(){s.value=1,n.value=null,l.value=[],m.value=null}function W(v){const h=rt(v.id);window.open(h,"_blank")}function b(){n.value&&q(n.value.durationCategory)}return pe(()=>e.isVisible,v=>{v?x():(s.value=1,n.value=null,l.value=[],m.value=null,f.value=[])}),pe([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(v,h)=>o.isVisible?(_(),g("div",gi,[a("div",bi,[J(ne,{name:"level",mode:"out-in"},{default:te(()=>{var $;return[s.value===1?(_(),g("div",wi,[a("header",Ci,[a("h3",Ti,[h[3]||(h[3]=le(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),o.weekNumber?(_(),g("span",$i," ¬∑ –ù–µ–¥–µ–ª—è "+C(o.weekNumber),1)):Z("",!0)]),a("button",{class:"modal__close",onClick:h[0]||(h[0]=D=>v.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Wi,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>[k.value?(_(),g("div",Ai,[...h[4]||(h[4]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):E.value?(_(),g("ul",Ei,[(_(!0),g(Q,null,ee(f.value,D=>(_(),g("li",{key:D.durationCategory,class:ae(["duration-list__item",{"duration-list__item--clickable":D.count>0}]),style:ge({"--duration-color":D.color}),onClick:A=>z(D,A),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[a("span",{class:"duration-list__color",style:ge({backgroundColor:D.color})},null,4),a("span",Ni,C(D.durationLabel),1),a("span",Si,C(D.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),D.count>0?(_(),g("span",Ii,"‚Üí")):Z("",!0)],14,Ui))),128))])):(_(),g("p",Di," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),a("footer",Mi,[a("button",{class:"btn",onClick:h[1]||(h[1]=D=>v.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value===2?(_(),g("div",Oi,[a("header",Bi,[a("button",{class:"btn-back",onClick:N,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a("h3",Ri," –¢–∏–∫–µ—Ç—ã: "+C((($=n.value)==null?void 0:$.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),a("button",{class:"modal__close",onClick:h[2]||(h[2]=D=>v.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),a("section",Pi,[J(ne,{name:"loading",mode:"out-in"},{default:te(()=>{var D;return[c.value?(_(),g("div",xi,[...h[5]||(h[5]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(_(),g("div",Li,[h[6]||(h[6]=a("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=a("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),a("p",Gi,C(m.value),1),a("button",{class:"btn btn-retry",onClick:b},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(_(),g("div",Fi,[h[8]||(h[8]=a("div",{class:"empty-state-icon"},"üìã",-1)),a("p",Vi," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+C((D=n.value)==null?void 0:D.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(_(),g("div",Yi,[J(Je,{name:"ticket",tag:"div",class:"tickets-list"},{default:te(()=>[(_(!0),g(Q,null,ee(l.value,(A,S)=>(_(),ie(Ke,{key:A.id,ticket:A,draggable:!1,style:ge({"--ticket-index":S}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},ji=_e(Hi,[["__scopeId","data-v-c26f06c2"]]),zi={class:"ac-dashboard"},qi={key:"preloader",class:"chart-preloader"},Zi={class:"preloader-content"},Xi={class:"preloader-message"},Ji={key:"content"},Ki={key:1,class:"weeks-dashboard"},Qi={class:"dashboard-header"},ec={class:"header-content"},tc={class:"breadcrumbs-row"},ac=["aria-label","aria-disabled","data-fallback","disabled"],sc={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},rc={class:"dashboard-layout"},oc={class:"filters-container"},nc={class:"chart-container"},lc={__name:"GraphAdmissionClosureDashboard",setup(o){const t=Ct(),e=Y(!1),s=Y(null),n=Y(null),l=Y({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),c=Y(!1),k=Y(!1),m=Y(!1),f=Y(!0),E=Y(null),x=Y(!1),z=j(()=>typeof window>"u"?!1:window.history.length>1),q=j(()=>z.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),N={name:"dashboard-sector-1c"};function W(w){var d;if((d=w==null?void 0:w.preventDefault)==null||d.call(w),!x.value){x.value=!0;try{if(z.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(N)}finally{x.value=!1}}}const b=Y({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),v=Y("weeks"),h=j(()=>{const w=b.value.customDateRange.startDate||b.value.customDateRange.endDate,d=b.value.employees.length===1&&b.value.employees.includes("all");return w||!d});async function $(){if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",v.value),console.log("[DEBUG] isLoading before:",e.value),v.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,s.value=null;const w=new Promise(d=>setTimeout(d,300));try{console.log("[DEBUG] Starting API call");const d=O(),R=d.weekStartUtc,y=d.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:R,weekEndUtc:y});const[u,P]=await Promise.all([w,We({product:"1C",periodMode:"weeks",weekStartUtc:R,weekEndUtc:y,includeTickets:!0})]);console.log("[DEBUG] API call successful, result:",P);const{meta:M,data:H,carryoverDebug:K}=P;n.value=M,l.value=H,console.log("[DEBUG] Data set, meta:",M,"data keys:",Object.keys(H)),K&&(console.log("[CARRYOVER-DEBUG] ========================================"),console.log("[CARRYOVER-DEBUG] Total:",K.total),console.log("[CARRYOVER-DEBUG] ThisWeek:",K.thisWeek),console.log("[CARRYOVER-DEBUG] PreviousWeek:",K.previousWeek),console.log("[CARRYOVER-DEBUG] Older:",K.older),console.log("[CARRYOVER-DEBUG] Sum:",K.sum,"(expected:",K.total,")"),console.log("[CARRYOVER-DEBUG] Series:",K.series),console.log("[CARRYOVER-DEBUG] CurrentWeekData:",K.currentWeekData),console.log("[CARRYOVER-DEBUG] WeeksData:",K.weeksData),console.log("[CARRYOVER-DEBUG] Full object:",K),console.log("[CARRYOVER-DEBUG] ========================================"))}catch(d){console.error("[DEBUG] API call failed:",d),s.value=d instanceof Error?d:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",d)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function D(w){b.value.stages=w}function A(w){b.value.employees=w}function S(w){b.value.dateRange=w}function G(w){b.value.customDateRange=w}function U(w){if(!["weeks","months"].includes(w)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",w);return}w!==v.value&&(v.value=w,$())}function I(w){const{mode:d}=w.detail;["weeks","months"].includes(d)&&U(d)}function B(){b.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},F()}function F(){$()}function L(w){["weeks","months"].includes(w)&&(v.value=w)}function X(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",f.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",v.value),f.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",f.value),console.log("[DEBUG] isLoading after:",e.value),yt(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),i()})}function i(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",v.value),console.log("[DEBUG] showPeriodModeInfo:",f.value),console.log("[DEBUG] isLoading:",e.value),(!v.value||!["weeks","months"].includes(v.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),v.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",v.value),yt(()=>{console.log("[DEBUG] nextTick callback, periodMode:",v.value),console.log("[DEBUG] isLoading in nextTick:",e.value),v.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),$()):v.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function r(w=null){var d,R,y;w?E.value=w:E.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((R=n.value)==null?void 0:R.weekStartUtc)||null,weekEndUtc:((y=n.value)==null?void 0:y.weekEndUtc)||null},k.value=!0}function p(w=null){var d,R,y;w?E.value=w:E.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((R=n.value)==null?void 0:R.weekStartUtc)||null,weekEndUtc:((y=n.value)==null?void 0:y.weekEndUtc)||null},c.value=!0}function T(w=null){var d,R,y;w?E.value=w:E.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((R=n.value)==null?void 0:R.weekStartUtc)||null,weekEndUtc:((y=n.value)==null?void 0:y.weekEndUtc)||null},m.value=!0}st(()=>{try{const w="graph-admission-closure-period-mode-info-shown";localStorage.getItem(w)&&localStorage.removeItem(w);const d="graph-admission-closure-period-mode";localStorage.getItem(d)&&localStorage.removeItem(d)}catch(w){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",w)}window.addEventListener("period-mode-change",I)}),gt(()=>{window.removeEventListener("period-mode-change",I)});function O(){const w=new Date,d=new Date(Date.UTC(w.getUTCFullYear(),w.getUTCMonth(),w.getUTCDate())),R=d.getUTCDay(),y=d.getUTCDate()-R+(R===0?-6:1),u=new Date(Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),y,0,0,0)),P=new Date(u);return P.setUTCDate(P.getUTCDate()+6),P.setUTCHours(23,59,59,999),{weekStartUtc:u.toISOString(),weekEndUtc:P.toISOString()}}return(w,d)=>{var y,u,P,M,H,K,ce,de,ue,ve,ke,he,ye,me,be,we,Ce,Te;const R=Tt("router-link");return _(),g("div",zi,[J(ne,{name:"fade",mode:"out-in"},{default:te(()=>[e.value?(_(),g("div",qi,[a("div",Zi,[d[3]||(d[3]=a("div",{class:"preloader-spinner"},[a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"})],-1)),d[4]||(d[4]=a("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),a("p",Xi," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+C(v.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),d[5]||(d[5]=a("div",{class:"preloader-dots"},[a("span",{class:"dot"}),a("span",{class:"dot"}),a("span",{class:"dot"})],-1))])])):!f.value&&!e.value?(_(),g("div",Ji,[v.value==="months"?(_(),ie(bn,{key:0})):(_(),g("div",Ki,[a("div",Qi,[a("div",ec,[a("div",tc,[a("button",{class:"btn-back-link",type:"button",onClick:W,"aria-label":q.value,"aria-disabled":!z.value,"data-fallback":!z.value,disabled:x.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,ac),a("nav",sc,[J(R,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:te(()=>[...d[6]||(d[6]=[le(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),d[8]||(d[8]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),J(R,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:te(()=>[...d[7]||(d[7]=[le(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),d[9]||(d[9]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),d[10]||(d[10]=a("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),d[11]||(d[11]=a("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),d[12]||(d[12]=a("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),a("div",rc,[a("div",oc,[J(Wt,{stages:b.value.stages,employees:b.value.employees,dateRange:b.value.dateRange,customDateRange:b.value.customDateRange,hasActiveFilters:h.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":v.value,"onUpdate:stages":D,"onUpdate:employees":A,"onUpdate:dateRange":S,"onUpdate:customDateRange":G,"onUpdate:periodMode":U,onReset:B,onApply:F},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),a("div",nc,[s.value?(_(),ie($t,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:s.value.message},null,8,["message"])):(_(),ie(cr,{key:1,meta:n.value,data:l.value,onOpenResponsible:p,onOpenStages:r,onOpenCarryover:T},null,8,["meta","data"]))])])]))])):Z("",!0)]),_:1}),J(jl,{"is-visible":c.value,responsible:l.value.responsible||[],"closed-tickets-created-this-week":l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":l.value.responsibleCreatedOtherWeek||[],"week-number":((y=E.value)==null?void 0:y.weekNumber)||((u=n.value)==null?void 0:u.weekNumber)||null,"week-start-utc":((P=E.value)==null?void 0:P.weekStartUtc)||((M=n.value)==null?void 0:M.weekStartUtc)||null,"week-end-utc":((H=E.value)==null?void 0:H.weekEndUtc)||((K=n.value)==null?void 0:K.weekEndUtc)||null,onClose:d[0]||(d[0]=$e=>{c.value=!1,E.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),J(pi,{"is-visible":k.value,"week-number":((ce=E.value)==null?void 0:ce.weekNumber)||((de=n.value)==null?void 0:de.weekNumber)||null,"week-start-utc":((ue=E.value)==null?void 0:ue.weekStartUtc)||((ve=n.value)==null?void 0:ve.weekStartUtc)||null,"week-end-utc":((ke=E.value)==null?void 0:ke.weekEndUtc)||((he=n.value)==null?void 0:he.weekEndUtc)||null,onClose:d[1]||(d[1]=$e=>{k.value=!1,E.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),J(ji,{"is-visible":m.value,"week-number":((ye=E.value)==null?void 0:ye.weekNumber)||((me=n.value)==null?void 0:me.weekNumber)||null,"week-start-utc":((be=E.value)==null?void 0:be.weekStartUtc)||((we=n.value)==null?void 0:we.weekStartUtc)||null,"week-end-utc":((Ce=E.value)==null?void 0:Ce.weekEndUtc)||((Te=n.value)==null?void 0:Te.weekEndUtc)||null,onClose:d[2]||(d[2]=$e=>{m.value=!1,E.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),f.value?(_(),ie(oa,{key:0,"is-visible":f.value,"current-mode":v.value,onClose:X,onSelectMode:L},null,8,["is-visible","current-mode"])):Z("",!0)])}}},hc=_e(lc,[["__scopeId","data-v-de18647a"]]);export{hc as default};
