const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./direct-access-config-7AjCqqS-.js","./chunk-CDkMrrG2.js","./chunk-CPzRTNN7.js","./access-config-async-DMhbbcMt.js","./chunk-0XsjXObU.js","./chunk-BqhZX2Wp.js","./chunk-D6xa6j6h.js","./chunk-RmAXThmH.js","./WebhookLogsDashboard.vue-i4zl-DjT.js","./WebhookLogDetails.vue-BzZ_Q7fI.js","./GraphAdmissionClosureDashboard.vue-De-suGw8.js","./chunk-VUhHxdp5.js","./dashboard-sector-1c-service-2_NTb9rQ.js","./GraphStateDashboard.vue-BodYmV8T.js","./TicketsTimeTrackingDashboard.vue-3rTVow0u.js"])))=>i.map(i=>d[i]);
var Eo=Object.defineProperty;var xo=(s,e,o)=>e in s?Eo(s,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[e]=o;var fe=(s,e,o)=>xo(s,typeof e!="symbol"?e+"":e,o);import{r as W,c as d,o as c,a as K,b as y,d as io,t as u,n as N,e as n,f as q,g as w,h as ae,i as _,j as oe,w as ct,s as Kt,F as U,k as F,l as Ao,m as de,p as ce,T as dt,q as te,v as yt,u as Te,x as qe,y as X,z as Ie,A as Nt,C as nt,B as Do,L as Io,P as Mo,D as Lo,E as Po,G as No,H as Oo,I as Bo,J as Ro,K as Uo,M as Ce,N as Fo,O as pe,Q as it,R as Ke,S as se,U as pt,V as Ot,W as ro,X as Xe,Y as Vo,Z as jo,_ as zo,$ as Ho}from"./chunk-0XsjXObU.js";import{a as lo,_ as me,g as Ee}from"./chunk-CDkMrrG2.js";import{C as Xt}from"./chunk-BqhZX2Wp.js";import{g as Wo,p as Gt,f as $o,a as qo,D as Ko,i as Xo,S as St,m as co,b as Bt,c as Go,d as Jo,e as Yo,h as Jt,E as Zo}from"./chunk-D6xa6j6h.js";import{D as Qo}from"./chunk-RmAXThmH.js";import"./chunk-CPzRTNN7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const a of l.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&t(a)}).observe(document,{childList:!0,subtree:!0});function o(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(i){if(i.ep)return;i.ep=!0;const l=o(i);fetch(i.href,l)}})();const H=(s,e)=>{const o=s.__vccOpts||s;for(const[t,i]of e)o[t]=i;return o},es={name:"App"},ts={id:"app"};function os(s,e,o,t,i,l){const a=W("router-view");return c(),d("div",ts,[K(a)])}const ss=H(es,[["render",os]]),ns={name:"StatusMessage",props:{type:{type:String,required:!0,validator:s=>["success","error","info","warning"].includes(s)},title:{type:String,default:null},message:{type:String,default:null}}},as={key:0},is={key:1};function rs(s,e,o,t,i,l){return c(),d("div",{class:N(["status-message",`status-message--${o.type}`])},[o.title?(c(),d("strong",as,u(o.title),1)):y("",!0),o.message?(c(),d("p",is,u(o.message),1)):y("",!0),io(s.$slots,"default",{},void 0)],2)}const uo=H(ns,[["render",rs],["__scopeId","data-v-7f15d2d7"]]),ls={name:"LoadingSpinner",props:{message:{type:String,default:"–ó–∞–≥—Ä—É–∑–∫–∞..."}}},cs={class:"loading-spinner"},ds={key:0,class:"message"};function us(s,e,o,t,i,l){return c(),d("div",cs,[e[0]||(e[0]=n("div",{class:"spinner"},null,-1)),o.message?(c(),d("p",ds,u(o.message),1)):y("",!0)])}const go=H(ls,[["render",us],["__scopeId","data-v-375eac16"]]);function Ge(){try{if(window.self===window.top)return!1;if(typeof BX24<"u")return!0;try{const s=window.parent.location.origin;return s.includes("bitrix24")||s.includes("kompo.by")}catch{return!1}}catch(s){return console.warn("Error checking Bitrix24 context:",s),!1}}function gs(){return typeof BX24<"u"}class Pe{static init(e){return new Promise((o,t)=>{if(!Ge()){console.log("Not inside Bitrix24, skipping BX24.init()"),e&&e(),o();return}if(typeof BX24>"u"){t(new Error("Bitrix24 API not loaded. Make sure script is included: //api.bitrix24.com/api/v1/"));return}const i=setTimeout(()=>{t(new Error("BX24.init() timeout: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Bitrix24 API –ø—Ä–µ–≤—ã—Å–∏–ª–∞ 5 —Å–µ–∫—É–Ω–¥"))},5e3);try{BX24.init(()=>{clearTimeout(i),e&&e(),o()})}catch(l){clearTimeout(i),t(l)}})}static installFinish(){return new Promise((e,o)=>{if(typeof BX24>"u"){o(new Error("Bitrix24 API not loaded"));return}try{BX24.installFinish(),e()}catch(t){o(t)}})}static callMethod(e,o={}){return new Promise((t,i)=>{if(typeof BX24>"u"){i(new Error("Bitrix24 API not loaded"));return}const l=setTimeout(()=>{i(new Error(`BX24.callMethod(${e}) timeout: –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–≤—ã—Å–∏–ª 10 —Å–µ–∫—É–Ω–¥`))},1e4);try{BX24.callMethod(e,o,a=>{if(clearTimeout(l),a.error()){const r=a.error();i(new Error(r.error_description||r.error||"Unknown error"))}else t(a.data())})}catch(a){clearTimeout(l),i(a)}})}static async getCurrentUser(){if(Ge()&&gs())try{const e=await Promise.race([this.callMethod("user.current",{}),new Promise((o,t)=>setTimeout(()=>t(new Error("Timeout")),5e3))]);return console.log("Got user from BX24.callMethod() (interface user):",e?.ID||"unknown"),e}catch(e){console.warn("BX24.callMethod() failed, using proxy API as fallback:",e);try{const t=await new Xt().getCurrentUser();return console.log("Got user from proxy API (token owner, fallback):",t),t}catch(o){throw console.error("Both BX24 API and proxy API failed:",o),e.message&&e.message.includes("timeout")?new Error("–¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. Bitrix24 API –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç."):new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.")}}else return console.warn("Not inside Bitrix24, using proxy API (will return token owner, not interface user)"),await new Xt().getCurrentUser()}static getUser(){return new Promise((e,o)=>{if(typeof BX24>"u"){o(new Error("Bitrix24 API not loaded"));return}if(typeof BX24.getUser!="function"){o(new Error("BX24.getUser is not available"));return}BX24.getUser(t=>{e(t)})})}static getAuth(){return new Promise((e,o)=>{if(typeof BX24>"u"){o(new Error("Bitrix24 API not loaded"));return}BX24.getAuth(t=>{e(t)})})}}const ms={name:"InstallPage",components:{StatusMessage:uo,LoadingSpinner:go},setup(){const s=w(!0),e=w(null),o=w(null);return ae(async()=>{try{let t=null;if(window.INSTALL_RESULT)t=window.INSTALL_RESULT;else{const i=lo("/install.php"),l=await fetch(`${i}?get_result=1`);l.ok&&(t=await l.json())}if(!t)throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏");if(o.value=t,t.rest_only===!1)if(t.install===!0){e.value={type:"success",title:"‚úì –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!",message:"–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ Bitrix24."};try{await Pe.init(()=>{Pe.installFinish()})}catch(i){console.error("Error finishing installation:",i)}}else e.value={type:"error",title:"‚úó –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏",message:"–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏."};else e.value={type:"info",title:"REST-only —Ä–µ–∂–∏–º",message:"–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ REST API, –±–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞."}}catch(t){console.error("Error loading install result:",t),e.value={type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:t.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–µ."}}finally{s.value=!1}}),{loading:s,installStatus:e,installInfo:o}}},fs={class:"install-page"},hs={class:"container"},vs={key:1,class:"info"};function ys(s,e,o,t,i,l){const a=W("StatusMessage"),r=W("LoadingSpinner");return c(),d("div",fs,[n("div",hs,[e[1]||(e[1]=n("h1",null,"–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Bitrix24 –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",-1)),t.installStatus?(c(),q(a,{key:0,type:t.installStatus.type,title:t.installStatus.title,message:t.installStatus.message},null,8,["type","title","message"])):y("",!0),t.installInfo?(c(),d("div",vs,[e[0]||(e[0]=n("h3",null,"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—Å—Ç–∞–Ω–æ–≤–∫–µ:",-1)),n("pre",null,u(JSON.stringify(t.installInfo,null,2)),1)])):y("",!0),t.loading?(c(),q(r,{key:2,message:"–û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏..."})):y("",!0)])])}const ps=H(ms,[["render",ys],["__scopeId","data-v-d082ec9e"]]),_s={name:"TicketCard",props:{ticket:{type:Object,required:!0},draggable:{type:Boolean,default:!0}},emits:["click","drag-start","drag-end"],setup(s,{emit:e}){const o=w(!1),t=_(()=>!1),i={color:"#ced4da",backgroundColor:"#f1f3f5",textColor:"#6c757d"},l={color:"#ced4da",backgroundColor:"#f8f9fa",textColor:"#6c757d"},a={color:"#dee2e6",backgroundColor:"#f8f9fa",textColor:"#6c757d"},r=_(()=>({label:s.ticket.priorityLabel||"–ù–µ —É–∫–∞–∑–∞–Ω–æ",colors:s.ticket.priorityColors||i})),g=_(()=>r.value.label||"–ù–µ —É–∫–∞–∑–∞–Ω–æ"),f=_(()=>({color:r.value.colors.textColor||i.textColor,backgroundColor:r.value.colors.backgroundColor||i.backgroundColor,borderColor:r.value.colors.color||i.color})),m=_(()=>({borderLeftColor:r.value.colors.color||i.color})),h=_(()=>{const k=s.ticket.service||{};return{label:k.label||s.ticket.serviceLabel||"–ù–µ —É–∫–∞–∑–∞–Ω–æ",colors:k.colors||s.ticket.serviceColors||l}}),b=_(()=>h.value.label||"–ù–µ —É–∫–∞–∑–∞–Ω–æ"),p=_(()=>({color:h.value.colors.textColor||l.textColor,backgroundColor:h.value.colors.backgroundColor||l.backgroundColor,borderColor:h.value.colors.color||l.color})),v=_(()=>{const k=s.ticket.actionStr||s.ticket.ufActionStr||null;if(!k)return null;const T=String(k).trim();return T.length>0?T:null}),S=_(()=>({color:a.textColor,backgroundColor:a.backgroundColor,borderColor:a.color})),D=_(()=>{if(!s.ticket.createdAt)return"";const k=Gt(s.ticket.createdAt);return k?$o(k):""}),C=_(()=>{if(!s.ticket.createdAt)return null;const k=Gt(s.ticket.createdAt);return qo(k)}),M=_(()=>{const k=C.value;return k&&Ko[k]||null}),I=_(()=>{const k=M.value;return k?{color:k.textColor,backgroundColor:k.backgroundColor,borderColor:k.color,border:`1px solid ${k.color}`}:{}});return{handleDragStart:k=>{t.value&&(k.dataTransfer.effectAllowed="move",k.dataTransfer.setData("application/json",JSON.stringify(s.ticket)),k.dataTransfer.setDragImage(k.target,0,0),o.value=!0,e("drag-start",s.ticket))},handleDragEnd:()=>{t.value&&(o.value=!1,e("drag-end"))},handleCardClick:k=>{if(o.value)return;const T=Wo(s.ticket.id);window.open(T,"_blank"),e("click",s.ticket)},isDragEnabled:t,priorityChipStyle:f,displayPriorityLabel:g,priorityBorderStyle:m,displayServiceLabel:b,serviceChipStyle:p,actionStrValue:v,actionChipStyle:S,formattedCreatedDate:D,dateAccentCategory:C,dateAccentConfig:M,dateAccentStyle:I}}},bs=["draggable"],ks={key:0,class:"ticket-department"},Cs={class:"ticket-header"},Ss={class:"ticket-id"},ws={class:"ticket-title"},Ts={class:"ticket-meta"},Es={key:1,class:"ticket-action"},xs={key:2,class:"ticket-description"},As={class:"ticket-date-label"},Ds={class:"ticket-date-value"};function Is(s,e,o,t,i,l){return c(),d("div",{class:"ticket-card",draggable:t.isDragEnabled,style:oe(t.priorityBorderStyle),onClick:e[0]||(e[0]=(...a)=>t.handleCardClick&&t.handleCardClick(...a)),onDragstart:e[1]||(e[1]=(...a)=>t.handleDragStart&&t.handleDragStart(...a)),onDragend:e[2]||(e[2]=(...a)=>t.handleDragEnd&&t.handleDragEnd(...a))},[o.ticket.departmentHead?(c(),d("div",ks,u(o.ticket.departmentHead),1)):y("",!0),n("div",Cs,[e[3]||(e[3]=n("span",{class:"ticket-icon"},"üé´",-1)),n("span",Ss,"#"+u(o.ticket.id),1)]),n("div",ws,u(o.ticket.ufSubject||o.ticket.title||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"),1),n("div",Ts,[n("span",{class:"ticket-priority",style:oe(t.priorityChipStyle)},u(t.displayPriorityLabel),5),n("span",{class:"ticket-service",style:oe(t.serviceChipStyle)},u(t.displayServiceLabel),5)]),t.actionStrValue?(c(),d("div",Es,[n("span",{class:"ticket-action-chip",style:oe(t.actionChipStyle)},u(t.actionStrValue),5)])):y("",!0),o.ticket.description?(c(),d("div",xs,u(o.ticket.description),1)):y("",!0),t.formattedCreatedDate?(c(),d("div",{key:3,class:"ticket-created-date",style:oe(t.dateAccentStyle)},[n("span",As,u(t.dateAccentConfig?.label||""),1),n("span",Ds,u(t.formattedCreatedDate),1)],4)):y("",!0)],44,bs)}const mo=H(_s,[["render",Is],["__scopeId","data-v-9cda001c"]]),Ms={name:"ZeroPoint",components:{TicketCard:mo},props:{tickets:{type:Array,required:!0,default:()=>[]},stageId:{type:String,required:!0}},emits:{"ticket-dragged":s=>typeof s=="object"&&s!==null,"ticket-assigned":s=>typeof s=="object"&&s!==null,"ticket-clicked":s=>typeof s=="object"&&s!==null},setup(s,{emit:e}){return{hasTickets:_(()=>Array.isArray(s.tickets)&&s.tickets.length>0),handleTicketDragStart:i=>{e("ticket-dragged",i)}}}},Ls={class:"zero-point"},Ps={key:0,class:"empty-state"};function Ns(s,e,o,t,i,l){const a=W("TicketCard");return c(),d("div",Ls,[e[3]||(e[3]=n("div",{class:"zero-point-header"},[n("h3",null,"–ù—É–ª–µ–≤–∞—è —Ç–æ—á–∫–∞")],-1)),ct([o.tickets.length,o.tickets.map(r=>r.id).join(",")],()=>(c(),d("div",{class:"zero-point-tickets"},[(c(!0),d(U,null,F(o.tickets,r=>(c(),q(a,{key:r.id,ticket:r,draggable:!0,onDragStart:g=>t.handleTicketDragStart(r),onClick:g=>s.$emit("ticket-clicked",r)},null,8,["ticket","onDragStart","onClick"]))),128))])),e,0),e[1]||(Kt(-1,!0),(e[1]=t.hasTickets?y("",!0):(c(),d("div",Ps,[...e[2]||(e[2]=[n("p",null,"–ù–µ—Ç –Ω–µ—Ä–∞–∑–æ–±—Ä–∞–Ω–Ω—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –≤ —Å—Ç–∞–¥–∏–∏",-1)])]))).cacheIndex=1,Kt(1),e[1])])}const Os=H(Ms,[["render",Ns],["__scopeId","data-v-c5370e55"]]);function Bs(s){return typeof s=="number"&&s>0&&!isNaN(s)}function fo(s){return typeof s=="number"&&s>0&&!isNaN(s)}function ho(s){return typeof s=="string"&&["formed","review","execution"].includes(s)}function Rs(s){return!s||typeof s!="object"?!1:Bs(s.id)&&typeof s.title=="string"&&s.title.trim().length>0}function vo(s,e,o){return!(!Rs(s)||!fo(e)||!ho(o)||s.assigneeId===e&&s.stageId===o)}function Us(s){const e=[];return!s||typeof s!="object"?(e.push("–î–∞–Ω–Ω—ã–µ —Ç–∏–∫–µ—Ç–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä–µ–∫—Ç–æ–º"),{valid:!1,errors:e}):((!s.title||typeof s.title!="string"||s.title.trim().length===0)&&e.push("–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"),s.stageId&&!ho(s.stageId)&&e.push("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ID —Å—Ç–∞–¥–∏–∏"),s.employeeId&&!fo(s.employeeId)&&e.push("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π ID —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"),{valid:e.length===0,errors:e})}const Qe=w([]);let Fs=0;function _t(){const s=(r,g="info",f=3e3)=>{const m=++Fs,h={id:m,message:r,type:g,duration:f,timestamp:Date.now()};return Qe.value.push(h),f>0&&setTimeout(()=>{e(m)},f),m},e=r=>{const g=Qe.value.findIndex(f=>f.id===r);g>-1&&Qe.value.splice(g,1)};return{notifications:Qe,showNotification:s,removeNotification:e,clearNotifications:()=>{Qe.value=[]},success:(r,g=3e3)=>s(r,"success",g),error:(r,g=5e3)=>s(r,"error",g),warning:(r,g=4e3)=>s(r,"warning",g),info:(r,g=3e3)=>s(r,"info",g)}}const wt="dashboard-sector-1c-logger-level",et={NONE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4};class je{static getLevel(){if(typeof localStorage<"u"){const o=localStorage.getItem(wt);if(o&&et[o]!==void 0)return o}return!0?"ERROR":"DEBUG"}static setLevel(e){return et[e]!==void 0?(typeof localStorage<"u"&&localStorage.setItem(wt,e),!0):!1}static isEnabled(e,o=null){const t=o||this.getLevel();if(t==="NONE")return!1;const i=et[e]||0,l=et[t]||0;return i<=l}static getLevels(){return{...et}}static reset(){typeof localStorage<"u"&&localStorage.removeItem(wt)}}let Q=class{static getLevelColor(e){return{ERROR:"#dc3545",WARN:"#ffc107",INFO:"#17a2b8",DEBUG:"#6c757d"}[e]||"#6c757d"}static formatMessage(e,o,t=""){const i=new Date().toISOString(),l=this.getLevelColor(e),a=`%c[${i}] %c[${e}] %c[${t||"Unknown"}] %c${o}`,r=["color: #6c757d; font-weight: normal",`color: ${l}; font-weight: bold`,"color: #007bff; font-weight: normal","color: #212529; font-weight: normal"];return{formatted:a,styles:r}}static log(e,o,t="",i=null){if(!je.isEnabled(e))return;const l=this.formatMessage(e,o,t),a=[l.formatted,...l.styles];switch(i!=null&&a.push(i),e){case"ERROR":console.error(...a);break;case"WARN":console.warn(...a);break;case"INFO":console.info(...a);break;case"DEBUG":console.log(...a);break;default:console.log(...a)}}static error(e,o="",t=null){this.log("ERROR",e,o,t)}static warn(e,o="",t=null){this.log("WARN",e,o,t)}static info(e,o="",t=null){this.log("INFO",e,o,t)}static debug(e,o="",t=null){this.log("DEBUG",e,o,t)}};function Vs(s){const e=_t(),o=w(!1);return{isDropZoneActive:o,handleDragStart:(g,f)=>{g.dataTransfer.effectAllowed="move",g.dataTransfer.setData("application/json",JSON.stringify(f)),g.dataTransfer.setDragImage(g.target,0,0)},handleDragOver:g=>{g.preventDefault(),g.dataTransfer.dropEffect="move",o.value=!0},handleDragLeave:g=>{const f=g.currentTarget.getBoundingClientRect(),m=g.clientX,h=g.clientY;(m<f.left||m>f.right||h<f.top||h>f.bottom)&&(o.value=!1)},handleDrop:async(g,f,m)=>{g.preventDefault(),o.value=!1;const h=g.dataTransfer.getData("application/json");if(h)try{const b=JSON.parse(h);if(!vo(b,f,m)){e.warning("–ù–µ–ª—å–∑—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–∏–∫–µ—Ç —Å—é–¥–∞");return}s&&typeof s=="function"&&await s(b,f,m)}catch(b){Q.error("Error parsing ticket data","useDragAndDrop",b),e.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–∏–∫–µ—Ç–∞")}},handleDragEnd:g=>{o.value=!1}}}function yo(s=null){const e=Ao(),o=e?.type?.name||e?.type?.__name||null,t=s||o||"Unknown",i=(f,m,h=null)=>{Q.log(f,m,t,h)};return{error:(f,m=null)=>{i("ERROR",f,m)},warn:(f,m=null)=>{i("WARN",f,m)},info:(f,m=null)=>{i("INFO",f,m)},debug:(f,m=null)=>{i("DEBUG",f,m)},log:i,context:t}}const js={name:"EmployeeColumn",components:{TicketCard:mo},props:{employee:{type:Object,required:!0},stageId:{type:String,required:!0}},emits:["ticket-clicked","ticket-dropped"],setup(s,{emit:e}){yo("EmployeeColumn");const t=Vs(async(m,h,b)=>{e("ticket-dropped",m,h)}),i=_(()=>s.employee.isFromSector1C?Array.isArray(s.employee.tickets)?s.employee.tickets:[]:Array.isArray(s.employee.ticketsInsideSector)?s.employee.ticketsInsideSector:[]),l=_(()=>s.employee.isFromSector1C?[]:Array.isArray(s.employee.ticketsOutsideSector)?s.employee.ticketsOutsideSector:Array.isArray(s.employee.tickets)?s.employee.tickets:[]),a=_(()=>s.employee.isFromSector1C?Array.isArray(s.employee.tickets)?s.employee.tickets:[]:[]),r=_(()=>i.value.length+l.value.length),g=m=>{t.handleDrop(m,s.employee.id,s.stageId)},f=m=>{};return{isDropZoneActive:t.isDropZoneActive,handleDragOver:t.handleDragOver,handleDragLeave:t.handleDragLeave,handleDrop:g,ticketsInsideSector:i,ticketsOutsideSector:l,ticketsToDisplay:a,totalTicketsCount:r,handleTicketDragStart:f}}},zs={class:"employee-header"},Hs={class:"employee-info"},Ws={class:"employee-details"},$s={class:"employee-name"},qs={key:0,class:"employee-position"},Ks={class:"tickets-count"},Xs={class:"tickets-list"},Gs={class:"section-header"},Js={class:"section-count"},Ys={key:2,class:"empty-state"};function Zs(s,e,o,t,i,l){const a=W("TicketCard");return c(),d("div",{class:N(["employee-column",{"drop-zone-active":t.isDropZoneActive}]),onDragover:e[3]||(e[3]=de((...r)=>t.handleDragOver&&t.handleDragOver(...r),["prevent"])),onDragleave:e[4]||(e[4]=(...r)=>t.handleDragLeave&&t.handleDragLeave(...r)),onDrop:e[5]||(e[5]=(...r)=>t.handleDrop&&t.handleDrop(...r))},[n("div",zs,[n("div",Hs,[e[6]||(e[6]=n("span",{class:"employee-icon"},"üë§",-1)),n("div",Ws,[n("div",$s,u(o.employee.name),1),o.employee.position?(c(),d("div",qs,u(o.employee.position),1)):y("",!0)])]),n("div",Ks," üìä –¢–∏–∫–µ—Ç–æ–≤: "+u(t.totalTicketsCount),1)]),n("div",Xs,[o.employee.isFromSector1C?ct([t.ticketsToDisplay.length,t.ticketsToDisplay.map(r=>r.id).join(",")],()=>(c(),d("div",{key:0},[K(dt,{name:"ticket",tag:"div"},{default:ce(()=>[(c(!0),d(U,null,F(t.ticketsToDisplay,r=>(c(),q(a,{key:r.id,ticket:r,draggable:!0,onClick:g=>s.$emit("ticket-clicked",r),onDragStart:t.handleTicketDragStart},null,8,["ticket","onClick","onDragStart"]))),128))]),_:1})])),e,0):(c(),d(U,{key:1},[t.ticketsInsideSector.length>0?ct([t.ticketsInsideSector.length,t.ticketsInsideSector.map(r=>r.id).join(",")],()=>(c(),d("div",{key:0,class:"tickets-section tickets-inside-sector"},[K(dt,{name:"ticket",tag:"div"},{default:ce(()=>[(c(!0),d(U,null,F(t.ticketsInsideSector,r=>(c(),q(a,{key:r.id,ticket:r,draggable:!0,onClick:g=>s.$emit("ticket-clicked",r),onDragStart:t.handleTicketDragStart},null,8,["ticket","onClick","onDragStart"]))),128))]),_:1})])),e,1):y("",!0),t.ticketsOutsideSector.length>0?ct([t.ticketsOutsideSector.length,t.ticketsOutsideSector.map(r=>r.id).join(",")],()=>(c(),d("div",{key:1,class:"tickets-section tickets-outside-sector"},[n("div",Gs,[e[7]||(e[7]=n("span",{class:"section-badge"},"–í–Ω–µ —Å–µ–∫—Ç–æ—Ä–∞",-1)),n("span",Js,u(t.ticketsOutsideSector.length),1)]),K(dt,{name:"ticket",tag:"div"},{default:ce(()=>[(c(!0),d(U,null,F(t.ticketsOutsideSector,r=>(c(),q(a,{key:r.id,ticket:r,draggable:!0,class:"ticket-outside-sector",onClick:g=>s.$emit("ticket-clicked",r),onDragStart:t.handleTicketDragStart},null,8,["ticket","onClick","onDragStart"]))),128))]),_:1})])),e,2):y("",!0)],64)),t.totalTicketsCount===0?(c(),d("div",Ys,[...e[8]||(e[8]=[n("p",null,"–ù–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤",-1)])])):y("",!0)])],34)}const Qs=H(js,[["render",Zs],["__scopeId","data-v-cdec5b5c"]]),en={name:"DashboardStage",components:{ZeroPoint:Os,EmployeeColumn:Qs},props:{stage:{type:Object,required:!0},zeroPointTickets:{type:Array,default:()=>[]}},emits:["ticket-moved","ticket-assigned","ticket-clicked"],setup(s,{emit:e}){const o=yo("DashboardStage"),t=w(!1),i=_(()=>{const b=Array.isArray(s.zeroPointTickets)?s.zeroPointTickets.length:0,p=Array.isArray(s.stage.employees)?s.stage.employees.reduce((v,S)=>Array.isArray(S.ticketsInsideSector)?v+S.ticketsInsideSector.length:S.isFromSector1C&&Array.isArray(S.tickets)?v+S.tickets.length:v,0):0;return b+p}),l=_(()=>Array.isArray(s.stage.employees)?s.stage.employees.reduce((b,p)=>Array.isArray(p.ticketsOutsideSector)?b+p.ticketsOutsideSector.length:!p.isFromSector1C&&Array.isArray(p.tickets)?b+p.tickets.length:b,0):0),a=_(()=>i.value+l.value),r=_(()=>{const b=s.stage?.name||"–°—Ç–∞–¥–∏—è",p=i.value,v=l.value;return v===0?`${b} (${p})`:`${b} (${p} / ${v})`});return{isDragging:t,ticketsCountInsideSector:i,ticketsCountOutsideSector:l,totalTicketsCount:a,stageNameWithCount:r,handleTicketDragged:b=>{t.value=!0},handleTicketAssigned:(b,p)=>{e("ticket-assigned",b,p)},handleTicketDropped:(b,p)=>{e("ticket-moved",b,p,s.stage.id),t.value=!1},handleTicketClicked:b=>{o.debug("Ticket clicked",b),e("ticket-clicked",b)}}}},tn={class:"stage-header"},on={class:"stage-content"},sn={class:"employees-container"};function nn(s,e,o,t,i,l){const a=W("ZeroPoint"),r=W("EmployeeColumn");return c(),d("div",{class:"dashboard-stage",style:oe({borderLeftColor:o.stage.color})},[n("div",tn,[n("h2",null,u(t.stageNameWithCount),1)]),n("div",on,[K(a,{tickets:o.zeroPointTickets,"stage-id":o.stage.id,onTicketDragged:t.handleTicketDragged,onTicketAssigned:t.handleTicketAssigned,onTicketClicked:t.handleTicketClicked},null,8,["tickets","stage-id","onTicketDragged","onTicketAssigned","onTicketClicked"]),n("div",sn,[(c(!0),d(U,null,F(o.stage.employees,g=>(c(),q(r,{key:g.id,employee:g,"stage-id":o.stage.id,onTicketClicked:t.handleTicketClicked,onTicketDropped:t.handleTicketDropped},null,8,["employee","stage-id","onTicketClicked","onTicketDropped"]))),128))])])],4)}const an=H(en,[["render",nn],["__scopeId","data-v-c6fbde76"]]),Tt={cache_check:{title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞",description:"–ü–æ–∏—Å–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö..."},cache_hit:{title:"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã",description:"–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞..."},loading_tickets:{title:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤",description:"–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24..."},filtering:{title:"–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∏–∫–µ—Ç–æ–≤",description:"–û—Ç–±–æ—Ä —Ç–∏–∫–µ—Ç–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–°..."},extracting_employees:{title:"–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤",description:"–ê–Ω–∞–ª–∏–∑ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤..."},loading_employees:{title:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤",description:"–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö..."},grouping:{title:"–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö",description:"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ —ç—Ç–∞–ø–∞–º..."},caching:{title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à",description:"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–≥—Ä—É–∑–æ–∫..."},complete:{title:"–ì–æ—Ç–æ–≤–æ!",description:"–î–∞—à–±–æ—Ä–¥ –∑–∞–≥—Ä—É–∂–µ–Ω"},error:{title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",description:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"}},rn={loading_tickets:{title:"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤",description:"–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24..."},filtering:{title:"–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∏–∫–µ—Ç–æ–≤",description:"–û—Ç–±–æ—Ä —Ç–∏–∫–µ—Ç–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–°..."},extracting_employees:{title:"–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤",description:"–ê–Ω–∞–ª–∏–∑ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤..."},loading_employees:{title:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤",description:"–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞—Ö..."},grouping:{title:"–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö",description:"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ —ç—Ç–∞–ø–∞–º..."},caching:{title:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫–µ—à",description:"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–≥—Ä—É–∑–æ–∫..."},cache_check:{title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞",description:"–ü–æ–∏—Å–∫ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö..."},cache_hit:{title:"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã",description:"–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞..."},complete:{title:"–ì–æ—Ç–æ–≤–æ!",description:"–î–∞—à–±–æ—Ä–¥ –∑–∞–≥—Ä—É–∂–µ–Ω"},error:{title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",description:"–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"}},ln={name:"LoadingPreloader",props:{currentStep:{type:String,default:null},progress:{type:Number,default:0},stepDetails:{type:Object,default:()=>({})},error:{type:String,default:null}},emits:["retry"],setup(s,{emit:e}){const o=_(()=>{const{currentStep:f,stepDetails:m}=s;return m?.description?{title:f?Tt[f]?.title||f:"–ó–∞–≥—Ä—É–∑–∫–∞...",description:m.description}:f?Tt[f]?Tt[f]:rn[f]||{title:"–ó–∞–≥—Ä—É–∑–∫–∞...",description:"–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ..."}:{title:"–ó–∞–≥—Ä—É–∑–∫–∞...",description:"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è..."}}),t=_(()=>o.value.title),i=_(()=>o.value.description),l=_(()=>s.stepDetails),a=_(()=>{const f=s.progress;return f==null||isNaN(f)?0:Math.round(Math.max(0,Math.min(100,f)))});return{stepTitle:t,stepDescription:i,details:l,displayProgress:a,getStageDisplayName:f=>f?{"DT140_12:UC_0VHWE2":"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ","DT140_12:PREPARATION":"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó","DT140_12:CLIENT":"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ","–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ":"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ","–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó":"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ"}[f]||f:"",handleRetry:()=>{e("retry")}}}},cn={class:"preloader-backdrop"},dn={class:"preloader-container"},un={class:"preloader-content-scrollable"},gn={key:0,class:"spinner-container"},mn={class:"preloader-content"},fn={class:"step-title"},hn={key:0,class:"step-description"},vn={key:1,class:"progress-container"},yn={class:"progress-bar"},pn={class:"progress-text"},_n={key:2,class:"step-details"},bn={key:0,class:"detail-description"},kn={key:1,class:"detail-item"},Cn={class:"detail-value"},Sn={key:0,class:"detail-total"},wn={key:2,class:"detail-item"},Tn={class:"detail-value"},En={key:0,class:"detail-total"},xn={key:3,class:"detail-item"},An={class:"detail-value"},Dn={key:0,class:"detail-total"},In={key:4,class:"detail-item"},Mn={class:"detail-value"},Ln={key:5,class:"detail-warning"},Pn={key:0,class:"error-container"},Nn={class:"error-content"},On={class:"error-message"};function Bn(s,e,o,t,i,l){return c(),d("div",{class:N(["loading-preloader",{"has-error":o.error}])},[n("div",cn,[n("div",dn,[n("div",un,[o.error?y("",!0):(c(),d("div",gn,[...e[1]||(e[1]=[n("div",{class:"spinner"},null,-1)])])),n("div",mn,[n("h3",fn,u(t.stepTitle),1),t.stepDescription?(c(),d("p",hn,u(t.stepDescription),1)):y("",!0),o.error?y("",!0):(c(),d("div",vn,[n("div",yn,[n("div",{class:"progress-fill",style:oe({width:t.displayProgress+"%"})},null,4)]),n("span",pn,u(t.displayProgress)+"%",1)])),o.error?y("",!0):(c(),d("div",_n,[t.details.description?(c(),d("div",bn,u(t.details.description),1)):y("",!0),t.details.count!==void 0?(c(),d("div",kn,[e[2]||(e[2]=n("span",{class:"detail-label"},"–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–∏–∫–µ—Ç–æ–≤:",-1)),n("span",Cn,u(t.details.count),1),t.details.total!==void 0?(c(),d("span",Sn," –∏–∑ "+u(t.details.total),1)):y("",!0)])):y("",!0),t.details.filteredTickets!==void 0?(c(),d("div",wn,[e[3]||(e[3]=n("span",{class:"detail-label"},"–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ —Ç–∏–∫–µ—Ç–æ–≤:",-1)),n("span",Tn,u(t.details.filteredTickets),1),t.details.totalTickets!==void 0?(c(),d("span",En," –∏–∑ "+u(t.details.totalTickets),1)):y("",!0)])):y("",!0),t.details.stage?(c(),d("div",xn,[e[4]||(e[4]=n("span",{class:"detail-label"},"–°—Ç–∞–¥–∏—è:",-1)),n("span",An,u(t.getStageDisplayName(t.details.stage)),1),t.details.stageIndex&&t.details.totalStages?(c(),d("span",Dn," ("+u(t.details.stageIndex)+"/"+u(t.details.totalStages)+") ",1)):y("",!0)])):y("",!0),t.details.employeeCount!==void 0?(c(),d("div",In,[e[5]||(e[5]=n("span",{class:"detail-label"},"–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:",-1)),n("span",Mn,u(t.details.employeeCount),1)])):y("",!0),t.details.warning?(c(),d("div",Ln,[n("span",null,"‚ö†Ô∏è "+u(t.details.warning),1)])):y("",!0)]))])])])]),o.error?(c(),d("div",Pn,[n("div",Nn,[e[6]||(e[6]=n("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),n("p",On,u(o.error),1),n("button",{onClick:e[0]||(e[0]=(...a)=>t.handleRetry&&t.handleRetry(...a)),class:"retry-button"}," –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É ")])])):y("",!0)],2)}const Rn=H(ln,[["render",Bn],["__scopeId","data-v-d129ff19"]]),Un={name:"LoggerControl",props:{showControl:{type:Boolean,default:!1}},setup(){const s=w(!1),e=w("ERROR"),o=w(!0),t=g=>({NONE:"–û—Ç–∫–ª—é—á–µ–Ω–æ",ERROR:"–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏",WARN:"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏",INFO:"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏",DEBUG:"–í—Å–µ –ª–æ–≥–∏ (–æ—Ç–ª–∞–¥–∫–∞)"})[g]||g;return ae(()=>{const g=je.getLevel();e.value=g,s.value=g!=="NONE"}),{enabled:s,level:e,isExpanded:o,getLevelDescription:t,handleToggle:()=>{s.value?(e.value==="NONE"&&(e.value="ERROR"),je.setLevel(e.value)):(je.setLevel("NONE"),e.value="NONE")},handleLevelChange:()=>{s.value&&je.setLevel(e.value)},resetToDefault:()=>{const g="ERROR";e.value=g,s.value=!0,je.setLevel(g)},toggleVisibility:()=>{o.value=!o.value}}}},Fn={key:0,class:"logger-control"},Vn={class:"logger-control-header"},jn=["aria-label"],zn={key:0,class:"logger-control-content"},Hn={class:"logger-control-section"},Wn={class:"logger-control-label"},$n={key:0,class:"logger-control-section"},qn={class:"logger-control-label"},Kn={key:1,class:"logger-control-info"},Xn={class:"logger-control-info-text"},Gn={key:2,class:"logger-control-section"};function Jn(s,e,o,t,i,l){return o.showControl?(c(),d("div",Fn,[n("div",Vn,[e[6]||(e[6]=n("h3",{class:"logger-control-title"},"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º",-1)),n("button",{class:"logger-control-toggle",onClick:e[0]||(e[0]=(...a)=>t.toggleVisibility&&t.toggleVisibility(...a)),"aria-label":t.isExpanded?"–°–≤–µ—Ä–Ω—É—Ç—å":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"},u(t.isExpanded?"‚ñº":"‚ñ∂"),9,jn)]),t.isExpanded?(c(),d("div",zn,[n("div",Hn,[n("label",Wn,[te(n("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=a=>t.enabled=a),onChange:e[2]||(e[2]=(...a)=>t.handleToggle&&t.handleToggle(...a)),class:"logger-control-checkbox"},null,544),[[yt,t.enabled]]),e[7]||(e[7]=n("span",{class:"logger-control-label-text"},"–í–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ",-1))])]),t.enabled?(c(),d("div",$n,[n("label",qn,[e[9]||(e[9]=n("span",{class:"logger-control-label-text"},"–£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:",-1)),te(n("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.level=a),onChange:e[4]||(e[4]=(...a)=>t.handleLevelChange&&t.handleLevelChange(...a)),class:"logger-control-select"},[...e[8]||(e[8]=[qe('<option value="NONE" data-v-ed57067c>–û—Ç–∫–ª—é—á–µ–Ω–æ</option><option value="ERROR" data-v-ed57067c>–¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏</option><option value="WARN" data-v-ed57067c>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏</option><option value="INFO" data-v-ed57067c>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏</option><option value="DEBUG" data-v-ed57067c>–í—Å–µ –ª–æ–≥–∏ (–æ—Ç–ª–∞–¥–∫–∞)</option>',5)])],544),[[Te,t.level]])])])):y("",!0),t.enabled?(c(),d("div",Kn,[n("span",Xn,[e[10]||(e[10]=X(" –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: ",-1)),n("strong",null,u(t.getLevelDescription(t.level)),1)])])):y("",!0),t.enabled?(c(),d("div",Gn,[n("button",{onClick:e[5]||(e[5]=(...a)=>t.resetToDefault&&t.resetToDefault(...a)),class:"logger-control-reset-btn",title:"–°–±—Ä–æ—Å–∏—Ç—å –∫ –∑–Ω–∞—á–µ–Ω–∏—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"}," –°–±—Ä–æ—Å–∏—Ç—å –∫ —É–º–æ–ª—á–∞–Ω–∏—é ")])):y("",!0)])):y("",!0)])):y("",!0)}const Yn=H(Un,[["render",Jn],["__scopeId","data-v-ed57067c"]]);function Zn(){const s=Ie(),e=Nt();return{goBack:(a="/")=>{window.history.length>1?s.back():s.push(a)},goTo:(a,r={})=>{s.push({path:a,...r})},goHome:(a={})=>{s.push({path:"/",...a})},isCurrentRoute:a=>e.path===a,router:s,route:e}}const Qn={name:"BackButton",props:{variant:{type:String,default:"header",validator:s=>["header","floating"].includes(s)},text:{type:String,default:"–ù–ê–ó–ê–î"},to:{type:String,default:null},showIcon:{type:Boolean,default:!0},ariaLabel:{type:String,default:"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é"},title:{type:String,default:"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é"}},setup(s){const{goBack:e,goHome:o}=Zn();return{buttonClasses:_(()=>[s.variant==="header"?"back-button":"floating-back-button"]),handleClick:()=>{s.to?o({path:s.to}):e()}}}},ea=["aria-label","title"],ta={key:0,class:"back-button-icon"},oa={key:1,class:"back-button-text"};function sa(s,e,o,t,i,l){return c(),d("button",{class:N(t.buttonClasses),onClick:e[0]||(e[0]=(...a)=>t.handleClick&&t.handleClick(...a)),"aria-label":o.ariaLabel,title:o.title},[o.showIcon?(c(),d("span",ta,"‚Üê")):y("",!0),o.variant==="header"?(c(),d("span",oa,u(o.text),1)):y("",!0)],10,ea)}const na=H(Qn,[["render",sa],["__scopeId","data-v-d605b6a0"]]),ze={allowedDepartmentIds:[369,366,7],adminDepartmentIds:[369]};function po(s){return!s||typeof s!="number"?!1:ze.allowedDepartmentIds.includes(s)}function bt(s){if(!s||!s.UF_DEPARTMENT)return!1;const e=Array.isArray(s.UF_DEPARTMENT)?s.UF_DEPARTMENT:[];return e.length===0?!1:e.some(o=>ze.adminDepartmentIds.includes(o))}class aa{constructor(){this.reset()}reset(){this.metrics={ticketsLoading:{stages:{},totalLoaded:0},filtering:{total:0,filtered:0,rejected:[],tagValueExamples:[]},employees:{uniqueIds:[],totalUnique:0,ticketsWithoutAssignedById:[],ticketsWithAssignedById1051:[]},grouping:{distributionByStages:{},ticketsNotInColumn:[],unknownStages:[]},zeroPoint:{byStage:{}}}}logTicketsLoading(e,o,t,i=null){this.metrics.ticketsLoading.stages[e]||(this.metrics.ticketsLoading.stages[e]={loaded:0,batches:[],total:0});const l=this.metrics.ticketsLoading.stages[e];l.loaded=t,l.batches.push({count:o,total:t,next:i}),l.total=t,this.metrics.ticketsLoading.totalLoaded=Object.values(this.metrics.ticketsLoading.stages).reduce((a,r)=>a+r.total,0)}logFiltering(e,o,t=[],i=[]){this.metrics.filtering.total=e,this.metrics.filtering.filtered=o,this.metrics.filtering.rejected=t.slice(0,50),this.metrics.filtering.tagValueExamples=i.slice(0,20)}logEmployees(e,o=[],t=[]){this.metrics.employees.uniqueIds=e,this.metrics.employees.totalUnique=e.length,this.metrics.employees.ticketsWithoutAssignedById=o.slice(0,50),this.metrics.employees.ticketsWithAssignedById1051=t.slice(0,50)}logGrouping(e,o=[],t=[]){e.forEach(i=>{const l={};let a=0;i.employees.forEach(r=>{const g=(r.ticketsInsideSector||[]).length+(r.ticketsOutsideSector||[]).length;l[r.id]=g,a+=g}),this.metrics.grouping.distributionByStages[i.id]={employees:l,total:a}}),this.metrics.grouping.ticketsNotInColumn=o.slice(0,50),this.metrics.grouping.unknownStages=t.slice(0,50)}logZeroPoint(e){Object.keys(e).forEach(o=>{this.metrics.zeroPoint.byStage[o]=Array.isArray(e[o])?e[o].length:0})}getMetrics(){return this.metrics}getProblematicTickets(){return{withoutAssignedById:this.metrics.employees.ticketsWithoutAssignedById,withAssignedById1051:this.metrics.employees.ticketsWithAssignedById1051,withoutSectorTag:this.metrics.filtering.rejected,notInColumn:this.metrics.grouping.ticketsNotInColumn,unknownStage:this.metrics.grouping.unknownStages}}exportToJSON(){return JSON.stringify({metrics:this.metrics,problematicTickets:this.getProblematicTickets(),timestamp:new Date().toISOString()},null,2)}}let Et=null;function ye(){return Et||(Et=new aa),Et}function xe(s=null,e=null){if(e&&!bt(e))return!1;if(s&&s.query&&s.query.diagnostics==="true")return!0;if(typeof window<"u"&&window.location){const o=window.location.hash;if(o){const i=o.split("?");if(i.length>1){const l=i[1];if(new URLSearchParams(l).get("diagnostics")==="true")return!0}if(o.includes("diagnostics=true"))return!0}if(new URLSearchParams(window.location.search).get("diagnostics")==="true")return!0}return typeof localStorage<"u"?localStorage.getItem("dashboard-sector-1c-diagnostics")==="true":!1}class He{static async call(e,o={}){return await new Qo().call(e,o)}}class ee{static get(e){const o=this.cache.get(e);return o?Date.now()-o.timestamp>o.ttl?(this.cache.delete(e),null):o.data:null}static set(e,o,t=this.DEFAULT_TTL){this.cache.set(e,{data:o,timestamp:Date.now(),ttl:t})}static delete(e){this.cache.delete(e)}static clear(){this.cache.clear()}static invalidateByPrefix(e){const o=[];for(const t of this.cache.keys())t.startsWith(e)&&o.push(t);o.forEach(t=>this.cache.delete(t))}static cleanExpired(){const e=Date.now(),o=[];for(const[t,i]of this.cache.entries())e-i.timestamp>i.ttl&&o.push(t);o.forEach(t=>this.cache.delete(t))}static getStats(){const e=Date.now();let o=0,t=0;for(const i of this.cache.values())e-i.timestamp>i.ttl?o++:t++;return{total:this.cache.size,valid:t,expired:o}}static getTicketsCacheKey(e){return`tickets:stage:${e}`}static getAllTicketsCacheKey(){return"tickets:all"}static getEmployeesCacheKey(e){return`employees:ids:${[...e].sort((t,i)=>t-i).join(",")}`}static getSectorDataCacheKey(){return"sector:data"}static invalidateTicketsCache(){this.invalidateByPrefix("tickets:"),this.invalidateByPrefix("sector:")}static invalidateEmployeesCache(){this.invalidateByPrefix("employees:")}}fe(ee,"cache",new Map),fe(ee,"DEFAULT_TTL",5*60*1e3),fe(ee,"EMPLOYEES_TTL",30*60*1e3),fe(ee,"TICKETS_TTL",5*60*1e3);typeof window<"u"&&setInterval(()=>{ee.cleanExpired()},5*60*1e3);function ne(s,e,o={}){if(!s||typeof s!="string")throw new Error("Step must be a non-empty string");const t=typeof e=="number"&&!isNaN(e)?Math.max(0,Math.min(100,e)):0;let i=o.description;return i||(i=ia(s,o)),{step:s,progress:t,details:{...o,description:i}}}function ia(s,e){return s==="loading_tickets"&&e.stageName&&e.stageIndex!==void 0?`–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏ "${e.stageName}" (${e.stageIndex}/${e.totalStages||1})...`:s==="filtering"&&e.filteredTickets!==void 0&&e.totalTickets!==void 0?`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∏–∫–µ—Ç–æ–≤: ${e.filteredTickets} –∏–∑ ${e.totalTickets}...`:s==="grouping"&&e.employeeCount!==void 0?`–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ ${e.employeeCount} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º...`:e.count!==void 0&&e.total!==void 0?`–û–±—Ä–∞–±–æ—Ç–∫–∞: ${e.count} –∏–∑ ${e.total}...`:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."}function mt(s){if(!s||typeof s!="object")throw new Error("Progress info must be an object");const e=s.step||null;if(!e)throw new Error("Step is required in progress info");const o=s.progress!==void 0&&s.progress!==null?s.progress:s.percent!==void 0&&s.percent!==null?s.percent:void 0,t=s.details||{};return s.stage&&(t.stage=s.stage),s.stageName&&(t.stageName=s.stageName),s.stageIndex!==void 0&&(t.stageIndex=s.stageIndex),s.totalStages!==void 0&&(t.totalStages=s.totalStages),s.count!==void 0&&(t.count=s.count),s.total!==void 0&&(t.total=s.total),s.warning&&(t.warning=s.warning),{step:e,progress:o!=null?Math.max(0,Math.min(100,o)):void 0,details:t}}function _o(s,e,o){const t=typeof s=="number"&&!isNaN(s)?Math.max(0,Math.min(100,s)):0,i=typeof e=="number"&&!isNaN(e)?Math.max(0,Math.min(100,e)):0,l=typeof o=="number"&&!isNaN(o)?Math.max(0,Math.min(100,o)):0,a=t+i*l/100;return Math.max(0,Math.min(100,a))}const rt=140;class We{static async getAllTickets(e,o=null,t=!0){const i=[],l=e.length;try{for(let a=0;a<e.length;a++){const r=e[a],g=this.getStageName(r);if(o){const f=a/l*100;o(ne("loading_tickets",f,{stage:r,stageName:g,stageIndex:a+1,totalStages:l}))}try{const f=await this.getTicketsByStage(r,t,o?m=>{const h=_o(a/l*100,1/l*100,m.percent||0);o(ne("loading_tickets",h,{stage:r,stageName:g,stageIndex:a+1,totalStages:l,count:m.count,total:m.total}))}:null);i.push(...f)}catch(f){Q.error(`Error loading tickets for stage ${r}`,"TicketRepository",f);let m=`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–∏ "${g}"`;throw f.message&&(f.message.includes("HTTP error")||f.message.includes("network")?m=`–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞–¥–∏–∏ "${g}". –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.`:f.message.includes("timeout")?m=`–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞–¥–∏–∏ "${g}". –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.`:f.message.includes("403")||f.message.includes("401")?m=`–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç–∞–¥–∏–∏ "${g}". –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.`:m=`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–∏ "${g}": ${f.message}`),new Error(m)}}}catch(a){throw Q.error("Error in getAllTickets","TicketRepository",a),a}return i}static getStageName(e){return{"DT140_12:UC_0VHWE2":"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ","DT140_12:PREPARATION":"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó","DT140_12:CLIENT":"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ"}[e]||e}static async getTicketsByStage(e,o=!0,t=null){if(o){const m=ee.getTicketsCacheKey(e),h=ee.get(m);if(h!==null){try{const b=ye();b&&xe()&&b.logTicketsLoading(e,h.length,h.length,null)}catch(b){Q.warn("Diagnostics logging error (cache hit) in getTicketsByStage","TicketRepository",b)}return t&&t(mt({step:"loading_tickets",percent:100,count:h.length,total:h.length})),h}}const i=[];let l=0;const a=50;let r=!0,g=0,f=null;for(;r;)try{const m=await He.call("crm.item.list",{entityTypeId:rt,filter:{stageId:e},select:["*"],order:{id:"DESC"},start:l,useOriginalUfNames:"Y"});let h=[];if(m&&m.result&&(Array.isArray(m.result)?h=m.result:m.result.items&&Array.isArray(m.result.items)?h=m.result.items:m.result.data&&Array.isArray(m.result.data)&&(h=m.result.data)),h.length>0){i.push(...h),l+=h.length;const b=m?.result?.next??m?.next,p=b!=null&&b!==""&&String(b)!=="0";r=h.length===a&&p,xe()&&Q.debug(`[Pagination] Stage: ${e}, Batch: ${h.length}, Total: ${i.length}, Start: ${l}, NextValue: ${b}, HasNext: ${p}, HasMore: ${r}`,"TicketRepository");try{const v=ye();v&&xe()&&(Q.debug(`[Pagination Debug] Stage: ${e}, Batch: ${h.length}, Total: ${i.length}`,"TicketRepository",{resultStructure:{hasResult:!!m?.result,resultIsArray:Array.isArray(m?.result),hasItems:!!m?.result?.items,hasData:!!m?.result?.data,hasNext:!!b,nextValue:b,nextType:typeof b,resultKeys:m?.result?Object.keys(m.result):[]}}),v.logTicketsLoading(e,h.length,i.length,b||null))}catch(v){Q.warn("Diagnostics logging error","TicketRepository",v)}if(r?g=l+a:g=i.length,t){const v=g>0?Math.min(100,i.length/g*100):0;t(mt({step:"loading_tickets",percent:v,count:i.length,total:g}))}f=null}else r=!1}catch(m){if(Q.error(`Error loading tickets batch for stage ${e} (start: ${l})`,"TicketRepository",m),l===0)throw f=m,new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–∏–∫–µ—Ç—ã –¥–ª—è —Å—Ç–∞–¥–∏–∏ ${e}: ${m.message||m}`);r=!1,t&&i.length>0&&t(ne("loading_tickets",100,{count:i.length,total:i.length,warning:`–ó–∞–≥—Ä—É–∂–µ–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ: ${i.length} —Ç–∏–∫–µ—Ç–æ–≤. –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.`}))}if(f&&i.length===0)throw f;if(o){const m=ee.getTicketsCacheKey(e);ee.set(m,i,ee.TICKETS_TTL)}return i}static async getTicket(e){return(await He.call("crm.item.get",{entityTypeId:rt,id:e})).result||null}static async updateTicket(e,o){const i=(await He.call("crm.item.update",{entityTypeId:rt,id:e,fields:o})).result===!0;return i&&ee.invalidateTicketsCache(),i}static async createTicket(e){const o=await He.call("crm.item.add",{entityTypeId:rt,fields:e}),t=o.result?parseInt(o.result):0;return t>0&&ee.invalidateTicketsCache(),t}static async assignTicket(e,o,t){return await this.updateTicket(e,{assignedById:o,stageId:t})}}const ra={name:"DiagnosticsPanel",props:{isEnabled:{type:Boolean,default:!1},isUserAdmin:{type:Boolean,default:!1}},setup(s){const e=w(!0),o=ye(),t=_(()=>!s.isEnabled||!s.isUserAdmin?{ticketsLoading:{stages:{},totalLoaded:0},filtering:{total:0,filtered:0,rejected:[],tagValueExamples:[]},employees:{uniqueIds:[],totalUnique:0,ticketsWithoutAssignedById:[],ticketsWithAssignedById1051:[]},grouping:{distributionByStages:{},ticketsNotInColumn:[],unknownStages:[]},zeroPoint:{byStage:{}}}:o?o.getMetrics():(console.warn("[DiagnosticsPanel] Diagnostics service not available"),{ticketsLoading:{stages:{},totalLoaded:0},filtering:{total:0,filtered:0,rejected:[],tagValueExamples:[]},employees:{uniqueIds:[],totalUnique:0,ticketsWithoutAssignedById:[],ticketsWithAssignedById1051:[]},grouping:{distributionByStages:{},ticketsNotInColumn:[],unknownStages:[]},zeroPoint:{byStage:{}}})),i=_(()=>!s.isEnabled||!s.isUserAdmin||!o?{withoutAssignedById:[],withAssignedById1051:[],withoutSectorTag:[],notInColumn:[],unknownStage:[]}:o.getProblematicTickets()),l=_(()=>{const f=i.value;return f.withoutAssignedById.length===0&&f.withAssignedById1051.length===0&&f.withoutSectorTag.length===0&&f.notInColumn.length===0&&f.unknownStage.length===0});return{isExpanded:e,metrics:t,problematicTickets:i,hasNoProblems:l,toggleExpanded:()=>{e.value=!e.value},downloadJSON:()=>{if(!o)return;const f=o.exportToJSON(),m=new Blob([f],{type:"application/json"}),h=URL.createObjectURL(m),b=document.createElement("a");b.href=h,b.download=`dashboard-diagnostics-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(h)},getStageName:f=>We.getStageName(f)||f}}},la={key:0,class:"diagnostics-panel"},ca={class:"diagnostics-header"},da={class:"header-actions"},ua=["title"],ga={key:0,class:"diagnostics-content"},ma={class:"diagnostics-section"},fa={class:"metrics-grid"},ha={class:"metric-card"},va={class:"metric-value"},ya={class:"metric-label"},pa={class:"metric-value"},_a={class:"metric-detail"},ba={class:"diagnostics-section"},ka={class:"metrics-grid"},Ca={class:"metric-card"},Sa={class:"metric-value"},wa={class:"metric-card",style:{"border-left-color":"#28a745"}},Ta={class:"metric-value"},Ea={class:"metric-card",style:{"border-left-color":"#dc3545"}},xa={class:"metric-value"},Aa={key:0,class:"metric-detail"},Da={key:0,class:"warning-box"},Ia={key:1,class:"examples-box"},Ma={class:"example-type"},La={key:0,class:"normalized"},Pa={class:"diagnostics-section"},Na={class:"metrics-grid"},Oa={class:"metric-card"},Ba={class:"metric-value"},Ra={class:"metric-card"},Ua={class:"metric-value"},Fa={class:"metric-card"},Va={class:"metric-value"},ja={class:"diagnostics-section"},za={class:"metrics-grid"},Ha={class:"metric-card"},Wa={class:"metric-value"},$a={class:"metric-card",style:{"border-left-color":"#28a745"}},qa={class:"metric-value"},Ka={class:"metric-card",style:{"border-left-color":"#ffc107"}},Xa={class:"metric-value"},Ga={key:0,class:"employees-list"},Ja={class:"diagnostics-section"},Ya={class:"metrics-grid"},Za={class:"metric-label"},Qa={class:"metric-value"},ei={class:"diagnostics-section problematic-tickets"},ti={key:0,class:"problem-group"},oi={class:"tickets-list"},si={class:"ticket-id"},ni={class:"ticket-title"},ai={class:"ticket-stage"},ii={key:0,class:"more-items"},ri={key:1,class:"problem-group"},li={class:"tickets-list"},ci={class:"ticket-id"},di={class:"ticket-title"},ui={class:"ticket-stage"},gi={key:0,class:"more-items"},mi={key:2,class:"problem-group"},fi={class:"tickets-list"},hi={class:"ticket-id"},vi={class:"ticket-title"},yi={class:"ticket-stage"},pi={key:0,class:"more-items"},_i={key:3,class:"problem-group"},bi={class:"tickets-list"},ki={class:"ticket-id"},Ci={class:"ticket-title"},Si={class:"ticket-stage"},wi={key:0,class:"more-items"},Ti={key:4,class:"problem-group"},Ei={class:"tickets-list"},xi={class:"ticket-id"},Ai={class:"ticket-title"},Di={class:"ticket-stage"},Ii={key:0,class:"more-items"},Mi={key:5,class:"no-problems"};function Li(s,e,o,t,i,l){return o.isEnabled&&o.isUserAdmin?(c(),d("div",la,[n("div",ca,[e[2]||(e[2]=n("h2",null,"üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞",-1)),n("div",da,[n("button",{onClick:e[0]||(e[0]=(...a)=>t.downloadJSON&&t.downloadJSON(...a)),class:"btn-download",title:"–°–∫–∞—á–∞—Ç—å JSON"}," üì• –°–∫–∞—á–∞—Ç—å JSON "),n("button",{onClick:e[1]||(e[1]=(...a)=>t.toggleExpanded&&t.toggleExpanded(...a)),class:"btn-toggle",title:t.isExpanded?"–°–≤–µ—Ä–Ω—É—Ç—å":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"},u(t.isExpanded?"‚ñº":"‚ñ∂"),9,ua)])]),t.isExpanded?(c(),d("div",ga,[n("section",ma,[e[4]||(e[4]=n("h3",null,"üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤",-1)),n("div",fa,[n("div",ha,[e[3]||(e[3]=n("div",{class:"metric-label"},"–í—Å–µ–≥–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ",-1)),n("div",va,u(t.metrics.ticketsLoading.totalLoaded),1)]),(c(!0),d(U,null,F(t.metrics.ticketsLoading.stages,(a,r)=>(c(),d("div",{key:r,class:"metric-card"},[n("div",ya,u(t.getStageName(r)),1),n("div",pa,u(a.total),1),n("div",_a,"–ë–∞—Ç—á–µ–π: "+u(a.batches.length),1)]))),128))])]),n("section",ba,[e[10]||(e[10]=n("h3",null,"üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ–∫—Ç–æ—Ä—É 1–°",-1)),n("div",ka,[n("div",Ca,[e[5]||(e[5]=n("div",{class:"metric-label"},"–í—Å–µ–≥–æ —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–æ",-1)),n("div",Sa,u(t.metrics.filtering.total),1)]),n("div",wa,[e[6]||(e[6]=n("div",{class:"metric-label"},"–ü—Ä–æ—à–ª–æ —Ñ–∏–ª—å—Ç—Ä (—Ç–µ–≥ 1–°)",-1)),n("div",Ta,u(t.metrics.filtering.filtered),1)]),n("div",Ea,[e[7]||(e[7]=n("div",{class:"metric-label"},"–û—Ç–∫–ª–æ–Ω–µ–Ω–æ (–Ω–µ—Ç —Ç–µ–≥–∞ 1–°)",-1)),n("div",xa,u(t.metrics.filtering.rejected.length),1),t.metrics.filtering.total>0?(c(),d("div",Aa,u(Math.round(t.metrics.filtering.rejected.length/t.metrics.filtering.total*100))+"% –æ—Ç –≤—Å–µ—Ö ",1)):y("",!0)])]),t.metrics.filtering.rejected.length>0?(c(),d("div",Da,[e[8]||(e[8]=n("strong",null,"‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:",-1)),X(" "+u(t.metrics.filtering.rejected.length)+" —Ç–∏–∫–µ—Ç–æ–≤ –Ω–µ –∏–º–µ—é—Ç —Ç–µ–≥–∞ —Å–µ–∫—Ç–æ—Ä–∞ 1–° (UF_CRM_7_TYPE_PRODUCT = '1C') –∏ –ø–æ—ç—Ç–æ–º—É –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –¥–∞—à–±–æ—Ä–¥–µ. –≠—Ç–∏ —Ç–∏–∫–µ—Ç—ã –µ—Å—Ç—å –≤ Bitrix24, –Ω–æ –Ω–µ –ø–æ–ø–∞–ª–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. ",1)])):y("",!0),t.metrics.filtering.tagValueExamples.length>0?(c(),d("div",Ia,[e[9]||(e[9]=n("h4",null,"–ü—Ä–∏–º–µ—Ä—ã –∑–Ω–∞—á–µ–Ω–∏–π UF_CRM_7_TYPE_PRODUCT:",-1)),n("ul",null,[(c(!0),d(U,null,F(t.metrics.filtering.tagValueExamples.slice(0,10),(a,r)=>(c(),d("li",{key:r},[n("code",null,u(JSON.stringify(a.value)),1),n("span",Ma,"("+u(a.type)+u(a.isArray?", –º–∞—Å—Å–∏–≤":"")+")",1),a.normalized&&a.normalized.length?(c(),d("span",La," ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: "+u(a.normalized.join(", ")),1)):y("",!0)]))),128))])])):y("",!0)]),n("section",Pa,[e[14]||(e[14]=n("h3",null,"üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏",-1)),n("div",Na,[n("div",Oa,[e[11]||(e[11]=n("div",{class:"metric-label"},"–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö ID",-1)),n("div",Ba,u(t.metrics.employees.totalUnique),1)]),n("div",Ra,[e[12]||(e[12]=n("div",{class:"metric-label"},"–ë–µ–∑ assignedById",-1)),n("div",Ua,u(t.metrics.employees.ticketsWithoutAssignedById.length),1)]),n("div",Fa,[e[13]||(e[13]=n("div",{class:"metric-label"},"–° assignedById=1051",-1)),n("div",Va,u(t.metrics.employees.ticketsWithAssignedById1051.length),1)])])]),n("section",ja,[e[18]||(e[18]=n("h3",null,"üì¶ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),(c(!0),d(U,null,F(t.metrics.grouping.distributionByStages,(a,r)=>(c(),d("div",{key:r,class:"stage-distribution"},[n("h4",null,u(t.getStageName(r)),1),n("div",za,[n("div",Ha,[e[15]||(e[15]=n("div",{class:"metric-label"},"–í—Å–µ–≥–æ —Ç–∏–∫–µ—Ç–æ–≤ –≤ —Å—Ç–∞–¥–∏–∏",-1)),n("div",Wa,u(a.total||0),1)]),n("div",$a,[e[16]||(e[16]=n("div",{class:"metric-label"},"–í–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),n("div",qa,u(a.insideSector||0),1)]),n("div",Ka,[e[17]||(e[17]=n("div",{class:"metric-label"},"–í–Ω–µ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),n("div",Xa,u(a.outsideSector||0),1)])]),Object.keys(a.employees||{}).length>0?(c(),d("div",Ga,[(c(!0),d(U,null,F(a.employees,(g,f)=>(c(),d("div",{key:f,class:"employee-item"}," –°–æ—Ç—Ä—É–¥–Ω–∏–∫ #"+u(f)+": "+u(g)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1))),128))])):y("",!0)]))),128))]),n("section",Ja,[e[19]||(e[19]=n("h3",null,"üéØ –ù—É–ª–µ–≤–∞—è —Ç–æ—á–∫–∞",-1)),n("div",Ya,[(c(!0),d(U,null,F(t.metrics.zeroPoint.byStage,(a,r)=>(c(),d("div",{key:r,class:"metric-card"},[n("div",Za,u(t.getStageName(r)),1),n("div",Qa,u(a),1)]))),128))])]),n("section",ei,[e[20]||(e[20]=n("h3",null,"‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),t.problematicTickets.withoutAssignedById.length>0?(c(),d("div",ti,[n("h4",null,"–ë–µ–∑ assignedById ("+u(t.problematicTickets.withoutAssignedById.length)+")",1),n("div",oi,[(c(!0),d(U,null,F(t.problematicTickets.withoutAssignedById.slice(0,10),a=>(c(),d("div",{key:a.id,class:"ticket-item"},[n("span",si,"#"+u(a.id),1),n("span",ni,u(a.title),1),n("span",ai,u(t.getStageName(a.stageId)),1)]))),128)),t.problematicTickets.withoutAssignedById.length>10?(c(),d("div",ii," ... –∏ –µ—â—ë "+u(t.problematicTickets.withoutAssignedById.length-10),1)):y("",!0)])])):y("",!0),t.problematicTickets.withAssignedById1051.length>0?(c(),d("div",ri,[n("h4",null,"–° assignedById=1051 ("+u(t.problematicTickets.withAssignedById1051.length)+")",1),n("div",li,[(c(!0),d(U,null,F(t.problematicTickets.withAssignedById1051.slice(0,10),a=>(c(),d("div",{key:a.id,class:"ticket-item"},[n("span",ci,"#"+u(a.id),1),n("span",di,u(a.title),1),n("span",ui,u(t.getStageName(a.stageId)),1)]))),128)),t.problematicTickets.withAssignedById1051.length>10?(c(),d("div",gi," ... –∏ –µ—â—ë "+u(t.problematicTickets.withAssignedById1051.length-10),1)):y("",!0)])])):y("",!0),t.problematicTickets.withoutSectorTag.length>0?(c(),d("div",mi,[n("h4",null,"–ë–µ–∑/–Ω–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–≥ —Å–µ–∫—Ç–æ—Ä–∞ ("+u(t.problematicTickets.withoutSectorTag.length)+")",1),n("div",fi,[(c(!0),d(U,null,F(t.problematicTickets.withoutSectorTag.slice(0,10),a=>(c(),d("div",{key:a.id||a.ID,class:"ticket-item"},[n("span",hi,"#"+u(a.id||a.ID),1),n("span",vi,u(a.title||a.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"),1),n("span",yi,u(t.getStageName(a.stageId||a.STAGE_ID)),1)]))),128)),t.problematicTickets.withoutSectorTag.length>10?(c(),d("div",pi," ... –∏ –µ—â—ë "+u(t.problematicTickets.withoutSectorTag.length-10),1)):y("",!0)])])):y("",!0),t.problematicTickets.notInColumn.length>0?(c(),d("div",_i,[n("h4",null,"–ù–µ –ø–æ–ø–∞–ª–∏ –≤ –∫–æ–ª–æ–Ω–∫—É ("+u(t.problematicTickets.notInColumn.length)+")",1),n("div",bi,[(c(!0),d(U,null,F(t.problematicTickets.notInColumn.slice(0,10),a=>(c(),d("div",{key:a.id,class:"ticket-item"},[n("span",ki,"#"+u(a.id),1),n("span",Ci,u(a.title),1),n("span",Si,u(t.getStageName(a.stageId)),1)]))),128)),t.problematicTickets.notInColumn.length>10?(c(),d("div",wi," ... –∏ –µ—â—ë "+u(t.problematicTickets.notInColumn.length-10),1)):y("",!0)])])):y("",!0),t.problematicTickets.unknownStage.length>0?(c(),d("div",Ti,[n("h4",null,"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è —Å—Ç–∞–¥–∏—è ("+u(t.problematicTickets.unknownStage.length)+")",1),n("div",Ei,[(c(!0),d(U,null,F(t.problematicTickets.unknownStage.slice(0,10),a=>(c(),d("div",{key:a.id,class:"ticket-item"},[n("span",xi,"#"+u(a.id),1),n("span",Ai,u(a.title),1),n("span",Di,"–°—Ç–∞–¥–∏—è: "+u(a.stageId),1)]))),128)),t.problematicTickets.unknownStage.length>10?(c(),d("div",Ii," ... –∏ –µ—â—ë "+u(t.problematicTickets.unknownStage.length-10),1)):y("",!0)])])):y("",!0),t.hasNoProblems?(c(),d("div",Mi," ‚úÖ –ü—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ ")):y("",!0)])])):y("",!0)])):y("",!0)}const Pi=H(ra,[["render",Li],["__scopeId","data-v-74a5e138"]]);class Ni{static async getEmployeesByIds(e,o=!0){if(!Array.isArray(e)||e.length===0)return[];if(o){const t=ee.getEmployeesCacheKey(e),i=ee.get(t);if(i!==null)return Q.debug(`Cache hit for employees: ${e.length} employees`,"EmployeeRepository"),i}try{const t=await He.call("user.get",{filter:{ID:e},select:["ID","NAME","LAST_NAME","EMAIL","WORK_POSITION","UF_DEPARTMENT"]});let i=[];if(t&&t.result&&(Array.isArray(t.result)?i=t.result:Q.warn("Unexpected user.get result format","EmployeeRepository",t)),o){const l=ee.getEmployeesCacheKey(e);ee.set(l,i,ee.EMPLOYEES_TTL)}return i}catch(t){return Q.error("Error getting employees by IDs","EmployeeRepository",t),[]}}}const ot=new Map;function bo(){ot.clear()}function Oi(s){if(!s)return[];if(Array.isArray(s))return s.filter(o=>typeof o=="number"||!isNaN(parseInt(o))).map(o=>typeof o=="number"?o:parseInt(o));if(typeof s=="number")return[s];const e=parseInt(s);return isNaN(e)?[]:[e]}function Bi(s,e=!0){const o=s.id||s.ID;if(!s||!o)return null;if(e&&ot.has(o))return ot.get(o);const t=s.UF_DEPARTMENT||s.departmentId,i=Oi(t);for(const l of i)if(Xo(l)){const r=l;return e&&ot.set(o,r),r}return e&&ot.set(o,null),null}function Ri(s){const e=Bi(s);return{id:parseInt(s.ID||s.id||0),name:`${s.NAME||s.name||""} ${s.LAST_NAME||s.lastName||""}`.trim()||s.EMAIL||s.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:s.WORK_POSITION||s.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:s.EMAIL||s.email||"",sectorId:e,departmentId:s.UF_DEPARTMENT||null,tickets:[]}}function Ui(s){return Array.isArray(s)?s.map(e=>Ri(e)):[]}const Fi="1C",Vi=["1–°"],st=new Map,Yt=100;function ko(s){return s.UF_CRM_7_TYPE_PRODUCT||s.uf_crm_7_type_product||s.ufCrm7TypeProduct||s.UF_CRM_7_TYPE_PRODUCT||s.uf_crm_7_type_product||null}function xt(s){return s==null?null:String(s).trim().toUpperCase().replace(/–°/g,"C")||null}function Co(s){if(!s)return[];if(Array.isArray(s))return s.map(xt).filter(Boolean);if(typeof s=="object"&&s.value!==void 0){const o=xt(s.value);return o?[o]:[]}const e=xt(s);return e?e.split(/[;,]/).map(o=>o.trim()).filter(Boolean):[]}function Zt(s){const e=ko(s),o=Co(e);return o.length===0?!1:o.some(t=>t===Fi||Vi.includes(t))}function ji(s){return`filter:${s.map(o=>o.id||o.ID||"").sort().join(",")}`}function zi(){st.size>Yt&&Array.from(st.keys()).slice(0,Math.floor(Yt*.2)).forEach(e=>st.delete(e))}function Hi(s){if(!Array.isArray(s))return[];const e=ji(s),o=st.get(e);if(o!==void 0)return o;const t=s.filter(Zt);try{const i=ye();if(i&&xe()){const l=s.filter(g=>!Zt(g)),a=[],r=new Set;s.forEach(g=>{const f=ko(g),m=Co(f),h=f==null?"":String(f);f!=null&&!r.has(h)&&(r.add(h),a.push({value:f,normalized:m,type:typeof f,isArray:Array.isArray(f),ticketId:g.id||g.ID}))}),i.logFiltering(s.length,t.length,l,a)}}catch(i){console.warn("Diagnostics logging error in filterBySector:",i)}return st.set(e,t),zi(),t}const ft=1051;function ht(s){if(!s||typeof s!="object")return null;let e=s.assignedById||s.ASSIGNED_BY_ID||s.assignedByIdId||s.assignedById;return e&&typeof e=="object"&&(e=e.id||e.ID||e.value||null),e||null}function Rt(s){if(s==null)return null;typeof s=="object"&&(s=s.id||s.ID||s.value||null);const e=typeof s=="number"?s:parseInt(s);return isNaN(e)||e<=0?null:e}function Wi(s,e=ft){const o=ht(s),t=Rt(o);return t===null||t===e}function $i(s,e){Array.isArray(s)||(Q.warn("Tickets is not an array","TicketGrouper",s),s=[]),Array.isArray(e)||(Q.warn("Employees is not an array","TicketGrouper",e),e=[]);const o=e.filter(g=>(g.id?parseInt(g.id):null)!==ft),t=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:o.map(g=>({...g,isFromSector1C:g.sectorId===St.SECTOR_1C,tickets:[],ticketsInsideSector:[],ticketsOutsideSector:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:o.map(g=>({...g,isFromSector1C:g.sectorId===St.SECTOR_1C,tickets:[],ticketsInsideSector:[],ticketsOutsideSector:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:o.map(g=>({...g,isFromSector1C:g.sectorId===St.SECTOR_1C,tickets:[],ticketsInsideSector:[],ticketsOutsideSector:[]}))}],i=new Map(t.map(g=>[g.id,g])),l=new Map;t.forEach(g=>{const f=new Map(g.employees.map(m=>[m.id,m]));l.set(g.id,f)});const a=[],r=[];s.forEach(g=>{const f=co(g.stageId||g.STAGE_ID||""),m=i.get(f);if(!m){r.push({id:g.id||g.ID,title:g.title||g.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",stageId:g.stageId||g.STAGE_ID,assignedById:ht(g)});return}const h=ht(g),b=Rt(h);if(b!==ft)if(b){const p=l.get(f);let v=p.get(b);v||(v={id:b,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${b}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",sectorId:null,departmentId:null,isFromSector1C:!1,tickets:[],ticketsInsideSector:[],ticketsOutsideSector:[]},m.employees.push(v),p.set(b,v));const S=Bt(g),D={...S,stageId:g.stageId||g.STAGE_ID||S.stageId,departmentHead:S.departmentHead||null,departmentHeadFull:S.departmentHeadFull||S.departmentHead||null};v.tickets.push(D),v.isFromSector1C?v.ticketsInsideSector.push(D):v.ticketsOutsideSector.push(D)}else a.push({id:g.id||g.ID,title:g.title||g.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",stageId:f,assignedById:h})}),t.forEach(g=>{g.employees.sort((f,m)=>f.isFromSector1C&&!m.isFromSector1C?-1:!f.isFromSector1C&&m.isFromSector1C?1:(f.id||0)-(m.id||0))});try{const g=ye();if(g&&xe()){const f={};t.forEach(h=>{let b=0,p=0;h.employees.forEach(v=>{b+=(v.ticketsInsideSector||[]).length,p+=(v.ticketsOutsideSector||[]).length}),f[h.id]={insideSector:b,outsideSector:p,total:b+p}});const m=g.metrics.grouping;Object.keys(f).forEach(h=>{m.distributionByStages[h]||(m.distributionByStages[h]={employees:{},total:0}),m.distributionByStages[h].insideSector=f[h].insideSector,m.distributionByStages[h].outsideSector=f[h].outsideSector,m.distributionByStages[h].total=f[h].total}),g.logGrouping(t,a,r)}}catch(g){Q.warn("Diagnostics logging error in groupTicketsByStages","TicketGrouper",g)}return t}function qi(s){const e={formed:[],review:[],execution:[]};if(!Array.isArray(s))return Q.warn("Tickets is not an array in getZeroPointTickets","TicketGrouper",s),e;s.filter(o=>Wi(o)).forEach(o=>{const t=co(o.stageId||o.STAGE_ID||"");if(e[t]){const i=Bt(o),l={...i,stageId:o.stageId||o.STAGE_ID||i.stageId,departmentHead:i.departmentHead||null,departmentHeadFull:i.departmentHeadFull||i.departmentHead||null};e[t].push(l)}});try{const o=ye();o&&xe()&&o.logZeroPoint(e)}catch(o){Q.warn("Diagnostics logging error in getZeroPointTickets","TicketGrouper",o)}return e}function Ki(s){if(!Array.isArray(s))return[];const e=new Set,o=[],t=[];s.forEach(l=>{const a=ht(l),r=Rt(a);!a||a===null||a===void 0?o.push({id:l.id||l.ID,title:l.title||l.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",stageId:l.stageId||l.STAGE_ID}):r===ft&&t.push({id:l.id||l.ID,title:l.title||l.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",stageId:l.stageId||l.STAGE_ID}),r&&e.add(r)});const i=Array.from(e);try{const l=ye();l&&xe()&&l.logEmployees(i,o,t)}catch(l){Q.warn("Diagnostics logging error in extractUniqueEmployeeIds","TicketGrouper",l)}return i}const lt=new Map,Xi=10*60*1e3;function Gi(s){if(!s||typeof s!="object")return{};const e={},o=Object.keys(s);for(const t of o)t.toUpperCase().startsWith("UF_")&&(e[t]=s[t]);return e}function Ji(s,e=null,o=!0){if(o&&e&&lt.has(e)){const l=lt.get(e),a=Date.now();if(l.timestamp&&a-l.timestamp<Xi)return l.data;lt.delete(e)}const t=Gi(s),i={typeProduct:t.UF_CRM_7_TYPE_PRODUCT||t.uf_crm_7_type_product||t.ufCrm7TypeProduct||null,all:t};return o&&e&&lt.set(e,{data:i,timestamp:Date.now()}),i}class Yi{static async getTicketDetails(e,o={}){const{select:t=["*"],useOriginalUfNames:i=!0,useCache:l=!0}=o;try{const a=await We.getTicket(e);if(!a)throw new Error(`–¢–∏–∫–µ—Ç —Å ID ${e} –Ω–µ –Ω–∞–π–¥–µ–Ω`);const r=Ji(a,e,l),g=a.UF_CRM_7_UF_PRIORITY||a.uf_crm_7_uf_priority||a.ufCrm7UfPriority||a.UF_CRM_7_UF_PRIORITY||a.uf_crm_7_uf_priority||a.priority||a.PRIORITY||null,f=Go(g),m=Jo(f);return{id:a.id||a.ID,title:a.title||a.TITLE,stageId:a.stageId||a.STAGE_ID,assignedById:a.assignedById||a.ASSIGNED_BY_ID,createdAt:a.createdTime||a.CREATED_TIME||a.CREATED_DATE,updatedAt:a.updatedTime||a.UPDATED_TIME||a.MODIFY_DATE,priorityId:f.id,priorityLabel:f.label,priorityColors:m,priority:f.id,priorityBitrixValue:f.bitrixValue||null,opportunity:a.opportunity||a.OPPORTUNITY,currencyId:a.currencyId||a.CURRENCY_ID,comments:a.comments||a.COMMENTS,additionalFields:r,rawData:a}}catch(a){throw Q.error("Error getting ticket details","TicketDetailsService",a),a}}}class Je{static notifyCacheCreationStarted(e){this.showNotification({content:`–ù–∞—á–∞—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –¥–ª—è –º–æ–¥—É–ª—è "${e}"...`,type:"info",autoHideDelay:3e3})}static notifyCacheCreationSuccess(e){this.showNotification({content:`‚úÖ –ö–µ—à –¥–ª—è –º–æ–¥—É–ª—è "${e}" —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω`,type:"success",autoHideDelay:5e3})}static notifyCacheCreationError(e,o){this.showNotification({content:`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–µ—à–∞ –¥–ª—è –º–æ–¥—É–ª—è "${e}": ${o}`,type:"error",autoHideDelay:7e3})}static notifyCacheUpdated(e,o="auto"){const t=o==="manual"?"–≤—Ä—É—á–Ω—É—é":"–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏";this.showNotification({content:`üîÑ –ö–µ—à –¥–ª—è –º–æ–¥—É–ª—è "${e}" –æ–±–Ω–æ–≤–ª—ë–Ω ${t}`,type:"info",autoHideDelay:4e3})}static notifyCacheUsed(e){this.showNotification({content:`‚ö° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –∫–µ—à –¥–ª—è –º–æ–¥—É–ª—è "${e}"`,type:"success",autoHideDelay:3e3})}static showNotification(e){typeof BX<"u"&&BX.UI&&BX.UI.Notification?BX.UI.Notification.Center.notify({content:e.content,autoHideDelay:e.autoHideDelay||3e3}):console.log("[CacheNotification]",e.content)}}const k0=Object.freeze(Object.defineProperty({__proto__:null,CacheNotificationService:Je},Symbol.toStringTag,{value:"Module"}));class At{static async getSectorData(e=!0,o=!1,t=null){let i=!1;try{if(xe()){const l=ye();l&&l.reset()}}catch(l){Q.warn("Error resetting diagnostics","DashboardSector1CService",l)}if(t&&t(ne("cache_check",0,{description:"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏..."})),o)try{t&&t(ne("backend_cache_check",5,{description:"–ü—Ä–æ–≤–µ—Ä–∫–∞ backend –∫–µ—à–∞..."}));const l=await fetch("/api/services/dashboard-sector-1c.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"getSectorDataCached",params:{forceRefresh:!1,ttl:600}})});if(l.ok){const a=await l.json();if(a.success&&a.data)return t&&t(ne("backend_cache_hit",100,{description:"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ backend –∫–µ—à–∞"})),a.cache_created===!0&&Je.notifyCacheCreationSuccess("–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° (backend)"),a.data}Q.warn("Backend cache miss or error, falling back to frontend logic","DashboardSector1CService")}catch(l){Q.warn("Backend cache request failed, falling back to frontend logic","DashboardSector1CService",l)}if(e){const l=ee.getSectorDataCacheKey(),a=ee.get(l);if(a!==null)return t&&t(ne("cache_hit",100,{description:"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ in-memory –∫–µ—à–∞"})),a}try{t&&t(ne("loading_tickets",10,{description:"–ù–∞—á–∞–ª–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤ –∏–∑ Bitrix24..."}));const l=Yo(),a=await We.getAllTickets(l,p=>{if(t){const v=mt(p),S=_o(10,40,v.progress||0);t(ne(v.step||"loading_tickets",S,{...v.details,warning:v.details.warning}))}},e);t&&t(ne("filtering",50,{totalTickets:a.length,description:`–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è ${a.length} —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ —Å–µ–∫—Ç–æ—Ä—É 1–°...`}));const r=Hi(a);t&&t(ne("filtering",50,{totalTickets:a.length,filteredTickets:r.length,description:`–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–æ ${r.length} —Ç–∏–∫–µ—Ç–æ–≤ –∏–∑ ${a.length}`})),t&&t(ne("extracting_employees",60,{filteredTickets:r.length,description:`–ê–Ω–∞–ª–∏–∑ ${r.length} —Ç–∏–∫–µ—Ç–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...`}));const g=Ki(r);t&&t(ne("extracting_employees",60,{employeeCount:g.length,description:`–ù–∞–π–¥–µ–Ω–æ ${g.length} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤`})),t&&t(ne("loading_employees",65,{employeeCount:g.length,description:`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ${g.length} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...`})),bo();const f=await Ni.getEmployeesByIds(g),m=Ui(f);t&&t(ne("loading_employees",90,{employeeCount:m.length,description:`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –¥–∞–Ω–Ω—ã—Ö ${m.length} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤`})),t&&t(ne("grouping",90,{filteredTickets:r.length,employeeCount:m.length,description:`–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ${r.length} —Ç–∏–∫–µ—Ç–æ–≤ –ø–æ —ç—Ç–∞–ø–∞–º –∏ ${m.length} —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º...`}));const b={stages:$i(r,m),employees:m,zeroPointTickets:qi(r)};if(t&&t(ne("caching",95,{description:"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –∫–µ—à –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–≥—Ä—É–∑–æ–∫..."})),e){const p=ee.getSectorDataCacheKey();ee.set(p,b,ee.TICKETS_TTL),i=!0}return t&&t(ne("complete",100,{description:"–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"})),i&&!o&&Je.notifyCacheCreationSuccess("–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°"),b}catch(l){throw Q.error("Error getting sector data","DashboardSector1CService",l),t&&t({step:"error",progress:0,error:l.message}),l}}static async assignTicket(e,o,t){try{const i=Jt(t),l=await We.assignTicket(e,o,i);return l&&ee.invalidateTicketsCache(),l}catch(i){throw Q.error("Error assigning ticket","DashboardSector1CService",i),i}}static async createTicket(e){try{const o=Jt(e.stageId||"formed"),t={title:e.title,stageId:o};e.employeeId&&(t.assignedById=e.employeeId);const i=await We.createTicket(t);return i>0&&ee.invalidateTicketsCache(),i}catch(o){throw Q.error("Error creating ticket","DashboardSector1CService",o),o}}static async getTicket(e){try{const o=await We.getTicket(e);return Bt(o)}catch(o){throw Q.error("Error getting ticket","DashboardSector1CService",o),o}}static async getTicketDetails(e,o={}){try{return await Yi.getTicketDetails(e,o)}catch(t){throw Q.error("Error getting ticket details","DashboardSector1CService",t),t}}static async addComment(e,o){try{return(await He.call("crm.timeline.comment.add",{fields:{entityId:e,entityType:"DYNAMIC_"+Zo,comment:o}})).result!==void 0}catch(t){throw Q.error("Error adding comment","DashboardSector1CService",t),t}}}function Zi(){const s=w(null),e=w(0),o=w(null),t=w(null),i=w({}),l=(b,p={})=>{s.value=b,i.value=p},a=b=>{const p=typeof b=="number"&&!isNaN(b)?b:0;e.value=Math.min(100,Math.max(0,p))},r=b=>{o.value=b,t.value=null},g=b=>{t.value=b},f=()=>{t.value=null},m=()=>{s.value=null,e.value=0,o.value=null,t.value=null,i.value={}},h=_(()=>o.value||t.value);return{currentStep:s,progress:e,error:o,temporaryError:t,displayError:h,stepDetails:i,updateStep:l,updateProgress:a,setError:r,setTemporaryError:g,clearTemporaryError:f,reset:m}}nt.register(Do,Io,Mo,Lo,Po,No,Oo,Bo,Ro,Uo);nt.defaults.responsive=!0;nt.defaults.maintainAspectRatio=!1;nt.defaults.plugins.legend.display=!0;nt.defaults.plugins.legend.position="top";const C0={primary:"#007bff",success:"#28a745",danger:"#dc3545",warning:"#ffc107",info:"#17a2b8",carryover:"#ff9800",successLight:"#6cbf47",carryoverLight:"#ffb74d",carryoverDark:"#f57c00"},ke={USER_NOT_DETERMINED:"USER_NOT_DETERMINED",ACCESS_DENIED:"ACCESS_DENIED",API_ERROR:"API_ERROR"};class we{constructor(e,o=null,t=null,i=null){this.allowed=e,this.errorCode=o,this.errorMessage=t,this.user=i}}class Ne{static async checkAccess(){try{const e=Ge();if(console.log("AccessControlService.checkAccess - isInsideBitrix24:",e),console.log("AccessControlService.checkAccess - window.self === window.top:",window.self===window.top),console.log("AccessControlService.checkAccess - typeof BX24:",typeof BX24),e)console.log("AccessControlService.checkAccess - Inside Bitrix24, skipping direct access check");else{console.log("AccessControlService.checkAccess - Not inside Bitrix24, checking direct access config...");const{isDirectAccessAllowed:l,getDenyMessage:a}=await me(async()=>{const{isDirectAccessAllowed:g,getDenyMessage:f}=await import("./direct-access-config-7AjCqqS-.js");return{isDirectAccessAllowed:g,getDenyMessage:f}},__vite__mapDeps([0,1]),import.meta.url),r=await l();if(console.log("AccessControlService.checkAccess - allowDirectAccess:",r),!r){const g=await a();return console.warn("Direct access denied: Application opened directly in browser, but direct access is disabled in config"),console.warn("Deny message:",g),new we(!1,ke.ACCESS_DENIED,g,null)}console.log("Direct access allowed: Using primary administrator token from settings.php")}if(e)try{await Promise.race([Pe.init(),new Promise((l,a)=>setTimeout(()=>a(new Error("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Bitrix24 API –ø—Ä–µ–≤—ã—Å–∏–ª–∞ 5 —Å–µ–∫—É–Ω–¥")),5e3))])}catch(l){console.warn("BX24.init() failed, will try proxy API:",l)}let o;try{o=await Promise.race([Pe.getCurrentUser(),new Promise((l,a)=>setTimeout(()=>a(new Error("–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø—Ä–µ–≤—ã—Å–∏–ª–æ 10 —Å–µ–∫—É–Ω–¥")),1e4))])}catch(l){console.warn("Bitrix24BxApi.getCurrentUser() failed, trying proxy API:",l);const{Bitrix24ApiProvider:a}=await me(async()=>{const{Bitrix24ApiProvider:r}=await import("./chunk-CPzRTNN7.js").then(g=>g.b);return{Bitrix24ApiProvider:r}},__vite__mapDeps([2,1]),import.meta.url);try{const r=await a.getInstance();o=await Promise.race([r.getCurrentUser(),new Promise((g,f)=>setTimeout(()=>f(new Error("–ü—Ä–æ–∫—Å–∏ API –ø—Ä–µ–≤—ã—Å–∏–ª–æ 5 —Å–µ–∫—É–Ω–¥")),5e3))]),console.log("Got user from proxy API:",o?.ID||"unknown")}catch(r){throw console.error("Both BX24 API and proxy API failed:",r),new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.")}}if(!o||!o.ID)return console.warn("AccessControlService.checkAccess - user not determined:",o),new we(!1,ke.USER_NOT_DETERMINED,"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.");console.log("AccessControlService.checkAccess - user determined:",{id:o.ID,name:o.NAME,departments:o.UF_DEPARTMENT});const t=o.UF_DEPARTMENT||[];if(console.log("AccessControlService.checkAccess - departmentIds:",t),!Array.isArray(t)||t.length===0){if(console.log("AccessControlService.checkAccess - user has no departments"),!e){const{isDirectAccessAllowed:l}=await me(async()=>{const{isDirectAccessAllowed:r}=await import("./direct-access-config-7AjCqqS-.js");return{isDirectAccessAllowed:r}},__vite__mapDeps([0,1]),import.meta.url);if(await l())return console.log("AccessControlService.checkAccess - Direct access allowed, granting access despite no departments"),new we(!0,null,null,o)}return console.warn("AccessControlService.checkAccess - Access denied: user has no departments"),new we(!1,ke.ACCESS_DENIED,"–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –æ—Ç–¥–µ–ª—É.")}const i=t.some(l=>po(l));return console.log("AccessControlService.checkAccess - hasAccess:",i),i?(console.log("AccessControlService.checkAccess - Access granted"),new we(!0,null,null,o)):(console.warn("AccessControlService.checkAccess - Access denied: no allowed departments"),new we(!1,ke.ACCESS_DENIED,"–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω"))}catch(e){return console.error("AccessControlService.checkAccess error:",e),e.message&&(e.message.includes("CORS")||e.message.includes("blocked")||e.message.includes("ERR_FAILED")||e.message.includes("unknown address space"))&&Ge()?(console.error("CORS error inside Bitrix24: Cannot determine interface user."),new we(!1,ke.API_ERROR,"–û—à–∏–±–∫–∞ CORS: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.")):e.message&&e.message.includes("not loaded")?new we(!1,ke.USER_NOT_DETERMINED,"–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª."):new we(!1,ke.API_ERROR,"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–æ—Å—Ç—É–ø–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.")}}static async getCurrentUser(){try{return Ge()&&await Pe.init(),await Pe.getCurrentUser()}catch(e){return console.error("AccessControlService.getCurrentUser error:",e),null}}}function Qi(s,e=300){let o;return function(...i){const l=()=>{clearTimeout(o),s(...i)};clearTimeout(o),o=setTimeout(l,e)}}function er(){const s=w(!1),e=w(null),o=w([{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:[]},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:[]},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:[]}]),t=w({formed:[],review:[],execution:[]}),i=w([]),l=w(null);return{isLoading:s,error:e,stages:o,zeroPointTickets:t,employees:i,draggedTicket:l,updateState:m=>{m.stages&&(o.value=m.stages),m.employees&&(i.value=m.employees),m.zeroPointTickets&&(t.value=m.zeroPointTickets)},resetState:()=>{s.value=!1,e.value=null,o.value=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:[]},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:[]},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:[]}],t.value={formed:[],review:[],execution:[]},i.value=[],l.value=null},updateLocalStateAfterMove:(m,h,b)=>{const p=o.value.find(S=>S.employees.some(D=>D.tickets.some(C=>C.id===m.id)));if(p){const S=p.employees.find(D=>D.tickets.some(C=>C.id===m.id));S&&(S.tickets=S.tickets.filter(D=>D.id!==m.id))}const v=o.value.find(S=>S.id===b);if(v){const S=v.employees.find(D=>D.id===h);if(S){const D={...m,assigneeId:h,stageId:b};S.tickets.push(D)}}Object.keys(t.value).forEach(S=>{t.value[S]=t.value[S].filter(D=>D.id!==m.id)})},getEmployeeTickets:(m,h)=>{const b=o.value.find(v=>v.id===h);if(!b)return[];const p=b.employees.find(v=>v.id===m);return p?p.tickets||[]:[]}}}const Ae={fadeOutDuration:400,fadeInDuration:400,delayBetween:150,readyDisplayTime:800,fadeOutEasing:"ease-out",fadeInEasing:"ease-in",fadeOutTransform:"scale(0.95)",fadeInTransform:"translateY(10px)"},Qt={fadeInDuration:400,fadeInEasing:"ease-in"};function So(s,e,o="opacity, transform"){return`${o} ${s}ms ${e}`}function tr(){return So(Ae.fadeOutDuration,Ae.fadeOutEasing)}function or(){return So(Qt.fadeInDuration,Qt.fadeInEasing)}function sr(){const s=w(!1),e=w(null),o=a=>{s.value=!0,e.value=Date.now(),a&&a()},t=a=>{s.value=!1,e.value=null,a&&a()},i=(a,r,g=Ae)=>{o(()=>{a&&a(),setTimeout(()=>{r&&r()},g.delayBetween),setTimeout(()=>{t()},g.fadeOutDuration)})},l=_(()=>e.value?Date.now()-e.value:0);return{isTransitioning:_(()=>s.value),startTransition:o,endTransition:t,executeTransition:i,transitionDuration:l}}function nr(s,e=""){if(Logger.error(`API Error ${e?`(${e})`:""}`,"ErrorHandler",s),s.message){if(s.message.includes("HTTP error"))return"–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.";if(s.message.includes("timeout"))return"–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";if(s.message.includes("403")||s.message.includes("401"))return"–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.";if(s.message.includes("500"))return"–û—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."}return s.message||"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"}function ar(s,e="",o={}){const t={message:s.message,stack:s.stack,context:e,...o,timestamp:new Date().toISOString()};Logger.error("Error logged","ErrorHandler",t)}function Dt(s,e="",o=null){const t=nr(s,e);ar(s,e),o&&typeof o=="function"?o(t,"error"):typeof BX<"u"&&BX.UI&&BX.UI.Notification&&BX.UI.Notification.Center.notify({content:t,autoHideDelay:5e3})}function ir(s){const e=_t(),o=Zi(),{isTransitioning:t,executeTransition:i}=sr();function l(p,v){const S=mt(p);S.step&&v.updateStep(S.step,S.details||{}),S.progress!==void 0&&S.progress!==null&&(v.updateProgress(S.progress),v.clearTemporaryError())}const a=async(p=!0)=>{s.isLoading.value=!0,s.error.value=null,o.reset(),o.updateStep("cache_check",{description:"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö..."}),o.updateProgress(0);try{const v=await At.getSectorData(p,S=>{l(S,o)});s.updateState(v)}catch(v){s.error.value=v.message,o.setError(v.message),Dt(v,"loading sector data",e.error)}finally{if(s.error.value)s.isLoading.value=!1;else{o.updateStep("complete",{description:"–î–∞—à–±–æ—Ä–¥ –∑–∞–≥—Ä—É–∂–µ–Ω"}),o.updateProgress(100);const v=Ae.readyDisplayTime||800;setTimeout(()=>{i(()=>{},()=>{s.isLoading.value=!1},Ae),setTimeout(()=>{o.reset()},Ae.fadeOutDuration)},v)}}},r=async(p,v,S)=>{if(!vo(p,v,S))return e.warning("–ù–µ–ª—å–∑—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–∏–∫–µ—Ç —Å—é–¥–∞"),!1;try{const D=await At.assignTicket(p.id,v,S);return D&&(s.updateLocalStateAfterMove(p,v,S),e.success("–¢–∏–∫–µ—Ç –ø–µ—Ä–µ–º–µ—â—ë–Ω")),D}catch(D){return Dt(D,"assigning ticket",e.error),!1}finally{s.draggedTicket.value=null}};return{loadSectorData:a,assignTicket:r,moveTicketToStage:async(p,v)=>await r(p,p.assigneeId,v),assignTicketToEmployee:async(p,v)=>await r(p,v,p.stageId),createTicket:async p=>{const v=Us(p);if(!v.valid){const S=v.errors.join(", ");return e.error(S),0}try{const S=await At.createTicket(p);return S>0&&(await a(!1),e.success("–¢–∏–∫–µ—Ç —Å–æ–∑–¥–∞–Ω")),S}catch(S){return Dt(S,"creating ticket",e.error),0}},handleTicketDragStart:p=>{s.draggedTicket.value=p},handleTicketDrop:async(p,v,S)=>{await r(p,v,S)},loadingProgress:o,isTransitioning:t}}const Ut={name:"DashboardSector1C",components:{DashboardStage:an,LoadingPreloader:Rn,LoggerControl:Yn,BackButton:na,DiagnosticsPanel:Pi},setup(){const s=Ie(),e=Nt(),o=er(),t=ir(o),i=w(null),l=_(()=>i.value?bt(i.value):!1),a=_(()=>xe(e,i.value)),r=()=>{s.push({name:"dashboard-sector-1c",query:{...e.query,diagnostics:"true"}}),typeof localStorage<"u"&&localStorage.setItem("dashboard-sector-1c-diagnostics","true");const O=ye();O&&O.reset(),t.loadSectorData(!1)},g=()=>{ee.invalidateTicketsCache(),ee.invalidateEmployeesCache(),bo();const O=ye();O&&O.reset(),t.loadSectorData(!1)};ae(async()=>{try{i.value=await Ne.getCurrentUser()}catch(O){console.error("Error getting current user:",O),i.value=null}if(a.value){const O=ye();O&&O.reset()}t.loadSectorData()});const f=tr(),m=or(),h=`${Ae.delayBetween}ms`,b=Ae.fadeOutTransform,p=Ae.fadeInTransform,v=()=>{t.loadSectorData(!1)},S=()=>{s.push({name:"dashboard-graph-state"})},D=()=>{s.push({name:"dashboard-graph-admission-closure"})},C=()=>{s.push({name:"dashboard-tickets-time-tracking"})},M=()=>{s.push("/")},I=t.loadingProgress,V=_(()=>typeof localStorage<"u"?localStorage.getItem("dashboard-sector-1c-show-logger-control")==="true":!1);return{isLoading:o.isLoading,error:o.error,stages:o.stages,zeroPointTickets:o.zeroPointTickets,employees:o.employees,draggedTicket:o.draggedTicket,currentStep:I.currentStep,progress:I.progress,stepDetails:I.stepDetails,loadingProgress:I,loadSectorData:t.loadSectorData,handleTicketDragStart:t.handleTicketDragStart,handleTicketDrop:t.handleTicketDrop,assignTicketToEmployee:t.assignTicketToEmployee,moveTicketToStage:t.moveTicketToStage,createTicket:t.createTicket,getEmployeeTickets:o.getEmployeeTickets,showLoggerControl:V,handleRetry:v,isTransitioning:t.isTransitioning,preloaderFadeOutTransition:f,dashboardFadeInTransition:m,transitionDelay:h,preloaderFadeOutTransform:b,dashboardFadeInTransform:p,navigateToGraphState:S,navigateToAdmissionClosure:D,navigateToTimeTracking:C,handleGoHome:M,isDiagnosticsEnabled:a,enableDiagnostics:r,clearCache:g,isUserAdmin:l}}},eo=()=>{Fo(s=>({e25fa6d4:s.preloaderFadeOutTransition,v2de4400b:s.preloaderFadeOutTransform,v66f66a76:s.dashboardFadeInTransition,e224f3ee:s.transitionDelay,v171b9ffc:s.dashboardFadeInTransform}))},to=Ut.setup;Ut.setup=to?(s,e)=>(eo(),to(s,e)):eo;const rr={class:"dashboard-header"},lr={class:"breadcrumbs-row"},cr={class:"header-actions"},dr={key:0,class:"dashboard-content"},ur={class:"stages-container"};function gr(s,e,o,t,i,l){const a=W("BackButton"),r=W("LoadingPreloader"),g=W("DashboardStage"),f=W("LoggerControl"),m=W("DiagnosticsPanel");return c(),d("div",{class:N(["dashboard-sector-1c",{"is-dragging":t.draggedTicket}])},[n("div",rr,[n("div",lr,[n("button",{class:"btn-home-link",type:"button",onClick:e[0]||(e[0]=(...h)=>t.handleGoHome&&t.handleGoHome(...h)),title:"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É","aria-label":"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"}," –ì–ª–∞–≤–Ω–∞—è "),e[6]||(e[6]=n("span",{class:"breadcrumb-separator"},"/",-1)),e[7]||(e[7]=n("span",{class:"breadcrumb-current"},"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1))]),K(a,{variant:"header"}),e[13]||(e[13]=n("h1",null,"–î–∞—à–±–æ—Ä–¥ - –°–µ–∫—Ç–æ—Ä 1–°",-1)),n("div",cr,[t.isDiagnosticsEnabled&&t.isUserAdmin?(c(),d("button",{key:0,onClick:e[1]||(e[1]=(...h)=>t.clearCache&&t.clearCache(...h)),class:"btn-clear-cache",title:"–°–±—Ä–æ—Å–∏—Ç—å –∫–µ—à —Å–µ–∫—Ç–æ—Ä–∞ –∏ —Ç–∏–∫–µ—Ç–æ–≤"},[...e[8]||(e[8]=[n("span",{class:"icon"},"‚ôªÔ∏è",-1),n("span",null,"–°–±—Ä–æ—Å–∏—Ç—å –∫–µ—à",-1)])])):y("",!0),!t.isDiagnosticsEnabled&&t.isUserAdmin?(c(),d("button",{key:1,onClick:e[2]||(e[2]=(...h)=>t.enableDiagnostics&&t.enableDiagnostics(...h)),class:"btn-enable-diagnostics",title:"–í–∫–ª—é—á–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º"},[...e[9]||(e[9]=[n("span",{class:"icon"},"üîç",-1),n("span",null,"–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",-1)])])):y("",!0),n("button",{onClick:e[3]||(e[3]=(...h)=>t.navigateToGraphState&&t.navigateToGraphState(...h)),class:"btn-navigate-graph-state",title:"–ü–µ—Ä–µ–π—Ç–∏ –∫ –≥—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞"},[...e[10]||(e[10]=[n("span",{class:"icon"},"üìä",-1),n("span",null,"–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è",-1)])]),n("button",{onClick:e[4]||(e[4]=(...h)=>t.navigateToAdmissionClosure&&t.navigateToAdmissionClosure(...h)),class:"btn-navigate-admission-closure",title:"–ü–µ—Ä–µ–π—Ç–∏ –∫ –≥—Ä–∞—Ñ–∏–∫—É –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞"},[...e[11]||(e[11]=[n("span",{class:"icon"},"üìà",-1),n("span",null,"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1)])]),n("button",{onClick:e[5]||(e[5]=(...h)=>t.navigateToTimeTracking&&t.navigateToTimeTracking(...h)),class:"btn-navigate-time-tracking",title:"–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç–∞–º –Ω–∞ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞"},[...e[12]||(e[12]=[n("span",{class:"icon"},"‚è±",-1),n("span",null,"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã",-1)])])])]),K(Ce,{name:"preloader-fade"},{default:ce(()=>[t.isLoading||t.error||t.currentStep?(c(),q(r,{key:0,"current-step":t.currentStep,progress:t.progress,"step-details":t.stepDetails,error:t.error||null,onRetry:t.handleRetry},null,8,["current-step","progress","step-details","error","onRetry"])):y("",!0)]),_:1}),K(Ce,{name:"dashboard-fade"},{default:ce(()=>[!t.isLoading&&!t.error&&!t.currentStep?(c(),d("div",dr,[n("div",ur,[(c(!0),d(U,null,F(t.stages,h=>(c(),q(g,{key:h.id,stage:h,"zero-point-tickets":t.zeroPointTickets[h.id]||[],onTicketMoved:t.handleTicketDrop,onTicketAssigned:t.assignTicketToEmployee},null,8,["stage","zero-point-tickets","onTicketMoved","onTicketAssigned"]))),128))])])):y("",!0)]),_:1}),K(a,{variant:"floating"}),K(f,{"show-control":t.showLoggerControl},null,8,["show-control"]),K(m,{"is-enabled":t.isDiagnosticsEnabled,"is-user-admin":t.isUserAdmin},null,8,["is-enabled","is-user-admin"])],2)}const mr=H(Ut,[["render",gr],["__scopeId","data-v-11e84363"]]),wo=Object.freeze(Object.defineProperty({__proto__:null,default:mr},Symbol.toStringTag,{value:"Module"})),fr={name:"ModuleAdapter",props:{moduleConfig:{type:Object,required:!0,validator:s=>s.id&&s.title&&s.component},sectorId:{type:String,required:!0},isCompact:{type:Boolean,default:!0}},emits:["module-ready","module-error","module-navigate"],setup(s,{emit:e}){const o=Ie(),t=w(!1),i=w(null),l=w(null),a=w(null),r=_(()=>{const v={isCompact:s.isCompact,sectorId:s.sectorId,moduleId:s.moduleConfig.id};switch(s.moduleConfig.component){case"SectorDashboard":return{sectorId:s.sectorId};case"DashboardSector1C":return{...v,showBreadcrumbs:!1,compactMode:!0};case"GraphStateDashboard":return{...v,showBreadcrumbs:!1,compactMode:!0,autoLoad:!1};case"TicketsTimeTrackingDashboard":return{...v,showBreadcrumbs:!1,compactMode:!0};case"GraphAdmissionClosureDashboard":return{...v,showBreadcrumbs:!1,compactMode:!0};default:return v}}),g=async()=>{try{t.value=!0,i.value=null,l.value="div",console.log(`[ModuleAdapter] Loading module ${s.moduleConfig.id} for sector ${s.sectorId} - using placeholder`),e("module-ready",{moduleId:s.moduleConfig.id,sectorId:s.sectorId})}catch(v){console.error(`Failed to load module ${s.moduleConfig.id}:`,v),i.value=v.message,e("module-error",{moduleId:s.moduleConfig.id,sectorId:s.sectorId,error:v})}finally{t.value=!1}},f=()=>{s.moduleConfig.route?o.push(s.moduleConfig.route):console.warn(`No route defined for module ${s.moduleConfig.id}`)},m=()=>{g()},h=v=>{e("module-navigate",{type:"ready",moduleId:s.moduleConfig.id,sectorId:s.sectorId,data:v})},b=v=>{e("module-navigate",{type:"error",moduleId:s.moduleConfig.id,sectorId:s.sectorId,error:v})},p=v=>{e("module-navigate",{type:"navigate",moduleId:s.moduleConfig.id,sectorId:s.sectorId,navigation:v})};return ae(()=>{g()}),{isLoading:t,error:i,moduleComponent:l,moduleInstance:a,moduleProps:r,openFullView:f,retryLoad:m,onModuleReady:h,onModuleError:b,onModuleNavigate:p}}},hr={class:"module-header"},vr={class:"module-icon"},yr={class:"module-info"},pr={class:"module-actions"},_r=["aria-label"],br={class:"module-content"},kr={key:0,class:"module-loading"},Cr={key:1,class:"module-error"},Sr={key:2,class:"module-body"},wr={class:"module-placeholder"},Tr={class:"placeholder-icon"};function Er(s,e,o,t,i,l){return c(),d("div",{class:N(["sector-module-adapter",`module-${o.moduleConfig.id}`])},[n("div",hr,[n("div",vr,u(o.moduleConfig.icon),1),n("div",yr,[n("h3",null,u(o.moduleConfig.title),1),n("p",null,u(o.moduleConfig.description),1)]),n("div",pr,[n("button",{onClick:e[0]||(e[0]=(...a)=>t.openFullView&&t.openFullView(...a)),class:"btn-module-fullscreen",title:"–û—Ç–∫—Ä—ã—Ç—å –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ","aria-label":`–û—Ç–∫—Ä—ã—Ç—å ${o.moduleConfig.title} –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ`}," ‚õ∂ ",8,_r)])]),n("div",br,[t.isLoading?(c(),d("div",kr,[e[3]||(e[3]=n("div",{class:"loading-spinner"},null,-1)),n("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ "+u(o.moduleConfig.title)+"...",1)])):t.error?(c(),d("div",Cr,[e[4]||(e[4]=n("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),e[5]||(e[5]=n("p",null,"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è",-1)),n("button",{onClick:e[1]||(e[1]=(...a)=>t.retryLoad&&t.retryLoad(...a)),class:"btn-retry"},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):(c(),d("div",Sr,[n("div",wr,[n("div",Tr,u(o.moduleConfig.icon),1),n("h4",null,u(o.moduleConfig.title),1),n("p",null,u(o.moduleConfig.description),1),e[6]||(e[6]=n("div",{class:"placeholder-status"},[n("span",{class:"status-badge"},"–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"),n("small",null,"–ú–æ–¥—É–ª—å –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏")],-1)),n("button",{onClick:e[2]||(e[2]=(...a)=>t.openFullView&&t.openFullView(...a)),class:"btn-open-full"}," –û—Ç–∫—Ä—ã—Ç—å –≤ –ø–æ–ª–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ ")])]))])],2)}const xr=H(fr,[["render",Er],["__scopeId","data-v-a553ba00"]]),Ar={name:"SectorContainer",components:{ModuleAdapter:xr},props:{sectorConfig:{type:Object,required:!0,validator:s=>s.id&&s.name&&s.icon}},emits:["module-ready","module-error","module-event","sector-expanded","sector-collapsed"],setup(s,{emit:e}){Ie();const o=w(!1),t=w(!1),i=w([]),l=_(()=>s.sectorConfig.modules&&s.sectorConfig.modules.length>0),a=_(()=>!1);ae(async()=>{l.value&&await r()});const r=async()=>{t.value=!0;try{i.value=s.sectorConfig.modules||[],e("module-ready",{sectorId:s.sectorConfig.id,modulesCount:i.value.length})}catch(p){console.error(`Failed to load modules for sector ${s.sectorConfig.id}:`,p),e("module-error",{sectorId:s.sectorConfig.id,error:p.message})}finally{t.value=!1}};return{expanded:o,loading:t,sectorModules:i,hasModules:l,canNavigateToDashboard:a,toggleExpanded:()=>{o.value=!o.value,o.value?e("sector-expanded",{sectorId:s.sectorConfig.id}):e("sector-collapsed",{sectorId:s.sectorConfig.id})},onModuleReady:p=>{e("module-ready",{sectorId:s.sectorConfig.id,moduleId:p.moduleId,data:p})},onModuleError:p=>{e("module-error",{sectorId:s.sectorConfig.id,moduleId:p.moduleId,error:p.error})},onModuleNavigate:p=>{e("module-event",{sectorId:s.sectorConfig.id,moduleId:p.moduleId,event:p})},navigateToSectorDashboard:()=>{console.log(`Navigate to dashboard for sector: ${s.sectorConfig.id}`)}}}},Dr={class:"sector-header"},Ir={class:"sector-header-left"},Mr={class:"sector-icon"},Lr={class:"sector-title"},Pr={class:"sector-actions"},Nr={key:0,class:"sector-content"},Or={key:0,class:"sector-loading"},Br={key:1,class:"sector-modules-grid"},Rr={key:2,class:"no-modules"},Ur={key:3,class:"sector-dashboard-link"};function Fr(s,e,o,t,i,l){const a=W("ModuleAdapter");return c(),d("div",{class:N(["sector-container",`sector-${o.sectorConfig.id}`])},[n("div",Dr,[n("div",Ir,[n("div",Mr,u(o.sectorConfig.icon),1),n("div",Lr,[n("h2",null,u(o.sectorConfig.name),1),n("p",null,u(o.sectorConfig.description),1)])]),n("div",Pr,[n("button",{onClick:e[0]||(e[0]=(...r)=>t.toggleExpanded&&t.toggleExpanded(...r)),class:"btn-toggle-sector"},u(t.expanded?"–°–≤–µ—Ä–Ω—É—Ç—å":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å"),1)])]),t.expanded?(c(),d("div",Nr,[t.loading?(c(),d("div",Or,[e[3]||(e[3]=n("div",{class:"loading-spinner"},null,-1)),n("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å–µ–∫—Ç–æ—Ä–∞ "+u(o.sectorConfig.name)+"...",1)])):t.sectorModules.length>0?(c(),d("div",Br,[(c(!0),d(U,null,F(t.sectorModules,r=>(c(),q(a,{key:r.id,"module-config":r,"sector-id":o.sectorConfig.id,"is-compact":!0,onModuleReady:t.onModuleReady,onModuleError:t.onModuleError,onModuleNavigate:t.onModuleNavigate},null,8,["module-config","sector-id","onModuleReady","onModuleError","onModuleNavigate"]))),128))])):(c(),d("div",Rr,[n("p",null,'–ú–æ–¥—É–ª–∏ –¥–ª—è —Å–µ–∫—Ç–æ—Ä–∞ "'+u(o.sectorConfig.name)+'" –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ',1),t.canNavigateToDashboard?(c(),d("button",{key:0,onClick:e[1]||(e[1]=(...r)=>t.navigateToSectorDashboard&&t.navigateToSectorDashboard(...r)),class:"btn-sector-dashboard"},[...e[4]||(e[4]=[n("span",{class:"icon"},"üìä",-1),X(" –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ ",-1)])])):y("",!0)])),t.sectorModules.length>0&&t.canNavigateToDashboard?(c(),d("div",Ur,[n("button",{onClick:e[2]||(e[2]=(...r)=>t.navigateToSectorDashboard&&t.navigateToSectorDashboard(...r)),class:"btn-sector-dashboard"},[...e[5]||(e[5]=[n("span",{class:"icon"},"üìä",-1),X(" –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ ",-1)])])])):y("",!0)])):y("",!0)],2)}const Vr=H(Ar,[["render",Fr],["__scopeId","data-v-0fa90bab"]]);class ut{static async logAppEntry(e,o=null){if(!e||!e.ID)return console.warn("[ActivityLoggingService] Invalid user object for app entry logging"),!1;const t={timestamp:new Date().toISOString(),type:"app_entry",user_id:e.ID,user_name:this.getUserName(e),user_email:e.EMAIL||null,ip:o||this.getClientIp(),user_agent:navigator.userAgent,session_id:this.getSessionId()};return await this.saveLog(t)}static async logPageVisit(e,o,t=null){if(!o||!o.ID)return console.warn("[ActivityLoggingService] Invalid user object for page visit logging"),!1;if(!e||!e.path)return console.warn("[ActivityLoggingService] Invalid route object for page visit logging"),!1;const i={timestamp:new Date().toISOString(),type:"page_visit",user_id:o.ID,user_name:this.getUserName(o),route_path:e.path,route_name:e.name||null,route_title:e.meta?.title||null,from_path:t?.path||null,from_name:t?.name||null,session_id:this.getSessionId()};return await this.saveLog(i)}static async saveLog(e){try{const o=Ee("/api/user-activity-log.php"),t=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(e),signal:AbortSignal.timeout(5e3)});if(!t.ok){const l=await t.text();return console.error("[ActivityLoggingService] Failed to save log:",{status:t.status,statusText:t.statusText,error:l}),!1}const i=await t.json();return i.success?!0:(console.error("[ActivityLoggingService] API returned error:",i.error),!1)}catch(o){return o.name==="AbortError"?console.warn("[ActivityLoggingService] Request timeout (activity logging skipped)"):console.error("[ActivityLoggingService] Error saving log:",o),!1}}static getSessionId(){const e="activity_session_id";if(sessionStorage.getItem(e))return sessionStorage.getItem(e);const o=this.generateSessionId();return sessionStorage.setItem(e,o),o}static generateSessionId(){const e=Date.now(),o=Math.random().toString(36).substring(2,11);return`${e}-${o}`}static getUserName(e){const o=e.NAME||"",t=e.LAST_NAME||"";return`${o} ${t}`.trim()||e.EMAIL||`User #${e.ID}`}static getClientIp(){return null}static isAppEntryLogged(){return sessionStorage.getItem("app_entry_logged")==="true"}static markAppEntryLogged(){sessionStorage.setItem("app_entry_logged","true")}}const jr={reports:[{id:1,title:"–û—Ç—á—ë—Ç –ø–æ —Ç–∏–∫–µ—Ç–∞–º",icon:"üìä",route:"/reports/tickets",description:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–∫–µ—Ç–∞–º –∏ –æ–±—Ä–∞—â–µ–Ω–∏—è–º",active:!1},{id:2,title:"–û—Ç—á—ë—Ç –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏",icon:"üìà",route:"/reports/performance",description:"–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –æ—Ç–¥–µ–ª–∞",active:!1},{id:3,title:"–û—Ç—á—ë—Ç –ø–æ —Å—Ä–æ–∫–∞–º",icon:"üìâ",route:"/reports/deadlines",description:"–ê–Ω–∞–ª–∏–∑ —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Å—Ä–æ–∫–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á",active:!1},{id:4,title:"–°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç",icon:"üìã",route:"/reports/summary",description:"–û–±—â–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è–º",active:!1},{id:5,title:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",icon:"üìã",route:"/dashboard/sector-1c",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",active:!0},{id:6,title:"–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è",icon:"üìä",route:"/dashboard/graph-state",description:"–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞ 1–° –≤–æ –≤—Ä–µ–º–µ–Ω–∏",active:!0,category:"analytics",order:6},{id:7,title:"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞/–∑–∞–∫—Ä—ã—Ç–∏–π 1–°",icon:"üìà",route:"/dashboard/graph-admission-closure",description:"–ù–µ–¥–µ–ª—å–Ω—ã–µ –Ω–æ–≤—ã–µ –∏ –∑–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ 1–°",active:!0,category:"analytics",order:7},{id:8,title:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –¢–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ 1–°",icon:"‚è±",route:"/dashboard/tickets-time-tracking",description:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–° –ø–æ –Ω–µ–¥–µ–ª—è–º",active:!0,category:"analytics",order:8}]};function zr(){return jr.reports.filter(s=>s.active===!0)}const Hr={adminInterfaces:[{id:1,title:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",icon:"üë•",route:"/admin/users",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é"},{id:2,title:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã",icon:"‚öôÔ∏è",route:"/admin/settings",description:"–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"},{id:3,title:"–õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤",icon:"üìã",route:"/admin/webhook-logs",description:"–ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –≤–µ–±—Ö—É–∫–æ–≤"},{id:4,title:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è",icon:"üìä",route:"/admin/usage-stats",description:"–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"},{id:5,title:"–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º",icon:"üóëÔ∏è",route:"/admin/cache",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º –º–æ–¥—É–ª–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"}]};function Wr(){return[...Hr.adminInterfaces]}const tt={sector1c:{id:"1c",name:"–°–µ–∫—Ç–æ—Ä 1–°",description:"–ú–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ 1–°:–ü—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ",icon:"‚öôÔ∏è",color:"#007bff",borderColor:"#0056b3",backgroundColor:"#f8f9fa",filterValue:"1C",modules:[{id:"dashboard-sector-1c",title:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",description:"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–æ–º 1–° —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏",icon:"‚öôÔ∏è",component:"SectorDashboard",route:"/dashboard/sector-1c",category:"management"},{id:"tickets-management-sector-1c",title:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞–º–∏ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –∏ –∑–∞–¥–∞—á–∞–º–∏ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",icon:"üìã",component:"TicketsTimeTrackingDashboard",route:"/tickets/time-tracking",category:"tickets"},{id:"state-chart",title:"–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è",description:"–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º —Å–µ–∫—Ç–æ—Ä–∞ 1–°",icon:"üìä",component:"GraphStateDashboard",route:"/graph/state",category:"analytics"},{id:"changes-visualization",title:"–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç",description:"–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ —Å–µ–∫—Ç–æ—Ä–µ 1–°",icon:"üìà",component:"GraphAdmissionClosureDashboard",route:"/graph/admission-closure",category:"analytics"}],features:["smart-process-140","1c-integration"],order:1},sectorPdm:{id:"pdm",name:"–°–µ–∫—Ç–æ—Ä PDM",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–∞–º–∏ PDM (Product Data Management)",icon:"üîß",color:"#28a745",borderColor:"#1e7e34",backgroundColor:"#f8fff8",filterValue:"PDM",modules:[{id:"dashboard-sector-pdm",title:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ PDM",description:"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–æ–º PDM —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏",icon:"üîß",component:"SectorDashboard",route:"/dashboard/sector-pdm",category:"management"}],features:["pdm-integration"],order:2},sectorBitrix24:{id:"bitrix24",name:"–°–µ–∫—Ç–æ—Ä –ë–∏—Ç—Ä–∏–∫—Å24",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ë–∏—Ç—Ä–∏–∫—Å24",icon:"üåê",color:"#ffc107",borderColor:"#d39e00",backgroundColor:"#fffef8",filterValue:"Bitrix24",modules:[{id:"dashboard-sector-bitrix24",title:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ –ë–∏—Ç—Ä–∏–∫—Å24",description:"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–æ–º –ë–∏—Ç—Ä–∏–∫—Å24 —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏",icon:"üåê",component:"SectorDashboard",route:"/dashboard/sector-bitrix24",category:"management"}],features:["bitrix24-integration"],order:3},sectorInfrastructure:{id:"infrastructure",name:"–°–µ–∫—Ç–æ—Ä –ñ–µ–ª–µ–∑–æ/–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞",description:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –∏ –ø—Ä–æ—á–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏",icon:"üñ•Ô∏è",color:"#dc3545",borderColor:"#bd2130",backgroundColor:"#fff8f8",filterValues:["–ñ–µ–ª–µ–∑–æ","–ü—Ä–æ—á–µ–µ"],modules:[{id:"dashboard-sector-infrastructure",title:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞",description:"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–æ–º –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏",icon:"üñ•Ô∏è",component:"SectorDashboard",route:"/dashboard/sector-infrastructure",category:"management"}],features:["infrastructure-management"],order:4}};class $r{static getAllSectors(){return Object.values(tt).sort((e,o)=>(e.order||0)-(o.order||0))}static getSectorById(e){return tt[e]||null}static getSectorsWithModules(){return this.getAllSectors().filter(e=>e.modules&&e.modules.length>0)}static getSectorColors(){const e={};return Object.values(tt).forEach(o=>{e[o.id]=o.color}),e}static sectorExists(e){return!!tt[e]}static getNextOrder(){return Math.max(...Object.values(tt).map(o=>o.order||0))+1}}const qr={name:"IndexPage",components:{StatusMessage:uo,LoadingSpinner:go,SectorContainer:Vr},beforeCreate(){console.log("[IndexPage] beforeCreate() called")},created(){console.log("[IndexPage] created() called")},beforeMount(){console.log("[IndexPage] beforeMount() called")},setup(){console.log("[IndexPage] setup() called");const s=Ie(),e=w(!0),o=w(null),t=w(!1),i=w(!1),l=w(""),a=w(null),r=w(null),g=w(!1);console.log("[IndexPage] Initial state:",{loading:e.value,accessAllowed:t.value,accessDenied:i.value});const f=w(zr()),m=w($r.getAllSectors()),h=w(!1),b=w(Wr()),p=_(()=>a.value?bt(a.value):!1),v=_(()=>{if(!a.value)return"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å";const P=a.value.FIRST_NAME?a.value.FIRST_NAME.trim():"",R=a.value.LAST_NAME?a.value.LAST_NAME.trim():"",j=a.value.NAME?a.value.NAME.trim():"";return P&&R?`${P} ${R}`:j&&R&&j!==R?`${j} ${R}`:P&&j&&P!==j?`${P} ${j}`:j&&j.includes(" ")?j:P||R||j||`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å #${a.value.ID}`}),S=_(()=>o.value?o.value.includes("no_install_app")?"–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ":"–û—à–∏–±–∫–∞ API":null),D=_(()=>o.value?o.value.includes("no_install_app")?"–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ Bitrix24. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É.":o.value:null),C=_(()=>o.value&&o.value.includes("no_install_app")),M=_(()=>lo("/install.php"));ae(async()=>{console.log("[IndexPage] onMounted() called");try{console.log("[IndexPage] Calling AccessControlService.checkAccess()...");const P=await Ne.checkAccess();if(console.log("[IndexPage] Access result:",{allowed:P.allowed,hasUser:!!P.user,user:P.user,errorCode:P.errorCode,errorMessage:P.errorMessage}),P.allowed){if(console.log("[IndexPage] Setting accessAllowed to true"),t.value=!0,a.value=P.user,console.log("[IndexPage] Access allowed, setting state:",{accessAllowed:t.value,hasUser:!!a.value,loading:e.value,accessDenied:i.value}),!ut.isAppEntryLogged())try{P.user&&await ut.logAppEntry(P.user)&&ut.markAppEntryLogged()}catch(R){console.error("[IndexPage] Error logging app entry:",R)}}else{i.value=!0;const R=Ge(),j=!R&&P.errorCode===ke.ACCESS_DENIED&&P.errorMessage&&P.errorMessage.includes("–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø");if(console.log("IndexPage - accessResult:",{errorCode:P.errorCode,errorMessage:P.errorMessage,isInsideB24:R,isDirectAccessDeniedCheck:j}),g.value=j,j&&(l.value=P.errorMessage,console.log("IndexPage - Set direct access denied message:",P.errorMessage)),console.log("IndexPage - State after check:",{accessDenied:i.value,isDirectAccessDenied:g.value,accessErrorMessage:l.value}),!j){if(P.user){const{getAllowedDepartmentIds:G}=await me(async()=>{const{getAllowedDepartmentIds:ve}=await import("./access-config-async-DMhbbcMt.js");return{getAllowedDepartmentIds:ve}},__vite__mapDeps([3,4,1,5,2,6,7]),import.meta.url);r.value={userId:P.user.ID,departmentIds:P.user.UF_DEPARTMENT||[],allowedIds:G()}}P.errorCode===ke.USER_NOT_DETERMINED?l.value="–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª.":P.errorCode===ke.ACCESS_DENIED?l.value="–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω":l.value=P.errorMessage||"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–æ—Å—Ç—É–ø–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ü–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –ò–¢ –æ—Ç–¥–µ–ª."}}}catch(P){o.value=P.message,console.error("Error checking access:",P)}finally{e.value=!1,console.log("[IndexPage] Final state:",{loading:e.value,accessAllowed:t.value,accessDenied:i.value,hasUser:!!a.value,error:o.value})}});const I=P=>{if(!P){console.error("Route is not defined for report");return}s.push(P)},V=()=>{h.value=!0},O=()=>{h.value=!1};return{loading:e,error:o,accessAllowed:t,accessDenied:i,accessErrorMessage:l,currentUser:a,userName:v,debugInfo:r,isDirectAccessDenied:g,errorTitle:S,errorMessage:D,showInstallLink:C,installPageUrl:M,reportsButtons:f,navigateToReport:I,sectors:m,handleModuleEvent:P=>{console.log("Module event:",P)},handleSectorExpanded:P=>{console.log("Sector expanded:",P.sectorId)},handleSectorCollapsed:P=>{console.log("Sector collapsed:",P.sectorId)},isAdmin:p,showAdminPopup:h,adminButtons:b,openAdminPopup:V,closeAdminPopup:O,navigateToAdmin:P=>{if(!P){console.error("Route is not defined for admin interface");return}s.push(P),O()}}}},Kr={class:"index-page"},Xr={class:"container"},Gr={key:0,class:"install-link"},Jr=["href"],Yr={key:0,class:"direct-access-denied-info",style:{"margin-top":"15px",padding:"15px",background:"#fff3cd",border:"1px solid #ffc107","border-radius":"4px"}},Zr={key:1,class:"debug-info",style:{"margin-top":"15px",padding:"10px",background:"#fff3cd",border:"1px solid #ffc107","border-radius":"4px","font-size":"12px"}},Qr={key:3,class:"main-content"},el={class:"greeting-section"},tl={class:"greeting-header"},ol={class:"greeting-header-content"},sl={class:"greeting-text"},nl={class:"sectors-section"},al={class:"admin-popup-header"},il={class:"admin-popup-content"},rl={class:"admin-buttons-grid"},ll=["onClick"],cl={class:"admin-icon"},dl={class:"admin-title"},ul={key:0,class:"admin-description"};function gl(s,e,o,t,i,l){const a=W("StatusMessage"),r=W("LoadingSpinner"),g=W("SectorContainer");return c(),d("div",Kr,[n("div",Xr,[t.error?(c(),q(a,{key:0,type:"error",title:t.errorTitle,message:t.errorMessage},{default:ce(()=>[t.showInstallLink?(c(),d("div",Gr,[n("a",{href:t.installPageUrl},"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ",8,Jr)])):y("",!0)]),_:1},8,["title","message"])):y("",!0),t.loading?(c(),q(r,{key:1,message:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞..."})):y("",!0),!t.loading&&t.accessDenied?(c(),q(a,{key:2,type:"error",title:"–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω",message:t.accessErrorMessage},{default:ce(()=>[t.isDirectAccessDenied?(c(),d("div",Yr,[...e[4]||(e[4]=[n("p",{style:{margin:"0 0 10px 0","font-weight":"600",color:"#856404"}},[n("strong",null,"–ö–∞–∫ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:")],-1),n("ol",{style:{margin:"0","padding-left":"20px",color:"#856404"}},[n("li",null,"–í–æ–π–¥–∏—Ç–µ –≤ Bitrix24"),n("li",null,"–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Bitrix24 (placement, –≤–∏–¥–∂–µ—Ç –∏–ª–∏ –≤–∫–ª–∞–¥–∫—É)")],-1)])])):t.debugInfo?(c(),d("div",Zr,[e[5]||(e[5]=n("strong",null,"–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:",-1)),e[6]||(e[6]=n("br",null,null,-1)),X(" ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "+u(t.debugInfo.userId),1),e[7]||(e[7]=n("br",null,null,-1)),X(" ID –æ—Ç–¥–µ–ª–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "+u(t.debugInfo.departmentIds),1),e[8]||(e[8]=n("br",null,null,-1)),X(" –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ ID –æ—Ç–¥–µ–ª–æ–≤: "+u(t.debugInfo.allowedIds),1),e[9]||(e[9]=n("br",null,null,-1)),e[10]||(e[10]=n("small",{style:{color:"#856404"}},"–î–æ–±–∞–≤—å—Ç–µ ID –æ—Ç–¥–µ–ª–∞ –≤ —Ñ–∞–π–ª vue-app/src/config/access-config.js",-1))])):y("",!0)]),_:1},8,["message"])):y("",!0),!t.loading&&!t.accessDenied&&t.accessAllowed?(c(),d("div",Qr,[n("div",el,[n("div",tl,[n("div",ol,[e[13]||(e[13]=n("h2",{class:"greeting-title"},"–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ –ò–¢ –æ—Ç–¥–µ–ª–∞ –¥–ª—è –ü–ª–∞–Ω–µ—Ä–∫–∏ –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ü–∏–∏",-1)),n("p",sl,[e[11]||(e[11]=X(" –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ",-1)),n("strong",null,u(t.userName),1),e[12]||(e[12]=X("! ",-1))])]),t.isAdmin?(c(),d("button",{key:0,class:"admin-button-header",onClick:e[0]||(e[0]=(...f)=>t.openAdminPopup&&t.openAdminPopup(...f)),title:"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ"}," ‚öôÔ∏è ")):y("",!0)])]),n("div",nl,[(c(!0),d(U,null,F(t.sectors,f=>(c(),q(g,{key:f.id,"sector-config":f,onModuleEvent:t.handleModuleEvent,onSectorExpanded:t.handleSectorExpanded,onSectorCollapsed:t.handleSectorCollapsed},null,8,["sector-config","onModuleEvent","onSectorExpanded","onSectorCollapsed"]))),128))]),t.showAdminPopup&&t.isAdmin?(c(),d("div",{key:0,class:"admin-popup-overlay",onClick:e[3]||(e[3]=(...f)=>t.closeAdminPopup&&t.closeAdminPopup(...f))},[n("div",{class:"admin-popup",onClick:e[2]||(e[2]=de(()=>{},["stop"]))},[n("div",al,[e[14]||(e[14]=n("h3",{class:"admin-popup-title"},"‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ",-1)),n("button",{class:"admin-popup-close",onClick:e[1]||(e[1]=(...f)=>t.closeAdminPopup&&t.closeAdminPopup(...f))}," ‚úï ")]),n("div",il,[n("div",rl,[(c(!0),d(U,null,F(t.adminButtons,f=>(c(),d("div",{key:f.id,class:"admin-interface-button",onClick:m=>t.navigateToAdmin(f.route)},[n("div",cl,u(f.icon),1),n("div",dl,u(f.title),1),f.description?(c(),d("div",ul,u(f.description),1)):y("",!0)],8,ll))),128))])])])])):y("",!0)])):y("",!0)])])}const ml=H(qr,[["render",gl],["__scopeId","data-v-12137466"]]),he=w(new Map),_e=w({hits:0,misses:0,sets:0,invalidations:0}),It={defaultTTL:5*60*1e3,maxSize:100,enableStats:!0};function fl(s={}){const{ttl:e=It.defaultTTL,maxSize:o=It.maxSize,enableStats:t=It.enableStats}=s,i=D=>{const C=new WeakSet;return JSON.stringify(D,(M,I)=>{if(typeof I=="object"&&I!==null){if(C.has(I))return"[Circular]";C.add(I)}return typeof I=="function"||I===void 0?null:I})},l=(D,C={})=>{const M=Object.keys(C).sort().reduce((I,V)=>{const O=C[V];if(O==null)I[V]=null;else if(typeof O=="object")try{I[V]=i(O)}catch{I[V]=String(O)}else I[V]=O;return I},{});try{return`${D}_${i(M)}`}catch{const V=Object.keys(M).sort().map(O=>`${O}=${M[O]}`).join("&");return`${D}_${V}`}},a=D=>{const C=he.value.get(D);return C?Date.now()-C.timestamp>C.ttl?(he.value.delete(D),t&&_e.value.misses++,null):(C.lastAccessed=Date.now(),t&&_e.value.hits++,C.data):(t&&_e.value.misses++,null)},r=(D,C,M=null)=>{he.value.size>=o&&g(),he.value.set(D,{data:C,timestamp:Date.now(),lastAccessed:Date.now(),ttl:M||e}),t&&_e.value.sets++},g=()=>{let D=null,C=1/0;for(const[M,I]of he.value.entries())I.lastAccessed<C&&(C=I.lastAccessed,D=M);D&&he.value.delete(D)},f=()=>{he.value.clear(),t&&(_e.value={hits:0,misses:0,sets:0,invalidations:0})},m=D=>{const C=typeof D=="string"?new RegExp(D):D;let M=0;for(const I of he.value.keys())C.test(I)&&(he.value.delete(I),M++);return t&&(_e.value.invalidations+=M),M},h=()=>{const D=Date.now();let C=0;for(const[M,I]of he.value.entries())D-I.timestamp>I.ttl&&(he.value.delete(M),C++);return C},b=()=>{const D=_e.value.hits+_e.value.misses,C=D>0?(_e.value.hits/D*100).toFixed(2):0;return{..._e.value,size:he.value.size,hitRate:`${C}%`}};let p=null;const v=(D=5*60*1e3)=>{p&&clearInterval(p),p=setInterval(()=>{h()},D)},S=()=>{p&&(clearInterval(p),p=null)};return v(),{get:a,set:r,clear:f,invalidate:m,cleanup:h,getCacheKey:l,getStats:b,startAutoCleanup:v,stopAutoCleanup:S}}function De(s){if(!s||typeof s!="object"||!s.timestamp||typeof s.timestamp!="string"||!s.event||typeof s.event!="string"||!s.category||typeof s.category!="string"||!["tasks","smart-processes","errors"].includes(s.category))return!1;try{new Date(s.timestamp)}catch{return!1}return!0}function hl(s){if(!s||typeof s!="object")return!1;for(const[e,o]of Object.entries(s))if(typeof o=="function")return!1;return!0}function Ye(s){if(!De(s))return null;const e={timestamp:s.timestamp,event:s.event,category:s.category};return s.ip&&typeof s.ip=="string"&&(e.ip=s.ip),s.payload&&typeof s.payload=="object"&&(e.payload=s.payload),s.details&&hl(s.details)&&(e.details=s.details),e}function Ft(s){return Array.isArray(s)?s.map(e=>Ye(e)).filter(e=>e!==null):[]}const{get:vl,set:yl,getCacheKey:pl,invalidate:oo}=fl({ttl:2*60*1e3,maxSize:50});class so{static getBaseUrl(){return Ee("/api/webhook-logs.php")}static get BASE_URL(){return this.getBaseUrl()}static async getLogs(e={},o=1,t=50,i=!1){if(o<1)throw new Error("Page must be greater than 0");if(t<1||t>1e3)throw new Error("Limit must be between 1 and 1000");const l={category:e.category||null,event:e.event||null,date:e.date||null,hour:e.hour!==void 0?e.hour:null,dateFrom:e.dateFrom||null,dateTo:e.dateTo||null,ip:e.ip||null,status:e.status||null},a=this.getBaseUrl(),r=pl(a,{filters:l,page:o,limit:t});if(!i){const f=vl(r);if(f)return console.log("[WebhookLogsApiService] Cache hit:",r.substring(0,50)+"..."),f}console.log("[WebhookLogsApiService] Cache miss:",r.substring(0,50)+"...");const g=new URLSearchParams({page:o.toString(),limit:t.toString()});l.category&&g.append("category",l.category),l.event&&g.append("event",l.event),l.date&&g.append("date",l.date),l.hour!==null&&g.append("hour",l.hour.toString()),l.dateFrom&&g.append("dateFrom",l.dateFrom),l.dateTo&&g.append("dateTo",l.dateTo),l.ip&&g.append("ip",l.ip),l.status&&g.append("status",l.status);try{const f=this.getBaseUrl(),m=await fetch(`${f}?${g.toString()}`);if(!m.ok){const v=await m.text();let S;try{S=JSON.parse(v)}catch{S={error:v}}throw new Error(S.error_description||S.error||`HTTP error! status: ${m.status}`)}const h=await m.json();if(console.log("[WebhookLogsApiService] API response:",{success:h.success,logsCount:h.logs?.length||0,pagination:h.pagination,hasError:!!h.error}),h.error)throw new Error(h.error_description||h.error);if(!h.success)throw console.warn("[WebhookLogsApiService] API returned success=false:",h),new Error("API request failed");if(!Array.isArray(h.logs))throw console.error("[WebhookLogsApiService] Invalid logs format:",h.logs),new Error("Invalid logs format: expected array");const b=Ft(h.logs);(!h.pagination||typeof h.pagination!="object")&&(console.warn("[WebhookLogsApiService] Invalid pagination format:",h.pagination),h.pagination={page:o,limit:t,total:b.length,pages:Math.ceil(b.length/t)});const p={success:!0,logs:b,pagination:{page:h.pagination.page||o,limit:h.pagination.limit||t,total:h.pagination.total||b.length,pages:h.pagination.pages||Math.ceil((h.pagination.total||b.length)/t)}};return yl(r,p),p}catch(f){throw console.error("[WebhookLogsApiService] Error:",f),f}}static invalidateCacheOnFilterChange(e={},o={}){const t=oo(/^\/api\/webhook-logs\.php/);console.log(`[WebhookLogsApiService] Invalidated ${t} entries on filter change`)}static clearCache(){const e=oo(/^\/api\/webhook-logs\.php/);console.log(`[WebhookLogsApiService] Cleared ${e} entries`)}static async getLogDetails(e,o=null){const t={};return o&&(t.date=o),(await this.getLogs(t,1,1e3)).logs.find(a=>`${a.timestamp}_${a.event}`===e)||null}static async getErrors(e={},o=1,t=50){return this.getLogs({...e,category:"errors"},o,t)}static async getStats(e={}){const o=await this.getLogs(e,1,1e3),t={total:o.pagination.total||o.logs.length,tasks:0,smartProcesses:0,errors:0,byEvent:{},byDate:{}};return o.logs.forEach(i=>{i.category==="tasks"?t.tasks++:i.category==="smart-processes"?t.smartProcesses++:i.category==="errors"&&t.errors++,t.byEvent[i.event]||(t.byEvent[i.event]=0),t.byEvent[i.event]++;const l=i.timestamp.split("T")[0];t.byDate[l]||(t.byDate[l]=0),t.byDate[l]++}),t}}function _l(){const s=Nt(),e=Ie(),o=new Date().toISOString().split("T")[0],t=w({category:null,event:null,dateFrom:o,dateTo:null,hour:null,ip:null,search:null,status:null}),i=()=>{const f=s.query;t.value={category:f.category||null,event:f.event||null,dateFrom:f.dateFrom||f.date||o,dateTo:f.dateTo||null,hour:f.hour?parseInt(f.hour):null,ip:f.ip||null,search:f.search||null,status:f.status||null}},l=f=>{if(g)return;const m={...s.query};Object.keys(f).forEach(b=>{const p=f[b];p!==null&&p!==""&&p!==void 0?m[b]=p.toString():delete m[b]}),JSON.stringify(m)!==JSON.stringify(s.query)&&(g=!0,e.replace({path:s.path,query:m}).finally(()=>{setTimeout(()=>{g=!1},100)}))},a=f=>{const m={...t.value,...f};JSON.stringify(t.value)!==JSON.stringify(m)&&(t.value=m,l(t.value))},r=()=>{t.value={category:null,event:null,dateFrom:o,dateTo:null,hour:null,ip:null,search:null,status:null},l(t.value)};ae(()=>{i()});let g=!1;return pe(()=>s.query,(f,m)=>{if(g)return;JSON.stringify(f)!==JSON.stringify(m)&&i()},{deep:!0}),{filters:t,updateFilters:a,clearFilters:r,loadFiltersFromUrl:i}}function bl(s,e,o={}){if(!e||!e.trim())return s;const{caseSensitive:t=!1,searchInEvent:i=!0,searchInPayload:l=!0,searchInDetails:a=!0,searchInIp:r=!0,searchInTimestamp:g=!1}=o,f=t?e.trim():e.trim().toLowerCase();return s.filter(m=>{if(i&&m.event&&(t?m.event:m.event.toLowerCase()).includes(f))return!0;if(l&&m.payload)try{const h=JSON.stringify(m.payload);if((t?h:h.toLowerCase()).includes(f))return!0}catch(h){console.warn("Error searching in payload:",h)}if(a&&m.details)try{const h=JSON.stringify(m.details);if((t?h:h.toLowerCase()).includes(f))return!0}catch(h){console.warn("Error searching in details:",h)}return!!(r&&m.ip&&(t?m.ip:m.ip.toLowerCase()).includes(f)||g&&m.timestamp&&(t?m.timestamp:m.timestamp.toLowerCase()).includes(f))})}function Pt(s){if(!s||typeof s!="object"||s.category!==void 0&&s.category!==null&&!["tasks","smart-processes","errors"].includes(s.category)||s.date!==void 0&&s.date!==null&&!/^\d{4}-\d{2}-\d{2}$/.test(s.date))return!1;if(s.hour!==void 0&&s.hour!==null){const e=parseInt(s.hour,10);if(isNaN(e)||e<0||e>23)return!1}return!(s.ip!==void 0&&s.ip!==null&&(typeof s.ip!="string"||s.ip.length===0))}function kl(s){if(!s||typeof s!="object")return!1;const e=parseInt(s.page,10),o=parseInt(s.limit,10),t=parseInt(s.total,10),i=parseInt(s.pages,10);return!(isNaN(e)||e<1||isNaN(o)||o<1||o>1e3||isNaN(t)||t<0||isNaN(i)||i<0)}function no(s){if(s==null)return"";const e=String(s),o=e.replace(/"/g,'""');return e.includes(",")||e.includes(`
`)||e.includes('"')?`"${o}"`:o}function Cl(s){return s==null?"":typeof s=="object"?JSON.stringify(s):String(s)}function Sl(s,e="webhook-logs.csv",o={}){return new Promise((t,i)=>{try{if(!Array.isArray(s)||s.length===0)throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞");const{columns:l=null,onProgress:a=null}=o,r=l||Object.keys(s[0]),f=[r.map(v=>no(v)).join(",")],m=s.length,h=1e3;for(let v=0;v<m;v+=h){const S=s.slice(v,v+h);if(S.forEach(D=>{const C=r.map(M=>{const I=D[M];return no(Cl(I))});f.push(C.join(","))}),a){const D=Math.min(100,Math.round((v+S.length)/m*100));a(D)}}const b="\uFEFF"+f.join(`
`),p=new Blob([b],{type:"text/csv;charset=utf-8;"});To(p,e),a&&a(100),t()}catch(l){i(l)}})}function wl(s,e="webhook-logs.json",o={}){return new Promise((t,i)=>{try{if(!Array.isArray(s)||s.length===0)throw new Error("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞");const{pretty:l=!0,onProgress:a=null}=o,r=l?JSON.stringify(s,null,2):JSON.stringify(s);a&&a(50);const g=new Blob([r],{type:"application/json;charset=utf-8;"});To(g,e),a&&a(100),t()}catch(l){i(l)}})}function To(s,e){const o=URL.createObjectURL(s),t=document.createElement("a");t.href=o,t.download=e,t.style.display="none",document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t),URL.revokeObjectURL(o)},100)}function Tl(s,e={},o=0){const t=new Date().toISOString().split("T")[0],i=new Date().toTimeString().split(" ")[0].replace(/:/g,"-");let l=`webhook-logs_${t}_${i}`;const a=[];return e.category&&a.push(`cat-${e.category}`),e.event&&a.push(`evt-${e.event.substring(0,10)}`),e.dateFrom&&a.push(`from-${e.dateFrom}`),e.dateTo&&a.push(`to-${e.dateTo}`),a.length>0&&(l+=`_${a.join("-")}`),o>0&&(l+=`_${o}records`),`${l}.${s}`}function El(s){const e=[];if(!Array.isArray(s))return e.push("–î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º"),{valid:!1,errors:e,estimatedSize:0};if(s.length===0)return e.push("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞"),{valid:!1,errors:e,estimatedSize:0};const o=JSON.stringify(s).length,t=50*1024*1024;return o>t&&e.push(`–ë–æ–ª—å—à–æ–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö (${Math.round(o/1024/1024)} MB). –≠–∫—Å–ø–æ—Ä—Ç –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è.`),{valid:e.length===0,errors:e,estimatedSize:o}}function Vt(s,e="short"){if(!s)return"‚Äî";try{const o=new Date(s);if(isNaN(o.getTime()))return"Invalid date";switch(e){case"short":return o.toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"});case"long":return o.toLocaleString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});case"relative":return xl(o);default:return o.toLocaleString("ru-RU")}}catch{return"Invalid date"}}function xl(s){const o=new Date-s,t=Math.floor(o/1e3),i=Math.floor(t/60),l=Math.floor(i/60),a=Math.floor(l/24);return t<60?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":i<60?`${i} ${Mt(i,"–º–∏–Ω—É—Ç—É","–º–∏–Ω—É—Ç—ã","–º–∏–Ω—É—Ç")} –Ω–∞–∑–∞–¥`:l<24?`${l} ${Mt(l,"—á–∞—Å","—á–∞—Å–∞","—á–∞—Å–æ–≤")} –Ω–∞–∑–∞–¥`:a<7?`${a} ${Mt(a,"–¥–µ–Ω—å","–¥–Ω—è","–¥–Ω–µ–π")} –Ω–∞–∑–∞–¥`:Vt(s.toISOString(),"short")}function Mt(s,e,o,t){const i=s%10,l=s%100;return i===1&&l!==11?e:i>=2&&i<=4&&(l<10||l>=20)?o:t}function Ze(s){return s?s.replace(/^ON/,"").split(/(?=[A-Z])/).map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):"‚Äî"}function Oe(s){return{tasks:"–ó–∞–¥–∞—á–∏","smart-processes":"–°–º–∞—Ä—Ç-–ø—Ä–æ—Ü–µ—Å—Å—ã",errors:"–û—à–∏–±–∫–∏"}[s]||s}function jt(s){if(!s||typeof s!="object")return"‚Äî";const e=[];if(s.task_id&&e.push(`–ó–∞–¥–∞—á–∞ #${s.task_id}`),s.entity_id&&e.push(`–°—É—â–Ω–æ—Å—Ç—å #${s.entity_id}`),s.task_title&&e.push(`"${s.task_title}"`),s.title&&e.push(`"${s.title}"`),s.comment_text){const o=s.comment_text.length>50?s.comment_text.substring(0,50)+"...":s.comment_text;e.push(`–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${o}`)}return e.length>0?e.join(" ‚Ä¢ "):"‚Äî"}const Al={name:"WebhookLogsExport",props:{logs:{type:Array,default:()=>[]},selectedLogs:{type:Array,default:()=>[]},filters:{type:Object,default:()=>({})},totalCount:{type:Number,default:0}},emits:["export-start","export-complete","export-error"],setup(s,{emit:e}){const o=w(!1),t=w("csv"),i=w("all"),l=w(!0),a=w(!1),r=w(0),g=w([]),f=w(null),m=_(()=>s.selectedLogs.length),h=_(()=>s.logs.length>0||s.totalCount>0),b=_(()=>s.filters.category||s.filters.event||s.filters.dateFrom||s.filters.dateTo),p=_(()=>i.value==="selected"?m.value:s.logs.length||s.totalCount),v=_(()=>i.value==="selected"?m.value>0:h.value),S=()=>{r.value=0,g.value=[],f.value=null,m.value>0?i.value="selected":i.value="all",o.value=!0,C()},D=()=>{a.value||(o.value=!1)},C=()=>{const O=M(),L=El(O);g.value=L.errors,f.value=L.estimatedSize},M=()=>(i.value==="selected"?s.selectedLogs:s.logs).map(k=>Ye(k)).filter(k=>De(k)?!0:(console.warn("[WebhookLogsExport] Skipping invalid log:",k),!1)),I=async()=>{try{a.value=!0,r.value=0;let O=M();if(O.length===0)throw new Error("–ù–µ—Ç –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞");const L=O.map(B=>({timestamp:B.timestamp,event:B.event,category:B.category,ip:B.ip||null,details:B.details||null,payload:B.payload||null,formatted:{timestamp:Vt(B.timestamp),event:Ze(B.event),category:Oe(B.category),details:jt(B.details)}}));e("export-start",{format:t.value,scope:i.value,count:L.length});const k=Tl(t.value,s.filters,L.length),T=B=>{r.value=B};t.value==="csv"?await Sl(L,k,{onProgress:T}):await wl(L,k,{pretty:l.value,onProgress:T}),e("export-complete",{format:t.value,filename:k,count:L.length}),setTimeout(()=>{a.value=!1,o.value=!1,r.value=0},500)}catch(O){console.error("[WebhookLogsExport] Export error:",O),e("export-error",O),a.value=!1,r.value=0,alert(`–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${O.message}`)}},V=O=>O<1024?`${O} B`:O<1024*1024?`${(O/1024).toFixed(2)} KB`:`${(O/1024/1024).toFixed(2)} MB`;return pe([i,()=>s.logs,()=>s.selectedLogs],()=>{o.value&&C()}),{showExportModal:o,exportFormat:t,exportScope:i,jsonPretty:l,exporting:a,exportProgress:r,exportWarnings:g,estimatedSize:f,selectedCount:m,hasAllLogs:h,hasFilters:b,exportCount:p,canExport:v,openExportModal:S,closeExportModal:D,handleExport:I,formatSize:V}}},Dl={class:"webhook-logs-export"},Il=["disabled","title"],Ml={key:0,class:"selected-badge"},Ll={class:"export-modal-header"},Pl={class:"export-modal-body"},Nl={class:"export-section"},Ol={class:"radio-group"},Bl={class:"export-section"},Rl={class:"radio-group"},Ul=["disabled"],Fl={class:"radio-label"},Vl={key:0},jl={key:1},zl=["disabled"],Hl={class:"radio-label"},Wl={key:0,class:"export-section"},$l={class:"checkbox-option"},ql={class:"export-info"},Kl={class:"info-item"},Xl={class:"info-value"},Gl={key:0,class:"info-item"},Jl={class:"info-value"},Yl={key:1,class:"export-warnings"},Zl={key:0,class:"export-progress"},Ql={class:"progress-bar"},ec={class:"progress-text"},tc={class:"export-modal-footer"},oc=["disabled"],sc={key:0},nc={key:1},ac=["disabled"];function ic(s,e,o,t,i,l){return c(),d("div",Dl,[n("button",{onClick:e[0]||(e[0]=(...a)=>t.openExportModal&&t.openExportModal(...a)),class:"btn-export",disabled:!t.canExport,title:t.canExport?"–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö":"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞"},[e[11]||(e[11]=n("span",{class:"btn-icon"},"üì•",-1)),e[12]||(e[12]=n("span",{class:"btn-text"},"–≠–∫—Å–ø–æ—Ä—Ç",-1)),t.selectedCount>0?(c(),d("span",Ml,u(t.selectedCount),1)):y("",!0)],8,Il),K(Ce,{name:"modal"},{default:ce(()=>[t.showExportModal?(c(),d("div",{key:0,class:"export-modal-overlay",onClick:e[10]||(e[10]=(...a)=>t.closeExportModal&&t.closeExportModal(...a))},[n("div",{class:"export-modal",onClick:e[9]||(e[9]=de(()=>{},["stop"]))},[n("div",Ll,[e[13]||(e[13]=n("h3",null,"–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö",-1)),n("button",{onClick:e[1]||(e[1]=(...a)=>t.closeExportModal&&t.closeExportModal(...a)),class:"btn-close"},"‚úï")]),n("div",Pl,[n("div",Nl,[e[16]||(e[16]=n("h4",null,"–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞",-1)),n("div",Ol,[n("label",{class:N(["radio-option",{active:t.exportFormat==="csv"}])},[te(n("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=a=>t.exportFormat=a),value:"csv",class:"radio-input"},null,512),[[it,t.exportFormat]]),e[14]||(e[14]=n("span",{class:"radio-label"},[n("strong",null,"CSV"),n("small",null,"–î–ª—è Excel, LibreOffice")],-1))],2),n("label",{class:N(["radio-option",{active:t.exportFormat==="json"}])},[te(n("input",{type:"radio","onUpdate:modelValue":e[3]||(e[3]=a=>t.exportFormat=a),value:"json",class:"radio-input"},null,512),[[it,t.exportFormat]]),e[15]||(e[15]=n("span",{class:"radio-label"},[n("strong",null,"JSON"),n("small",null,"–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, API")],-1))],2)])]),n("div",Bl,[e[19]||(e[19]=n("h4",null,"–ß—Ç–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å",-1)),n("div",Rl,[n("label",{class:N(["radio-option",{active:t.exportScope==="all",disabled:!t.hasAllLogs}])},[te(n("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=a=>t.exportScope=a),value:"all",disabled:!t.hasAllLogs,class:"radio-input"},null,8,Ul),[[it,t.exportScope]]),n("span",Fl,[e[17]||(e[17]=n("strong",null,"–í—Å–µ –∑–∞–ø–∏—Å–∏",-1)),t.hasFilters?(c(),d("small",Vl,"–° –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ ("+u(t.exportCount)+" –∑–∞–ø–∏—Å–µ–π)",1)):(c(),d("small",jl,"–í—Å–µ–≥–æ: "+u(t.exportCount)+" –∑–∞–ø–∏—Å–µ–π",1))])],2),n("label",{class:N(["radio-option",{active:t.exportScope==="selected",disabled:t.selectedCount===0}])},[te(n("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=a=>t.exportScope=a),value:"selected",disabled:t.selectedCount===0,class:"radio-input"},null,8,zl),[[it,t.exportScope]]),n("span",Hl,[e[18]||(e[18]=n("strong",null,"–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏",-1)),n("small",null,u(t.selectedCount)+" –∑–∞–ø–∏—Å–µ–π –≤—ã–±—Ä–∞–Ω–æ",1)])],2)])]),t.exportFormat==="json"?(c(),d("div",Wl,[e[21]||(e[21]=n("h4",null,"–û–ø—Ü–∏–∏ JSON",-1)),n("label",$l,[te(n("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>t.jsonPretty=a),class:"checkbox-input"},null,512),[[yt,t.jsonPretty]]),e[20]||(e[20]=n("span",{class:"checkbox-label"},"–ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å –æ—Ç—Å—Ç—É–ø–∞–º–∏)",-1))])])):y("",!0),n("div",ql,[n("div",Kl,[e[22]||(e[22]=n("span",{class:"info-label"},"–ó–∞–ø–∏—Å–µ–π –∫ —ç–∫—Å–ø–æ—Ä—Ç—É:",-1)),n("span",Xl,u(t.exportCount),1)]),t.estimatedSize?(c(),d("div",Gl,[e[23]||(e[23]=n("span",{class:"info-label"},"–ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞–∑–º–µ—Ä:",-1)),n("span",Jl,u(t.formatSize(t.estimatedSize)),1)])):y("",!0)]),t.exportWarnings.length>0?(c(),d("div",Yl,[(c(!0),d(U,null,F(t.exportWarnings,(a,r)=>(c(),d("div",{key:r,class:"warning-item"}," ‚ö†Ô∏è "+u(a),1))),128))])):y("",!0)]),t.exporting?(c(),d("div",Zl,[n("div",Ql,[n("div",{class:"progress-fill",style:oe({width:`${t.exportProgress}%`})},null,4)]),n("div",ec," –≠–∫—Å–ø–æ—Ä—Ç: "+u(t.exportProgress)+"% ",1)])):y("",!0),n("div",tc,[n("button",{onClick:e[7]||(e[7]=(...a)=>t.handleExport&&t.handleExport(...a)),disabled:t.exporting||!t.canExport,class:"btn-primary"},[t.exporting?(c(),d("span",sc,"–≠–∫—Å–ø–æ—Ä—Ç...")):(c(),d("span",nc,"–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å"))],8,oc),n("button",{onClick:e[8]||(e[8]=(...a)=>t.closeExportModal&&t.closeExportModal(...a)),disabled:t.exporting,class:"btn-secondary"}," –û—Ç–º–µ–Ω–∞ ",8,ac)])])])):y("",!0)]),_:1})])}const rc=H(Al,[["render",ic],["__scopeId","data-v-7ae66f8c"]]),lc={name:"WebhookLogSearch",props:{modelValue:{type:String,default:""}},emits:["update:modelValue","search"],setup(s,{emit:e}){const o=w(s.modelValue||""),t=w(!1),i=w(null),l=Qi(p=>{t.value=!1,e("search",p)},400),a=()=>{t.value=!0,e("update:modelValue",o.value),l(o.value)},r=()=>{t.value=!1,e("search",o.value)},g=()=>{o.value="",t.value=!1,i.value=null,e("update:modelValue",""),e("search","")};return pe(()=>s.modelValue,p=>{p!==o.value&&(o.value=p)}),{searchQuery:o,isSearching:t,searchResultsCount:i,handleSearchInput:a,handleSearch:r,clearSearch:g,setResultsCount:p=>{i.value=p},getResultsText:p=>{const v=p%10,S=p%100;return S>=11&&S<=19?"–∑–∞–ø–∏—Å–µ–π":v===1?"–∑–∞–ø–∏—Å—å":v>=2&&v<=4?"–∑–∞–ø–∏—Å–∏":"–∑–∞–ø–∏—Å–µ–π"},performSearch:(p,v)=>{if(!p||!v||!Array.isArray(v))return[];const S=p.toLowerCase().trim();return S.length===0?v:v.map(C=>Ye(C)).filter(C=>De(C)).filter(C=>{if(C.event&&C.event.toLowerCase().includes(S)||C.category&&C.category.toLowerCase().includes(S)||C.ip&&C.ip.toLowerCase().includes(S)||C.details&&typeof C.details=="object"&&(C.details.task_id&&String(C.details.task_id).includes(S)||C.details.task_title&&C.details.task_title.toLowerCase().includes(S)||C.details.entity_id&&String(C.details.entity_id).includes(S)||C.details.title&&C.details.title.toLowerCase().includes(S)||C.details.comment_text&&C.details.comment_text.toLowerCase().includes(S)))return!0;if(C.payload&&typeof C.payload=="object")try{if(JSON.stringify(C.payload).toLowerCase().includes(S))return!0}catch{}return!1})},formatSearchResult:p=>{const v=[];if(p.event&&v.push(Ze(p.event)),p.category&&v.push(Oe(p.category)),p.details){const S=jt(p.details);S!=="‚Äî"&&v.push(S)}return v.join(" ‚Ä¢ ")}}}},cc={class:"webhook-search"},dc={class:"search-wrapper"},uc={key:0,class:"search-indicator"},gc={key:1,class:"search-results"};function mc(s,e,o,t,i,l){return c(),d("div",cc,[n("div",dc,[e[5]||(e[5]=n("span",{class:"search-icon"},"üîç",-1)),te(n("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.searchQuery=a),type:"text",placeholder:"–ü–æ–∏—Å–∫ –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –ª–æ–≥–æ–≤ (—Å–æ–±—ã—Ç–∏–µ, payload, IP, –¥–µ—Ç–∞–ª–∏)...",class:"search-input",onInput:e[1]||(e[1]=(...a)=>t.handleSearchInput&&t.handleSearchInput(...a)),onKeyup:[e[2]||(e[2]=se((...a)=>t.handleSearch&&t.handleSearch(...a),["enter"])),e[3]||(e[3]=se((...a)=>t.clearSearch&&t.clearSearch(...a),["esc"]))]},null,544),[[Ke,t.searchQuery]]),t.searchQuery?(c(),d("button",{key:0,onClick:e[4]||(e[4]=(...a)=>t.clearSearch&&t.clearSearch(...a)),class:"clear-button",title:"–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫ (Esc)","aria-label":"–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫"}," ‚úï ")):y("",!0)]),t.isSearching?(c(),d("div",uc,[...e[6]||(e[6]=[n("span",{class:"spinner"},null,-1),X(" –ü–æ–∏—Å–∫... ",-1)])])):y("",!0),t.searchQuery&&t.searchResultsCount!==null?(c(),d("div",gc," –ù–∞–π–¥–µ–Ω–æ: "+u(t.searchResultsCount)+" "+u(t.getResultsText(t.searchResultsCount)),1)):y("",!0)])}const fc=H(lc,[["render",mc],["__scopeId","data-v-db228863"]]);function hc(s,e=null){const o=()=>{try{const a=localStorage.getItem(s);return a?JSON.parse(a):e}catch(a){return console.error(`Error loading ${s} from localStorage:`,a),e}},t=a=>{try{localStorage.setItem(s,JSON.stringify(a))}catch(r){console.error(`Error saving ${s} to localStorage:`,r)}},i=()=>{try{localStorage.removeItem(s)}catch(a){console.error(`Error clearing ${s} from localStorage:`,a)}},l=w(o());return pe(l,a=>{t(a)},{deep:!0}),{value:l,save:t,load:o,clear:i}}const vc={name:"WebhookLogFilters",props:{filters:{type:Object,required:!0}},emits:["update:filters","reset"],setup(s,{emit:e}){const o=w(null),t=hc("webhook-filters",{category:null,event:null,dateFrom:null,dateTo:null,hour:null,ip:null,status:null}),i=k=>(o.value=null,Pt(k)?(e("update:filters",k),!0):(o.value="–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏",console.error("[WebhookLogFilters] Validation error:",o.value),!1)),l=new Date().toISOString().split("T")[0],a=w({category:t.value.category||s.filters.category||null,event:t.value.event||s.filters.event||null,dateFrom:t.value.dateFrom||s.filters.dateFrom||s.filters.date||l,dateTo:t.value.dateTo||s.filters.dateTo||null,hour:t.value.hour!==void 0?t.value.hour:s.filters.hour!==void 0?s.filters.hour:null,ip:t.value.ip||s.filters.ip||null,status:t.value.status||s.filters.status||null}),r=w(null),g=[{id:"today",label:"–°–µ–≥–æ–¥–Ω—è",getDates:()=>({from:l,to:l})},{id:"yesterday",label:"–í—á–µ—Ä–∞",getDates:()=>{const k=new Date;k.setDate(k.getDate()-1);const T=k.toISOString().split("T")[0];return{from:T,to:T}}},{id:"last7days",label:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π",getDates:()=>{const k=new Date;return k.setDate(k.getDate()-7),{from:k.toISOString().split("T")[0],to:l}}},{id:"last30days",label:"–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π",getDates:()=>{const k=new Date;return k.setDate(k.getDate()-30),{from:k.toISOString().split("T")[0],to:l}}}],f=k=>{const T=g.find(B=>B.id===k);if(T){const B=T.getDates();a.value.dateFrom=B.from,a.value.dateTo=B.to,r.value=k,O()}};pe(()=>s.filters,k=>{a.value={category:k.category||null,event:k.event||null,dateFrom:k.dateFrom||k.date||l,dateTo:k.dateTo||null,hour:k.hour!==void 0?k.hour:null,ip:k.ip||null,status:k.status||null}},{deep:!0}),pe(a,k=>{t.value={...k},e("update:filters",{...k})},{deep:!0});const m=_(()=>{const k={};return a.value.category&&(k.category=a.value.category),a.value.event&&(k.event=a.value.event),a.value.hour!==null&&(k.hour=a.value.hour),a.value.ip&&(k.ip=a.value.ip),a.value.status&&(k.status=a.value.status),a.value.dateFrom&&a.value.dateFrom!==l&&(k.dateFrom=a.value.dateFrom),a.value.dateTo&&(k.dateTo=a.value.dateTo),k}),h=_(()=>Object.keys(m.value).length>0),b=k=>({category:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è",event:"–°–æ–±—ã—Ç–∏–µ",hour:"–ß–∞—Å",ip:"IP –∞–¥—Ä–µ—Å",status:"–°—Ç–∞—Ç—É—Å",dateFrom:"–î–∞—Ç–∞ –æ—Ç",dateTo:"–î–∞—Ç–∞ –¥–æ"})[k]||k,p=(k,T)=>k==="category"?Oe(T)||T:k==="hour"?`${String(T).padStart(2,"0")}:00`:k==="event"?Ze(T)||T:k==="status"&&{success:"–£—Å–ø–µ—à–Ω–æ",error:"–û—à–∏–±–∫–∞",warning:"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ"}[T]||T,v=_(()=>[{value:null,label:"–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},{value:"tasks",label:Oe("tasks")},{value:"smart-processes",label:Oe("smart-processes")},{value:"errors",label:Oe("errors")}]),S=_(()=>[{value:null,label:"–í—Å–µ —Å–æ–±—ã—Ç–∏—è"},...["ONTASKADD","ONTASKUPDATE","ONTASKDELETE","ONTASKCOMMENTADD","ONTASKCOMMENTUPDATE","ONTASKCOMMENTDELETE","ONCRMDYNAMICITEMADD","ONCRMDYNAMICITEMUPDATE","ONCRMDYNAMICITEMDELETE"].map(T=>({value:T,label:Ze(T)}))]),D=k=>{k==="hour"?a.value[k]=null:k==="dateFrom"?a.value[k]=l:a.value[k]=null,r.value=null},C=k=>{const T={...a.value,category:k||null};i(T)&&(a.value.category=k)},M=k=>{const T={...a.value,event:k||null};i(T)&&(a.value.event=k)},I=(k,T)=>{if(k&&!/^\d{4}-\d{2}-\d{2}$/.test(k)){console.error("[WebhookLogFilters] Invalid date format:",k),o.value="–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç—ã";return}const B={...a.value,[T]:k||null};i(B)&&(a.value[T]=k)},V=k=>{if(k!=null){const B=parseInt(k,10);if(isNaN(B)||B<0||B>23){console.error("[WebhookLogFilters] Invalid hour:",k),o.value="–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —á–∞—Å (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç 0 –¥–æ 23)";return}}const T={...a.value,hour:k!=null?parseInt(k,10):null};i(T)&&(a.value.hour=k!=null?parseInt(k,10):null)},O=()=>{i({...a.value})},L=()=>{a.value={category:null,event:null,dateFrom:l,dateTo:null,hour:null,ip:null,status:null},r.value=null,t.clear(),e("reset")};return ae(()=>{t.value&&Object.keys(t.value).length>0&&e("update:filters",{...t.value})}),{localFilters:a,activeFilters:m,hasActiveFilters:h,getFilterLabel:b,getFilterValue:p,clearFilter:D,handleFilterChange:O,handleCategoryChange:C,handleEventChange:M,handleDateChange:I,handleHourChange:V,handleReset:L,quickFilters:g,activeQuickFilter:r,applyQuickFilter:f,categoryOptions:v,eventOptions:S,validationError:o}}},yc={class:"webhook-log-filters"},pc={key:0,class:"active-filters-indicator"},_c=["onClick"],bc={key:1,class:"validation-error"},kc={class:"quick-filters"},Cc=["onClick"],Sc={class:"filters-row"},wc={class:"filter-group"},Tc=["value"],Ec={class:"filter-group"},xc=["value"],Ac={class:"filter-group"},Dc={class:"filter-group"},Ic={class:"filter-group"},Mc={class:"filter-group"},Lc={class:"filter-group"};function Pc(s,e,o,t,i,l){return c(),d("div",yc,[t.hasActiveFilters?(c(),d("div",pc,[e[14]||(e[14]=n("span",{class:"indicator-text"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:",-1)),(c(!0),d(U,null,F(t.activeFilters,(a,r)=>(c(),d("span",{key:r,class:"filter-badge"},[X(u(t.getFilterLabel(r))+": "+u(t.getFilterValue(r,a))+" ",1),n("button",{onClick:g=>t.clearFilter(r),class:"filter-badge-remove",title:"–£–¥–∞–ª–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä"}," √ó ",8,_c)]))),128)),n("button",{onClick:e[0]||(e[0]=(...a)=>t.handleReset&&t.handleReset(...a)),class:"btn-clear-all"}," –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ ")])):y("",!0),t.validationError?(c(),d("div",bc," ‚ö†Ô∏è "+u(t.validationError),1)):y("",!0),n("div",kc,[e[15]||(e[15]=n("span",{class:"quick-filters-label"},"–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã:",-1)),(c(!0),d(U,null,F(t.quickFilters,a=>(c(),d("button",{key:a.id,onClick:r=>t.applyQuickFilter(a.id),class:N(["quick-filter-btn",{active:t.activeQuickFilter===a.id}])},u(a.label),11,Cc))),128))]),n("div",Sc,[n("div",wc,[e[16]||(e[16]=n("label",{for:"category-filter"},"–ö–∞—Ç–µ–≥–æ—Ä–∏—è:",-1)),te(n("select",{id:"category-filter","onUpdate:modelValue":e[1]||(e[1]=a=>t.localFilters.category=a),onChange:e[2]||(e[2]=a=>t.handleCategoryChange(t.localFilters.category)),class:"filter-select"},[(c(!0),d(U,null,F(t.categoryOptions,a=>(c(),d("option",{key:a.value,value:a.value},u(a.label),9,Tc))),128))],544),[[Te,t.localFilters.category]])]),n("div",Ec,[e[17]||(e[17]=n("label",{for:"event-filter"},"–¢–∏–ø —Å–æ–±—ã—Ç–∏—è:",-1)),te(n("select",{id:"event-filter","onUpdate:modelValue":e[3]||(e[3]=a=>t.localFilters.event=a),onChange:e[4]||(e[4]=a=>t.handleEventChange(t.localFilters.event)),class:"filter-select"},[(c(!0),d(U,null,F(t.eventOptions,a=>(c(),d("option",{key:a.value,value:a.value},u(a.label),9,xc))),128))],544),[[Te,t.localFilters.event]])]),n("div",Ac,[e[18]||(e[18]=n("label",{for:"date-from-filter"},"–î–∞—Ç–∞ –æ—Ç:",-1)),te(n("input",{id:"date-from-filter","onUpdate:modelValue":e[5]||(e[5]=a=>t.localFilters.dateFrom=a),type:"date",onChange:e[6]||(e[6]=a=>t.handleDateChange(t.localFilters.dateFrom,"dateFrom")),class:"filter-input"},null,544),[[Ke,t.localFilters.dateFrom]])]),n("div",Dc,[e[19]||(e[19]=n("label",{for:"date-to-filter"},"–î–∞—Ç–∞ –¥–æ:",-1)),te(n("input",{id:"date-to-filter","onUpdate:modelValue":e[7]||(e[7]=a=>t.localFilters.dateTo=a),type:"date",onChange:e[8]||(e[8]=a=>t.handleDateChange(t.localFilters.dateTo,"dateTo")),class:"filter-input"},null,544),[[Ke,t.localFilters.dateTo]])]),n("div",Ic,[e[20]||(e[20]=n("label",{for:"ip-filter"},"IP –∞–¥—Ä–µ—Å:",-1)),te(n("input",{id:"ip-filter","onUpdate:modelValue":e[9]||(e[9]=a=>t.localFilters.ip=a),type:"text",placeholder:"192.168.1.1",onInput:e[10]||(e[10]=(...a)=>t.handleFilterChange&&t.handleFilterChange(...a)),class:"filter-input"},null,544),[[Ke,t.localFilters.ip]])]),n("div",Mc,[e[22]||(e[22]=n("label",{for:"status-filter"},"–°—Ç–∞—Ç—É—Å:",-1)),te(n("select",{id:"status-filter","onUpdate:modelValue":e[11]||(e[11]=a=>t.localFilters.status=a),onChange:e[12]||(e[12]=(...a)=>t.handleFilterChange&&t.handleFilterChange(...a)),class:"filter-select"},[...e[21]||(e[21]=[n("option",{value:null},"–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã",-1),n("option",{value:"success"},"–£—Å–ø–µ—à–Ω–æ",-1),n("option",{value:"error"},"–û—à–∏–±–∫–∞",-1),n("option",{value:"warning"},"–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ",-1)])],544),[[Te,t.localFilters.status]])]),n("div",Lc,[n("button",{onClick:e[13]||(e[13]=(...a)=>t.handleReset&&t.handleReset(...a)),class:"btn-reset"}," –°–±—Ä–æ—Å–∏—Ç—å ")])])])}const Nc=H(vc,[["render",Pc],["__scopeId","data-v-2a150a46"]]),Oc={name:"WebhookLogList",props:{logs:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:null},pagination:{type:Object,default:null},selectedLogs:{type:Array,default:()=>[]}},emits:["select-log","page-change","update:selectedLogs"],setup(s,{emit:e}){const o=_(()=>!s.logs||!Array.isArray(s.logs)?(console.warn("[WebhookLogList] Invalid logs prop:",s.logs),[]):s.logs.map(T=>Ye(T)).filter(T=>De(T)?!0:(console.warn("[WebhookLogList] Invalid log entry:",T),!1))),t=w("timestamp"),i=w("desc"),l=T=>{t.value===T?i.value=i.value==="asc"?"desc":"asc":(t.value=T,i.value="desc")},a=_(()=>!o.value||o.value.length===0?[]:[...o.value].sort((B,P)=>{let R,j;switch(t.value){case"timestamp":R=new Date(B.timestamp||0).getTime(),j=new Date(P.timestamp||0).getTime();break;case"event":R=(B.event||"").toLowerCase(),j=(P.event||"").toLowerCase();break;case"category":R=(B.category||"").toLowerCase(),j=(P.category||"").toLowerCase();break;case"ip":R=(B.ip||"").toLowerCase(),j=(P.ip||"").toLowerCase();break;default:return 0}return R<j?i.value==="asc"?-1:1:R>j?i.value==="asc"?1:-1:0})),r=T=>t.value!==T?"‚ÜïÔ∏è":i.value==="asc"?"‚Üë":"‚Üì",g=T=>T.category==="errors"?"status-error":"status-success",f=T=>T.category==="errors"?"‚ùå":"‚úÖ",m=T=>T.category==="errors"?"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏":"–£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ",h=T=>`${T.timestamp}_${T.event}_${T.ip||"unknown"}`,b=T=>T?Vt(T,"short"):"‚Äî",p=T=>T?Ze(T):"‚Äî",v=T=>T?Oe(T):"‚Äî",S=T=>!T||typeof T!="object"?"‚Äî":jt(T),D=T=>`category-${T}`,C=T=>T?.startsWith("ONTASK")?"event-task":T?.startsWith("ONCRMDYNAMIC")?"event-smart-process":"event-other",M=T=>{e("select-log",T)},I=T=>{T>=1&&T<=s.pagination.pages&&e("page-change",T)},V=T=>s.selectedLogs.some(B=>h(B)===h(T)),O=(T,B)=>{B.stopPropagation();const P=[...s.selectedLogs],R=h(T),j=P.findIndex(G=>h(G)===R);B.target.checked?j===-1&&P.push(T):j!==-1&&P.splice(j,1),e("update:selectedLogs",P)},L=T=>{T.target.checked?e("update:selectedLogs",[...s.logs]):e("update:selectedLogs",[])},k=_(()=>o.value.length>0&&o.value.every(T=>V(T)));return pe(()=>s.logs,T=>{if(T&&Array.isArray(T)){const B=T.filter(P=>!De(P)).length;B>0&&console.warn(`[WebhookLogList] Received ${B} invalid log entries out of ${T.length}`)}},{immediate:!0}),{validatedLogs:o,sortBy:t,sortOrder:i,sortedLogs:a,handleSort:l,getSortIcon:r,getStatusClass:g,getStatusIcon:f,getStatusTitle:m,getLogId:h,formatTimestamp:b,formatEvent:p,formatCategoryLabel:v,formatDetailsPreview:S,getCategoryClass:D,getEventClass:C,handleLogClick:M,handlePageChange:I,isSelected:V,handleSelectLog:O,handleSelectAll:L,allSelected:k}}},Bc={class:"webhook-log-list"},Rc={key:0,class:"logs-table-container"},Uc={class:"logs-table"},Fc={class:"checkbox-header"},Vc=["checked"],jc={class:"sort-icon"},zc={class:"sort-icon"},Hc={class:"sort-icon"},Wc={class:"sort-icon"},$c=["onClick"],qc=["checked","onChange"],Kc=["title"],Xc={class:"details-preview"},Gc=["onClick"],Jc={key:0,class:"pagination"},Yc=["disabled"],Zc={class:"pagination-info"},Qc=["disabled"];function ed(s,e,o,t,i,l){return c(),d("div",Bc,[o.logs.length>0?(c(),d("div",Rc,[n("table",Uc,[n("thead",null,[n("tr",null,[n("th",Fc,[n("input",{type:"checkbox",checked:t.allSelected,onChange:e[0]||(e[0]=(...a)=>t.handleSelectAll&&t.handleSelectAll(...a)),onClick:e[1]||(e[1]=de(()=>{},["stop"])),class:"checkbox-input",title:"–í—ã–±—Ä–∞—Ç—å –≤—Å–µ"},null,40,Vc)]),n("th",{onClick:e[2]||(e[2]=a=>t.handleSort("timestamp")),class:N(["sortable",{"sort-asc":t.sortBy==="timestamp"&&t.sortOrder==="asc","sort-desc":t.sortBy==="timestamp"&&t.sortOrder==="desc"}])},[e[9]||(e[9]=X(" –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è ",-1)),n("span",jc,u(t.getSortIcon("timestamp")),1)],2),n("th",{onClick:e[3]||(e[3]=a=>t.handleSort("event")),class:N(["sortable",{"sort-asc":t.sortBy==="event"&&t.sortOrder==="asc","sort-desc":t.sortBy==="event"&&t.sortOrder==="desc"}])},[e[10]||(e[10]=X(" –¢–∏–ø —Å–æ–±—ã—Ç–∏—è ",-1)),n("span",zc,u(t.getSortIcon("event")),1)],2),n("th",{onClick:e[4]||(e[4]=a=>t.handleSort("category")),class:N(["sortable",{"sort-asc":t.sortBy==="category"&&t.sortOrder==="asc","sort-desc":t.sortBy==="category"&&t.sortOrder==="desc"}])},[e[11]||(e[11]=X(" –ö–∞—Ç–µ–≥–æ—Ä–∏—è ",-1)),n("span",Hc,u(t.getSortIcon("category")),1)],2),n("th",{onClick:e[5]||(e[5]=a=>t.handleSort("ip")),class:N(["sortable",{"sort-asc":t.sortBy==="ip"&&t.sortOrder==="asc","sort-desc":t.sortBy==="ip"&&t.sortOrder==="desc"}])},[e[12]||(e[12]=X(" IP ",-1)),n("span",Wc,u(t.getSortIcon("ip")),1)],2),e[13]||(e[13]=n("th",null,"–î–µ—Ç–∞–ª–∏",-1)),e[14]||(e[14]=n("th",null,"–î–µ–π—Å—Ç–≤–∏—è",-1))])]),n("tbody",null,[(c(!0),d(U,null,F(t.sortedLogs,a=>(c(),d("tr",{key:t.getLogId(a),onClick:r=>t.handleLogClick(a),class:N(["log-row",{"row-selected":t.isSelected(a)}])},[n("td",{onClick:e[6]||(e[6]=de(()=>{},["stop"]))},[n("input",{type:"checkbox",checked:t.isSelected(a),onChange:r=>t.handleSelectLog(a,r),class:"checkbox-input"},null,40,qc)]),n("td",null,u(t.formatTimestamp(a.timestamp)),1),n("td",null,[n("span",{class:N(["status-indicator",t.getStatusClass(a)]),title:t.getStatusTitle(a)},u(t.getStatusIcon(a)),11,Kc),n("span",{class:N(["event-badge",t.getEventClass(a.event)])},u(t.formatEvent(a.event)),3)]),n("td",null,[n("span",{class:N(["category-badge",t.getCategoryClass(a.category)])},u(t.formatCategoryLabel(a.category)),3)]),n("td",null,u(a.ip||"N/A"),1),n("td",null,[n("div",Xc,u(t.formatDetailsPreview(a.details)),1)]),n("td",null,[n("button",{onClick:de(r=>t.handleLogClick(a),["stop"]),class:"btn-view"}," –ü—Ä–æ—Å–º–æ—Ç—Ä ",8,Gc)])],10,$c))),128))])]),o.pagination&&o.pagination.pages>1?(c(),d("div",Jc,[n("button",{onClick:e[7]||(e[7]=a=>t.handlePageChange(o.pagination.page-1)),disabled:o.pagination.page<=1,class:"btn-pagination"}," –ù–∞–∑–∞–¥ ",8,Yc),n("span",Zc," –°—Ç—Ä–∞–Ω–∏—Ü–∞ "+u(o.pagination.page)+" –∏–∑ "+u(o.pagination.pages)+" (–≤—Å–µ–≥–æ: "+u(o.pagination.total)+") ",1),n("button",{onClick:e[8]||(e[8]=a=>t.handlePageChange(o.pagination.page+1)),disabled:o.pagination.page>=o.pagination.pages,class:"btn-pagination"}," –í–ø–µ—Ä—ë–¥ ",8,Qc)])):y("",!0)])):y("",!0)])}const td=H(Oc,[["render",ed],["__scopeId","data-v-fddd3018"]]),od={name:"LoadingSkeleton",props:{width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"20px"},variant:{type:String,default:"rect",validator:s=>["rect","circle","text","table-row"].includes(s)},animated:{type:Boolean,default:!0},borderRadius:{type:String,default:null}},setup(s){return{skeletonStyle:_(()=>{const o={width:typeof s.width=="number"?`${s.width}px`:s.width,height:typeof s.height=="number"?`${s.height}px`:s.height};return s.borderRadius&&(o.borderRadius=s.borderRadius),o})}}},sd={key:0,class:"skeleton-shimmer"};function nd(s,e,o,t,i,l){return c(),d("div",{class:N(["skeleton",[`skeleton-${o.variant}`,{"skeleton-animated":o.animated}]]),style:oe(t.skeletonStyle)},[o.animated?(c(),d("div",sd)):y("",!0)],6)}const ad=H(od,[["render",nd],["__scopeId","data-v-014f86e6"]]),id={name:"SkeletonLogList",components:{LoadingSkeleton:ad},props:{rows:{type:Number,default:5}},setup(){return{getColumnWidth:e=>["40px","15%","20%","15%","15%","20%","15%"][e-1]||"100%"}}},rd={class:"skeleton-log-list"},ld={class:"skeleton-table-header"};function cd(s,e,o,t,i,l){const a=W("LoadingSkeleton");return c(),d("div",rd,[n("div",ld,[(c(),d(U,null,F(7,r=>K(a,{key:r,width:"120px",height:"16px",variant:"text"})),64))]),(c(!0),d(U,null,F(o.rows,r=>(c(),d("div",{key:r,class:"skeleton-table-row"},[(c(),d(U,null,F(7,g=>K(a,{key:g,width:"100%",height:"20px",variant:"text",style:oe({width:t.getColumnWidth(g)})},null,8,["style"])),64))]))),128))])}const dd=H(id,[["render",cd],["__scopeId","data-v-475c4e73"]]),ud={name:"EmptyState",props:{icon:{type:String,default:"üì≠"},title:{type:String,required:!0},description:{type:String,required:!0},actionLabel:{type:String,default:null},actions:{type:Array,default:null},hints:{type:Array,default:()=>[]},variant:{type:String,default:"default",validator:s=>["default","error","warning","info"].includes(s)}},emits:["action","action-click"]},gd={class:"empty-icon"},md={class:"empty-title"},fd={class:"empty-description"},hd={key:0,class:"empty-hints"},vd={key:1,class:"empty-actions"},yd=["onClick"];function pd(s,e,o,t,i,l){return c(),d("div",{class:N(["empty-state",`empty-state-${o.variant}`])},[n("div",gd,u(o.icon),1),n("h3",md,u(o.title),1),n("p",fd,u(o.description),1),o.hints&&o.hints.length>0?(c(),d("div",hd,[(c(!0),d(U,null,F(o.hints,(a,r)=>(c(),d("div",{key:r,class:"hint-item"}," üí° "+u(a),1))),128))])):y("",!0),o.actionLabel||o.actions?(c(),d("div",vd,[o.actionLabel?(c(),d("button",{key:0,onClick:e[0]||(e[0]=a=>s.$emit("action")),class:"btn-primary"},u(o.actionLabel),1)):y("",!0),(c(!0),d(U,null,F(o.actions,(a,r)=>(c(),d("button",{key:r,onClick:g=>s.$emit("action-click",a.id),class:N(["btn",`btn-${a.variant||"secondary"}`])},u(a.label),11,yd))),128))])):y("",!0)],2)}const _d=H(ud,[["render",pd],["__scopeId","data-v-081c13b9"]]),bd={name:"ErrorDisplay",props:{title:{type:String,default:"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞"},message:{type:String,required:!0},details:{type:String,default:null},severity:{type:String,default:"error",validator:s=>["error","warning","critical"].includes(s)},retryable:{type:Boolean,default:!1}},emits:["retry"],setup(){return{showDetails:w(!1)}}},kd={class:"error-icon"},Cd={class:"error-content"},Sd={class:"error-title"},wd={class:"error-message"},Td={key:0,class:"error-details"},Ed={class:"error-actions"};function xd(s,e,o,t,i,l){return c(),d("div",{class:N(["error-display",`error-${o.severity}`])},[n("div",kd,u(o.severity==="critical"?"üö®":"‚ö†Ô∏è"),1),n("div",Cd,[n("h4",Sd,u(o.title),1),n("p",wd,u(o.message),1),o.details&&t.showDetails?(c(),d("div",Td,[n("pre",null,u(o.details),1)])):y("",!0),n("div",Ed,[o.retryable?(c(),d("button",{key:0,onClick:e[0]||(e[0]=a=>s.$emit("retry")),class:"btn-retry"}," üîÑ –ü–æ–≤—Ç–æ—Ä–∏—Ç—å ")):y("",!0),o.details?(c(),d("button",{key:1,onClick:e[1]||(e[1]=a=>t.showDetails=!t.showDetails),class:"btn-details"},u(t.showDetails?"–°–∫—Ä—ã—Ç—å":"–ü–æ–∫–∞–∑–∞—Ç—å")+" –¥–µ—Ç–∞–ª–∏ ",1)):y("",!0)])])],2)}const Ad=H(bd,[["render",xd],["__scopeId","data-v-3f2f4c14"]]),Dd={name:"Notification",props:{notification:{type:Object,required:!0}},emits:["close"],setup(s,{emit:e}){const o=w(100),t=_(()=>s.notification.duration>0);let i=null;const l={success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"},a=_(()=>l[s.notification.type]||"‚ÑπÔ∏è"),r=()=>{e("close")},g=()=>{s.notification.onClick&&s.notification.onClick()};return ae(()=>{if(t.value&&s.notification.duration>0){const f=Date.now(),m=s.notification.duration;i=setInterval(()=>{const h=Date.now()-f;o.value=Math.max(0,100-h/m*100),o.value<=0&&(clearInterval(i),r())},50)}}),pt(()=>{i&&clearInterval(i)}),{icon:a,progress:o,showProgress:t,close:r,handleClick:g}}},Id={class:"notification-content"},Md={class:"notification-icon"},Ld={class:"notification-message"},Pd={key:0,class:"notification-progress"};function Nd(s,e,o,t,i,l){return c(),d("div",{class:N(["notification",`notification-${o.notification.type}`]),onClick:e[1]||(e[1]=(...a)=>t.handleClick&&t.handleClick(...a))},[n("div",Id,[n("span",Md,u(t.icon),1),n("span",Ld,u(o.notification.message),1)]),n("button",{onClick:e[0]||(e[0]=de((...a)=>t.close&&t.close(...a),["stop"])),class:"notification-close"},"‚úï"),t.showProgress?(c(),d("div",Pd,[n("div",{class:"progress-bar",style:oe({width:`${t.progress}%`})},null,4)])):y("",!0)],2)}const Od=H(Dd,[["render",Nd],["__scopeId","data-v-1b602bdf"]]),Bd={name:"NotificationContainer",components:{Notification:Od},setup(){const{notifications:s,removeNotification:e}=_t();return{notifications:s,removeNotification:e}}},Rd={class:"notification-container"};function Ud(s,e,o,t,i,l){const a=W("Notification");return c(),q(Ot,{to:"body"},[n("div",Rd,[K(dt,{name:"notification",tag:"div"},{default:ce(()=>[(c(!0),d(U,null,F(t.notifications,r=>(c(),q(a,{key:r.id,notification:r,onClose:g=>t.removeNotification(r.id)},null,8,["notification","onClose"]))),128))]),_:1})])])}const Fd=H(Bd,[["render",Ud],["__scopeId","data-v-dd8772c8"]]),Vd={name:"RealtimeControls",props:{enabled:{type:Boolean,default:!1},connectionState:{type:String,default:"disconnected"},error:{type:String,default:null}},emits:["toggle"],setup(s,{emit:e}){const o=w(s.enabled);pe(()=>s.enabled,h=>{o.value=h});const t=_(()=>s.connectionState==="connecting"),i=_(()=>!!s.error),l=_(()=>({"status-connected":s.connectionState==="connected","status-connecting":s.connectionState==="connecting","status-disconnected":s.connectionState==="disconnected","status-error":s.connectionState==="error"})),a=_(()=>{switch(s.connectionState){case"connected":return"–ü–æ–¥–∫–ª—é—á–µ–Ω–æ";case"connecting":return"–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...";case"disconnected":return"–û—Ç–∫–ª—é—á–µ–Ω–æ";case"error":return"–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è";default:return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"}}),r=_(()=>a.value),g=_(()=>({"status-connected":s.connectionState==="connected","status-connecting":s.connectionState==="connecting","status-disconnected":s.connectionState==="disconnected","status-error":s.connectionState==="error"})),f=_(()=>s.error?typeof s.error=="string"?s.error:s.error.message?s.error.message:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞":null);return{localEnabled:o,isConnecting:t,hasError:i,statusClass:l,statusText:a,connectionStatusText:r,connectionStatusClass:g,displayError:f,handleToggle:()=>{e("toggle",o.value)}}}},jd={class:"realtime-controls"},zd={class:"control-toggle"},Hd=["disabled"],Wd={class:"status-text"},$d={key:0,class:"error-message"};function qd(s,e,o,t,i,l){return c(),d("div",jd,[n("label",zd,[te(n("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=a=>t.localEnabled=a),onChange:e[1]||(e[1]=(...a)=>t.handleToggle&&t.handleToggle(...a)),disabled:t.isConnecting},null,40,Hd),[[yt,t.localEnabled]]),e[2]||(e[2]=n("span",{class:"toggle-label"},"–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ",-1))]),n("div",{class:N(["status-indicator",t.statusClass])},[e[3]||(e[3]=n("span",{class:"status-dot"},null,-1)),n("span",Wd,u(t.statusText),1)],2),t.hasError&&t.displayError?(c(),d("div",$d," ‚ö†Ô∏è "+u(t.displayError),1)):y("",!0)])}const Kd=H(Vd,[["render",qd],["__scopeId","data-v-af36f073"]]),Xd={name:"NewLogsIndicator",props:{count:{type:Number,default:0},newLogs:{type:Array,default:()=>[]}},emits:["apply","dismiss"],setup(s,{emit:e}){const o=(a,r,g,f)=>{const m=a%10,h=a%100;return h>=11&&h<=19?f:m===1?r:m>=2&&m<=4?g:f},t=_(()=>!s.newLogs||!Array.isArray(s.newLogs)||s.newLogs.length===0?[]:s.newLogs.map(r=>Ye(r)).filter(r=>De(r)).slice(0,5).map(r=>({...r,formatted:{event:Ze(r.event),category:Oe(r.category)}})));return{pluralize:o,newLogsPreview:t,handleApply:()=>{if(!s.newLogs||s.newLogs.length===0)return;const a=s.newLogs.map(r=>Ye(r)).filter(r=>De(r));if(a.length===0){console.warn("[NewLogsIndicator] No valid logs to apply");return}e("apply",a)},handleDismiss:()=>{e("dismiss")}}}},Gd={key:0,class:"new-logs-indicator"},Jd={class:"indicator-content"},Yd={class:"indicator-text"},Zd={class:"indicator-actions"};function Qd(s,e,o,t,i,l){return c(),q(Ce,{name:"slide-down"},{default:ce(()=>[o.count>0?(c(),d("div",Gd,[n("div",Jd,[e[2]||(e[2]=n("span",{class:"indicator-icon"},"üîî",-1)),n("span",Yd,u(o.count)+" "+u(t.pluralize(o.count,"–Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ","–Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏—è","–Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π")),1),n("div",Zd,[n("button",{onClick:e[0]||(e[0]=(...a)=>t.handleApply&&t.handleApply(...a)),class:"btn-apply"}," –ü—Ä–∏–º–µ–Ω–∏—Ç—å "),n("button",{onClick:e[1]||(e[1]=(...a)=>t.handleDismiss&&t.handleDismiss(...a)),class:"btn-dismiss"}," ‚úï ")])])])):y("",!0)]),_:1})}const eu=H(Xd,[["render",Qd],["__scopeId","data-v-19791dbc"]]);class tu{constructor(e,o={}){this.url=e,this.options={reconnectInterval:3e3,maxReconnectAttempts:10,reconnectDelay:1e3,lastTimestamp:null,...o},this.eventSource=null,this.listeners=new Map,this.reconnectAttempts=0,this.reconnectTimer=null,this.isManualDisconnect=!1,this.connectionState="disconnected"}updateOptions(e){this.options={...this.options,...e}}connect(){if(this.connectionState==="connected"||this.connectionState==="connecting"){console.warn("[RealtimeService] Already connected or connecting");return}this.isManualDisconnect=!1,this.connectionState="connecting",this.notifyListeners("state-change",{state:this.connectionState});try{let e=this.url;if(!e.startsWith("http://")&&!e.startsWith("https://")){const o=new URL(e,window.location.origin);this.options.lastTimestamp&&o.searchParams.set("last_timestamp",this.options.lastTimestamp),e=o.toString()}else{const o=new URL(e);this.options.lastTimestamp&&o.searchParams.set("last_timestamp",this.options.lastTimestamp),e=o.toString()}console.log("[RealtimeService] Connecting to:",e),this.eventSource=new EventSource(e),this.eventSource.onopen=()=>{console.log("[RealtimeService] EventSource opened"),this.notifyListeners("open",{timestamp:new Date().toISOString()})},this.eventSource.onmessage=o=>{try{const t=JSON.parse(o.data);this.notifyListeners("message",t)}catch(t){console.error("[RealtimeService] Error parsing message:",t)}},this.eventSource.addEventListener("connected",o=>{try{const t=JSON.parse(o.data);console.log("[RealtimeService] Connected event received:",t),this.connectionState="connected",this.reconnectAttempts=0,this.notifyListeners("connected",t),this.notifyListeners("state-change",{state:this.connectionState})}catch(t){console.error("[RealtimeService] Error parsing connected event:",t)}}),this.eventSource.addEventListener("new_logs",o=>{const t=JSON.parse(o.data);if(t.logs&&t.logs.length>0){const i=t.logs[t.logs.length-1];i.timestamp&&(this.options.lastTimestamp=i.timestamp)}this.notifyListeners("new_logs",t)}),this.eventSource.addEventListener("error",o=>{try{const t=JSON.parse(o.data);this.notifyListeners("error",t)}catch{this.notifyListeners("error",{message:"Server error"})}}),this.eventSource.addEventListener("timeout",o=>{try{const t=JSON.parse(o.data);this.notifyListeners("timeout",t)}catch{this.notifyListeners("timeout",{message:"Connection timeout"})}this.reconnect()}),this.eventSource.addEventListener("closed",o=>{try{const t=JSON.parse(o.data);this.notifyListeners("closed",t)}catch{this.notifyListeners("closed",{message:"Connection closed"})}this.isManualDisconnect||this.reconnect()}),this.eventSource.onerror=o=>{console.error("[RealtimeService] Connection error:",o),console.error("[RealtimeService] EventSource readyState:",this.eventSource?.readyState),this.eventSource?.readyState===EventSource.CLOSED?(console.log("[RealtimeService] EventSource closed by server"),this.connectionState="disconnected",this.notifyListeners("state-change",{state:this.connectionState}),this.isManualDisconnect||this.reconnect()):this.eventSource?.readyState===EventSource.CONNECTING?console.log("[RealtimeService] Still connecting..."):(this.connectionState="error",this.notifyListeners("error",{error:o,type:"connection",message:"Failed to connect to realtime stream",readyState:this.eventSource?.readyState}),this.notifyListeners("state-change",{state:this.connectionState}),this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.isManualDisconnect||this.reconnect())}}catch(e){console.error("[RealtimeService] Error creating EventSource:",e),this.connectionState="error",this.notifyListeners("error",{error:e,type:"initialization"}),this.notifyListeners("state-change",{state:this.connectionState}),this.isManualDisconnect||this.reconnect()}}reconnect(){if(this.isManualDisconnect)return;if(this.reconnectAttempts>=this.options.maxReconnectAttempts){console.error("[RealtimeService] Max reconnect attempts reached"),this.notifyListeners("max-reconnect-attempts",{attempts:this.reconnectAttempts});return}this.reconnectAttempts++;const e=Math.min(this.options.reconnectDelay*Math.pow(2,this.reconnectAttempts-1),this.options.reconnectInterval);console.log(`[RealtimeService] Reconnecting in ${e}ms (attempt ${this.reconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect()},e)}disconnect(){this.isManualDisconnect=!0,this.connectionState="disconnected",this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.eventSource&&(this.eventSource.close(),this.eventSource=null),this.notifyListeners("disconnected",{timestamp:new Date().toISOString()}),this.notifyListeners("state-change",{state:this.connectionState})}on(e,o){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(o)}off(e,o){if(this.listeners.has(e)){const t=this.listeners.get(e),i=t.indexOf(o);i>-1&&t.splice(i,1)}}notifyListeners(e,o){this.listeners.has(e)&&this.listeners.get(e).forEach(t=>{try{t(o)}catch(i){console.error(`[RealtimeService] Error in listener for ${e}:`,i)}})}getState(){return this.connectionState}isConnected(){return this.connectionState==="connected"}}function ou(s,e={}){const{autoConnect:o=!1,enableSound:t=!1,onNewLogs:i=null,validateLogs:l=!0}=e,a=new tu(s,e),r=w("disconnected"),g=w([]),f=w(0),m=w(null),h=w(null),b=w(0),p=_(()=>r.value==="connected"),v=_(()=>r.value==="connecting"),S=_(()=>r.value==="error"),D=_(()=>f.value>0),C=R=>{r.value=R.state,R.state==="connected"&&(b.value=0,h.value=null)},M=R=>{let j=R.logs||[];if(l){j=Ft(j);const G=j.filter(ve=>De(ve));G.length!==j.length&&console.warn("[useRealtime] Filtered out invalid logs:",j.length-G.length),j=G}j.length!==0&&(g.value.push(...j),f.value+=j.length,m.value=new Date().toISOString(),t&&j.length>0&&P(),i&&i(j))},I=R=>{const j=R.message||R.error?.message||"Connection error";h.value=j,r.value="error",console.error("[useRealtime] Error:",R)},V=R=>{console.warn("[useRealtime] Connection timeout:",R)},O=R=>{h.value=`Max reconnect attempts reached (${R.attempts})`,console.error("[useRealtime] Max reconnect attempts:",R)},L=(R={})=>{h.value=null,R.lastTimestamp!==void 0&&a.updateOptions({lastTimestamp:R.lastTimestamp}),a.on("state-change",C),a.on("new_logs",M),a.on("error",I),a.on("timeout",V),a.on("max-reconnect-attempts",O),a.connect()},k=()=>{a.off("state-change",C),a.off("new_logs",M),a.off("error",I),a.off("timeout",V),a.off("max-reconnect-attempts",O),a.disconnect()},T=()=>{g.value=[],f.value=0},B=R=>{R&&Array.isArray(R)&&(R.unshift(...g.value),T())},P=()=>{try{const R=new Audio("/sounds/notification.mp3");R.volume=.3,R.play().catch(j=>{console.warn("[useRealtime] Failed to play sound:",j)})}catch(R){console.warn("[useRealtime] Sound not available:",R)}};return o&&ae(()=>{L()}),pt(()=>{k()}),{connectionState:r,isConnected:p,isConnecting:v,hasError:S,newLogs:g,newLogsCount:f,hasNewLogs:D,lastUpdateTime:m,error:h,reconnectAttempts:b,connect:L,disconnect:k,clearNewLogs:T,applyNewLogs:B}}const su=ro(()=>me(()=>import("./WebhookLogsDashboard.vue-i4zl-DjT.js"),__vite__mapDeps([8,4,1,5,2,6,7]),import.meta.url)),nu=ro(()=>me(()=>import("./WebhookLogDetails.vue-BzZ_Q7fI.js"),__vite__mapDeps([9,4,1,5,2,6,7]),import.meta.url)),au={name:"WebhookLogsPage",components:{WebhookLogsDashboard:su,WebhookLogsExport:rc,WebhookLogSearch:fc,WebhookLogFilters:Nc,WebhookLogList:td,WebhookLogDetails:nu,SkeletonLogList:dd,EmptyState:_d,ErrorDisplay:Ad,NotificationContainer:Fd,RealtimeControls:Kd,NewLogsIndicator:eu},setup(){const s=Ie(),{success:e,error:o}=_t(),t=w(!1),i=w(!1),l=w(null),a=w(null),r=w([]),g=(x,E=2)=>{if(x==null)return String(x);if(typeof x=="string")return x;const $=(z,Y=0)=>{if(Y>10)return"[Max Depth]";if(z==null||typeof z!="object")return z;if(Array.isArray(z))return z.map(re=>$(re,Y+1));const ie={};try{for(const re in z)if(Object.prototype.hasOwnProperty.call(z,re))try{const at=z[re];if(typeof at=="function"||at===void 0)continue;ie[re]=$(at,Y+1)}catch{ie[re]="[Error reading property]"}}catch{return"[Error reading object]"}return ie};try{const z=$(x),Y=new WeakSet;return JSON.stringify(z,(ie,re)=>{if(typeof re=="object"&&re!==null){if(Y.has(re))return"[Circular]";Y.add(re)}return re},E)}catch(z){return console.error("[WebhookLogsPage] Error in safeStringify:",z),`[Error: ${z.message}]`}},f=w(null),m=w([]),h=w(""),b=w(null),p=w(null),v=w(!1),{connectionState:S,newLogsCount:D,error:C,connect:M,disconnect:I,applyNewLogs:V,clearNewLogs:O}=ou(Ee("/api/webhook-realtime.php"),{autoConnect:!1,enableSound:!0,validateLogs:!0,onNewLogs:x=>{console.log("[WebhookLogsPage] New logs received:",x.length),x.length>0&&(r.value.unshift(...x),B.value.total+=x.length,e(`–ü–æ–ª—É—á–µ–Ω–æ ${x.length} –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π`))}}),{filters:L,updateFilters:k,clearFilters:T}=_l(),B=w({page:1,limit:50,total:0,pages:0}),P=_(()=>{let x=[...r.value];return h.value&&h.value.trim()&&(x=bl(x,h.value,{caseSensitive:!1,searchInEvent:!0,searchInPayload:!0,searchInDetails:!0,searchInIp:!0})),L.value.category&&(x=x.filter(E=>E.category===L.value.category)),L.value.event&&(x=x.filter(E=>E.event===L.value.event)),L.value.ip&&(x=x.filter(E=>E.ip&&E.ip.includes(L.value.ip))),L.value.status&&(x=x.filter(E=>L.value.status==="error"?E.category==="errors":L.value.status==="success"?E.category!=="errors":!0)),L.value.dateFrom&&(x=x.filter(E=>E.timestamp?new Date(E.timestamp).toISOString().split("T")[0]>=L.value.dateFrom:!1)),L.value.dateTo&&(x=x.filter(E=>E.timestamp?new Date(E.timestamp).toISOString().split("T")[0]<=L.value.dateTo:!1)),L.value.hour!==null&&(x=x.filter(E=>E.timestamp?new Date(E.timestamp).getHours()===L.value.hour:!1)),x});pe(P,x=>{b.value&&h.value&&b.value.setResultsCount(x.length)});const R=async()=>{try{await Pe.init();const x=await Pe.getCurrentUser();if(console.log("[WebhookLogsPage] User data:",x),!x||!x.ID){console.warn("[WebhookLogsPage] User not determined"),a.value=g({error:"User not determined",userId:x?.ID||null,userName:x?`${x.NAME||""} ${x.LAST_NAME||""}`.trim():null}),t.value=!1;return}const E=x?.UF_DEPARTMENT||[];if(console.log("[WebhookLogsPage] User departments:",E),console.log("[WebhookLogsPage] Allowed departments:",ze.allowedDepartmentIds),E.length>0){const $=E.some(z=>po(z));console.log("[WebhookLogsPage] Has access:",$),t.value=$,$||(a.value=g({userId:x.ID,userName:`${x.NAME||""} ${x.LAST_NAME||""}`.trim(),userDepartments:E,allowedDepartments:ze.allowedDepartmentIds,message:"User departments do not match allowed departments"}))}else console.warn("[WebhookLogsPage] User has no departments"),a.value=g({userId:x.ID,userName:`${x.NAME||""} ${x.LAST_NAME||""}`.trim(),userDepartments:[],allowedDepartments:ze.allowedDepartmentIds,message:"User has no departments assigned"}),t.value=!1}catch(x){console.error("[WebhookLogsPage] Error checking access:",x),a.value=g({error:x.message,stack:x.stack}),t.value=!1}},j=_(()=>ze.allowedDepartmentIds.join(", ")),G=async(x=!1)=>{if(t.value&&!(ge&&!x)){ge=!0,i.value=!0,l.value=null;try{const E=new Date().toISOString().split("T")[0],$={category:L.value.category||null,event:L.value.event||null,date:L.value.dateFrom||E,hour:L.value.hour!==null&&L.value.hour!==void 0?L.value.hour:null,ip:L.value.ip||null,status:L.value.status||null,dateFrom:L.value.dateFrom||E,dateTo:L.value.dateTo||null};if(!Pt($))throw new Error("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏");console.log("[WebhookLogsPage] Loading logs with filters:",$);const z=await so.getLogs($,B.value.page,B.value.limit,x);if(console.log("[WebhookLogsPage] API result:",z),console.log("[WebhookLogsPage] Logs count:",z?.logs?.length||0),console.log("[WebhookLogsPage] Pagination:",z?.pagination),!z.success)throw new Error(z.error||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤");kl(z.pagination)?B.value=z.pagination:(console.warn("[WebhookLogsPage] Invalid pagination format, using defaults"),B.value={page:B.value.page,limit:B.value.limit,total:z.logs.length,pages:Math.ceil(z.logs.length/B.value.limit)});const Y=Ft(z.logs),ie=Y.filter(re=>De(re));ie.length!==Y.length&&console.warn("[WebhookLogsPage] Filtered out invalid logs:",Y.length-ie.length),r.value=ie,x&&e("–õ–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã")}catch(E){ve(E)}finally{i.value=!1,ge=!1}}},ve=x=>{console.error("[WebhookLogsPage] API Error:",x),x.status===403?(l.value="–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω",o("–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º –≤–µ–±—Ö—É–∫–æ–≤")):x.status===404?(l.value="–õ–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",o("–õ–æ–≥–∏ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")):x.status>=500?(l.value="–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",o("–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.")):(l.value=x.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞",o(l.value)),x.status>=500&&(r.value=[])},Be=x=>{h.value=x,k({search:x||null})};let ge=!1;const Me=x=>{if(!Pt(x)){o("–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏");return}const E={category:L.value.category,event:L.value.event,dateFrom:L.value.dateFrom,dateTo:L.value.dateTo,hour:L.value.hour,ip:L.value.ip,status:L.value.status},$={category:x?.category||null,event:x?.event||null,dateFrom:x?.dateFrom||null,dateTo:x?.dateTo||null,hour:x?.hour!==void 0?x.hour:null,ip:x?.ip||null,status:x?.status||null},z=Object.keys($).some(Y=>{const ie=E[Y],re=$[Y];return ie!==re});if(!(!z&&!ge)){if(k($),B.value.page=1,z)try{so.invalidateCacheOnFilterChange(E,$)}catch(Y){console.error("[WebhookLogsPage] Error invalidating cache:",Y)}ge||(ge=!0,G(!0).finally(()=>{ge=!1}))}},A=()=>{T(),h.value="",B.value.page=1,G()},J=x=>{f.value=x},Le=()=>{f.value=null},Re=x=>{B.value.page=x,G()},Se=()=>{try{s.push("/")}catch(x){console.error("Navigation error:",x),window.location.hash="#/"}},Ve=x=>{m.value=x},Ue=x=>{console.log("–≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—á–∞—Ç:",x)},kt=x=>{console.log("–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω:",x),e(`–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω: ${x.count} –∑–∞–ø–∏—Å–µ–π –≤ —Ñ–∞–π–ª–µ ${x.filename}`)},Ct=x=>{console.error("–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:",x),o(`–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞: ${x.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"}`)},Ht=()=>{h.value="",A()},Wt=x=>{if(console.log("[WebhookLogsPage] Toggle auto-update:",x),v.value=x,x){let E=null;if(r.value.length>0){const $=r.value[0];$.timestamp&&(E=$.timestamp,console.log("[WebhookLogsPage] Using lastTimestamp:",E))}M({lastTimestamp:E})}else I()},$t=()=>{V(r.value),e("–ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã")},qt=()=>{O()};return ae(async()=>{await R(),t.value&&(L.value.search&&(h.value=L.value.search),await G())}),{hasAccess:t,loading:i,error:l,logs:r,filteredLogs:P,selectedLog:f,selectedLogs:m,filters:L,searchQuery:h,searchComponent:b,pagination:B,previousPeriodStats:p,handleFiltersUpdate:Me,handleFiltersReset:A,handleSearch:Be,handleLogSelect:J,handleLogClose:Le,handlePageChange:Re,handleSelectedLogsUpdate:Ve,handleExportStart:Ue,handleExportComplete:kt,handleExportError:Ct,handleClearSearch:Ht,autoUpdateEnabled:v,connectionState:S,newLogsCount:D,realtimeError:C,handleToggleAutoUpdate:Wt,handleApplyNewLogs:$t,handleDismissNewLogs:qt,allowedDepartmentsText:j,accessDebugInfo:a,goBack:Se}}},iu={class:"webhook-logs-page"},ru={class:"page-header"},lu={class:"page-header-top"},cu={key:0,class:"access-denied"},du={class:"access-denied-content"},uu={class:"access-hint"},gu={key:0,class:"access-debug"},mu={key:1,class:"page-content"},fu={class:"actions-bar"};function hu(s,e,o,t,i,l){const a=W("WebhookLogsDashboard"),r=W("WebhookLogsExport"),g=W("WebhookLogSearch"),f=W("RealtimeControls"),m=W("NewLogsIndicator"),h=W("WebhookLogFilters"),b=W("SkeletonLogList"),p=W("WebhookLogList"),v=W("EmptyState"),S=W("ErrorDisplay"),D=W("WebhookLogDetails"),C=W("NotificationContainer");return c(),d("div",iu,[n("div",ru,[n("div",lu,[n("button",{onClick:e[0]||(e[0]=(...M)=>t.goBack&&t.goBack(...M)),class:"back-button",title:"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É","aria-label":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"},[...e[3]||(e[3]=[n("span",{class:"back-icon","aria-hidden":"true"},"‚Üê",-1),n("span",{class:"back-text"},"–ù–∞–∑–∞–¥",-1)])])]),e[4]||(e[4]=n("h1",null,"–õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤ Bitrix24",-1))]),t.hasAccess?(c(),d("div",mu,[K(a,{logs:t.logs,pagination:t.pagination,"previous-period-stats":t.previousPeriodStats},null,8,["logs","pagination","previous-period-stats"]),n("div",fu,[K(r,{logs:t.filteredLogs,"selected-logs":t.selectedLogs,filters:t.filters,"total-count":t.filteredLogs.length,onExportStart:t.handleExportStart,onExportComplete:t.handleExportComplete,onExportError:t.handleExportError},null,8,["logs","selected-logs","filters","total-count","onExportStart","onExportComplete","onExportError"]),K(g,{modelValue:t.searchQuery,"onUpdate:modelValue":e[1]||(e[1]=M=>t.searchQuery=M),onSearch:t.handleSearch,ref:"searchComponent"},null,8,["modelValue","onSearch"])]),K(f,{enabled:t.autoUpdateEnabled,"connection-state":t.connectionState,error:t.realtimeError,onToggle:t.handleToggleAutoUpdate},null,8,["enabled","connection-state","error","onToggle"]),K(m,{count:t.newLogsCount,onApply:t.handleApplyNewLogs,onDismiss:t.handleDismissNewLogs},null,8,["count","onApply","onDismiss"]),K(h,{filters:t.filters,"onUpdate:filters":t.handleFiltersUpdate,onReset:t.handleFiltersReset},null,8,["filters","onUpdate:filters","onReset"]),K(Ce,{name:"fade"},{default:ce(()=>[t.loading&&t.logs.length===0?(c(),q(b,{key:0,rows:5})):y("",!0)]),_:1}),K(Ce,{name:"fade"},{default:ce(()=>[!t.loading&&t.filteredLogs.length>0?(c(),q(p,{key:0,logs:t.filteredLogs,loading:!1,error:null,pagination:t.pagination,"selected-logs":t.selectedLogs,onSelectLog:t.handleLogSelect,onPageChange:t.handlePageChange,"onUpdate:selectedLogs":t.handleSelectedLogsUpdate},null,8,["logs","pagination","selected-logs","onSelectLog","onPageChange","onUpdate:selectedLogs"])):y("",!0)]),_:1}),K(Ce,{name:"fade"},{default:ce(()=>[!t.loading&&t.filteredLogs.length===0&&!t.error&&t.logs.length===0?(c(),q(v,{key:0,icon:"üì≠",title:"–õ–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",description:"–õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤ –ø–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. –û–Ω–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –æ—Ç Bitrix24.",hints:["–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–∏–ø—É —Å–æ–±—ã—Ç–∏—è","–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥","–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã"],"action-label":"–û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã",onAction:t.handleFiltersReset},null,8,["onAction"])):y("",!0)]),_:1}),K(Ce,{name:"fade"},{default:ce(()=>[!t.loading&&t.filteredLogs.length===0&&!t.error&&t.logs.length>0?(c(),q(v,{key:0,icon:"üîç",title:"–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ",description:"–ü–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã.",hints:["–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞","–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã","–û—á–∏—Å—Ç–∏—Ç–µ –ø–æ–∏—Å–∫ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞"],"action-label":"–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫",onAction:t.handleClearSearch},null,8,["onAction"])):y("",!0)]),_:1}),K(Ce,{name:"fade"},{default:ce(()=>[t.error?(c(),q(S,{key:0,title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤",message:t.error,retryable:!0,onRetry:s.loadLogs},null,8,["message","onRetry"])):y("",!0)]),_:1}),t.selectedLog?(c(),d("div",{key:0,class:"modal-overlay",onClick:e[2]||(e[2]=(...M)=>t.handleLogClose&&t.handleLogClose(...M))})):y("",!0),K(Ce,{name:"modal"},{default:ce(()=>[t.selectedLog?(c(),q(D,{key:0,log:t.selectedLog,onClose:t.handleLogClose},null,8,["log","onClose"])):y("",!0)]),_:1})])):(c(),d("div",cu,[n("div",du,[e[7]||(e[7]=n("h2",null,"–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω",-1)),e[8]||(e[8]=n("p",null,"–£ –≤–∞—Å –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –ª–æ–≥–æ–≤ –≤–µ–±—Ö—É–∫–æ–≤.",-1)),n("p",uu,[e[5]||(e[5]=X(" –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à—ë–Ω —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ –æ—Ç–¥–µ–ª–æ–≤: ",-1)),n("strong",null,u(t.allowedDepartmentsText),1)]),e[9]||(e[9]=n("p",{class:"access-hint"}," –ï—Å–ª–∏ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —É –≤–∞—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã. ",-1)),t.accessDebugInfo?(c(),d("details",gu,[e[6]||(e[6]=n("summary",null,"–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),n("pre",null,u(t.accessDebugInfo),1)])):y("",!0)])])),K(C)])}const vu=H(au,[["render",hu],["__scopeId","data-v-628bf174"]]),yu={name:"DrillDownNavigation",props:{breadcrumbs:{type:Array,default:()=>[],validator:s=>Array.isArray(s)&&s.every(e=>typeof e=="object"&&typeof e.id=="string"&&typeof e.label=="string")},separator:{type:String,default:">"},showBackButton:{type:Boolean,default:!0},additionalActions:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},maxLabelLength:{type:Number,default:30}},emits:["navigate","back","action"],setup(s,{emit:e}){const o=_(()=>s.breadcrumbs.map(g=>({...g,label:i(g.label,s.maxLabelLength)}))),t=_(()=>{const g=o.value;return g.length<=5?g:[g[0],{id:"ellipsis-start",label:"...",isEllipsis:!0},...g.slice(-3)]}),i=(g,f)=>g.length<=f?g:g.substring(0,f-3)+"...";return{visibleBreadcrumbs:t,handleNavigate:g=>{g.action&&e("navigate",g)},handleBack:()=>{e("back")},handleAction:g=>{e("action",g)}}}},pu={class:"drilldown-navigation",role:"navigation","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"},_u={class:"breadcrumb-list"},bu={key:0,class:"breadcrumb-separator","aria-hidden":"true"},ku=["onClick","onKeydown","aria-label","title"],Cu={class:"breadcrumb-text"},Su={key:2,class:"breadcrumb-current-text","aria-current":"page"},wu={class:"breadcrumb-text"},Tu={key:3,class:"breadcrumb-loading","aria-label":"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö"},Eu=["aria-label","title"],xu={key:1,class:"breadcrumb-actions"},Au=["onClick","onKeydown","aria-label","title","disabled"],Du={key:1,class:"action-text"};function Iu(s,e,o,t,i,l){return c(),d("nav",pu,[n("ol",_u,[(c(!0),d(U,null,F(o.breadcrumbs,(a,r)=>(c(),d("li",{key:a.id,class:N(["breadcrumb-item",{"breadcrumb-current":r===o.breadcrumbs.length-1,"breadcrumb-interactive":r<o.breadcrumbs.length-1}])},[r>0?(c(),d("span",bu,u(o.separator),1)):y("",!0),r<o.breadcrumbs.length-1&&a.action?(c(),d("button",{key:1,class:"breadcrumb-link",onClick:g=>t.handleNavigate(a),onKeydown:[se(g=>t.handleNavigate(a),["enter"]),se(g=>t.handleNavigate(a),["space"])],"aria-label":`–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–∞–∑–¥–µ–ª—É ${a.label}`,title:`–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ ${a.label}`},[a.icon?(c(),q(Xe(a.icon),{key:0,class:"breadcrumb-icon","aria-hidden":"true"})):y("",!0),n("span",Cu,u(a.label),1)],40,ku)):(c(),d("span",Su,[a.icon?(c(),q(Xe(a.icon),{key:0,class:"breadcrumb-icon","aria-hidden":"true"})):y("",!0),n("span",wu,u(a.label),1)])),r===o.breadcrumbs.length-1&&o.isLoading?(c(),d("div",Tu,[...e[3]||(e[3]=[n("div",{class:"loading-spinner","aria-hidden":"true"},null,-1)])])):y("",!0)],2))),128))]),o.showBackButton&&o.breadcrumbs.length>1?(c(),d("button",{key:0,class:"back-button",onClick:e[0]||(e[0]=(...a)=>t.handleBack&&t.handleBack(...a)),onKeydown:[e[1]||(e[1]=se((...a)=>t.handleBack&&t.handleBack(...a),["enter"])),e[2]||(e[2]=se((...a)=>t.handleBack&&t.handleBack(...a),["space"]))],"aria-label":`–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ ${o.breadcrumbs[o.breadcrumbs.length-2]?.label||"–ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É"}`,title:`–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ ${o.breadcrumbs[o.breadcrumbs.length-2]?.label||"–ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —Ä–∞–∑–¥–µ–ª—É"}`},[...e[4]||(e[4]=[n("svg",{class:"back-icon",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})],-1),n("span",{class:"back-text"},"–ù–∞–∑–∞–¥",-1)])],40,Eu)):y("",!0),o.additionalActions.length>0?(c(),d("div",xu,[(c(!0),d(U,null,F(o.additionalActions,a=>(c(),d("button",{key:a.id,class:N(["action-button",a.class]),onClick:r=>t.handleAction(a),onKeydown:[se(r=>t.handleAction(a),["enter"]),se(r=>t.handleAction(a),["space"])],"aria-label":a.label,title:a.title||a.label,disabled:a.disabled},[a.icon?(c(),q(Xe(a.icon),{key:0,class:"action-icon","aria-hidden":"true"})):y("",!0),a.text?(c(),d("span",Du,u(a.text),1)):y("",!0)],42,Au))),128))])):y("",!0)])}const Mu=H(yu,[["render",Iu],["__scopeId","data-v-e0da3deb"]]),Lu={name:"MetricCard",emits:["click"],props:{metric:{type:Object,default:()=>({})},title:{type:String,required:!0},value:{type:[Number,String],required:!0},unit:{type:String,default:""},subtitle:{type:String,default:""},icon:{type:String,default:""},trend:{type:Number,default:null},trendPeriod:{type:String,default:""},progress:{type:Number,default:null},size:{type:String,default:"medium",validator:s=>["small","medium","large","compact"].includes(s)},interactive:{type:Boolean,default:!1}},computed:{formattedValue(){return typeof this.value=="number"?this.value>=1e6?`${(this.value/1e6).toFixed(1)}M`:this.value>=1e3?`${(this.value/1e3).toFixed(1)}K`:this.value.toLocaleString():this.value}}},Pu={class:"metric-header"},Nu=["innerHTML"],Ou={class:"metric-title"},Bu={class:"metric-value-section"},Ru={class:"metric-value"},Uu={key:0,class:"metric-unit"},Fu={key:0,class:"metric-subtitle"},Vu={key:1,class:"metric-trend"},ju={class:"trend-indicator"},zu={key:0,viewBox:"0 0 24 24",width:"12",height:"12"},Hu={key:1,viewBox:"0 0 24 24",width:"12",height:"12"},Wu={key:2,viewBox:"0 0 24 24",width:"12",height:"12"},$u={class:"trend-value"},qu={class:"trend-period"},Ku={key:2,class:"metric-progress"},Xu={class:"progress-bar"},Gu={class:"progress-text"};function Ju(s,e,o,t,i,l){return c(),d("div",{class:N(["metric-card",{[`size-${o.size}`]:!0,"has-trend":o.trend!==null,"trend-up":o.trend>0,"trend-down":o.trend<0,"trend-neutral":o.trend===0,interactive:o.interactive}]),onClick:e[0]||(e[0]=a=>o.interactive?s.$emit("click",o.metric):null)},[n("div",Pu,[o.icon?(c(),d("div",{key:0,class:"metric-icon",innerHTML:o.icon},null,8,Nu)):y("",!0),n("div",Ou,u(o.title),1)]),n("div",Bu,[n("div",Ru,u(l.formattedValue),1),o.unit?(c(),d("div",Uu,u(o.unit),1)):y("",!0)]),o.subtitle?(c(),d("div",Fu,u(o.subtitle),1)):y("",!0),o.trend!==null?(c(),d("div",Vu,[n("div",ju,[o.trend>0?(c(),d("svg",zu,[...e[1]||(e[1]=[n("path",{d:"M7 14l5-5 5 5z",fill:"currentColor"},null,-1)])])):o.trend<0?(c(),d("svg",Hu,[...e[2]||(e[2]=[n("path",{d:"M7 10l5 5 5-5z",fill:"currentColor"},null,-1)])])):(c(),d("svg",Wu,[...e[3]||(e[3]=[n("path",{d:"M7 12h10v-2H7z",fill:"currentColor"},null,-1)])]))]),n("span",$u,u(Math.abs(o.trend))+"%",1),n("span",qu,u(o.trendPeriod||"vs prev"),1)])):y("",!0),o.progress!==null?(c(),d("div",Ku,[n("div",Xu,[n("div",{class:"progress-fill",style:oe({width:`${Math.min(o.progress,100)}%`})},null,4)]),n("span",Gu,u(o.progress)+"%",1)])):y("",!0)],2)}const Yu=H(Lu,[["render",Ju],["__scopeId","data-v-b8d66bef"]]),Zu={name:"ContextSidebar",components:{MetricCard:Yu},props:{context:{type:String,default:"global",validator:s=>["global","user","management"].includes(s)},selectedUser:{type:Object,default:null},selectedUsers:{type:Array,default:()=>[]},globalMetrics:{type:Array,default:()=>[]},userStats:{type:Object,default:()=>({})},userFilters:{type:Object,default:()=>({timeRange:"week",activity_types:[]})},filterPresets:{type:Array,default:()=>[]},activePreset:{type:String,default:null},recentActivity:{type:Array,default:()=>[]},auditLog:{type:Array,default:()=>[]},activityTypes:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},collapsed:{type:Boolean,default:!1},canEditPermissions:{type:Boolean,default:!1}},emits:["toggle-collapse","metric-click","filter-preset-apply","activity-click","filter-change","view-profile","export-data","edit-permissions","bulk-action","user-select"],setup(s,{emit:e}){const o=w(s.collapsed),t=_(()=>{if(!s.selectedUser?.name)return"";const[I,V]=s.selectedUser.name.split(" ");return`${I?.[0]||""}${V?.[0]||""}`.toUpperCase()}),i=()=>{o.value=!o.value,e("toggle-collapse",o.value)},l=()=>{switch(s.context){case"global":return"–û–±–∑–æ—Ä";case"user":return"–ê–Ω–∞–ª–∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è";case"management":return"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ";default:return"–û–±–∑–æ—Ä"}},a=()=>`${l()} - –±–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π`,r=I=>{switch(I){case"online":return"–û–Ω–ª–∞–π–Ω";case"away":return"–û—Ç–æ—à—ë–ª";case"offline":return"–û—Ñ—Ñ–ª–∞–π–Ω";default:return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}},g=I=>{if(!I)return"";const[V,O]=I.split(" ");return`${V?.[0]||""}${O?.[0]||""}`.toUpperCase()},f=I=>{const V=Math.floor(I/60),O=I%60;return`${V}:${O.toString().padStart(2,"0")}`},m=I=>{const V=new Date(I),L=new Date-V,k=Math.floor(L/(1e3*60)),T=Math.floor(L/(1e3*60*60)),B=Math.floor(L/(1e3*60*60*24));return k<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":k<60?`${k} –º–∏–Ω –Ω–∞–∑–∞–¥`:T<24?`${T} —á –Ω–∞–∑–∞–¥`:B<7?`${B} –¥ –Ω–∞–∑–∞–¥`:V.toLocaleDateString()},h=I=>{e("metric-click",I)},b=I=>{e("filter-preset-apply",I)},p=I=>{e("activity-click",I)},v=()=>{e("filter-change",s.userFilters)},S=()=>{e("view-profile",s.selectedUser)},D=()=>{e("export-data",s.selectedUser)},C=()=>{e("edit-permissions",s.selectedUser)},M=I=>{e("bulk-action",{action:I,users:s.selectedUsers})};return pe(()=>s.collapsed,I=>{o.value=I}),{isCollapsed:o,userInitials:t,toggleCollapse:i,getContextTitle:l,getAriaLabel:a,getStatusText:r,getUserInitials:g,formatDuration:f,formatTime:m,handleMetricClick:h,applyFilterPreset:b,handleActivityClick:p,handleFilterChange:v,viewDetailedProfile:S,exportUserData:D,editPermissions:C,performBulkAction:M}}},Qu=["aria-label"],eg=["aria-label","title"],tg={class:"sidebar-header"},og={class:"context-title"},sg={key:0,class:"user-indicator"},ng={class:"user-avatar"},ag=["src","alt"],ig={key:1,class:"avatar-placeholder"},rg={class:"user-info"},lg={class:"user-name"},cg={key:0,class:"global-context-content"},dg={class:"metrics-section"},ug={class:"metrics-grid"},gg={class:"filters-section"},mg={class:"filter-presets"},fg=["onClick","aria-label"],hg={class:"preset-label"},vg={key:0,class:"preset-count"},yg={class:"recent-activity-section"},pg={class:"recent-activity-list"},_g=["onClick"],bg={class:"activity-content"},kg={class:"activity-text"},Cg={class:"activity-time"},Sg={key:1,class:"user-context-content"},wg={class:"user-stats-section"},Tg={class:"user-stats-grid"},Eg={class:"stat-item"},xg={class:"stat-value"},Ag={class:"stat-item"},Dg={class:"stat-value"},Ig={class:"stat-item"},Mg={class:"stat-value"},Lg={class:"stat-item"},Pg={class:"stat-value"},Ng={class:"analysis-filters-section"},Og={class:"filter-controls"},Bg={class:"filter-group"},Rg={class:"filter-group"},Ug={class:"checkbox-group"},Fg=["value"],Vg={class:"user-actions-section"},jg={class:"action-buttons"},zg=["aria-label"],Hg=["aria-label"],Wg=["aria-label"],$g={key:2,class:"management-context-content"},qg={key:0,class:"selected-users-section"},Kg={class:"section-title"},Xg={class:"selected-users-list"},Gg={class:"user-avatar small"},Jg=["src","alt"],Yg={key:1,class:"avatar-placeholder small"},Zg={class:"user-name"},Qg={key:0,class:"more-users"},em={class:"bulk-operations-section"},tm={class:"bulk-actions"},om=["disabled"],sm=["disabled"],nm=["disabled"],am={class:"audit-log-section"},im={class:"audit-log-list"},rm={class:"audit-content"},lm={class:"audit-text"},cm={class:"audit-time"},dm={key:0,class:"sidebar-loading-overlay"};function um(s,e,o,t,i,l){const a=W("MetricCard");return c(),d("aside",{class:N(["context-sidebar",{collapsed:t.isCollapsed,"context-global":o.context==="global","context-user":o.context==="user","context-management":o.context==="management"}]),role:"complementary","aria-label":t.getAriaLabel()},[n("button",{class:"collapse-toggle",onClick:e[0]||(e[0]=(...r)=>t.toggleCollapse&&t.toggleCollapse(...r)),onKeydown:[e[1]||(e[1]=se((...r)=>t.toggleCollapse&&t.toggleCollapse(...r),["enter"])),e[2]||(e[2]=se((...r)=>t.toggleCollapse&&t.toggleCollapse(...r),["space"]))],"aria-label":t.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å":"–°–≤–µ—Ä–Ω—É—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å",title:t.isCollapsed?"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å":"–°–≤–µ—Ä–Ω—É—Ç—å –±–æ–∫–æ–≤—É—é –ø–∞–Ω–µ–ª—å"},[(c(),d("svg",{class:N(["collapse-icon",{rotated:t.isCollapsed}]),viewBox:"0 0 24 24","aria-hidden":"true"},[...e[13]||(e[13]=[n("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"},null,-1)])],2))],40,eg),n("header",tg,[n("h3",og,u(t.getContextTitle()),1),o.context==="user"&&o.selectedUser?(c(),d("div",sg,[n("div",ng,[o.selectedUser.avatar?(c(),d("img",{key:0,src:o.selectedUser.avatar,alt:`–ê–≤–∞—Ç–∞—Ä ${o.selectedUser.name}`},null,8,ag)):(c(),d("div",ig,u(t.userInitials),1))]),n("div",rg,[n("div",lg,u(o.selectedUser.name),1),n("div",{class:N(["user-status",o.selectedUser.status])},u(t.getStatusText(o.selectedUser.status)),3)])])):y("",!0)]),n("div",{class:N(["sidebar-content",{"content-collapsed":t.isCollapsed}])},[o.context==="global"?(c(),d("div",cg,[n("section",dg,[e[14]||(e[14]=n("h4",{class:"section-title"},"–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",-1)),n("div",ug,[(c(!0),d(U,null,F(o.globalMetrics,r=>(c(),q(a,{key:r.id,metric:r,size:"compact",onClick:t.handleMetricClick},null,8,["metric","onClick"]))),128))])]),n("section",gg,[e[15]||(e[15]=n("h4",{class:"section-title"},"–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã",-1)),n("div",mg,[(c(!0),d(U,null,F(o.filterPresets,r=>(c(),d("button",{key:r.id,class:N(["filter-preset",{active:o.activePreset===r.id}]),onClick:g=>t.applyFilterPreset(r),"aria-label":`–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä: ${r.label}`},[(c(),q(Xe(r.icon),{class:"preset-icon"})),n("span",hg,u(r.label),1),r.count!==void 0?(c(),d("span",vg,u(r.count),1)):y("",!0)],10,fg))),128))])]),n("section",yg,[e[16]||(e[16]=n("h4",{class:"section-title"},"–ù–µ–¥–∞–≤–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è",-1)),n("div",pg,[(c(!0),d(U,null,F(o.recentActivity,r=>(c(),d("div",{key:r.id,class:"activity-item",onClick:g=>t.handleActivityClick(r)},[n("div",{class:N(["activity-icon",r.type])},[(c(),q(Xe(r.icon)))],2),n("div",bg,[n("div",kg,u(r.text),1),n("div",Cg,u(t.formatTime(r.timestamp)),1)])],8,_g))),128))])])])):o.context==="user"?(c(),d("div",Sg,[n("section",wg,[e[21]||(e[21]=n("h4",{class:"section-title"},"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",-1)),n("div",Tg,[n("div",Eg,[n("div",xg,u(o.userStats.total_actions||0),1),e[17]||(e[17]=n("div",{class:"stat-label"},"–¥–µ–π—Å—Ç–≤–∏–π",-1)),o.userStats.actions_change!==0?(c(),d("div",{key:0,class:N(["stat-change",{positive:o.userStats.actions_change>0,negative:o.userStats.actions_change<0}])},u(o.userStats.actions_change>0?"+":"")+u(o.userStats.actions_change)+"% ",3)):y("",!0)]),n("div",Ag,[n("div",Dg,u(t.formatDuration(o.userStats.avg_session_duration||0)),1),e[18]||(e[18]=n("div",{class:"stat-label"},"—Å—Ä–µ–¥–Ω—è—è —Å–µ—Å—Å–∏—è",-1))]),n("div",Ig,[n("div",Mg,u(o.userStats.total_sessions||0),1),e[19]||(e[19]=n("div",{class:"stat-label"},"—Å–µ—Å—Å–∏–π",-1))]),n("div",Lg,[n("div",Pg,u(o.userStats.activity_score||0)+"/100",1),e[20]||(e[20]=n("div",{class:"stat-label"},"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",-1))])])]),n("section",Ng,[e[26]||(e[26]=n("h4",{class:"section-title"},"–§–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–∏–∑–∞",-1)),n("div",Og,[n("div",Bg,[e[23]||(e[23]=n("label",{class:"filter-label"},"–ü–µ—Ä–∏–æ–¥:",-1)),te(n("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.userFilters.timeRange=r),class:"filter-select",onChange:e[4]||(e[4]=(...r)=>t.handleFilterChange&&t.handleFilterChange(...r))},[...e[22]||(e[22]=[qe('<option value="today" data-v-abccaced>–°–µ–≥–æ–¥–Ω—è</option><option value="week" data-v-abccaced>–ù–µ–¥–µ–ª—è</option><option value="month" data-v-abccaced>–ú–µ—Å—è—Ü</option><option value="quarter" data-v-abccaced>–ö–≤–∞—Ä—Ç–∞–ª</option><option value="year" data-v-abccaced>–ì–æ–¥</option>',5)])],544),[[Te,o.userFilters.timeRange]])]),n("div",Rg,[e[25]||(e[25]=n("label",{class:"filter-label"},"–¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π:",-1)),n("div",Ug,[(c(!0),d(U,null,F(o.activityTypes,r=>(c(),d("label",{key:r.id,class:"checkbox-label"},[te(n("input",{type:"checkbox",value:r.id,"onUpdate:modelValue":e[5]||(e[5]=g=>o.userFilters.activity_types=g),onChange:e[6]||(e[6]=(...g)=>t.handleFilterChange&&t.handleFilterChange(...g))},null,40,Fg),[[yt,o.userFilters.activity_types]]),e[24]||(e[24]=n("span",{class:"checkmark"},null,-1)),X(" "+u(r.label),1)]))),128))])])])]),n("section",Vg,[e[30]||(e[30]=n("h4",{class:"section-title"},"–î–µ–π—Å—Ç–≤–∏—è",-1)),n("div",jg,[n("button",{class:"action-button primary",onClick:e[7]||(e[7]=(...r)=>t.viewDetailedProfile&&t.viewDetailedProfile(...r)),"aria-label":`–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å ${o.selectedUser?.name}`},[...e[27]||(e[27]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L19 6.6C18.8 6 18.5 5.4 18.1 4.9L19 3L17 1L15.4 1.9C14.9 1.5 14.3 1.2 13.7 1L13 0V2C12.4 2 11.8 2.2 11.3 2.6L10.6 1.9L8.6 3L9.5 4.9C9.1 5.4 8.8 6 8.6 6.6L7 7V9L8.6 8.4C8.8 9 9.1 9.6 9.5 10.1L8.6 12L10.6 13.9L11.3 13.2C11.8 13.6 12.4 13.8 13 14V16H11V18H13V20H11V22H13V20H15V18H13V16H15V14C15.6 14 16.2 13.6 16.7 13.2L17.4 13.9L19.4 12L18.5 10.1C18.9 9.6 19.2 9 19.4 8.4L21 9ZM12 8C10.9 8 10 7.1 10 6C10 4.9 10.9 4 12 4C13.1 4 14 4.9 14 6C14 7.1 13.1 8 12 8Z"})],-1),X(" –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å ",-1)])],8,zg),n("button",{class:"action-button secondary",onClick:e[8]||(e[8]=(...r)=>t.exportUserData&&t.exportUserData(...r)),"aria-label":`–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ ${o.selectedUser?.name}`},[...e[28]||(e[28]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1),X(" –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö ",-1)])],8,Hg),o.canEditPermissions?(c(),d("button",{key:0,class:"action-button warning",onClick:e[9]||(e[9]=(...r)=>t.editPermissions&&t.editPermissions(...r)),"aria-label":`–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ ${o.selectedUser?.name}`},[...e[29]||(e[29]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,6V8H13V6H11M11,10V18H13V10H11Z"})],-1),X(" –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ ",-1)])],8,Wg)):y("",!0)])])])):o.context==="management"?(c(),d("div",$g,[o.selectedUsers.length>0?(c(),d("section",qg,[n("h4",Kg,"–í—ã–±—Ä–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: "+u(o.selectedUsers.length),1),n("div",Xg,[(c(!0),d(U,null,F(o.selectedUsers.slice(0,3),r=>(c(),d("div",{key:r.id,class:"selected-user-item"},[n("div",Gg,[r.avatar?(c(),d("img",{key:0,src:r.avatar,alt:r.name},null,8,Jg)):(c(),d("div",Yg,u(t.getUserInitials(r.name)),1))]),n("span",Zg,u(r.name),1)]))),128)),o.selectedUsers.length>3?(c(),d("div",Qg," +"+u(o.selectedUsers.length-3)+" –µ—â—ë ",1)):y("",!0)])])):y("",!0),n("section",em,[e[34]||(e[34]=n("h4",{class:"section-title"},"–ú–∞—Å—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",-1)),n("div",tm,[n("button",{class:"bulk-action-button",onClick:e[10]||(e[10]=r=>t.performBulkAction("change_department")),disabled:o.selectedUsers.length===0},[...e[31]||(e[31]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,6V8H13V6H11M11,10V18H13V10H11Z"})],-1),X(" –ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª ",-1)])],8,om),n("button",{class:"bulk-action-button",onClick:e[11]||(e[11]=r=>t.performBulkAction("toggle_admin")),disabled:o.selectedUsers.length===0},[...e[32]||(e[32]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,6V8H13V6H11M11,10V18H13V10H11Z"})],-1),X(" –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ ",-1)])],8,sm),n("button",{class:"bulk-action-button",onClick:e[12]||(e[12]=r=>t.performBulkAction("export")),disabled:o.selectedUsers.length===0},[...e[33]||(e[33]=[n("svg",{class:"action-icon",viewBox:"0 0 24 24"},[n("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1),X(" –≠–∫—Å–ø–æ—Ä—Ç ",-1)])],8,nm)])]),n("section",am,[e[35]||(e[35]=n("h4",{class:"section-title"},"–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è",-1)),n("div",im,[(c(!0),d(U,null,F(o.auditLog.slice(0,5),r=>(c(),d("div",{key:r.id,class:"audit-entry"},[n("div",{class:N(["audit-icon",r.type])},[(c(),q(Xe(r.icon)))],2),n("div",rm,[n("div",lm,u(r.text),1),n("div",cm,u(t.formatTime(r.timestamp)),1)])]))),128))])])])):y("",!0)],2),o.isLoading?(c(),d("div",dm,[...e[36]||(e[36]=[n("div",{class:"loading-spinner","aria-label":"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö"},null,-1)])])):y("",!0)],10,Qu)}const gm=H(Zu,[["render",um],["__scopeId","data-v-abccaced"]]),ao=s=>new Date(s),mm=(s,e,o={})=>{const t=new Date(s),i=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return e.replace("yyyy",i).replace("MM",l).replace("dd",a)},fm={name:"UnifiedUserCard",props:{user:{type:Object,required:!0,validator:s=>s&&typeof s=="object"&&s.id&&s.name&&s.email},isSelected:{type:Boolean,default:!1},showExtendedMetrics:{type:Boolean,default:!1},compactView:{type:Boolean,default:!1},canEditPermissions:{type:Boolean,default:!1},canDelete:{type:Boolean,default:!1},maxDepartments:{type:Number,default:2}},emits:["select","view-profile","edit-permissions","toggle-hidden","view-analytics","export-data","send-notification","view-audit","delete-user"],setup(s,{emit:e}){const o=w(!1),t=w(null),i=_(()=>{const[A,J]=s.user.name.split(" ");return`${A?.[0]||""}${J?.[0]||""}`.toUpperCase()}),l=_(()=>{const A=["#2196F3","#4CAF50","#FF9800","#F44336","#9C27B0","#00BCD4","#8BC34A","#FFC107","#E91E63","#3F51B5"];return A[Math.abs(s.user.id)%A.length]}),a=_(()=>(s.user.departments||[]).slice(0,s.maxDepartments).map(J=>({...J,shortName:J.name.length>10?J.name.substring(0,8)+"...":J.name}))),r=_(()=>{const A=s.user.departments||[];return Math.max(0,A.length-s.maxDepartments)}),g=_(()=>{const A=s.user.activity_stats?.total_actions||0;return A>=1e6?`${(A/1e6).toFixed(1)}M`:A>=1e3?`${(A/1e3).toFixed(1)}K`:A.toLocaleString()}),f=_(()=>{const A=s.user.activity_stats?.total_sessions||0;return A>=1e3?`${(A/1e3).toFixed(1)}K`:A.toString()}),m=_(()=>{const A=s.user.activity_stats?.avg_session_duration||0,J=Math.floor(A/60),Le=Math.floor(A%60);return`${J}:${Le.toString().padStart(2,"0")}`}),h=_(()=>{const A=s.user.activity_stats?.last_activity;if(!A)return"–ù–∏–∫–æ–≥–¥–∞";let J;try{J=typeof A=="string"?ao(A):new Date(A)}catch{return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"}const Re=new Date-J,Se=Math.floor(Re/(1e3*60*60*24)),Ve=Math.floor(Re/(1e3*60*60)),Ue=Math.floor(Re/(1e3*60));return Ue<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":Ue<60?`${Ue} –º–∏–Ω`:Ve<24?`${Ve} —á`:Se<7?`${Se} –¥`:Se<30?`${Math.floor(Se/7)} –Ω–µ–¥`:mm(J,"dd.MM.yyyy")}),b=_(()=>Math.min(100,Math.max(0,s.user.activity_stats?.activity_score||0))),p=_(()=>s.user.activity_stats?.actions_change_percent||0),v=_(()=>s.user.status||"offline"),S=_(()=>!!s.user.is_admin),D=_(()=>{if(!s.user.created_at)return!1;try{const A=typeof s.user.created_at=="string"?ao(s.user.created_at):new Date(s.user.created_at);return Math.floor((new Date-A)/(1e3*60*60*24))<=7}catch{return!1}}),C=_(()=>!!s.user.is_hidden),M=_(()=>s.user.name||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"),I=_(()=>s.user.email||""),V=_(()=>s.user.avatar||null),O=()=>{e("select",s.user)},L=()=>{e("view-profile",s.user)},k=()=>{e("edit-permissions",s.user)},T=()=>{e("toggle-hidden",s.user)},B=()=>{o.value=!0;const A=J=>{t.value&&!t.value.contains(J.target)&&(o.value=!1,document.removeEventListener("click",A))};setTimeout(()=>{document.addEventListener("click",A)},0)},P=()=>{o.value=!1,e("view-analytics",s.user)},R=()=>{o.value=!1,e("export-data",s.user)},j=()=>{o.value=!1,e("send-notification",s.user)},G=()=>{o.value=!1,e("view-audit",s.user)},ve=()=>{o.value=!1,confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${s.user.name}?`)&&e("delete-user",s.user)},Be=()=>{console.warn(`Failed to load avatar for user ${s.user.id}`)},ge=A=>{switch(A){case"online":return"–æ–Ω–ª–∞–π–Ω";case"away":return"–æ—Ç–æ—à—ë–ª";case"offline":return"–æ—Ñ—Ñ–ª–∞–π–Ω";default:return"–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}},Me=A=>{if(A.key==="Enter"||A.key===" ")A.preventDefault(),O();else if(A.key==="ArrowDown"){A.preventDefault();const J=A.target.nextElementSibling;J&&J.focus()}else if(A.key==="ArrowUp"){A.preventDefault();const J=A.target.previousElementSibling;J&&J.focus()}};return ae(()=>{const A=document.querySelector(`[data-user-id="${s.user.id}"]`);A&&A.addEventListener("keydown",Me)}),pt(()=>{const A=document.querySelector(`[data-user-id="${s.user.id}"]`);A&&A.removeEventListener("keydown",Me)}),{showContextMenuFlag:o,contextMenuRef:t,userInitials:i,avatarColor:l,visibleDepartments:a,hiddenDepartmentsCount:r,totalActionsFormatted:g,totalSessionsFormatted:f,avgSessionDurationFormatted:m,lastActivityFormatted:h,activityScore:b,actionsChange:p,userStatus:v,isAdmin:S,isNew:D,isHidden:C,userName:M,userEmail:I,userAvatar:V,handleSelect:O,viewProfile:L,editPermissions:k,toggleHidden:T,showContextMenu:B,viewDetailedAnalytics:P,exportUserData:R,sendNotification:j,viewAuditLog:G,deleteUser:ve,handleAvatarError:Be,getStatusText:ge}}},hm=["aria-label","aria-selected","aria-describedby"],vm={class:"user-avatar-section"},ym={class:"avatar-container"},pm=["src","alt"],_m=["title"],bm={key:2,class:"new-indicator",title:"–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"},km={class:"user-info-section"},Cm={class:"user-header"},Sm={class:"user-name"},wm={class:"user-badges"},Tm={key:0,class:"badge admin",title:"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"},Em={key:1,class:"badge hidden",title:"–°–∫—Ä—ã—Ç—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"},xm={class:"user-email"},Am={key:0,class:"user-departments"},Dm=["title"],Im=["title"],Mm={class:"user-metrics-section"},Lm={class:"metric primary"},Pm={class:"metric-value"},Nm=["title"],Om={class:"metric secondary"},Bm={class:"metric-value"},Rm={key:0,class:"activity-score"},Um={class:"score-bar"},Fm=["title"],Vm={key:1,class:"mini-metrics"},jm={class:"mini-metric"},zm={class:"mini-metric"},Hm={class:"user-actions-section"},Wm=["aria-label","title"],$m=["aria-label","title"],qm=["aria-label","title"],Km=["aria-label"],Xm=["aria-label"],Gm=["aria-label"],Jm=["aria-label"],Ym=["aria-label"],Zm=["aria-label"],Qm=["aria-label"],ef=["id"],tf={key:1,class:"selection-indicator","aria-hidden":"true"};function of(s,e,o,t,i,l){return c(),d("div",{class:N(["unified-user-card",{selected:o.isSelected,"activity-high":t.activityScore>=80,"activity-medium":t.activityScore>=50&&t.activityScore<80,"activity-low":t.activityScore<50,"status-online":t.userStatus==="online","status-away":t.userStatus==="away","status-offline":t.userStatus==="offline","has-departments":t.visibleDepartments.length>0,"is-admin":t.isAdmin,"is-new":t.isNew,"is-hidden":t.isHidden,"compact-view":o.compactView}]),onClick:e[10]||(e[10]=(...a)=>t.handleSelect&&t.handleSelect(...a)),onDblclick:e[11]||(e[11]=(...a)=>t.viewProfile&&t.viewProfile(...a)),onKeydown:[e[12]||(e[12]=se((...a)=>t.handleSelect&&t.handleSelect(...a),["enter"])),e[13]||(e[13]=se((...a)=>t.handleSelect&&t.handleSelect(...a),["space"]))],onContextmenu:e[14]||(e[14]=de((...a)=>t.showContextMenu&&t.showContextMenu(...a),["prevent"])),tabindex:"0",role:"button","aria-label":`–í—ã–±—Ä–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${t.userName}`,"aria-selected":o.isSelected,"aria-describedby":`user-card-${o.user.id}-description`},[n("div",vm,[n("div",ym,[t.userAvatar?(c(),d("img",{key:0,src:t.userAvatar,alt:`–ê–≤–∞—Ç–∞—Ä ${t.userName}`,class:"user-avatar",onError:e[0]||(e[0]=(...a)=>t.handleAvatarError&&t.handleAvatarError(...a))},null,40,pm)):(c(),d("div",{key:1,class:"avatar-placeholder",style:oe({backgroundColor:t.avatarColor})},u(t.userInitials),5)),n("div",{class:N(["status-indicator",t.userStatus]),title:`–°—Ç–∞—Ç—É—Å: ${t.getStatusText(t.userStatus)}`},null,10,_m),t.isNew?(c(),d("div",bm," NEW ")):y("",!0)])]),n("div",km,[n("div",Cm,[n("h4",Sm,u(t.userName),1),n("div",wm,[t.isAdmin?(c(),d("span",Tm," –ê–¥–º–∏–Ω ")):y("",!0),t.isHidden?(c(),d("span",Em," –°–∫—Ä—ã—Ç ")):y("",!0)])]),n("p",xm,u(t.userEmail),1),t.visibleDepartments.length>0?(c(),d("div",Am,[(c(!0),d(U,null,F(t.visibleDepartments,a=>(c(),d("span",{key:a.id,class:"dept-tag",style:oe({backgroundColor:a.color}),title:a.name},u(a.shortName||a.name),13,Dm))),128)),t.hiddenDepartmentsCount>0?(c(),d("span",{key:0,class:"dept-more",title:`–ï—â—ë ${t.hiddenDepartmentsCount} –æ—Ç–¥–µ–ª–æ–≤`}," +"+u(t.hiddenDepartmentsCount),9,Im)):y("",!0)])):y("",!0)]),n("div",Mm,[n("div",Lm,[n("div",Pm,u(t.totalActionsFormatted),1),e[15]||(e[15]=n("div",{class:"metric-label"},"–¥–µ–π—Å—Ç–≤–∏–π",-1)),t.actionsChange!==0?(c(),d("div",{key:0,class:N(["metric-change",{positive:t.actionsChange>0,negative:t.actionsChange<0}]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ: ${t.actionsChange>0?"+":""}${t.actionsChange}%`},u(t.actionsChange>0?"+":"")+u(t.actionsChange)+"% ",11,Nm)):y("",!0)]),n("div",Om,[n("div",Bm,u(t.lastActivityFormatted),1),e[16]||(e[16]=n("div",{class:"metric-label"},"–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",-1))]),o.compactView?y("",!0):(c(),d("div",Rm,[n("div",Um,[n("div",{class:N(["score-fill",{"high-score":t.activityScore>=80,"medium-score":t.activityScore>=50&&t.activityScore<80,"low-score":t.activityScore<50}]),style:oe({width:`${t.activityScore}%`})},null,6)]),n("div",{class:"score-label",title:`–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: ${t.activityScore}/100`},u(t.activityScore)+"/100 ",9,Fm)])),o.compactView?(c(),d("div",Vm,[n("span",jm,u(t.totalSessionsFormatted)+" —Å–µ—Å—Å–∏–π",1),n("span",zm,u(t.avgSessionDurationFormatted),1)])):y("",!0)]),n("div",Hm,[n("button",{onClick:e[1]||(e[1]=de((...a)=>t.viewProfile&&t.viewProfile(...a),["stop"])),class:"action-btn primary","aria-label":`–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å ${t.userName}`,title:`–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å ${t.userName}`}," üëÅÔ∏è ",8,Wm),o.canEditPermissions?(c(),d("button",{key:0,onClick:e[2]||(e[2]=de((...a)=>t.editPermissions&&t.editPermissions(...a),["stop"])),class:"action-btn secondary","aria-label":`–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ ${t.userName}`,title:`–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ ${t.userName}`}," ‚öôÔ∏è ",8,$m)):y("",!0),n("button",{onClick:e[3]||(e[3]=de((...a)=>t.toggleHidden&&t.toggleHidden(...a),["stop"])),class:N(["action-btn tertiary",{active:t.isHidden}]),"aria-label":`${t.isHidden?"–ü–æ–∫–∞–∑–∞—Ç—å":"–°–∫—Ä—ã—Ç—å"} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${t.userName}`,title:`${t.isHidden?"–ü–æ–∫–∞–∑–∞—Ç—å":"–°–∫—Ä—ã—Ç—å"} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${t.userName}`},u(t.isHidden?"üëÅÔ∏è‚Äçüó®Ô∏è":"üôà"),11,qm),n("button",{onClick:e[4]||(e[4]=de((...a)=>t.showContextMenu&&t.showContextMenu(...a),["stop"])),class:"action-btn menu","aria-label":`–ú–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è ${t.userName}`,title:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è"}," ‚ãÆ ",8,Km)]),t.showContextMenuFlag?(c(),d("div",{key:0,class:"context-menu",ref:"contextMenu",role:"menu","aria-label":`–ú–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è ${t.userName}`},[n("button",{onClick:e[5]||(e[5]=(...a)=>t.viewDetailedAnalytics&&t.viewDetailedAnalytics(...a)),class:"menu-item",role:"menuitem","aria-label":`–î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è ${t.userName}`}," üìä –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ ",8,Gm),n("button",{onClick:e[6]||(e[6]=(...a)=>t.exportUserData&&t.exportUserData(...a)),class:"menu-item",role:"menuitem","aria-label":`–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö ${t.userName}`}," üì• –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö ",8,Jm),n("button",{onClick:e[7]||(e[7]=(...a)=>t.sendNotification&&t.sendNotification(...a)),class:"menu-item",role:"menuitem","aria-label":`–û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ${t.userName}`}," üìß –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ",8,Ym),n("button",{onClick:e[8]||(e[8]=(...a)=>t.viewAuditLog&&t.viewAuditLog(...a)),class:"menu-item",role:"menuitem","aria-label":`–ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ –¥–ª—è ${t.userName}`}," üìã –ñ—É—Ä–Ω–∞–ª –∞—É–¥–∏—Ç–∞ ",8,Zm),e[17]||(e[17]=n("hr",{class:"menu-divider",role:"separator"},null,-1)),o.canDelete?(c(),d("button",{key:0,onClick:e[9]||(e[9]=(...a)=>t.deleteUser&&t.deleteUser(...a)),class:"menu-item danger",role:"menuitem","aria-label":`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${t.userName}`}," üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ",8,Qm)):y("",!0)],8,Xm)):y("",!0),n("div",{id:`user-card-${o.user.id}-description`,class:"sr-only"}," –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å "+u(t.userName)+", email "+u(t.userEmail)+", —Å—Ç–∞—Ç—É—Å "+u(t.getStatusText(t.userStatus))+", "+u(t.totalActionsFormatted)+" –¥–µ–π—Å—Ç–≤–∏–π, –ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å "+u(t.lastActivityFormatted)+", —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ "+u(t.activityScore)+" –∏–∑ 100. "+u(t.isAdmin?"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.":"")+" "+u(t.isHidden?"–°–∫—Ä—ã—Ç—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.":"")+" "+u(t.visibleDepartments.length>0?`–û—Ç–¥–µ–ª—ã: ${t.visibleDepartments.map(a=>a.name).join(", ")}.`:""),9,ef),o.isSelected?(c(),d("div",tf,[...e[18]||(e[18]=[n("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[n("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})],-1)])])):y("",!0)],42,hm)}const sf=H(fm,[["render",of],["__scopeId","data-v-5e790fbc"]]),nf={name:"BulkActionsBar",emits:["execute","clear-selection"],props:{selectedUsers:{type:Array,default:()=>[]},availableActions:{type:Array,default:()=>[]}}},af={key:0,class:"bulk-actions-bar"},rf={class:"bar-content"},lf={class:"selection-info"},cf={class:"selection-count"},df={class:"selection-text"},uf={class:"actions-list"},gf=["onClick","title"],mf={key:0,class:"action-icon"},ff={class:"action-text"};function hf(s,e,o,t,i,l){return o.selectedUsers.length>0?(c(),d("div",af,[n("div",rf,[n("div",lf,[n("span",cf," –í—ã–±—Ä–∞–Ω–æ: "+u(o.selectedUsers.length),1),n("span",df,u(o.selectedUsers.length===1?"–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å":"–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"),1)]),n("div",uf,[(c(!0),d(U,null,F(o.availableActions,a=>(c(),d("button",{key:a.id,onClick:r=>s.$emit("execute",a),class:N(["action-btn",a.class]),title:a.description},[a.icon?(c(),d("span",mf,u(a.icon),1)):y("",!0),n("span",ff,u(a.label),1)],10,gf))),128))]),n("button",{onClick:e[0]||(e[0]=a=>s.$emit("clear-selection")),class:"clear-btn",title:"–û—á–∏—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä"}," ‚úï ")])])):y("",!0)}const vf=H(nf,[["render",hf],["__scopeId","data-v-56b78081"]]),yf={name:"VirtualList",emits:["item-click"],props:{items:{type:Array,default:()=>[]},itemHeight:{type:Number,default:50},containerHeight:{type:Number,default:400},bufferSize:{type:Number,default:5}},data(){return{scrollTop:0}},computed:{totalItems(){return this.items.length},totalHeight(){return this.totalItems*this.itemHeight},visibleCount(){return Math.ceil(this.containerHeight/this.itemHeight)+this.bufferSize*2},startIndex(){const s=Math.floor(this.scrollTop/this.itemHeight)-this.bufferSize;return Math.max(0,s)},endIndex(){const s=this.startIndex+this.visibleCount;return Math.min(this.totalItems,s)},visibleItems(){return this.items.slice(this.startIndex,this.endIndex)},offsetTop(){return this.startIndex*this.itemHeight},offsetBottom(){return Math.max(0,this.totalHeight-this.offsetTop-this.visibleItems.length*this.itemHeight)},listHeight(){return Math.min(this.totalHeight,this.containerHeight)}},methods:{handleScroll(s){this.scrollTop=s.target.scrollTop},getItemKey(s,e){return s.id||s.key||e},scrollToIndex(s){const e=Math.max(0,s*this.itemHeight-this.containerHeight/2);this.$refs.container?.scrollTo({top:e,behavior:"smooth"})},scrollToTop(){this.$refs.container?.scrollTo({top:0,behavior:"smooth"})},scrollToBottom(){const s=this.totalHeight-this.containerHeight;this.$refs.container?.scrollTo({top:s,behavior:"smooth"})}}},pf={class:"virtual-list-container",ref:"container"};function _f(s,e,o,t,i,l){return c(),d("div",pf,[n("div",{class:"virtual-list",style:oe({height:`${l.listHeight}px`}),onScroll:e[0]||(e[0]=(...a)=>l.handleScroll&&l.handleScroll(...a))},[n("div",{class:"virtual-spacer top",style:oe({height:`${l.offsetTop}px`})},null,4),(c(!0),d(U,null,F(l.visibleItems,(a,r)=>(c(),d("div",{key:l.getItemKey(a,l.startIndex+r),class:"virtual-item"},[io(s.$slots,"item",{item:a,index:l.startIndex+r},void 0)]))),128)),n("div",{class:"virtual-spacer bottom",style:oe({height:`${l.offsetBottom}px`})},null,4)],36)],512)}const bf=H(yf,[["render",_f],["__scopeId","data-v-302c06ef"]]),kf={name:"PaginationControls",emits:["page-change","per-page-change"],props:{currentPage:{type:Number,required:!0},totalPages:{type:Number,required:!0},totalItems:{type:Number,required:!0},perPage:{type:Number,default:50},showPerPageSelector:{type:Boolean,default:!0},perPageOptions:{type:Array,default:()=>[10,25,50,100]},maxVisiblePages:{type:Number,default:7}},computed:{startItem(){return(this.currentPage-1)*this.perPage+1},endItem(){return Math.min(this.currentPage*this.perPage,this.totalItems)},visiblePages(){const s=[],e=this.totalPages,o=this.currentPage,t=this.maxVisiblePages;if(e<=t)for(let i=1;i<=e;i++)s.push(i);else{const i=Math.max(1,o-Math.floor(t/2)),l=Math.min(e,i+t-1),a=Math.max(1,l-t+1);a>1&&(s.push(1),a>2&&s.push("..."));for(let r=a;r<=l;r++)s.push(r);l<e&&(l<e-1&&s.push("..."),s.push(e))}return s}}},Cf={key:0,class:"pagination-controls"},Sf={class:"pagination-info"},wf={class:"pagination-text"},Tf={class:"pagination-nav"},Ef=["disabled"],xf=["disabled"],Af={key:0,class:"page-btn ellipsis",disabled:"","aria-hidden":"true"},Df=["onClick","aria-label","aria-current"],If=["disabled"],Mf=["disabled"],Lf={key:0,class:"per-page-selector"},Pf=["value"],Nf=["value"];function Of(s,e,o,t,i,l){return o.totalPages>1?(c(),d("div",Cf,[n("div",Sf,[n("span",wf,u(l.startItem)+"-"+u(l.endItem)+" –∏–∑ "+u(o.totalItems.toLocaleString()),1)]),n("div",Tf,[n("button",{onClick:e[0]||(e[0]=a=>s.$emit("page-change",1)),disabled:o.currentPage===1,class:"page-btn first","aria-label":"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É",title:"–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"}," ¬´¬´ ",8,Ef),n("button",{onClick:e[1]||(e[1]=a=>s.$emit("page-change",o.currentPage-1)),disabled:o.currentPage===1,class:"page-btn prev","aria-label":"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É",title:"–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"}," ‚Äπ ",8,xf),(c(!0),d(U,null,F(l.visiblePages,a=>(c(),d(U,{key:a},[a==="..."?(c(),d("button",Af,u(a),1)):(c(),d("button",{key:1,onClick:r=>s.$emit("page-change",a),class:N({"page-btn":!0,current:a===o.currentPage}),"aria-label":`–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É ${a}`,"aria-current":a===o.currentPage?"page":null},u(a),11,Df))],64))),128)),n("button",{onClick:e[2]||(e[2]=a=>s.$emit("page-change",o.currentPage+1)),disabled:o.currentPage===o.totalPages,class:"page-btn next","aria-label":"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É",title:"–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"}," ‚Ä∫ ",8,If),n("button",{onClick:e[3]||(e[3]=a=>s.$emit("page-change",o.totalPages)),disabled:o.currentPage===o.totalPages,class:"page-btn last","aria-label":"–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É",title:"–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"}," ¬ª¬ª ",8,Mf)]),o.showPerPageSelector?(c(),d("div",Lf,[e[5]||(e[5]=n("label",{for:"per-page-select",class:"per-page-label"},"–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å:",-1)),n("select",{id:"per-page-select",value:o.perPage,onChange:e[4]||(e[4]=a=>s.$emit("per-page-change",parseInt(a.target.value))),class:"per-page-select","aria-label":"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"},[(c(!0),d(U,null,F(o.perPageOptions,a=>(c(),d("option",{key:a,value:a},u(a),9,Nf))),128))],40,Pf)])):y("",!0)])):y("",!0)}const Bf=H(kf,[["render",Of],["__scopeId","data-v-59d0e153"]]),Rf={name:"UserListPanel",components:{UnifiedUserCard:sf,BulkActionsBar:vf,VirtualList:bf,PaginationControls:Bf},props:{users:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},pagination:{type:Object,default:()=>({current_page:1,per_page:50,total:0,total_pages:0})},filters:{type:Object,default:()=>({search:"",department_ids:[],activity_filter:"all",sort_by:"last_activity",sort_order:"desc",time_range:"week"})},viewOptions:{type:Object,default:()=>({compactView:!1,showExtendedMetrics:!1,itemsPerPage:50})},canEditPermissions:{type:Boolean,default:!1},canDeleteUsers:{type:Boolean,default:!1}},emits:["user-select","user-select-multiple","filters-change","pagination-change","view-options-change","user-action"],setup(s,{emit:e}){const o=w(!1),t=w([]),i=w({...s.filters}),l=w(null),a=w(null),r=_(()=>s.users),g=_(()=>{let A=0;return i.value.search&&A++,i.value.department_ids.length>0&&A++,i.value.activity_filter!=="all"&&A++,i.value.time_range!=="week"&&A++,A}),f=_(()=>{if(!a.value)return 400;const A=a.value.getBoundingClientRect();return Math.max(400,window.innerHeight-A.top-200)}),m=_(()=>[{id:369,name:"–ë–∏—Ç—Ä–∏–∫—Å24 –æ—Ç–¥–µ–ª",color:"#2196F3"},{id:366,name:"–°–µ–∫—Ç–æ—Ä 1–°",color:"#4CAF50"},{id:370,name:"–û—Ç–¥–µ–ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏",color:"#FF9800"},{id:371,name:"–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞",color:"#F44336"}]),h=_(()=>[{id:"change_department",label:"–ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª",icon:"BuildingIcon",description:"–ù–∞–∑–Ω–∞—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –¥—Ä—É–≥–æ–π –æ—Ç–¥–µ–ª"},{id:"toggle_admin",label:"–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",icon:"ShieldIcon",description:"–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏–ª–∏ –æ—Ç–æ–∑–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"},{id:"export",label:"–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö",icon:"DownloadIcon",description:"–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"},{id:"hide_users",label:"–°–∫—Ä—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",icon:"EyeOffIcon",description:"–°–∫—Ä—ã—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Å–ø–∏—Å–∫–∞"}]),b=()=>{o.value=!o.value},p=()=>{e("filters-change",{...i.value})},v=()=>{i.value={search:"",department_ids:[],activity_filter:"all",sort_by:"last_activity",sort_order:"desc",time_range:"week"},p()},S=A=>{const J=i.value.department_ids.indexOf(A);J>-1?i.value.department_ids.splice(J,1):i.value.department_ids.push(A),p()},D=()=>{i.value.sort_order=i.value.sort_order==="asc"?"desc":"asc",p()},C=()=>{const A={...s.viewOptions,compactView:!s.viewOptions.compactView};e("view-options-change",A)},M=()=>{l.value&&clearTimeout(l.value),l.value=setTimeout(I,300)},I=()=>{p()},V=()=>{i.value.search="",p()},O=A=>{L(A)},L=A=>{e("user-select",A)},k=A=>{t.value=A,e("user-select-multiple",A)},T=()=>{t.value=[]},B=A=>{e("user-action","view-profile",A)},P=A=>{e("user-action","edit-permissions",A)},R=A=>{e("user-action","toggle-visibility",A)},j=A=>{e("user-action","view-analytics",A)},G=A=>{e("user-action","export-data",A)},ve=A=>{e("user-action","delete",A)},Be=A=>{e("user-action","bulk-action",{action:A,users:t.value})},ge=A=>{e("pagination-change",A)},Me=A=>{e("pagination-change",1,A)};return pe(()=>s.filters,A=>{i.value={...A}},{deep:!0}),ae(()=>{Vo(()=>{a.value&&(a.value.style.height=`${f.value}px`)})}),{showFilters:o,selectedUsers:t,localFilters:i,filteredUsers:r,activeFiltersCount:g,listHeight:f,departments:m,bulkActions:h,listContainer:a,toggleFilters:b,applyFilters:p,resetFilters:v,toggleDepartmentFilter:S,toggleSortOrder:D,toggleCompactView:C,debounceSearch:M,applySearch:I,clearSearch:V,handleUserClick:O,handleUserSelect:L,handleUserSelectMultiple:k,clearSelection:T,handleViewProfile:B,handleEditPermissions:P,handleToggleHidden:R,handleViewAnalytics:j,handleExportUserData:G,handleDeleteUser:ve,handleBulkAction:Be,handlePageChange:ge,handlePerPageChange:Me}}},Uf={class:"panel-header"},Ff={class:"header-content"},Vf={class:"panel-title"},jf={key:0,class:"users-count"},zf={class:"header-actions"},Hf={class:"search-container"},Wf=["aria-expanded"],$f={key:0,class:"filters-count"},qf={class:"view-options"},Kf={key:0,class:"filters-panel",role:"region","aria-label":"–ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤"},Xf={class:"filters-grid"},Gf={class:"filter-group"},Jf={class:"departments-filter"},Yf=["onClick","aria-label"],Zf={class:"filter-group"},Qf={class:"filter-group"},eh={class:"filter-group"},th={class:"sort-controls"},oh=["aria-label"],sh={class:"filter-actions"},nh={class:"users-list-container",role:"list","aria-label":"–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"},ah={key:0,class:"loading-state"},ih={key:1,class:"empty-state"},rh={class:"empty-title"},lh={class:"empty-description"};function ch(s,e,o,t,i,l){const a=W("BulkActionsBar"),r=W("UnifiedUserCard"),g=W("VirtualList"),f=W("PaginationControls");return c(),d("div",{class:N(["user-list-panel",{loading:o.loading,empty:!o.loading&&t.filteredUsers.length===0,"compact-view":o.viewOptions.compactView}]),role:"region","aria-label":"–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"},[n("div",Uf,[n("div",Ff,[n("h2",Vf,[e[16]||(e[16]=X(" –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ",-1)),o.loading?y("",!0):(c(),d("span",jf," ("+u(o.pagination.total.toLocaleString())+") ",1))]),n("div",zf,[n("div",Hf,[te(n("input",{"onUpdate:modelValue":e[0]||(e[0]=m=>t.localFilters.search=m),type:"text",class:"search-input",placeholder:"–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email...",onInput:e[1]||(e[1]=(...m)=>t.debounceSearch&&t.debounceSearch(...m)),onKeydown:e[2]||(e[2]=se((...m)=>t.applySearch&&t.applySearch(...m),["enter"])),"aria-label":"–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"},null,544),[[Ke,t.localFilters.search]]),t.localFilters.search?(c(),d("button",{key:0,onClick:e[3]||(e[3]=(...m)=>t.clearSearch&&t.clearSearch(...m)),class:"search-clear","aria-label":"–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫"}," ‚úï ")):y("",!0),e[17]||(e[17]=n("div",{class:"search-icon","aria-hidden":"true"},"üîç",-1))]),n("button",{onClick:e[4]||(e[4]=(...m)=>t.toggleFilters&&t.toggleFilters(...m)),class:N(["filters-toggle",{active:t.showFilters}]),"aria-label":"–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã","aria-expanded":t.showFilters},[e[18]||(e[18]=n("svg",{class:"filter-icon",viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{d:"M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"})],-1)),e[19]||(e[19]=X(" –§–∏–ª—å—Ç—Ä—ã ",-1)),t.activeFiltersCount>0?(c(),d("span",$f,u(t.activeFiltersCount),1)):y("",!0)],10,Wf),n("div",qf,[n("button",{onClick:e[5]||(e[5]=(...m)=>t.toggleCompactView&&t.toggleCompactView(...m)),class:N(["view-toggle",{active:o.viewOptions.compactView}]),"aria-label":"–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥",title:"–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤–∏–¥"},[...e[20]||(e[20]=[n("svg",{viewBox:"0 0 24 24","aria-hidden":"true"},[n("path",{d:"M3 3h18v2H3V3zm0 16h18v2H3v16zm0-8h18v2H3v-2z"})],-1)])],2)])])])]),t.showFilters?(c(),d("div",Kf,[n("div",Xf,[n("div",Gf,[e[21]||(e[21]=n("label",{class:"filter-label"},"–û—Ç–¥–µ–ª—ã:",-1)),n("div",Jf,[(c(!0),d(U,null,F(t.departments,m=>(c(),d("button",{key:m.id,onClick:h=>t.toggleDepartmentFilter(m.id),class:N(["department-chip",{active:t.localFilters.department_ids.includes(m.id)}]),style:oe({borderColor:m.color}),"aria-label":`–§–∏–ª—å—Ç—Ä –ø–æ –æ—Ç–¥–µ–ª—É ${m.name}`},[n("span",{class:"dept-dot",style:oe({backgroundColor:m.color}),"aria-hidden":"true"},null,4),X(" "+u(m.name),1)],14,Yf))),128))])]),n("div",Zf,[e[23]||(e[23]=n("label",{class:"filter-label"},"–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:",-1)),te(n("select",{"onUpdate:modelValue":e[6]||(e[6]=m=>t.localFilters.activity_filter=m),class:"filter-select",onChange:e[7]||(e[7]=(...m)=>t.applyFilters&&t.applyFilters(...m)),"aria-label":"–§–∏–ª—å—Ç—Ä –ø–æ —É—Ä–æ–≤–Ω—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏"},[...e[22]||(e[22]=[qe('<option value="all" data-v-8c6ab554>–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</option><option value="active" data-v-8c6ab554>–ê–∫—Ç–∏–≤–Ω—ã–µ (80%+)</option><option value="moderate" data-v-8c6ab554>–°—Ä–µ–¥–Ω–µ –∞–∫—Ç–∏–≤–Ω—ã–µ (50-80%)</option><option value="inactive" data-v-8c6ab554>–ù–µ–∞–∫—Ç–∏–≤–Ω—ã–µ (&lt;50%)</option><option value="new" data-v-8c6ab554>–ù–æ–≤—ã–µ (–∑–∞ –Ω–µ–¥–µ–ª—é)</option>',5)])],544),[[Te,t.localFilters.activity_filter]])]),n("div",Qf,[e[25]||(e[25]=n("label",{class:"filter-label"},"–ü–µ—Ä–∏–æ–¥:",-1)),te(n("select",{"onUpdate:modelValue":e[8]||(e[8]=m=>t.localFilters.time_range=m),class:"filter-select",onChange:e[9]||(e[9]=(...m)=>t.applyFilters&&t.applyFilters(...m)),"aria-label":"–í—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏"},[...e[24]||(e[24]=[qe('<option value="today" data-v-8c6ab554>–°–µ–≥–æ–¥–Ω—è</option><option value="week" data-v-8c6ab554>–≠—Ç–∞ –Ω–µ–¥–µ–ª—è</option><option value="month" data-v-8c6ab554>–≠—Ç–æ—Ç –º–µ—Å—è—Ü</option><option value="quarter" data-v-8c6ab554>–≠—Ç–æ—Ç –∫–≤–∞—Ä—Ç–∞–ª</option><option value="year" data-v-8c6ab554>–≠—Ç–æ—Ç –≥–æ–¥</option>',5)])],544),[[Te,t.localFilters.time_range]])]),n("div",eh,[e[28]||(e[28]=n("label",{class:"filter-label"},"–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:",-1)),n("div",th,[te(n("select",{"onUpdate:modelValue":e[10]||(e[10]=m=>t.localFilters.sort_by=m),class:"filter-select sort-select",onChange:e[11]||(e[11]=(...m)=>t.applyFilters&&t.applyFilters(...m)),"aria-label":"–ü–æ–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"},[...e[26]||(e[26]=[n("option",{value:"last_activity"},"–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",-1),n("option",{value:"name"},"–ò–º—è",-1),n("option",{value:"email"},"Email",-1),n("option",{value:"total_actions"},"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π",-1)])],544),[[Te,t.localFilters.sort_by]]),n("button",{onClick:e[12]||(e[12]=(...m)=>t.toggleSortOrder&&t.toggleSortOrder(...m)),class:"sort-order-toggle","aria-label":`–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ ${t.localFilters.sort_order==="asc"?"—É–±—ã–≤–∞—é—â–∏–π":"–≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∏–π"}`},[(c(),d("svg",{class:N({rotated:t.localFilters.sort_order==="desc"}),viewBox:"0 0 24 24","aria-hidden":"true"},[...e[27]||(e[27]=[n("path",{d:"M7 14l5-5 5 5z"},null,-1)])],2))],8,oh)])])]),n("div",sh,[n("button",{onClick:e[13]||(e[13]=(...m)=>t.resetFilters&&t.resetFilters(...m)),class:"filter-reset-btn"}," –°–±—Ä–æ—Å–∏—Ç—å "),n("button",{onClick:e[14]||(e[14]=(...m)=>t.applyFilters&&t.applyFilters(...m)),class:"filter-apply-btn"}," –ü—Ä–∏–º–µ–Ω–∏—Ç—å ")])])):y("",!0),t.selectedUsers.length>0?(c(),q(a,{key:1,"selected-users":t.selectedUsers,"available-actions":t.bulkActions,onExecute:t.handleBulkAction,onClearSelection:t.clearSelection},null,8,["selected-users","available-actions","onExecute","onClearSelection"])):y("",!0),n("div",nh,[o.loading?(c(),d("div",ah,[(c(!0),d(U,null,F(o.viewOptions.itemsPerPage,m=>(c(),d("div",{key:m,class:"user-skeleton","aria-hidden":"true"},[...e[29]||(e[29]=[qe('<div class="skeleton-avatar" data-v-8c6ab554></div><div class="skeleton-content" data-v-8c6ab554><div class="skeleton-line" data-v-8c6ab554></div><div class="skeleton-line short" data-v-8c6ab554></div></div><div class="skeleton-actions" data-v-8c6ab554><div class="skeleton-button" data-v-8c6ab554></div><div class="skeleton-button" data-v-8c6ab554></div></div>',3)])]))),128))])):t.filteredUsers.length===0?(c(),d("div",ih,[e[30]||(e[30]=n("div",{class:"empty-icon","aria-hidden":"true"},"üë•",-1)),n("h3",rh,u(t.localFilters.search?"–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã":"–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"),1),n("p",lh,u(t.localFilters.search?`–ü–æ –∑–∞–ø—Ä–æ—Å—É "${t.localFilters.search}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫ –∏–ª–∏ —Å–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã.`:"–í —Å–∏—Å—Ç–µ–º–µ –µ—â—ë –Ω–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π."),1),t.activeFiltersCount>0?(c(),d("button",{key:0,onClick:e[15]||(e[15]=(...m)=>t.resetFilters&&t.resetFilters(...m)),class:"empty-action-btn"}," –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã ")):y("",!0)])):(c(),q(g,{key:2,items:t.filteredUsers,"item-height":o.viewOptions.compactView?80:120,"container-height":t.listHeight,class:"virtual-users-list",onItemClick:t.handleUserClick},{item:ce(({item:m,index:h})=>[(c(),q(r,{key:m.id,user:m,"is-selected":t.selectedUsers.some(b=>b.id===m.id),"compact-view":o.viewOptions.compactView,"can-edit-permissions":o.canEditPermissions,"can-delete":o.canDeleteUsers,"show-extended-metrics":!o.viewOptions.compactView,onSelect:t.handleUserSelect,onViewProfile:t.handleViewProfile,onEditPermissions:t.handleEditPermissions,onToggleHidden:t.handleToggleHidden,onViewAnalytics:t.handleViewAnalytics,onExportData:t.handleExportUserData,onDeleteUser:t.handleDeleteUser},null,8,["user","is-selected","compact-view","can-edit-permissions","can-delete","show-extended-metrics","onSelect","onViewProfile","onEditPermissions","onToggleHidden","onViewAnalytics","onExportData","onDeleteUser"]))]),_:1},8,["items","item-height","container-height","onItemClick"]))]),!o.loading&&o.pagination.total_pages>1?(c(),q(f,{key:2,"current-page":o.pagination.current_page,"total-pages":o.pagination.total_pages,"total-items":o.pagination.total,"per-page":o.pagination.per_page,onPageChange:t.handlePageChange,onPerPageChange:t.handlePerPageChange},null,8,["current-page","total-pages","total-items","per-page","onPageChange","onPerPageChange"])):y("",!0)],2)}const dh=H(Rf,[["render",ch],["__scopeId","data-v-8c6ab554"]]),uh={name:"AnalysisPanel",emits:["back","filter-change","export"],props:{user:{type:Object,default:null},activityData:{type:Object,default:()=>({})},filters:{type:Object,default:()=>({})},timeRange:{type:String,default:"week"},isLoading:{type:Boolean,default:!1}},methods:{getStatusText(s){switch(s){case"online":return"–æ–Ω–ª–∞–π–Ω";case"away":return"–æ—Ç–æ—à—ë–ª";case"offline":return"–æ—Ñ—Ñ–ª–∞–π–Ω";default:return"–Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}},formatDuration(s){const e=Math.floor(s/60),o=Math.floor(s%60);return`${e}:${o.toString().padStart(2,"0")}`},formatLastActivity(s){if(!s)return"–ù–∏–∫–æ–≥–¥–∞";const e=new Date(s),t=new Date-e,i=Math.floor(t/(1e3*60)),l=Math.floor(t/(1e3*60*60)),a=Math.floor(t/(1e3*60*60*24));return i<1?"—Ç–æ–ª—å–∫–æ —á—Ç–æ":i<60?`${i} –º–∏–Ω –Ω–∞–∑–∞–¥`:l<24?`${l} —á –Ω–∞–∑–∞–¥`:a<7?`${a} –¥ –Ω–∞–∑–∞–¥`:e.toLocaleDateString("ru-RU")}}},gh={class:"analysis-panel"},mh={class:"analysis-header"},fh={class:"user-summary"},hh={class:"user-avatar"},vh=["src","alt"],yh={key:1,class:"avatar-placeholder"},ph={class:"user-info"},_h={class:"user-email"},bh={class:"user-status"},kh={key:0,class:"admin-badge"},Ch={class:"header-actions"},Sh={class:"analysis-content"},wh={class:"stats-section"},Th={class:"stats-grid"},Eh={class:"stat-card"},xh={class:"stat-value"},Ah={class:"stat-card"},Dh={class:"stat-value"},Ih={class:"stat-card"},Mh={class:"stat-value"},Lh={class:"stat-card"},Ph={class:"stat-value"},Nh={class:"activity-section"},Oh={class:"last-activity"},Bh={key:0,class:"departments-section"},Rh={class:"departments-list"};function Uh(s,e,o,t,i,l){return c(),d("div",gh,[n("div",mh,[n("div",fh,[n("div",hh,[o.user.avatar?(c(),d("img",{key:0,src:o.user.avatar,alt:`–ê–≤–∞—Ç–∞—Ä ${o.user.name}`},null,8,vh)):(c(),d("div",yh,u(o.user.name.charAt(0)),1))]),n("div",ph,[n("h2",null,u(o.user.name),1),n("p",_h,u(o.user.email),1),n("div",bh,[n("span",{class:N(`status-${o.user.status}`)},u(l.getStatusText(o.user.status)),3),o.user.is_admin?(c(),d("span",kh,"–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä")):y("",!0)])])]),n("div",Ch,[n("button",{onClick:e[0]||(e[0]=a=>s.$emit("back")),class:"back-btn"},"‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É")])]),n("div",Sh,[n("div",wh,[e[5]||(e[5]=n("h3",null,"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",-1)),n("div",Th,[n("div",Eh,[n("div",xh,u(o.user.activity_stats?.total_actions||0),1),e[1]||(e[1]=n("div",{class:"stat-label"},"–í—Å–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏–π",-1))]),n("div",Ah,[n("div",Dh,u(o.user.activity_stats?.total_sessions||0),1),e[2]||(e[2]=n("div",{class:"stat-label"},"–°–µ—Å—Å–∏–π",-1))]),n("div",Ih,[n("div",Mh,u(l.formatDuration(o.user.activity_stats?.avg_session_duration||0)),1),e[3]||(e[3]=n("div",{class:"stat-label"},"–°—Ä–µ–¥–Ω—è—è —Å–µ—Å—Å–∏—è",-1))]),n("div",Lh,[n("div",Ph,u(o.user.activity_stats?.activity_score||0)+"/100",1),e[4]||(e[4]=n("div",{class:"stat-label"},"–£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",-1))])])]),n("div",Nh,[e[6]||(e[6]=n("h3",null,"üïí –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å",-1)),n("div",Oh,[n("p",null,u(l.formatLastActivity(o.user.activity_stats?.last_activity)),1)])]),o.user.departments&&o.user.departments.length>0?(c(),d("div",Bh,[e[7]||(e[7]=n("h3",null,"üè¢ –û—Ç–¥–µ–ª—ã",-1)),n("div",Rh,[(c(!0),d(U,null,F(o.user.departments,a=>(c(),d("span",{key:a.id,class:"department-tag",style:oe({backgroundColor:a.color})},u(a.name),5))),128))])])):y("",!0),e[8]||(e[8]=n("div",{class:"placeholder-note"},[n("strong",null,"üöß –°–ª–µ–¥—É—é—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ:"),n("ul",null,[n("li",null,"–ì—Ä–∞—Ñ–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏"),n("li",null,"–ê–Ω–∞–ª–∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"),n("li",null,"–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"),n("li",null,"–≠–∫—Å–ø–æ—Ä—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")])],-1))])])}const Fh=H(uh,[["render",Uh],["__scopeId","data-v-15fd9d64"]]),Vh={name:"ManagementPanel",emits:["back","permissions-change","bulk-update"],props:{selectedUsers:{type:Array,default:()=>[]},allUsers:{type:Array,default:()=>[]},departments:{type:Array,default:()=>[]},auditLog:{type:Array,default:()=>[]},isLoading:{type:Boolean,default:!1},canEditPermissions:{type:Boolean,default:!1}},methods:{handleBulkPermissions(){this.$emit("bulk-update","change_permissions",{is_admin:!1,department_id:369})}}},jh={class:"management-panel"},zh={class:"panel-placeholder"},Hh={key:0,class:"selected-info"},Wh={class:"selected-list"},$h={class:"user-name"},qh={class:"user-email"},Kh={class:"placeholder-actions"};function Xh(s,e,o,t,i,l){return c(),d("div",jh,[n("div",zh,[e[2]||(e[2]=n("div",{class:"placeholder-icon"},"‚öôÔ∏è",-1)),e[3]||(e[3]=n("h3",null,"–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∞–º–∏",-1)),e[4]||(e[4]=n("p",null,"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",-1)),e[5]||(e[5]=n("div",{class:"placeholder-note"},[n("strong",null,"–°—Ç–∞—Ç—É—Å:"),X(" –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ (TASK-089 - –≠—Ç–∞–ø 5) ")],-1)),o.selectedUsers.length>0?(c(),d("div",Hh,[n("h4",null,"–í—ã–±—Ä–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: "+u(o.selectedUsers.length),1),n("div",Wh,[(c(!0),d(U,null,F(o.selectedUsers.slice(0,3),a=>(c(),d("div",{key:a.id,class:"selected-user"},[n("span",$h,u(a.name),1),n("span",qh,u(a.email),1)]))),128))])])):y("",!0),n("div",Kh,[n("button",{onClick:e[0]||(e[0]=a=>s.$emit("back")),class:"back-btn"},"‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É"),o.selectedUsers.length>0?(c(),d("button",{key:0,onClick:e[1]||(e[1]=(...a)=>l.handleBulkPermissions&&l.handleBulkPermissions(...a)),class:"permissions-btn"}," –ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ ("+u(o.selectedUsers.length)+") ",1)):y("",!0)])])])}const Gh=H(Vh,[["render",Xh],["__scopeId","data-v-7dfddba5"]]),Jh={name:"UnifiedUserManagement",components:{DrillDownNavigation:Mu,ContextSidebar:gm,UserListPanel:dh,AnalysisPanel:Fh,ManagementPanel:Gh},props:{config:{type:Object,default:()=>({enablePersistence:!0,enableKeyboardShortcuts:!0,defaultView:"global"})}},setup(s){console.log("[UnifiedUserManagement] Component loaded successfully",s.config);const e=w("global"),o=w(null),t=w(!1),i=w([{id:1,name:"–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",email:"ivan@example.com",departments:[{id:369,name:"–ë–∏—Ç—Ä–∏–∫—Å24 –æ—Ç–¥–µ–ª",color:"#2196F3"}],is_admin:!0,activity_stats:{total_actions:156,last_activity:new Date().toISOString(),activity_score:85},status:"online"},{id:2,name:"–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤",email:"petr@example.com",departments:[{id:366,name:"–°–µ–∫—Ç–æ—Ä 1–°",color:"#4CAF50"}],is_admin:!1,activity_stats:{total_actions:89,last_activity:new Date(Date.now()-864e5).toISOString(),activity_score:67},status:"away"},{id:3,name:"–ê–Ω–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞",email:"anna@example.com",departments:[],is_admin:!1,activity_stats:{total_actions:23,last_activity:new Date(Date.now()-6048e5).toISOString(),activity_score:35},status:"offline"}]),l=w({search:"",department_ids:[],activity_filter:"all",sort_by:"last_activity",sort_order:"desc"}),a=w([{id:"total_users",label:"–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",value:i.value.length,change:5.2},{id:"active_users",label:"–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ–≥–æ–¥–Ω—è",value:i.value.filter(v=>v.status==="online").length,change:12.1},{id:"new_users",label:"–ù–æ–≤—ã—Ö —Å–µ–≥–æ–¥–Ω—è",value:1,change:-2.3}]),r=_(()=>{const v=[{id:"global",label:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",icon:"UsersIcon",action:()=>g("global")}];return e.value==="user"&&o.value&&v.push({id:`user-${o.value.id}`,label:o.value.name,icon:"UserIcon",action:()=>f(o.value)}),e.value==="management"&&v.push({id:"management",label:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∞–º–∏",icon:"SettingsIcon",action:()=>g("management")}),v}),g=(v,S={})=>{e.value=v,S.user&&(o.value=S.user),console.log(`[UnifiedUserManagement] Switched to context: ${v}`,S)},f=v=>{o.value=v,g("user",{user:v})};return{currentContext:e,selectedUser:o,loading:t,users:i,filters:l,globalMetrics:a,breadcrumbs:r,handleUserSelect:v=>{f(v)},handleBreadcrumbNavigate:v=>{v.action&&v.action()},handleGoBack:()=>{(e.value==="user"||e.value==="management")&&(g("global"),o.value=null),console.log("[UnifiedUserManagement] Returned to global context")},handleMetricClick:v=>{console.log("Metric clicked:",v)}}}},Yh={class:"unified-user-management"},Zh={class:"management-grid"},Qh={class:"main-content-area"};function ev(s,e,o,t,i,l){const a=W("DrillDownNavigation"),r=W("ContextSidebar"),g=W("UserListPanel"),f=W("AnalysisPanel"),m=W("ManagementPanel");return c(),d("div",Yh,[K(a,{breadcrumbs:t.breadcrumbs,"is-loading":t.loading,onNavigate:t.handleBreadcrumbNavigate,onBack:t.handleGoBack},null,8,["breadcrumbs","is-loading","onNavigate","onBack"]),n("div",Zh,[K(r,{context:t.currentContext,"global-metrics":t.globalMetrics,"selected-user":t.selectedUser,onMetricClick:t.handleMetricClick},null,8,["context","global-metrics","selected-user","onMetricClick"]),n("div",Qh,[t.currentContext==="global"?(c(),q(g,{key:0,users:t.users,loading:t.loading,pagination:{current_page:1,total:t.users.length,total_pages:1},filters:t.filters,"can-edit-permissions":!0,"can-delete":!1,onUserSelect:t.handleUserSelect},null,8,["users","loading","pagination","filters","onUserSelect"])):t.currentContext==="user"?(c(),q(f,{key:1,user:t.selectedUser,onBack:t.handleGoBack},null,8,["user","onBack"])):t.currentContext==="management"?(c(),q(m,{key:2,onBack:t.handleGoBack},null,8,["onBack"])):y("",!0)])])])}const tv=H(Jh,[["render",ev],["__scopeId","data-v-953cd27b"]]),ov={name:"UsersManagementPage",components:{UnifiedUserManagement:tv},setup(){const s=Ie();return ae(async()=>{try{if(!(await Ne.checkAccess()).allowed){s.push("/");return}if(!await Ne.getCurrentUser()){s.push("/");return}console.log("[UsersManagementPage] Access granted - loading unified interface")}catch(e){console.error("[UsersManagementPage] Access check failed:",e),s.push("/")}}),{}}},sv={class:"users-management-page"};function nv(s,e,o,t,i,l){const a=W("UnifiedUserManagement");return c(),d("div",sv,[K(a,{config:{enablePersistence:!0,enableKeyboardShortcuts:!0,defaultView:"global"}})])}const av=H(ov,[["render",nv],["__scopeId","data-v-3ef05244"]]);class Z{static async getCacheStatus(){try{const e=Ee("/api/admin/cache-status.php");console.log("[CacheManagementService] Fetching cache status from:",e);const o=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("[CacheManagementService] Response status:",o.status),!o.ok){const i=await o.text();throw console.error("[CacheManagementService] HTTP error:",i),new Error(`HTTP error! status: ${o.status}, message: ${i}`)}const t=await o.json();if(console.log("[CacheManagementService] API result:",t),t.success){let i=t.modules||[];console.log("[CacheManagementService] Modules from API:",i.length,i),i.length===0&&(console.log("[CacheManagementService] Using mock data for UI demonstration"),i=this.getMockModules(),console.log("[CacheManagementService] Mock modules:",i.length));const l=this.categorizeAndSortModules(i);return console.log("[CacheManagementService] Categorized result:",l),l}else throw new Error(t.error||"Failed to get cache status")}catch(e){console.error("[CacheManagementService] Error getting cache status:",e),console.log("[CacheManagementService] Using mock data due to API error");const o=this.getMockModules(),t=this.categorizeAndSortModules(o);return console.log("[CacheManagementService] Mock categorized result:",t),t}}static async clearCache(e){try{const o=Ee("/api/admin/cache-clear.php"),t=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({module_id:e,confirm:!0})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();if(i.success)return!0;throw new Error(i.error||"Failed to clear cache")}catch(o){throw console.error("[CacheManagementService] Error clearing cache:",o),o}}static async getCacheStats(){try{const e=Ee("/api/admin/cache-stats.php"),o=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const t=await o.json();if(t.success)return t.stats||{};throw new Error(t.error||"Failed to get cache stats")}catch(e){throw console.error("[CacheManagementService] Error getting cache stats:",e),e}}static formatCacheSize(e){if(e===0)return"0 B";const o=1024,t=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(o));return Math.round(e/Math.pow(o,i)*100)/100+" "+t[i]}static categorizeAndSortModules(e,o={}){const t=this.generateCacheKey(e),i=this.getCachedResult(t);if(i&&!o.forceRefresh)return i;const l=performance.now(),a=this.performCategorization(e),r=performance.now();return a.metadata={processingTime:r-l,totalModules:e.length,primaryCount:a.primaryModules.length,secondaryCount:a.secondaryModules.length,cached:!1},this.setCachedResult(t,a),a}static performCategorization(e){const o=[],t=[];return e.forEach(i=>{this.validateModule(i),this.PRIMARY_MODULE_IDS.includes(i.id)?o.push({...i,category:"primary",priority:this.PRIMARY_MODULE_PRIORITIES[i.id]||999}):t.push({...i,category:"secondary",groupType:this.getModuleType(i.id)})}),{primaryModules:this.sortPrimaryModules(o),secondaryModules:this.sortSecondaryModules(t)}}static sortPrimaryModules(e){return e.sort((o,t)=>{const i=this.PRIMARY_MODULE_PRIORITIES[o.id]||999,l=this.PRIMARY_MODULE_PRIORITIES[t.id]||999;return i-l})}static sortSecondaryModules(e){return e.sort((o,t)=>{const i=this.getModuleType(o.id),l=this.getModuleType(t.id);return i!==l?this.compareModuleTypes(i,l):o.name.localeCompare(t.name)})}static compareModuleTypes(e,o){const t=["users","activity","webhooks","other"],i=t.indexOf(e),l=t.indexOf(o);return(i===-1?999:i)-(l===-1?999:l)}static getModuleType(e){for(const[o,t]of Object.entries(this.SECONDARY_MODULE_TYPES))if(e.startsWith(t.prefix))return o;return e.includes("time-tracking")?"time-tracking":e.includes("graph")?"graphs":e.includes("dashboard")?"dashboards":"other"}static getModuleTypeConfig(e){return this.SECONDARY_MODULE_TYPES[e]||{title:"üîß –ü—Ä–æ—á–∏–µ –º–æ–¥—É–ª–∏",description:"–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Å–∏—Å—Ç–µ–º—ã"}}static validateModule(e){if(!e||typeof e!="object")throw new Error("Module must be an object");if(!e.id||typeof e.id!="string")throw new Error("Module must have a valid id");if(!e.name||typeof e.name!="string")throw new Error("Module must have a valid name");return!0}static generateCacheKey(e){const o=e.map(t=>t.id).sort().join(",");return btoa(o).substring(0,16)}static getCachedResult(e){const o=this.categorizationCache.get(e);return o?Date.now()-o.timestamp>this.CACHE_TTL?(this.categorizationCache.delete(e),null):{...o.data,metadata:{...o.data.metadata,cached:!0}}:null}static setCachedResult(e,o){if(this.categorizationCache.set(e,{data:{...o,metadata:{...o.metadata,cached:!1}},timestamp:Date.now()}),this.categorizationCache.size>10){const t=this.categorizationCache.keys().next().value;this.categorizationCache.delete(t)}}static clearCategorizationCache(){this.categorizationCache.clear()}static invalidateCacheAfterModuleOperation(){this.clearCategorizationCache()}static getCategorizationStats(){return{cacheSize:this.categorizationCache.size,cacheEntries:Array.from(this.categorizationCache.entries()).map(([e,o])=>({key:e,age:Date.now()-o.timestamp,modulesCount:o.data.primaryModules.length+o.data.secondaryModules.length}))}}static formatTTL(e){return e<60?`${e} —Å–µ–∫`:e<3600?`${Math.floor(e/60)} –º–∏–Ω`:`${Math.floor(e/3600)} —á`}static formatCreationTime(e){return e<1e3?`${Math.round(e)}–º—Å`:e<6e4?`${Math.round(e/1e3*10)/10}—Å–µ–∫`:`${Math.round(e/6e4*10)/10}–º–∏–Ω`}static formatCacheHitRatio(e){return`${Math.round(e*100)}%`}static formatDataFreshness(e){return`${Math.round(e*100)}%`}static getExpiryColor(e){if(!e)return"gray";const o=Date.now()/1e3,t=(e-o)/3600;return t>2?"green":t>.5?"yellow":"red"}static getEfficiencyColor(e){return e>=.85?"green":e>=.7?"yellow":"red"}static getCreationTimeColor(e){return e<=2e3?"green":e<=1e4?"yellow":"red"}static getFreshnessColor(e){return e>=.9?"green":e>=.7?"yellow":"red"}static generateModuleMetadata(e){const o=Math.floor(Date.now()/1e3),t=e.metadata||{},i=this.PRIMARY_MODULE_IDS.includes(e.id);return{version:t.version||"1.0",module_id:e.id,module_name:e.name,created_at:t.created_at||o-Math.random()*86400*7,created_by:t.created_by||(Math.random()>.5?"system":"cron"),creation_time_ms:t.creation_time_ms||500+Math.random()*9500,last_accessed_at:t.last_accessed_at||o-Math.random()*3600,access_count:t.access_count||Math.floor(Math.random()*100)+1,expires_at:t.expires_at||o+(e.ttl||3600),ttl_seconds:e.ttl||3600,file_size_bytes:e.total_size||Math.floor(Math.random()*1e7)+1e6,compression_ratio:t.compression_ratio||.7+Math.random()*.3,data_version:t.data_version||`2026.01.12.v${Math.floor(Math.random()*10)+1}`,source_params:t.source_params||{period:i?Math.random()>.5?"weeks":"months":"default",sector_id:e.id.includes("sector-1c")?"1c":"all",filters:Math.random()>.5?["active_only"]:[],limit:Math.floor(Math.random()*1e3)+500},performance_metrics:t.performance_metrics||{avg_response_time_ms:20+Math.random()*80,cache_hit_ratio:.7+Math.random()*.3,data_freshness_score:.8+Math.random()*.2}}}static getMockModules(){const e=Math.floor(Date.now()/1e3);return[{id:"dashboard-sector-1c",name:"–î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",status:"active",file_count:5,total_size:1024e3,ttl:600,created_at:e-7200,expires_at:e+1800,cache_dir:"api/cache/dashboard-sector-1c"},{id:"graph-state",name:"–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è",status:"active",file_count:3,total_size:512e3,ttl:3600,created_at:e-3600,expires_at:e+7200,cache_dir:"api/cache/graph-state"},{id:"graph-admission-closure-weeks",name:"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞/–∑–∞–∫—Ä—ã—Ç–∏–π 1–° (4 –Ω–µ–¥–µ–ª–∏)",status:"active",file_count:8,total_size:2048e3,ttl:300,created_at:e-1800,expires_at:e+120,cache_dir:"api/cache/graph-admission-closure/weeks"},{id:"graph-admission-closure-months",name:"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞/–∑–∞–∫—Ä—ã—Ç–∏–π 1–° (3 –º–µ—Å—è—Ü–∞)",status:"active",file_count:12,total_size:3072e3,ttl:300,created_at:e-3600,expires_at:e+240,cache_dir:"api/cache/graph-admission-closure/months"},{id:"time-tracking-default",name:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã (—Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)",status:"active",file_count:4,total_size:768e3,ttl:300,created_at:e-900,expires_at:e+2100,cache_dir:"api/cache/time-tracking-sector-1c/default"},{id:"time-tracking-detailed",name:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã (–¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)",status:"active",file_count:6,total_size:1536e3,ttl:120,created_at:e-600,expires_at:e+3540,cache_dir:"api/cache/time-tracking-sector-1c/detailed"},{id:"time-tracking-summary",name:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã (—Å–≤–æ–¥–Ω—ã–π —Ä–µ–∂–∏–º)",status:"active",file_count:2,total_size:384e3,ttl:600,created_at:e-1800,expires_at:e+4200,cache_dir:"api/cache/time-tracking-sector-1c/summary"},{id:"users-management-departments",name:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–æ—Ç–¥–µ–ª—ã)",status:"active",file_count:2,total_size:256e3,ttl:3600,created_at:e-7200,expires_at:e+28800,cache_dir:"api/cache/users-management/departments"},{id:"webhook-logs-api",name:"–õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤ (API –∑–∞–ø—Ä–æ—Å—ã)",status:"active",file_count:15,total_size:512e4,ttl:300,created_at:e-3600,expires_at:e+2400,cache_dir:"api/cache/webhook-logs/api"}]}static enrichModulesWithMetadata(e){return e.map(o=>({...o,metadata:this.generateModuleMetadata(o)}))}}fe(Z,"PRIMARY_MODULE_IDS",["dashboard-sector-1c","graph-state","graph-admission-closure-weeks","graph-admission-closure-months","time-tracking-default","time-tracking-detailed","time-tracking-summary"]),fe(Z,"PRIMARY_MODULE_PRIORITIES",{"dashboard-sector-1c":1,"graph-state":2,"graph-admission-closure-weeks":3,"graph-admission-closure-months":4,"time-tracking-default":5,"time-tracking-detailed":6,"time-tracking-summary":7}),fe(Z,"SECONDARY_MODULE_TYPES",{users:{prefix:"users-management",title:"üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",description:"–ú–æ–¥—É–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –æ—Ç–¥–µ–ª–∞–º–∏"},activity:{prefix:"user-activity",title:"üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",description:"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"},webhooks:{prefix:"webhook-logs",title:"üîó –õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤",description:"–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–µ–±—Ö—É–∫–æ–≤"}}),fe(Z,"categorizationCache",new Map),fe(Z,"CACHE_TTL",3e4);function iv(s){const e=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate())),o=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-o);const t=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-t)/864e5+1)/7)}class Lt{static async createCache(e,o=null,t={}){try{const i=Ee("/api/admin/cache-create.php"),l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({module_id:e,mode:o,params:t})});if(!l.ok){const r=await l.json().catch(()=>({}));throw new Error(r.error||`HTTP error! status: ${l.status}`)}const a=await l.json();if(a.success)return a;throw new Error(a.error||"Failed to create cache")}catch(i){throw console.error("[CacheCreationService] Error creating cache:",i),i}}static async getCreationStatus(e){try{const o=Ee(`/api/admin/cache-create-status.php?task_id=${e}`),t=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const i=await t.json();if(i.success)return i;throw new Error(i.error||"Failed to get creation status")}catch(o){throw console.error("[CacheCreationService] Error getting creation status:",o),o}}static getDefaultParams(e){if(e.includes("graph-admission-closure"))if((e.includes("weeks")?"weeks":"months")==="weeks"){const t=new Date,i=t.getUTCFullYear(),l=iv(t),a=new Date(i,0,1+(l-1)*7),r=a.getUTCDay(),g=a.getUTCDate()-r+(r===0?-6:1);a.setUTCDate(g),a.setUTCHours(0,0,0,0);const f=new Date(a);return f.setUTCDate(a.getUTCDate()+6),f.setUTCHours(23,59,59,999),{product:"1C",periodMode:"weeks",weekStartUtc:a.toISOString(),weekEndUtc:f.toISOString(),includeTickets:!0,includeNewTicketsByStages:!0,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,useCache:!0,forceRefresh:!0}}else return{product:"1C",periodMode:"months",includeTickets:!0,includeNewTicketsByStages:!1,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!1};if(e.includes("dashboard-sector-1c"))return{forceRefresh:!0,ttl:600};if(e.includes("graph-state"))return{type:"current",forceRefresh:!0,ttl:3600};if(e.includes("time-tracking")){const o=e.includes("detailed")?"detailed":e.includes("summary")?"summary":"default";return{product:"1C",includeTaskDetails:o==="detailed",summary:o==="summary"}}return{}}}const rv={name:"CacheCreateProgress",props:{progress:{type:Number,required:!0,validator:s=>s>=0&&s<=100},message:{type:String,default:"–°–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞..."}}},lv={class:"cache-create-progress"},cv={class:"progress-bar"},dv={class:"progress-text"};function uv(s,e,o,t,i,l){return c(),d("div",lv,[n("div",cv,[n("div",{class:"progress-fill",style:oe({width:o.progress+"%"})},null,4)]),n("div",dv,u(o.progress)+"% - "+u(o.message),1)])}const gv=H(rv,[["render",uv],["__scopeId","data-v-7071de3b"]]),mv={name:"CacheCreateModal",components:{CacheCreateProgress:gv},props:{module:{type:Object,required:!0}},emits:["close","create"],setup(s,{emit:e}){const o=w(!1),t=w(0),i=w(""),l=w(null),a=w(""),r=_(()=>s.module.id.includes("graph-admission-closure")||s.module.id.includes("time-tracking")),g=_(()=>s.module.id.includes("graph-admission-closure")?["months","weeks"]:s.module.id.includes("time-tracking")?["default","detailed","summary"]:[]),f=()=>{e("close")},m=b=>{b.preventDefault(),b.stopPropagation(),b.target===b.currentTarget&&f()},h=async()=>{o.value=!0,t.value=0,i.value="–ù–∞—á–∞–ª–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–µ—à–∞...";try{let b={};if(a.value.trim())try{b=JSON.parse(a.value)}catch{throw new Error("–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤")}else b=Lt.getDefaultParams(s.module.id);Je.notifyCacheCreationStarted(s.module.name),t.value=25,i.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Bitrix24...";const p=await Lt.createCache(s.module.id,l.value,b);t.value=75,i.value="–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–µ—à–∞...",await new Promise(v=>setTimeout(v,500)),t.value=100,i.value="–ö–µ—à —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!",Je.notifyCacheCreationSuccess(s.module.name),setTimeout(()=>{e("create",p),f()},1e3)}catch(b){console.error("[CacheCreateModal] Error creating cache:",b),Je.notifyCacheCreationError(s.module.name,b.message),o.value=!1}};return ae(()=>{g.value.length>0&&(l.value=g.value[0]);const b=Lt.getDefaultParams(s.module.id);a.value=JSON.stringify(b,null,2)}),{creating:o,progress:t,progressMessage:i,selectedMode:l,paramsJson:a,supportsModes:r,availableModes:g,close:f,handleOverlayClick:m,handleCreate:h}}},fv={class:"modal-header"},hv={class:"modal-body"},vv={key:1,class:"create-form"},yv={key:0,class:"form-group"},pv=["value"],_v={class:"form-group"},bv={class:"modal-footer"},kv=["disabled"],Cv=["disabled"],Sv={key:0},wv={key:1};function Tv(s,e,o,t,i,l){const a=W("CacheCreateProgress");return c(),q(Ot,{to:"body"},[n("div",{class:"modal-overlay",onClick:e[6]||(e[6]=(...r)=>t.handleOverlayClick&&t.handleOverlayClick(...r))},[n("div",{class:"modal-content",onClick:e[5]||(e[5]=de(()=>{},["stop"])),style:{"pointer-events":"auto"}},[n("div",fv,[n("h2",null,"–°–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞: "+u(o.module.name),1),n("button",{onClick:e[0]||(e[0]=(...r)=>t.close&&t.close(...r)),class:"btn-close"},"√ó")]),n("div",hv,[t.creating?(c(),q(a,{key:0,progress:t.progress,message:t.progressMessage},null,8,["progress","message"])):(c(),d("div",vv,[t.supportsModes?(c(),d("div",yv,[e[7]||(e[7]=n("label",null,"–†–µ–∂–∏–º –∫–µ—à–∞:",-1)),te(n("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.selectedMode=r),class:"form-control"},[(c(!0),d(U,null,F(t.availableModes,r=>(c(),d("option",{key:r,value:r},u(r),9,pv))),128))],512),[[Te,t.selectedMode]])])):y("",!0),n("div",_v,[e[8]||(e[8]=n("label",null,"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (JSON):",-1)),te(n("textarea",{"onUpdate:modelValue":e[2]||(e[2]=r=>t.paramsJson=r),placeholder:'{"product": "1C", ...}',rows:"5",class:"form-control"},null,512),[[Ke,t.paramsJson]]),e[9]||(e[9]=n("small",{class:"form-text"},"–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é",-1))])]))]),n("div",bv,[n("button",{onClick:e[3]||(e[3]=(...r)=>t.close&&t.close(...r)),class:"btn-cancel",disabled:t.creating},"–û—Ç–º–µ–Ω–∞",8,kv),n("button",{onClick:e[4]||(e[4]=(...r)=>t.handleCreate&&t.handleCreate(...r)),disabled:t.creating,class:"btn-create"},[t.creating?(c(),d("span",Sv,"–°–æ–∑–¥–∞–Ω–∏–µ...")):(c(),d("span",wv,"–°–æ–∑–¥–∞—Ç—å –∫–µ—à"))],8,Cv)])])])])}const Ev=H(mv,[["render",Tv],["__scopeId","data-v-1fa7d83b"]]),xv={name:"CacheCreateButton",components:{CacheCreateModal:Ev},props:{module:{type:Object,required:!0}},emits:["created"],setup(s,{emit:e}){const o=w(!1),t=w(!1);return{showModal:o,creating:t,openModal:()=>{o.value=!0},closeModal:()=>{o.value=!1},handleCreate:async r=>{t.value=!0;try{e("created",r)}finally{t.value=!1}}}}},Av={class:"cache-create-button"},Dv=["disabled"],Iv={key:0},Mv={key:1};function Lv(s,e,o,t,i,l){const a=W("CacheCreateModal");return c(),d("div",Av,[n("button",{onClick:e[0]||(e[0]=(...r)=>t.openModal&&t.openModal(...r)),disabled:t.creating,class:N(["btn-create",{"btn-disabled":t.creating}])},[t.creating?(c(),d("span",Iv,"–°–æ–∑–¥–∞–Ω–∏–µ...")):(c(),d("span",Mv,"‚ûï –°–æ–∑–¥–∞—Ç—å –∫–µ—à"))],10,Dv),t.showModal?(c(),q(a,{key:0,module:o.module,onClose:t.closeModal,onCreate:t.handleCreate},null,8,["module","onClose","onCreate"])):y("",!0)])}const Pv=H(xv,[["render",Lv],["__scopeId","data-v-45e7d308"]]);class ue{static success(e,o,t={}){this.show("success",e,o,t)}static error(e,o,t={}){this.show("error",e,o,t)}static warning(e,o,t={}){this.show("warning",e,o,t)}static info(e,o,t={}){this.show("info",e,o,t)}static show(e,o,t,i={}){const l={autoHideDelay:i.autoHideDelay||5e3,position:i.position||"top-right",...i};this.isBitrix24Available()?this.showBitrix24Notification(e,o,t,l):this.showFallbackNotification(e,o,t,l)}static isBitrix24Available(){return typeof window<"u"&&window.BX&&window.BX.UI&&window.BX.UI.Notification&&window.BX.UI.Notification.Center&&typeof window.BX.UI.Notification.Center.notify=="function"}static showBitrix24Notification(e,o,t,i){try{const a={success:"success",error:"error",warning:"warning",info:"info"}[e]||"info",r=o?`${o}: ${t}`:t;window.BX.UI.Notification.Center.notify({content:r,autoHideDelay:i.autoHideDelay,category:`cache-management-${e}`,position:i.position}),console.log(`[NotificationSystem] Bitrix24 notification shown: ${e}`,{title:o,message:t,config:i})}catch(l){console.error("[NotificationSystem] Error showing Bitrix24 notification:",l),this.showFallbackNotification(e,o,t,i)}}static showFallbackNotification(e,o,t,i){if("Notification"in window&&Notification.permission==="granted")try{const l=new Notification(o||"–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ",{body:t,icon:this.getIconForType(e),tag:`cache-management-${e}`});setTimeout(()=>{l.close()},i.autoHideDelay),console.log(`[NotificationSystem] Browser notification shown: ${e}`,{title:o,message:t});return}catch(l){console.warn("[NotificationSystem] Browser notification failed:",l)}this.showCustomNotification(e,o,t,i)}static showCustomNotification(e,o,t,i){let l=document.getElementById("notification-container");if(!l){l=document.createElement("div"),l.id="notification-container",l.className="notification-container",document.body.appendChild(l);const g=document.createElement("style");g.textContent=this.getNotificationStyles(),document.head.appendChild(g)}const a=document.createElement("div");a.className=`custom-notification notification-${e}`,a.innerHTML=`
      <div class="notification-content">
        <div class="notification-title">${o||""}</div>
        <div class="notification-message">${t}</div>
      </div>
      <button class="notification-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ">√ó</button>
    `,a.querySelector(".notification-close").addEventListener("click",()=>{this.removeCustomNotification(a)}),l.appendChild(a),setTimeout(()=>{this.removeCustomNotification(a)},i.autoHideDelay),console.log(`[NotificationSystem] Custom notification shown: ${e}`,{title:o,message:t})}static removeCustomNotification(e){e&&e.parentNode&&(e.classList.add("notification-hiding"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},300))}static getIconForType(e){const o={success:"‚úÖ",error:"‚ùå",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è"};return o[e]||o.info}static getNotificationStyles(){return`
      .notification-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 10000;
        pointer-events: none;
      }

      .custom-notification {
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        margin-bottom: 10px;
        min-width: 300px;
        max-width: 500px;
        pointer-events: auto;
        opacity: 0;
        transform: translateX(100%);
        animation: notificationSlideIn 0.3s ease forwards;
        border-left: 4px solid;
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        padding: 16px;
        gap: 12px;
      }

      .custom-notification.notification-success {
        border-left-color: #28a745;
      }

      .custom-notification.notification-error {
        border-left-color: #dc3545;
      }

      .custom-notification.notification-warning {
        border-left-color: #ffc107;
      }

      .custom-notification.notification-info {
        border-left-color: #17a2b8;
      }

      .notification-content {
        flex: 1;
      }

      .notification-title {
        font-weight: 600;
        font-size: 14px;
        margin-bottom: 4px;
        color: #333;
      }

      .notification-message {
        font-size: 13px;
        color: #666;
        line-height: 1.4;
      }

      .notification-close {
        background: none;
        border: none;
        font-size: 20px;
        color: #999;
        cursor: pointer;
        padding: 0;
        line-height: 1;
        flex-shrink: 0;
      }

      .notification-close:hover {
        color: #333;
      }

      .notification-hiding {
        animation: notificationSlideOut 0.3s ease forwards;
      }

      @keyframes notificationSlideIn {
        from {
          opacity: 0;
          transform: translateX(100%);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes notificationSlideOut {
        from {
          opacity: 1;
          transform: translateX(0);
        }
        to {
          opacity: 0;
          transform: translateX(100%);
        }
      }

      @media (max-width: 768px) {
        .notification-container {
          left: 10px;
          right: 10px;
          top: 10px;
        }

        .custom-notification {
          min-width: auto;
          max-width: none;
        }
      }
    `}static clearAll(){try{this.isBitrix24Available()&&window.BX.UI.Notification.Center.clearAll&&window.BX.UI.Notification.Center.clearAll()}catch(o){console.warn("[NotificationSystem] Error clearing Bitrix24 notifications:",o)}const e=document.getElementById("notification-container");if(e&&(e.innerHTML=""),"Notification"in window&&"getNotifications"in Notification)try{Notification.getNotifications().forEach(t=>{t.tag&&t.tag.startsWith("cache-management-")&&t.close()})}catch(o){console.warn("[NotificationSystem] Error clearing browser notifications:",o)}}}ue.show.bind(ue);ue.success.bind(ue);ue.error.bind(ue);ue.warning.bind(ue);ue.info.bind(ue);let le=null,be=null;const $e=class $e{static show(e={}){return new Promise((o,t)=>{be=o,le||(le=this.createModal(),document.body.appendChild(le)),this.configureModal(e),this.showModal()})}static hide(){le&&(this.hideModal(),be&&(be(!1),be=null))}static createModal(){const e=document.createElement("div");return e.className="cache-confirmation-modal",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-labelledby","confirmation-title"),e.setAttribute("aria-describedby","confirmation-message"),e.innerHTML=`
      <div class="modal-backdrop" data-action="cancel"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="confirmation-title" class="modal-title"></h3>
          <button
            class="modal-close"
            data-action="cancel"
            aria-label="–ó–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"
          >
            √ó
          </button>
        </div>

        <div class="modal-body">
          <div class="modal-icon">
            <span class="icon-symbol"></span>
          </div>
          <p id="confirmation-message" class="modal-message"></p>
        </div>

        <div class="modal-footer">
          <button class="btn btn-cancel" data-action="cancel"></button>
          <button class="btn btn-confirm" data-action="confirm"></button>
        </div>
      </div>
    `,this.attachEventListeners(e),this.addStyles(),e}static configureModal(e){const{title:o="–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è",message:t="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ?",type:i="warning",confirmText:l="–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",cancelText:a="–û—Ç–º–µ–Ω–∞",showCancel:r=!0}=e,g=le.querySelector(".modal-title");g.textContent=o;const f=le.querySelector(".modal-message");f.textContent=t;const m=le.querySelector(".icon-symbol"),h={danger:"‚ö†Ô∏è",warning:"‚ö†Ô∏è",info:"‚ÑπÔ∏è",success:"‚úÖ"};m.textContent=h[i]||h.warning;const b=le.querySelector(".btn-cancel"),p=le.querySelector(".btn-confirm");b.textContent=a,p.textContent=l,r?b.style.display="inline-block":b.style.display="none",le.className=`cache-confirmation-modal modal-${i}`}static showModal(){document.body.style.overflow="hidden",le.style.display="flex",le.classList.add("modal-visible"),setTimeout(()=>{const e=le.querySelector(".btn-confirm");e&&e.focus()},100),document.addEventListener("keydown",this.handleKeyDown)}static hideModal(){document.body.style.overflow="",le.classList.remove("modal-visible"),document.removeEventListener("keydown",this.handleKeyDown),setTimeout(()=>{le&&(le.style.display="none")},300)}static attachEventListeners(e){e.addEventListener("click",o=>{const t=o.target.closest("[data-action]")?.getAttribute("data-action");t==="confirm"?this.handleConfirm():t==="cancel"&&this.handleCancel()})}static handleConfirm(){be&&(be(!0),be=null),this.hideModal()}static handleCancel(){be&&(be(!1),be=null),this.hideModal()}static handleTabNavigation(e){const t=le.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=t[0],l=t[t.length-1];e.shiftKey?document.activeElement===i&&(e.preventDefault(),l.focus()):document.activeElement===l&&(e.preventDefault(),i.focus())}static addStyles(){if(document.getElementById("cache-confirmation-styles"))return;const e=document.createElement("style");e.id="cache-confirmation-styles",e.textContent=`
      .cache-confirmation-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 10000;
        align-items: center;
        justify-content: center;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      }

      .cache-confirmation-modal.modal-visible {
        display: flex;
      }

      .modal-backdrop {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(2px);
      }

      .modal-content {
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 400px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        position: relative;
        z-index: 10001;
        animation: modalSlideIn 0.3s ease-out;
      }

      @keyframes modalSlideIn {
        from {
          opacity: 0;
          transform: scale(0.9) translateY(-20px);
        }
        to {
          opacity: 1;
          transform: scale(1) translateY(0);
        }
      }

      .modal-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 20px 24px 16px;
        border-bottom: 1px solid #e0e0e0;
      }

      .modal-title {
        margin: 0;
        font-size: 18px;
        font-weight: 600;
        color: #333;
      }

      .modal-close {
        background: none;
        border: none;
        font-size: 24px;
        color: #999;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
      }

      .modal-close:hover {
        background: #f0f0f0;
        color: #333;
      }

      .modal-body {
        padding: 24px;
        text-align: center;
      }

      .modal-icon {
        margin-bottom: 16px;
      }

      .icon-symbol {
        font-size: 48px;
        display: block;
      }

      .modal-message {
        margin: 0;
        font-size: 16px;
        color: #555;
        line-height: 1.5;
      }

      .modal-footer {
        display: flex;
        gap: 12px;
        justify-content: flex-end;
        padding: 16px 24px 24px;
        border-top: 1px solid #e0e0e0;
      }

      .btn {
        padding: 10px 20px;
        border-radius: 6px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border: none;
        transition: all 0.2s ease;
        min-width: 80px;
      }

      .btn:focus {
        outline: 2px solid #007bff;
        outline-offset: 2px;
      }

      .btn-cancel {
        background: #f8f9fa;
        color: #6c757d;
        border: 1px solid #dee2e6;
      }

      .btn-cancel:hover {
        background: #e9ecef;
        border-color: #adb5bd;
      }

      .btn-confirm {
        background: #007bff;
        color: white;
      }

      .btn-confirm:hover {
        background: #0056b3;
      }

      /* –¢–∏–ø—ã –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω */
      .modal-danger .btn-confirm {
        background: #dc3545;
      }

      .modal-danger .btn-confirm:hover {
        background: #c82333;
      }

      .modal-warning .btn-confirm {
        background: #ffc107;
        color: #212529;
      }

      .modal-warning .btn-confirm:hover {
        background: #e0a800;
      }

      .modal-info .btn-confirm {
        background: #17a2b8;
      }

      .modal-info .btn-confirm:hover {
        background: #138496;
      }

      .modal-success .btn-confirm {
        background: #28a745;
      }

      .modal-success .btn-confirm:hover {
        background: #1e7e34;
      }

      /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
      @media (max-width: 480px) {
        .modal-content {
          margin: 20px;
          width: calc(100% - 40px);
        }

        .modal-header,
        .modal-body,
        .modal-footer {
          padding-left: 20px;
          padding-right: 20px;
        }

        .modal-footer {
          flex-direction: column-reverse;
        }

        .btn {
          width: 100%;
        }
      }

      /* –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å */
      @media (prefers-reduced-motion: reduce) {
        .modal-content,
        .modal-close,
        .btn {
          animation: none;
          transition: none;
        }
      }

      /* –í—ã—Å–æ–∫–∏–π –∫–æ–Ω—Ç—Ä–∞—Å—Ç */
      @media (prefers-contrast: high) {
        .modal-content {
          border: 2px solid #000;
        }

        .btn-cancel {
          border: 2px solid #000;
        }

        .btn-confirm {
          border: 2px solid #000;
        }
      }
    `,document.head.appendChild(e)}};fe($e,"handleKeyDown",e=>{switch(e.key){case"Enter":e.preventDefault(),$e.handleConfirm();break;case"Escape":e.preventDefault(),$e.handleCancel();break;case"Tab":$e.handleTabNavigation(e);break}});let Fe=$e;Fe.show.bind(Fe);Fe.hide.bind(Fe);const Nv={name:"CacheModuleCard",components:{CacheCreateButton:Pv},props:{module:{type:Object,required:!0,validator:s=>s&&typeof s.id=="string"&&typeof s.name=="string"},isPrimary:{type:Boolean,default:!1},priority:{type:Number,default:999},groupType:{type:String,default:null}},emits:["clear","refresh","details"],setup(s,{emit:e}){const o=w(!1),t=w(!1),i=w(!1),l=w(!1),a=E=>{if(!E.target.closest(".action-button"))switch(E.key){case"Enter":case" ":E.preventDefault();const $=E.currentTarget.querySelector(".action-button:not([disabled])");$&&$.focus();break}};ae(()=>{const E=()=>{l.value=window.innerWidth<768};E(),window.addEventListener("resize",E);const $=document.querySelector(`[data-module-id="${s.module.id}"]`);$&&$.addEventListener("keydown",a)}),pt(()=>{const E=document.querySelector(`[data-module-id="${s.module.id}"]`);E&&E.removeEventListener("keydown",a)});const r=_(()=>({"cache-module-card":!0,"primary-module":s.isPrimary,"secondary-module":!s.isPrimary,"high-priority":s.priority<=3,"expiring-soon":S.value,"empty-cache":p.value,loading:o.value||t.value,[Le.value]:!0})),g=_(()=>s.isPrimary?"üèÜ":{users:"üë•",activity:"üìä",webhooks:"üîó",other:"üîß"}[s.groupType]||"üîß"),f=_(()=>({"primary-icon":s.isPrimary,"secondary-icon":!s.isPrimary})),m=_(()=>s.isPrimary?"–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å":s.groupType?Z.getModuleTypeConfig(s.groupType).title||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞":""),h=_(()=>s.priority?`priority-${s.priority}`:""),b=_(()=>`status-${s.module.status||"empty"}`),p=_(()=>(s.module.file_count||0)===0),v=_(()=>s.module.expires_at?new Date(s.module.expires_at*1e3)<=new Date:!1),S=_(()=>{if(!s.module.expires_at)return!1;const z=(new Date(s.module.expires_at*1e3)-new Date)/(1e3*60*60);return z>0&&z<=2}),D=_(()=>{const E=s.module.status;return E==="active"?"–ê–∫—Ç–∏–≤–µ–Ω":E==="expired"?"–ü—Ä–æ—Å—Ä–æ—á–µ–Ω":E==="empty"?"–ü—É—Å—Ç":"–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω"}),C=_(()=>Z.formatCacheSize(s.module.total_size||0)),M=_(()=>Z.formatTTL(s.module.ttl||0)),I=_(()=>{if(!s.module.cache_dir)return"";const E=s.module.cache_dir.split("/");return E.length>2?"..."+E.slice(-2).join("/"):s.module.cache_dir}),V=_(()=>s.module.metadata?.creation_time_ms?Z.formatCreationTime(s.module.metadata.creation_time_ms):"‚Äî"),O=_(()=>{if(!s.module.metadata?.last_accessed_at)return"‚Äî";const E=new Date(s.module.metadata.last_accessed_at*1e3),z=new Date-E;return z<6e4?"–¢–æ–ª—å–∫–æ —á—Ç–æ":z<36e5?`${Math.floor(z/6e4)} –º–∏–Ω –Ω–∞–∑–∞–¥`:E.toLocaleString("ru-RU",{hour:"2-digit",minute:"2-digit"})}),L=_(()=>s.module.metadata?.access_count||0),k=_(()=>s.module.metadata?.performance_metrics?.cache_hit_ratio?Z.formatCacheHitRatio(s.module.metadata.performance_metrics.cache_hit_ratio):"‚Äî"),T=_(()=>s.module.metadata?.performance_metrics?.data_freshness_score?Z.formatDataFreshness(s.module.metadata.performance_metrics.data_freshness_score):"‚Äî"),B=_(()=>s.module.expires_at?`metric-${Z.getExpiryColor(s.module.expires_at)}`:""),P=_(()=>s.module.metadata?.creation_time_ms?`metric-${Z.getCreationTimeColor(s.module.metadata.creation_time_ms)}`:""),R=_(()=>s.module.metadata?.performance_metrics?.cache_hit_ratio?`metric-${Z.getEfficiencyColor(s.module.metadata.performance_metrics.cache_hit_ratio)}`:""),j=_(()=>s.module.metadata?.performance_metrics?.data_freshness_score?`metric-${Z.getFreshnessColor(s.module.metadata.performance_metrics.data_freshness_score)}`:""),G=_(()=>{if(!s.module.expires_at)return null;const E=new Date(s.module.expires_at*1e3);return Math.max(0,Math.floor((E-new Date)/1e3))}),ve=_(()=>{if(G.value===null)return"‚Äî";if(G.value<=0)return"–ò—Å—Ç–µ–∫";const E=Math.floor(G.value/3600),$=Math.floor(G.value%3600/60),z=G.value%60;return E>0?`${E}—á ${$}–º`:$>0?`${$}–º ${z}—Å`:`${z}—Å`}),Be=_(()=>G.value===null?"":G.value<=0||G.value<=1800?"metric-red":G.value<=7200?"metric-orange":"metric-green"),ge=E=>{if(E===0)return"0 B";const $=1024,z=["B","KB","MB","GB","TB"],Y=Math.floor(Math.log(E)/Math.log($));return parseFloat((E/Math.pow($,Y)).toFixed(1))+" "+z[Y]},Me=E=>E<60?`${E}—Å`:E<3600?`${Math.floor(E/60)}–º`:E<86400?`${Math.floor(E/3600)}—á`:`${Math.floor(E/86400)}–¥`,A=_(()=>{if(p.value)return"empty";if(v.value)return"expired";const E=G.value;return E===null?"fresh":E<=0?"expired":E<=30*60*1e3?"critical":E<=2*60*60*1e3?"warning":"fresh"}),J=_(()=>{const E=A.value;return{fresh:"–°–≤–µ–∂–∏–π –∫–µ—à",warning:"–ò—Å—Ç–µ–∫–∞–µ—Ç —Å–∫–æ—Ä–æ",critical:"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –∏—Å—Ç–µ–∫–∞–µ—Ç",expired:"–ü—Ä–æ—Å—Ä–æ—á–µ–Ω",empty:"–ö–µ—à –ø—É—Å—Ç"}[E]||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ"}),Le=_(()=>`cache-state-${A.value}`),Re=_(()=>({fresh:"üü¢",warning:"üü°",critical:"üî¥",expired:"‚ö´",empty:"‚ö™"})[A.value]||"‚ùì"),Se=_(()=>!p.value&&!o.value),Ve=_(()=>s.isPrimary&&!p.value),Ue=_(()=>p.value?"–ö–µ—à –º–æ–¥—É–ª—è –ø—É—Å—Ç":`–û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –º–æ–¥—É–ª—è ${s.module.name}`),kt=_(()=>{if(!s.module.created_at)return"‚Äî";const E=new Date(s.module.created_at*1e3),$=new Date,z=$-E;if(z<6e4)return"–¢–æ–ª—å–∫–æ —á—Ç–æ";if(z<36e5){const ie=Math.floor(z/6e4);return`${ie} ${ie===1?"–º–∏–Ω—É—Ç—É":ie<5?"–º–∏–Ω—É—Ç—ã":"–º–∏–Ω—É—Ç"} –Ω–∞–∑–∞–¥`}if(E.toDateString()===$.toDateString())return`–°–µ–≥–æ–¥–Ω—è –≤ ${E.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}`;const Y=new Date($);return Y.setDate(Y.getDate()-1),E.toDateString()===Y.toDateString()?`–í—á–µ—Ä–∞ –≤ ${E.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}`:E.toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}),Ct=_(()=>{if(!s.module.expires_at)return"‚Äî";const E=new Date(s.module.expires_at*1e3),z=E-new Date;if(z<0)return`–ü—Ä–æ—Å—Ä–æ—á–µ–Ω (${E.toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})})`;const Y=Math.floor(z/6e4),ie=Math.floor(Y/60);return ie>0?`${ie} —á ${Y%60} –º–∏–Ω`:Y>0?`${Y} –º–∏–Ω`:"–ú–µ–Ω–µ–µ –º–∏–Ω—É—Ç—ã"});return{clearing:o,creating:t,showDetailModal:i,isMobile:l,moduleClasses:r,moduleIcon:g,iconClass:f,moduleTypeText:m,priorityClass:h,statusClass:b,isEmpty:p,isExpired:v,isExpiringSoon:S,statusText:D,formattedSize:C,formattedTTL:M,shortCacheDir:I,formattedCreationTime:V,formattedLastAccess:O,accessCount:L,cacheEfficiency:k,dataFreshness:T,expiresClass:B,creationTimeClass:P,cacheEfficiencyClass:R,dataFreshnessClass:j,cacheState:A,cacheStateText:J,cacheStateClass:Le,cacheStateIcon:Re,timeToExpiry:G,formatTimeToExpiry:ve,timeToExpiryClass:Be,formatBytes:ge,formatTTL:Me,canClear:Se,canShowDetails:Ve,clearButtonLabel:Ue,formattedCreatedAt:kt,formattedExpiresAt:Ct,handleClear:async()=>{if(Se.value)try{if(!await Fe.show({title:"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞",message:`–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –º–æ–¥—É–ª—è "${s.module.name}"?

–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.`,type:"danger",confirmText:"üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –∫–µ—à",cancelText:"–û—Ç–º–µ–Ω–∞"}))return;o.value=!0,await Z.clearCache(s.module.id),e("clear",s.module.id),ue.success("–ö–µ—à —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω",`–ö–µ—à –º–æ–¥—É–ª—è "${s.module.name}" –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω`)}catch(E){console.error("[CacheModuleCard] Error clearing cache:",E),ue.error("–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞",`–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –∫–µ—à –º–æ–¥—É–ª—è "${s.module.name}": ${E.message}`)}finally{o.value=!1}},handleCacheCreated:()=>{Z.invalidateCacheAfterModuleOperation(),e("refresh")},handleCreatingState:E=>{t.value=E},showDetails:()=>{i.value=!0,e("details",s.module)},closeDetails:()=>{i.value=!1}}}},Ov=["aria-labelledby","aria-describedby","data-module-id"],Bv={class:"card-header"},Rv={class:"module-identity"},Uv={class:"module-info"},Fv=["id"],Vv={class:"module-type"},jv={class:"header-meta"},zv=["id"],Hv={class:"card-content"},Wv={class:"data-grid",role:"region","aria-label":"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–µ—à–µ"},$v={class:"data-section statistics"},qv={class:"data-items"},Kv={class:"data-item"},Xv={class:"data-value"},Gv={class:"data-item"},Jv={class:"data-value"},Yv={key:0,class:"data-item full-width"},Zv=["title"],Qv={class:"data-section lifetime"},ey={class:"data-items"},ty={class:"data-item"},oy={class:"data-value"},sy={key:0,class:"data-item"},ny={class:"data-value"},ay={key:1,class:"data-item"},iy={class:"data-section cache-state"},ry={class:"section-header"},ly=["aria-label"],cy={class:"data-items"},dy={class:"data-value cache-state-text"},uy={key:0,class:"data-section performance"},gy={class:"data-items"},my={key:0,class:"data-item"},fy={key:1,class:"data-item"},hy={class:"data-value"},vy={key:2,class:"data-item"},yy={class:"data-value"},py={key:3,class:"data-item"},_y={key:4,class:"data-item"},by={key:5,class:"data-item"},ky={class:"data-value"},Cy={key:6,class:"data-item"},Sy={class:"data-value"},wy={key:7,class:"data-item"},Ty=["aria-label"],Ey={class:"primary-actions"},xy={class:"secondary-actions"},Ay=["disabled","aria-label"],Dy={key:0,class:"button-content"},Iy={key:1,class:"button-content"},My={key:2,class:"button-content"},Ly=["aria-label"],Py={class:"detail-modal",role:"dialog","aria-modal":"true"},Ny={class:"modal-header"},Oy={class:"modal-content"},By={class:"json-data"};function Ry(s,e,o,t,i,l){const a=W("CacheCreateButton");return c(),d("article",{class:N(["cache-module-card",t.moduleClasses]),role:"article","aria-labelledby":`module-${o.module.id}-title`,"aria-describedby":`module-${o.module.id}-status`,"data-module-id":o.module.id,tabindex:"0"},[n("div",Bv,[n("div",Rv,[n("div",{class:N(["module-icon",t.iconClass])},u(t.moduleIcon),3),n("div",Uv,[n("h3",{class:"module-name",id:`module-${o.module.id}-title`},u(o.module.name),9,Fv),n("span",Vv,u(t.moduleTypeText),1)])]),n("div",jv,[o.isPrimary&&o.priority?(c(),d("span",{key:0,class:N(["priority-badge",t.priorityClass])},u(o.priority),3)):y("",!0),n("span",{class:N(["status-badge",t.statusClass]),id:`module-${o.module.id}-status`,role:"status"},u(t.statusText),11,zv)])]),n("div",Hv,[n("div",Wv,[n("div",$v,[e[14]||(e[14]=n("div",{class:"section-header"},[n("span",{class:"section-icon","aria-hidden":"true"},"üìä"),n("h4",{class:"section-title"},"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞")],-1)),n("div",qv,[n("div",Kv,[e[11]||(e[11]=n("span",{class:"data-label"},"–§–∞–π–ª–æ–≤:",-1)),n("span",Xv,u(o.module.file_count||0),1)]),n("div",Gv,[e[12]||(e[12]=n("span",{class:"data-label"},"–†–∞–∑–º–µ—Ä:",-1)),n("span",Jv,u(t.formattedSize),1)]),o.module.cache_dir?(c(),d("div",Yv,[e[13]||(e[13]=n("span",{class:"data-label"},"–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:",-1)),n("span",{class:"data-value cache-dir",title:o.module.cache_dir},u(t.shortCacheDir),9,Zv)])):y("",!0)])]),n("div",Qv,[e[18]||(e[18]=n("div",{class:"section-header"},[n("span",{class:"section-icon","aria-hidden":"true"},"‚è∞"),n("h4",{class:"section-title"},"–í—Ä–µ–º—è –∂–∏–∑–Ω–∏")],-1)),n("div",ey,[n("div",ty,[e[15]||(e[15]=n("span",{class:"data-label"},"TTL:",-1)),n("span",oy,u(t.formattedTTL),1)]),o.module.created_at?(c(),d("div",sy,[e[16]||(e[16]=n("span",{class:"data-label"},"–°–æ–∑–¥–∞–Ω:",-1)),n("span",ny,u(t.formattedCreatedAt),1)])):y("",!0),o.module.expires_at?(c(),d("div",ay,[e[17]||(e[17]=n("span",{class:"data-label"},"–ò—Å—Ç–µ–∫–∞–µ—Ç:",-1)),n("span",{class:N(["data-value",t.expiresClass])},u(t.formattedExpiresAt),3)])):y("",!0)])]),n("div",iy,[n("div",ry,[n("span",{class:"section-icon","aria-label":t.cacheStateText,"aria-hidden":"false"},u(t.cacheStateIcon),9,ly),e[19]||(e[19]=n("h4",{class:"section-title"},"–°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–µ—à–∞",-1))]),n("div",cy,[n("div",{class:N(["data-item cache-state-indicator",t.cacheStateClass])},[e[20]||(e[20]=n("span",{class:"data-label"},"–°—Ç–∞—Ç—É—Å:",-1)),n("span",dy,u(t.cacheStateText),1)],2)])]),o.module.metadata||o.module.created_at?(c(),d("div",uy,[e[29]||(e[29]=n("div",{class:"section-header"},[n("span",{class:"section-icon","aria-hidden":"true"},"‚ö°"),n("h4",{class:"section-title"},"–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å")],-1)),n("div",gy,[t.formattedCreationTime?(c(),d("div",my,[e[21]||(e[21]=n("span",{class:"data-label"},"–í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è:",-1)),n("span",{class:N(["data-value",t.creationTimeClass])},u(t.formattedCreationTime),3)])):y("",!0),t.formattedLastAccess?(c(),d("div",fy,[e[22]||(e[22]=n("span",{class:"data-label"},"–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ—Å—Ç—É–ø:",-1)),n("span",hy,u(t.formattedLastAccess),1)])):y("",!0),t.accessCount!==null?(c(),d("div",vy,[e[23]||(e[23]=n("span",{class:"data-label"},"–û–±—Ä–∞—â–µ–Ω–∏–π:",-1)),n("span",yy,u(t.accessCount),1)])):y("",!0),t.cacheEfficiency?(c(),d("div",py,[e[24]||(e[24]=n("span",{class:"data-label"},"–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:",-1)),n("span",{class:N(["data-value",t.cacheEfficiencyClass])},u(t.cacheEfficiency),3)])):y("",!0),t.dataFreshness?(c(),d("div",_y,[e[25]||(e[25]=n("span",{class:"data-label"},"–°–≤–µ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:",-1)),n("span",{class:N(["data-value",t.dataFreshnessClass])},u(t.dataFreshness),3)])):y("",!0),o.module.total_size?(c(),d("div",by,[e[26]||(e[26]=n("span",{class:"data-label"},"–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä:",-1)),n("span",ky,u(t.formatBytes(o.module.total_size)),1)])):y("",!0),o.module.ttl?(c(),d("div",Cy,[e[27]||(e[27]=n("span",{class:"data-label"},"TTL:",-1)),n("span",Sy,u(t.formatTTL(o.module.ttl)),1)])):y("",!0),t.timeToExpiry!==null?(c(),d("div",wy,[e[28]||(e[28]=n("span",{class:"data-label"},"–ò—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑:",-1)),n("span",{class:N(["data-value",t.timeToExpiryClass])},u(t.formatTimeToExpiry),3)])):y("",!0)])])):y("",!0)])]),n("div",{class:N(["card-actions",{"mobile-layout":t.isMobile}]),role:"group","aria-label":`–î–µ–π—Å—Ç–≤–∏—è —Å –∫–µ—à–µ–º ${o.module.name}`},[n("div",Ey,[K(a,{module:o.module,disabled:t.creating,onCreated:t.handleCacheCreated,onCreating:t.handleCreatingState,class:N({loading:t.creating})},null,8,["module","disabled","onCreated","onCreating","class"])]),n("div",xy,[n("button",{onClick:e[0]||(e[0]=(...r)=>t.handleClear&&t.handleClear(...r)),onKeydown:[e[1]||(e[1]=se((...r)=>t.handleClear&&t.handleClear(...r),["enter"])),e[2]||(e[2]=se(de((...r)=>t.handleClear&&t.handleClear(...r),["prevent"]),["space"]))],disabled:!t.canClear,class:N(["action-button clear-button",{disabled:!t.canClear,loading:t.clearing}]),"aria-label":t.clearButtonLabel,tabindex:"0"},[t.clearing?(c(),d("span",Dy,[...e[30]||(e[30]=[n("span",{class:"spinner"},null,-1),X(" –û—á–∏—Å—Ç–∫–∞... ",-1)])])):t.isEmpty?(c(),d("span",Iy," üìÅ –ö–µ—à –ø—É—Å—Ç ")):(c(),d("span",My," üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å "))],42,Ay),t.canShowDetails?(c(),d("button",{key:0,onClick:e[3]||(e[3]=(...r)=>t.showDetails&&t.showDetails(...r)),onKeydown:[e[4]||(e[4]=se((...r)=>t.showDetails&&t.showDetails(...r),["enter"])),e[5]||(e[5]=se(de((...r)=>t.showDetails&&t.showDetails(...r),["prevent"]),["space"]))],class:"action-button details-button","aria-label":`–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–µ—à–∞ ${o.module.name}`,title:"–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–µ—à–∞",tabindex:"0"}," üìä ",40,Ly)):y("",!0)])],10,Ty),(c(),q(Ot,{to:"body"},[t.showDetailModal?(c(),d("div",{key:0,class:"detail-modal-overlay",onClick:e[9]||(e[9]=de((...r)=>t.closeDetails&&t.closeDetails(...r),["self"])),onKeydown:e[10]||(e[10]=se((...r)=>t.closeDetails&&t.closeDetails(...r),["escape"]))},[n("div",Py,[n("div",Ny,[n("h3",null,"–î–µ—Ç–∞–ª–∏ –∫–µ—à–∞: "+u(o.module.name),1),n("button",{onClick:e[6]||(e[6]=(...r)=>t.closeDetails&&t.closeDetails(...r)),onKeydown:[e[7]||(e[7]=se((...r)=>t.closeDetails&&t.closeDetails(...r),["enter"])),e[8]||(e[8]=se((...r)=>t.closeDetails&&t.closeDetails(...r),["escape"]))],class:"close-button","aria-label":"–ó–∞–∫—Ä—ã—Ç—å",tabindex:"0"}," ‚úï ",32)]),n("div",Oy,[n("pre",By,u(JSON.stringify(o.module,null,2)),1)])])],32)):y("",!0)]))],10,Ov)}const Uy=H(Nv,[["render",Ry],["__scopeId","data-v-bc59cd77"]]),Fy={name:"CacheStats",props:{modules:{type:Array,required:!1,default:()=>[]}},setup(s){console.log("[CacheStats] setup called with modules:",s.modules);const e=_(()=>s.modules||[]),o=_(()=>{console.log("[CacheStats] Computing primaryModules, total modules:",e.value?.length||0);const v=e.value.filter(S=>Z.PRIMARY_MODULE_IDS.includes(S.id));return console.log("[CacheStats] Primary modules count:",v.length),v}),t=_(()=>{console.log("[CacheStats] Computing secondaryModules, total modules:",e.value?.length||0);const v=e.value.filter(S=>!Z.PRIMARY_MODULE_IDS.includes(S.id));return console.log("[CacheStats] Secondary modules count:",v.length),v}),i=_(()=>o.value?.length||0),l=_(()=>t.value?.length||0),a=_(()=>e.value?.length||0),r=_(()=>e.value.reduce((v,S)=>v+(S.file_count||0),0)),g=_(()=>(s.modules||[]).reduce((v,S)=>v+(S.total_size||0),0)),f=_(()=>Z.formatCacheSize(g.value)),m=_(()=>{const v=s.modules||[];if(v.length===0)return"0 –º–∏–Ω";const S=v.reduce((C,M)=>C+(M.ttl||0),0),D=Math.round(S/v.length);return Z.formatTTL(D)}),h=_(()=>(e.value||[]).filter(v=>v.status==="active").length),b=_(()=>{if((l.value||0)===0)return[];const v={};(t.value||[]).forEach(D=>{const C=Z.getModuleType(D.id);if(!v[C]){const M=Z.getModuleTypeConfig(C);v[C]={type:C,title:M.title||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –≥—Ä—É–ø–ø–∞",icon:p(C),count:0}}v[C].count++});const S=l.value||0;return Object.values(v).map(D=>({...D,percentage:S>0?Math.round(D.count/S*100):0})).sort((D,C)=>C.count-D.count)}),p=v=>{const S={users:"üë•",activity:"üìä",webhooks:"üîó",other:"üîß"};return S[v]||S.other};return{modules:e,primaryModulesCount:i,secondaryModulesCount:l,totalModules:a,totalFiles:r,totalSizeFormatted:f,avgTTL:m,activeModules:h,groupStats:b}}},Vy={key:0,class:"cache-stats"},jy={class:"stats-overview"},zy={class:"overview-grid"},Hy={class:"overview-card primary"},Wy={class:"overview-content"},$y={class:"overview-value"},qy={class:"overview-card secondary"},Ky={class:"overview-content"},Xy={class:"overview-value"},Gy={class:"overview-card total"},Jy={class:"overview-content"},Yy={class:"overview-value"},Zy={class:"detailed-stats"},Qy={class:"stats-grid"},e1={class:"stat-card"},t1={class:"stat-content"},o1={class:"stat-value"},s1={class:"stat-card"},n1={class:"stat-content"},a1={class:"stat-value"},i1={class:"stat-card"},r1={class:"stat-content"},l1={class:"stat-value"},c1={class:"stat-card"},d1={class:"stat-content"},u1={class:"stat-value"},g1={key:0,class:"group-distribution"},m1={class:"distribution-grid"},f1={class:"group-icon"},h1={class:"group-info"},v1={class:"group-name"},y1={class:"group-count"},p1={class:"group-percentage"},_1={key:1,class:"cache-stats-loading"};function b1(s,e,o,t,i,l){return(t.modules||[]).length>0?(c(),d("div",Vy,[e[18]||(e[18]=n("h2",{class:"stats-title"},"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º",-1)),n("div",jy,[n("div",zy,[n("div",Hy,[e[2]||(e[2]=n("div",{class:"overview-icon"},"üèÜ",-1)),n("div",Wy,[n("div",$y,u(t.primaryModulesCount),1),e[0]||(e[0]=n("div",{class:"overview-label"},"–û—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π",-1)),e[1]||(e[1]=n("div",{class:"overview-desc"},"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ",-1))])]),n("div",qy,[e[5]||(e[5]=n("div",{class:"overview-icon"},"üîß",-1)),n("div",Ky,[n("div",Xy,u(t.secondaryModulesCount),1),e[3]||(e[3]=n("div",{class:"overview-label"},"–ü–æ–±–æ—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π",-1)),e[4]||(e[4]=n("div",{class:"overview-desc"},"–°–ª—É–∂–µ–±–Ω—ã–µ",-1))])]),n("div",Gy,[e[8]||(e[8]=n("div",{class:"overview-icon"},"üì¶",-1)),n("div",Jy,[n("div",Yy,u(t.totalModules),1),e[6]||(e[6]=n("div",{class:"overview-label"},"–í—Å–µ–≥–æ –º–æ–¥—É–ª–µ–π",-1)),e[7]||(e[7]=n("div",{class:"overview-desc"},"–ê–∫—Ç–∏–≤–Ω—ã—Ö",-1))])])])]),n("div",Zy,[n("div",Qy,[n("div",e1,[e[10]||(e[10]=n("div",{class:"stat-icon"},"üìÑ",-1)),n("div",t1,[n("div",o1,u(t.totalFiles),1),e[9]||(e[9]=n("div",{class:"stat-label"},"–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤",-1))])]),n("div",s1,[e[12]||(e[12]=n("div",{class:"stat-icon"},"üíæ",-1)),n("div",n1,[n("div",a1,u(t.totalSizeFormatted),1),e[11]||(e[11]=n("div",{class:"stat-label"},"–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä",-1))])]),n("div",i1,[e[14]||(e[14]=n("div",{class:"stat-icon"},"‚è±Ô∏è",-1)),n("div",r1,[n("div",l1,u(t.avgTTL),1),e[13]||(e[13]=n("div",{class:"stat-label"},"–°—Ä–µ–¥–Ω–∏–π TTL",-1))])]),n("div",c1,[e[16]||(e[16]=n("div",{class:"stat-icon"},"‚ö°",-1)),n("div",d1,[n("div",u1,u(t.activeModules),1),e[15]||(e[15]=n("div",{class:"stat-label"},"–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–µ—à–µ–π",-1))])])])]),t.secondaryModulesCount>0?(c(),d("div",g1,[e[17]||(e[17]=n("h3",{class:"distribution-title"},"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–æ—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π",-1)),n("div",m1,[(c(!0),d(U,null,F(t.groupStats,a=>(c(),d("div",{key:a.type,class:"distribution-item"},[n("div",f1,u(a.icon),1),n("div",h1,[n("div",v1,u(a.title),1),n("div",y1,u(a.count)+" –º–æ–¥—É–ª–µ–π",1)]),n("div",p1,u(a.percentage)+"%",1)]))),128))])])):y("",!0)])):(c(),d("div",_1,[...e[19]||(e[19]=[n("p",null,"üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...",-1)])]))}const k1=H(Fy,[["render",b1],["__scopeId","data-v-9fa190bb"]]),C1={name:"CacheManagement",components:{CacheModuleCard:Uy,CacheStats:k1},setup(){const s=w([]),e=w([]),o=w(!0),t=w(null),i=w(!1),l=_(()=>(s.value?.length||0)+(e.value?.length||0)),a=_(()=>{const C=r.value?.length||0,M=(g.value?.length||0)>0?1:0;return C+M}),r=_(()=>{const C=(s.value||[]).filter(M=>!M.id.includes("time-tracking"));return console.log("[CacheManagement] individualPrimaryModules:",C.length,C.map(M=>M.id)),C}),g=_(()=>{const C=(s.value||[]).filter(M=>M.id.includes("time-tracking")).sort((M,I)=>{const V=["time-tracking-default","time-tracking-detailed","time-tracking-summary"];return V.indexOf(M.id)-V.indexOf(I.id)});return console.log("[CacheManagement] timeTrackingModules:",C.length,C.map(M=>M.id)),C}),f=_(()=>{const C={};return(e.value||[]).forEach(I=>{const V=Z.getModuleType(I.id);C[V]||(C[V]={type:V,title:h(V),modules:[]}),C[V].modules.push(I)}),Object.values(C).sort((I,V)=>{const O=["users","activity","webhooks","other"],L=O.indexOf(I.type),k=O.indexOf(V.type);return(L===-1?999:L)-(k===-1?999:k)})}),m=async()=>{o.value=!0,t.value=null;try{const C=await Z.getCacheStatus();s.value=C.primaryModules||[],e.value=C.secondaryModules||[],console.log("[CacheManagement] Primary modules:",s.value.length,s.value.map(M=>({id:M.id,name:M.name}))),console.log("[CacheManagement] Secondary modules:",e.value.length,e.value.map(M=>({id:M.id,name:M.name})))}catch(C){console.error("[CacheManagement] Error loading modules:",C),t.value=C.message}finally{o.value=!1}},h=C=>{const M={users:"üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",activity:"üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",webhooks:"üîó –õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤",other:"üîß –ü—Ä–æ—á–∏–µ –º–æ–¥—É–ª–∏"};return M[C]||M.other},b=async C=>{console.log(`[CacheManagement] Clearing module: ${C}`),Z.invalidateCacheAfterModuleOperation(),await m()},p=async()=>{console.log("[CacheManagement] Clearing all cache"),i.value=!0;try{await Z.clearCache("all"),Z.invalidateCacheAfterModuleOperation(),ue.success("–ö–µ—à –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–µ–Ω","–í—Å–µ —Ñ–∞–π–ª—ã –∫–µ—à–∞ –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã"),await m()}catch(C){console.error("[CacheManagement] Error clearing all cache:",C),ue.error("–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–µ—à–∞",`–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–µ—à: ${C.message}`)}finally{i.value=!1}},v=async C=>{console.log(`[CacheManagement] Creating cache for: ${C.name} (${C.id})`),alert(`–°–æ–∑–¥–∞–Ω–∏–µ –∫–µ—à–∞ –¥–ª—è –º–æ–¥—É–ª—è: ${C.name}
ID: ${C.id}
–≠—Ç–æ mock —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.`)},S=async C=>{console.log(`[CacheManagement] Clearing cache for: ${C.name} (${C.id})`),alert(`–û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞ –¥–ª—è –º–æ–¥—É–ª—è: ${C.name}
ID: ${C.id}
–≠—Ç–æ mock —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.`)},D=()=>{m()};return ae(()=>{m()}),{primaryModules:s,secondaryModules:e,loading:o,error:t,totalModules:l,groupedSecondaryModules:f,individualPrimaryModules:r,timeTrackingModules:g,logicalPrimaryCount:a,clearingAll:i,handleModuleClear:b,handleClearAllCache:p,handleCreateMock:v,handleClearMock:S,refreshModules:D}}},S1={class:"cache-management"},w1={key:0,class:"header-section"},T1={class:"stats-bar"},E1={class:"stat-item"},x1={class:"stat-item"},A1={class:"stat-item"},D1={key:0,class:"global-actions"},I1=["disabled"],M1={key:0},L1={key:1},P1={class:"section-header"},N1={class:"section-meta"},O1={class:"module-count","aria-label":"{{ logicalPrimaryCount }} –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π"},B1={key:0,class:"modules-container"},R1={key:0,class:"modules-grid"},U1={key:1,class:"time-tracking-group"},F1={class:"modules-grid"},V1={key:1,class:"empty-state"},j1={key:2,class:"section-divider"},z1={key:3,class:"cache-section secondary-modules","aria-labelledby":"secondary-modules-heading"},H1={class:"section-header"},W1={class:"section-meta"},$1={class:"module-count","aria-label":"{{ (secondaryModules || []).length }} –≤—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π"},q1={class:"grouped-modules"},K1={class:"group-header"},X1={class:"group-title"},G1={class:"group-badge secondary"},J1={class:"modules-grid"},Y1={key:4,class:"error-message",role:"alert","aria-live":"assertive"},Z1={key:5,class:"loading-overlay",role:"status","aria-live":"polite","aria-label":"–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –∫–µ—à–∞"};function Q1(s,e,o,t,i,l){const a=W("CacheModuleCard");return c(),d("div",S1,[!t.loading&&!t.error?(c(),d("div",w1,[e[6]||(e[6]=n("h1",null,"üóëÔ∏è –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º",-1)),e[7]||(e[7]=n("p",{class:"description"}," –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º —Å–∏—Å—Ç–µ–º—ã —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è ",-1)),n("div",T1,[n("span",E1,[n("strong",null,u(t.totalModules),1),e[3]||(e[3]=X(" –≤—Å–µ–≥–æ –º–æ–¥—É–ª–µ–π ",-1))]),n("span",x1,[n("strong",null,u(t.logicalPrimaryCount),1),e[4]||(e[4]=X(" –æ—Å–Ω–æ–≤–Ω—ã—Ö ",-1))]),n("span",A1,[n("strong",null,u((t.secondaryModules||[]).length),1),e[5]||(e[5]=X(" –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö ",-1))])]),!t.loading&&!t.error?(c(),d("div",D1,[n("button",{onClick:e[0]||(e[0]=(...r)=>t.handleClearAllCache&&t.handleClearAllCache(...r)),disabled:t.clearingAll,class:N(["btn-clear-all",{"btn-disabled":t.clearingAll}])},[t.clearingAll?(c(),d("span",M1,"üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ–≥–æ –∫–µ—à–∞...")):(c(),d("span",L1,"üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–µ—à"))],10,I1)])):y("",!0)])):y("",!0),!t.loading&&!t.error?(c(),d("section",{key:1,class:N(["cache-section primary-modules",{empty:(t.primaryModules||[]).length===0}]),"aria-labelledby":"primary-modules-heading"},[n("div",P1,[e[9]||(e[9]=n("h2",{id:"primary-modules-heading"},"üèÜ –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–µ—à–∞",-1)),n("div",N1,[n("span",O1,u(t.logicalPrimaryCount),1),e[8]||(e[8]=n("span",{class:"section-badge primary",role:"status","aria-label":"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏"},"–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç",-1))])]),e[13]||(e[13]=n("p",{class:"section-description"}," 5 –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã: –¥–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–°, –≥—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–∏–µ–º–∞-–∑–∞–∫—Ä—ã—Ç–∏—è –∏ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ 1–°. ",-1)),(t.primaryModules||[]).length>0?(c(),d("div",B1,[t.individualPrimaryModules.length>0?(c(),d("div",R1,[(c(!0),d(U,null,F(t.individualPrimaryModules,r=>(c(),d("div",{key:r.id,class:"module-wrapper"},[K(a,{module:r,"is-primary":!0,priority:r.priority,onClear:t.handleModuleClear,onRefresh:t.refreshModules},null,8,["module","priority","onClear","onRefresh"])]))),128))])):y("",!0),(t.timeTrackingModules||[]).length>0?(c(),d("div",U1,[e[10]||(e[10]=n("div",{class:"group-header"},[n("h3",{class:"group-title"},"‚è±Ô∏è –¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ 1–°"),n("span",{class:"group-badge"},"–û—Å–Ω–æ–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞")],-1)),e[11]||(e[11]=n("p",{class:"group-description"},"–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–∞—á–∞–º–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è",-1)),n("div",F1,[(c(!0),d(U,null,F(t.timeTrackingModules,r=>(c(),d("div",{key:r.id,class:"module-wrapper"},[K(a,{module:r,"is-primary":!0,priority:r.priority,onClear:t.handleModuleClear,onRefresh:t.refreshModules},null,8,["module","priority","onClear","onRefresh"])]))),128))])])):y("",!0)])):(c(),d("div",V1,[e[12]||(e[12]=n("p",null,"‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–µ—à–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",-1)),n("button",{onClick:e[1]||(e[1]=(...r)=>t.refreshModules&&t.refreshModules(...r)),class:"refresh-btn"},"–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫")]))],2)):y("",!0),!t.loading&&!t.error&&(t.secondaryModules||[]).length>0?(c(),d("div",j1,[...e[14]||(e[14]=[qe('<div class="divider-line" data-v-6a4e8216></div><div class="divider-content" data-v-6a4e8216><span class="divider-icon" data-v-6a4e8216>üîß</span><span class="divider-text" data-v-6a4e8216>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏</span><span class="divider-subtitle" data-v-6a4e8216>–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã</span></div><div class="divider-line" data-v-6a4e8216></div>',3)])])):y("",!0),!t.loading&&!t.error&&(t.secondaryModules||[]).length>0?(c(),d("section",z1,[n("div",H1,[e[16]||(e[16]=n("h2",{id:"secondary-modules-heading"},"üîß –ü–æ–±–æ—á–Ω—ã–µ –º–æ–¥—É–ª–∏ –∫–µ—à–∞",-1)),n("div",W1,[n("span",$1,u((t.secondaryModules||[]).length),1),e[15]||(e[15]=n("span",{class:"section-badge secondary",role:"status","aria-label":"–°–ª—É–∂–µ–±–Ω—ã–µ –º–æ–¥—É–ª–∏"},"–°–ª—É–∂–µ–±–Ω—ã–µ",-1))])]),e[17]||(e[17]=n("p",{class:"section-description"}," –ú–æ–¥—É–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã. ",-1)),n("div",q1,[(c(!0),d(U,null,F(t.groupedSecondaryModules,r=>(c(),d("div",{key:r.type,class:N(["module-group",`group-${r.type}`])},[n("div",K1,[n("h3",X1,u(r.title),1),n("span",G1,u(r.modules.length),1)]),n("div",J1,[(c(!0),d(U,null,F(r.modules,g=>(c(),d("div",{key:g.id,class:"module-wrapper"},[K(a,{module:g,"is-primary":!1,"group-type":r.type,onClear:t.handleModuleClear,onRefresh:t.refreshModules},null,8,["module","group-type","onClear","onRefresh"])]))),128))])],2))),128))])])):y("",!0),t.error?(c(),d("div",Y1,[e[18]||(e[18]=n("h3",null,"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π –∫–µ—à–∞",-1)),n("p",null,u(t.error),1),n("button",{onClick:e[2]||(e[2]=(...r)=>s.loadModules&&s.loadModules(...r)),class:"retry-btn","aria-label":"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –º–æ–¥—É–ª–µ–π –∫–µ—à–∞"},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É")])):y("",!0),t.loading?(c(),d("div",Z1,[...e[19]||(e[19]=[n("div",{class:"loading-spinner","aria-hidden":"true"},null,-1),n("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –∫–µ—à–∞...",-1)])])):y("",!0)])}const e0=H(C1,[["render",Q1],["__scopeId","data-v-6a4e8216"]]),t0={name:"CacheManagementPage",components:{CacheManagement:e0},beforeCreate(){console.log("[CacheManagementPage] beforeCreate() called")},created(){console.log("[CacheManagementPage] created() called")},beforeMount(){console.log("[CacheManagementPage] beforeMount() called")},setup(){console.log("[CacheManagementPage] setup() called with new hierarchical UI");const s=Ie(),e=w(!1),o=w(null),t=()=>{s.push({name:"index"})};return ae(()=>{console.log("[CacheManagementPage] onMounted() called - hierarchical cache management ready")}),{loading:e,error:o,goBack:t}}},o0={class:"cache-management-page"},s0={class:"page-header"},n0={class:"page-header-top"},a0={key:0,class:"loading"},i0={key:1,class:"error"},r0={key:2,class:"cache-content"};function l0(s,e,o,t,i,l){const a=W("CacheManagement");return c(),d("div",o0,[n("div",s0,[n("div",n0,[n("button",{onClick:e[0]||(e[0]=(...r)=>t.goBack&&t.goBack(...r)),class:"back-button",title:"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É","aria-label":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"},[...e[1]||(e[1]=[n("span",{class:"back-icon","aria-hidden":"true"},"‚Üê",-1),n("span",{class:"back-text"},"–ù–∞–∑–∞–¥",-1)])])]),e[2]||(e[2]=n("h1",null,"üóëÔ∏è –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º",-1))]),t.loading?(c(),d("div",a0," –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–µ—à–∞... ")):t.error?(c(),d("div",i0,u(t.error),1)):(c(),d("div",r0,[K(a)]))])}const c0=H(t0,[["render",l0],["__scopeId","data-v-a20ded38"]]),d0=[{path:"/install",name:"install",component:ps},{path:"/",name:"index",component:ml},{path:"/webhook-logs",name:"webhook-logs",redirect:"/admin/webhook-logs"},{path:"/admin/webhook-logs",name:"admin-webhook-logs",component:vu,meta:{requiresAuth:!0,title:"–õ–æ–≥–∏ –≤–µ–±—Ö—É–∫–æ–≤",adminOnly:!0}},{path:"/admin/users",name:"admin-users",component:av,meta:{requiresAuth:!0,title:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏",adminOnly:!0}},{path:"/admin/cache",name:"admin-cache",component:c0,meta:{requiresAuth:!0,title:"–†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–µ—à–µ–º",adminOnly:!0}},{path:"/dashboard/sector-1c",name:"dashboard-sector-1c",component:()=>me(()=>Promise.resolve().then(()=>wo),void 0,import.meta.url),meta:{requiresAuth:!0,chunk:"dashboard-sector1c"}},{path:"/dashboard/graph-admission-closure",name:"dashboard-graph-admission-closure",component:()=>me(()=>import("./GraphAdmissionClosureDashboard.vue-De-suGw8.js"),__vite__mapDeps([10,4,11,7,5,2,1,6,12]),import.meta.url),meta:{title:"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",description:"–ù–µ–¥–µ–ª—å–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã –Ω–æ–≤—ã—Ö –∏ –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–°",requiresAuth:!0,chunk:"admission-dashboard"}},{path:"/dashboard/graph-state",name:"dashboard-graph-state",component:()=>me(()=>import("./GraphStateDashboard.vue-BodYmV8T.js"),__vite__mapDeps([13,4,1,6,7,5,2,11]),import.meta.url),meta:{title:"–ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞ 1–°",description:"–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ–∫—Ç–æ—Ä–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏",requiresAuth:!0,chunk:"graph-state"}},{path:"/dashboard/tickets-time-tracking",name:"dashboard-tickets-time-tracking",component:()=>me(()=>import("./TicketsTimeTrackingDashboard.vue-3rTVow0u.js"),__vite__mapDeps([14,4,1,5,2,6,7]),import.meta.url),meta:{title:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –¢–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ 1–°",description:"–¢—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å–µ–∫—Ç–æ—Ä–∞ 1–° –ø–æ –Ω–µ–¥–µ–ª—è–º",requiresAuth:!0,chunk:"tickets-tracking"}}],vt=jo({history:zo(),routes:d0});vt.beforeEach(async(s,e,o)=>{if(console.log("[Router] beforeEach:",{to:s.path,from:e.path,name:s.name}),s.meta.title&&(document.title=`${s.meta.title} - Bitrix24 Dashboard`),s.meta.requiresAuth){console.log("[Router] requiresAuth check for:",s.path);try{const t=await Ne.checkAccess();if(!t.allowed){console.warn("Unauthorized access attempt to:",s.path,t.errorMessage),o({name:"index"});return}}catch(t){console.error("Error checking access in navigation guard:",t),o();return}}if(s.meta.adminOnly)try{const t=await Ne.getCurrentUser();if(!t||!bt(t)){console.warn("Admin access required for:",s.path),o({name:"index"});return}}catch(t){console.error("Error checking admin access in navigation guard:",t),o({name:"index"});return}if(e.name!==null&&s.path!==e.path)try{if((await Ne.checkAccess()).allowed){const i=await Ne.getCurrentUser();i&&ut.logPageVisit(s,i,e).catch(l=>{console.error("[Router] Error logging page visit:",l)})}}catch(t){console.error("[Router] Error in activity logging:",t)}if(s.name==="index"&&!e.name&&setTimeout(()=>{me(()=>Promise.resolve().then(()=>wo),void 0,import.meta.url)},1e3),s.meta.chunk)switch(s.meta.chunk){case"dashboard-sector1c":setTimeout(()=>{me(()=>import("./dashboard-sector-1c-service-2_NTb9rQ.js"),__vite__mapDeps([12,7,5,2,1,6]),import.meta.url)},500);break;case"admission-dashboard":setTimeout(()=>{me(()=>import("./chunk-CPzRTNN7.js").then(t=>t.l),__vite__mapDeps([2,1]),import.meta.url)},500);break}console.log("[Router] Allowing navigation to:",s.path),o()});setTimeout(()=>{const s=window.location.pathname,e=window.location.hash;e&&e!=="#/"||(s.includes("install.php")?vt.replace("/install"):vt.replace("/"))},0);class gt{static startBundleLoad(){this.metrics.bundleLoadTime=performance.now()}static endBundleLoad(e){const o=performance.now()-this.metrics.bundleLoadTime;this.metrics.chunkLoadTimes.set(e,o),console.log(`üì¶ Chunk "${e}" loaded in ${o.toFixed(2)}ms`),window.gtag&&window.gtag("event","bundle_load",{chunk_name:e,load_time:o}),o>1e3&&console.warn(`üêå Slow chunk load: ${e} took ${o.toFixed(2)}ms`)}static trackComponentLoad(e,o){const t=performance.now()-o;this.metrics.componentLoadTime.set(e,t),console.log(`üß© Component "${e}" loaded in ${t.toFixed(2)}ms`),t>500&&console.warn(`üêå Slow component load: ${e} took ${t.toFixed(2)}ms`)}static trackApiCall(e,o){this.metrics.apiResponseTime.set(e,o),o>1e3&&console.warn(`üêå Slow API call to ${e}: ${o}ms`)}static getReport(){const e=Array.from(this.metrics.componentLoadTime.values()),o=Array.from(this.metrics.apiResponseTime.values()),t=Array.from(this.metrics.chunkLoadTimes.values());return{totalChunks:this.metrics.chunkLoadTimes.size,totalComponents:this.metrics.componentLoadTime.size,totalApiCalls:this.metrics.apiResponseTime.size,averageComponentLoadTime:e.length>0?e.reduce((i,l)=>i+l,0)/e.length:0,averageApiResponseTime:o.length>0?o.reduce((i,l)=>i+l,0)/o.length:0,averageChunkLoadTime:t.length>0?t.reduce((i,l)=>i+l,0)/t.length:0,slowestComponents:Array.from(this.metrics.componentLoadTime.entries()).sort(([,i],[,l])=>l-i).slice(0,5).map(([i,l])=>({name:i,time:l})),slowestApiCalls:Array.from(this.metrics.apiResponseTime.entries()).sort(([,i],[,l])=>l-i).slice(0,5).map(([i,l])=>({endpoint:i,time:l})),slowestChunks:Array.from(this.metrics.chunkLoadTimes.entries()).sort(([,i],[,l])=>l-i).slice(0,5).map(([i,l])=>({name:i,time:l}))}}static clearMetrics(){this.metrics.bundleLoadTime=0,this.metrics.componentLoadTime.clear(),this.metrics.apiResponseTime.clear(),this.metrics.chunkLoadTimes.clear()}}fe(gt,"metrics",{bundleLoadTime:0,componentLoadTime:new Map,apiResponseTime:new Map,chunkLoadTimes:new Map});class u0{static init(){this.initChunkLoadErrorHandling(),this.initUnhandledErrorHandling(),this.initNetworkErrorHandling()}static initChunkLoadErrorHandling(){if(window.addEventListener("error",e=>{e.target.tagName==="SCRIPT"&&(console.error("‚ùå Chunk loading error:",e.target.src),this.reportError("chunk_load_error",{url:e.target.src,message:e.message||"Script load failed"}))}),"PerformanceObserver"in window)try{new PerformanceObserver(o=>{for(const t of o.getEntries())if(t.entryType==="resource"&&t.name.includes(".js")){const i=t.responseEnd-t.requestStart;gt.trackApiCall(t.name,i)}}).observe({entryTypes:["resource"]})}catch{console.warn("PerformanceObserver not supported")}}static initUnhandledErrorHandling(){window.addEventListener("unhandledrejection",e=>{console.error("‚ùå Unhandled promise rejection:",e.reason),this.reportError("unhandled_rejection",{reason:e.reason?.message||String(e.reason),stack:e.reason?.stack})}),window.addEventListener("error",e=>{e.error&&e.filename&&(console.error("‚ùå Unhandled error:",e.error),this.reportError("unhandled_error",{message:e.error.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:e.error.stack}))})}static initNetworkErrorHandling(){const e=window.fetch;window.fetch=function(...o){const t=performance.now();return e.apply(this,o).then(i=>{const l=performance.now()-t;return gt.trackApiCall(o[0],l),i.ok||console.warn(`üö® API error: ${i.status} ${i.statusText} for ${o[0]}`),i}).catch(i=>{const l=performance.now()-t;throw console.error(`‚ùå Network error for ${o[0]}:`,i),gt.trackApiCall(o[0],l),this.reportError("network_error",{url:o[0],message:i.message,loadTime:l}),i})}}static reportError(e,o){const t={type:e,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,...o};if(console.error("üìä Error report:",t),window.Sentry&&window.Sentry.captureException(new Error(`${e}: ${JSON.stringify(o)}`)),typeof BX<"u"&&BX.ajax)try{BX.ajax({url:"/api/log-error.php",method:"POST",data:t})}catch(i){console.error("Failed to send error report to Bitrix24:",i)}window.gtag&&window.gtag("event","exception",{description:`${e}: ${o.message||"Unknown error"}`,fatal:!1})}static getErrorStats(){return{chunkLoadErrors:0,networkErrors:0,unhandledErrors:0,totalErrors:0}}}const zt=Ho(ss);zt.use(vt);const g0=s=>{try{const e=new WeakSet;return JSON.stringify(s,(o,t)=>{if(typeof t=="object"&&t!==null){if(e.has(t))return"[Circular]";e.add(t)}return typeof t=="function"||t===void 0?null:t})}catch{return String(s)}};zt.config.errorHandler=(s,e,o)=>{if(s instanceof TypeError&&s.message.includes("Cannot read properties of undefined (reading 'type')")){console.warn("Caught undefined.type error:",{error:s.message,component:e?.$options?.name||"Unknown",info:o,stack:s.stack});return}if(console.error("Vue error:",s,o),typeof BX<"u"&&BX.ajax)try{BX.ajax({url:Ee("/api/log-error.php"),method:"POST",data:{error:s?.message||String(s),info:typeof o=="string"?o:g0(o),component:e?.$options?.name||"Unknown"}})}catch(t){console.error("Failed to log error:",t)}};zt.mount("#app");u0.init();export{Ne as A,At as D,ft as K,go as L,uo as S,mo as T,H as _,ze as a,Oe as b,C0 as c,De as d,hl as e,Ze as f,Vt as g,k0 as h,bt as i,Ye as n,_t as u};
