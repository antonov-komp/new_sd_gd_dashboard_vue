const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ticketListUtils-Di3XI8Sv.js","./priority-config-2rHD6LRf.js","./main-B1VBivpg.js","./main-DFwah1ox.css","./priority-config-Bxxce_5E.css","./ticket-mapper-BLFj9gdD.js"])))=>i.map(i=>d[i]);
var It=Object.defineProperty;var Mt=(r,t,e)=>t in r?It(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Fe=(r,t,e)=>Mt(r,typeof t!="symbol"?t+"":t,e);import{_ as he,g as V,G as ye,m as ze,H as ft,f as ie,o as y,j as J,k as ee,a as g,d as Z,b as s,y as le,n as te,B as ne,I as Bt,c as Y,J as H,K as pt,t as w,F as K,e as Q,L as Pe,M as Ot,N as Me,O as ae,P as xt,Q as gt,R as Ne,S as Rt,U as Pt,V as Lt,W as Gt,X as Ft,Y as Vt,Z as Ht,$ as Yt,x as zt,l as _e,a0 as jt,z as bt,r as wt,a1 as Tt,a2 as We,T as Le,a3 as Se,a4 as kt}from"./main-B1VBivpg.js";import{F as Ct}from"./FiltersPanel-DbJ-1pTb.js";import{L as De,D as qt,B as Zt}from"./index-BQH8tOH1.js";import{g as ht,a as Xt,b as mt,D as Jt,T as Ge,c as je}from"./priority-config-2rHD6LRf.js";const Kt={key:0,class:"modal-overlay"},Qt={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},es={class:"modal-body"},ts={class:"mode-description"},ss={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:r=>["weeks","months"].includes(r)}},emits:["close","start-loading","select-mode"],setup(r,{emit:t}){const e=r,a=t,n=V(e.currentMode);function l(m){if(!["weeks","months"].includes(m)){console.warn("[PeriodModeInfoModal] Invalid mode:",m);return}n.value=m,console.log("[DEBUG Modal] handleModeSelect: mode =",m),console.log("[DEBUG Modal] Emitting select-mode event"),a("select-mode",m),console.log("[DEBUG Modal] Emitting close event"),a("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),a("start-loading")},100)}function c(){console.log("[DEBUG Modal] handleClose called, selectedMode =",n.value),console.log("[DEBUG Modal] Emitting select-mode event with",n.value),a("select-mode",n.value),console.log("[DEBUG Modal] Emitting close event"),a("close")}function v(m){m.key==="Escape"&&e.isVisible&&c()}return ye(()=>e.currentMode,m=>{["weeks","months"].includes(m)&&(n.value=m)}),ze(()=>{e.isVisible&&document.addEventListener("keydown",v)}),ft(()=>{document.removeEventListener("keydown",v)}),ye(()=>e.isVisible,m=>{m?(document.addEventListener("keydown",v),n.value=e.currentMode):document.removeEventListener("keydown",v)}),(m,f)=>(y(),ie(Bt,{to:"body"},[J(ne,{name:"modal-fade"},{default:ee(()=>[r.isVisible?(y(),g("div",Kt,[s("div",Qt,[s("div",{class:"modal-header"},[f[2]||(f[2]=s("h2",{id:"modal-title",class:"modal-title"},[s("span",{class:"modal-icon"},"‚ÑπÔ∏è"),le(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),s("button",{class:"modal-close-btn",onClick:c,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),s("div",es,[f[5]||(f[5]=s("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),s("div",ts,[s("button",{class:te(["mode-item mode-item--clickable",{"mode-item--selected":n.value==="weeks"}]),onClick:f[0]||(f[0]=A=>l("weeks")),type:"button"},[...f[3]||(f[3]=[s("div",{class:"mode-header"},[s("span",{class:"mode-icon"},"üìÖ"),s("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),s("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),s("button",{class:te(["mode-item mode-item--clickable",{"mode-item--selected":n.value==="months"}]),onClick:f[1]||(f[1]=A=>l("months")),type:"button"},[...f[4]||(f[4]=[s("div",{class:"mode-header"},[s("span",{class:"mode-icon"},"üìä"),s("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),s("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):Z("",!0)]),_:1})]))}},as=he(ss,[["__scopeId","data-v-4a42a9a6"]]),rs={class:"ac-chart"},os={class:"ac-chart__header"},ns={class:"ac-chart__subtitle"},ls={class:"ac-chart__controls"},is={class:"chart-type-selector"},cs=["onClick"],ds={class:"chart-type-icon"},us={class:"chart-type-label"},vs={class:"ac-chart__summary"},ks={class:"summary-week-block summary-week-block--current"},hs={class:"summary-week-block__title"},ms={class:"summary-week-block__title-week"},ys={key:0,class:"summary-week-block__title-dates"},_s={class:"summary-week-block__cards"},fs={class:"summary-card__value-wrapper"},ps={class:"summary-card__value"},gs=["title"],bs={class:"percentage-indicator__arrow"},ws={class:"percentage-indicator__value"},Ts={class:"percentage-indicator__label"},Cs={class:"summary-card__value-wrapper"},$s={class:"summary-card__value-main"},Ws=["title"],Ds={class:"percentage-indicator__arrow"},Es={class:"percentage-indicator__value"},As={class:"percentage-indicator__label"},Ns={class:"summary-card__breakdown"},Ss={class:"breakdown-item breakdown-item--this-week"},Us={class:"breakdown-item__value"},Is={class:"breakdown-item breakdown-item--other-week"},Ms={class:"breakdown-item__value"},Bs={class:"summary-card__value-wrapper"},Os={class:"summary-card__value-main"},xs=["title"],Rs={class:"percentage-indicator__arrow"},Ps={class:"percentage-indicator__value"},Ls={class:"percentage-indicator__label"},Gs={class:"summary-card__breakdown"},Fs={class:"breakdown-item breakdown-item--this-week"},Vs={class:"breakdown-item__value"},Hs={class:"breakdown-item breakdown-item--other-week"},Ys={class:"breakdown-item__value"},zs={class:"summary-card summary-card--stages"},js={class:"summary-card__tags"},qs={key:0,class:"stage-tag stage-tag--empty"},Zs={key:0,class:"summary-week-divider"},Xs={key:1,class:"summary-week-block summary-week-block--previous"},Js={class:"summary-week-block__title"},Ks={class:"summary-week-block__title-week"},Qs={key:0,class:"summary-week-block__title-dates"},ea={class:"summary-week-block__cards"},ta={class:"summary-card__value-wrapper"},sa={class:"summary-card__values-comparison"},aa={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ra={class:"summary-card__value"},oa={class:"value-label"},na={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},la={class:"summary-card__value summary-card__value--current-week"},ia={class:"value-label"},ca=["title"],da={class:"percentage-indicator__arrow"},ua={class:"percentage-indicator__value"},va={class:"percentage-indicator__label"},ka={class:"summary-card__value-wrapper"},ha={class:"summary-card__values-comparison"},ma={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},ya={class:"summary-card__value-main"},_a={class:"value-label"},fa={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},pa={class:"summary-card__value-main summary-card__value-main--current-week"},ga={class:"value-label"},ba=["title"],wa={class:"percentage-indicator__arrow"},Ta={class:"percentage-indicator__value"},Ca={class:"percentage-indicator__label"},$a={class:"summary-card__breakdown"},Wa={class:"breakdown-item breakdown-item--this-week"},Da={class:"breakdown-item__value"},Ea={class:"breakdown-item breakdown-item--other-week"},Aa={class:"breakdown-item__value"},Na={class:"summary-card__value-wrapper"},Sa={class:"summary-card__values-comparison"},Ua={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Ia={class:"summary-card__value-main"},Ma={class:"value-label"},Ba={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Oa={class:"summary-card__value-main summary-card__value-main--current-week"},xa={class:"value-label"},Ra=["title"],Pa={class:"percentage-indicator__arrow"},La={class:"percentage-indicator__value"},Ga={class:"percentage-indicator__label"},Fa={class:"summary-card__breakdown"},Va={class:"breakdown-item breakdown-item--this-week"},Ha={class:"breakdown-item__value"},Ya={class:"breakdown-item breakdown-item--other-week"},za={class:"breakdown-item__value"},ja={class:"summary-card summary-card--stages summary-card--previous"},qa={class:"summary-card__tags"},Za={key:0,class:"stage-tag stage-tag--empty"},Xa={class:"ac-chart__body"},Ja={key:0,class:"split-charts-container"},Ka={class:"chart-wrapper chart-wrapper--left"},Qa={class:"chart-canvas-wrapper"},er={class:"chart-wrapper chart-wrapper--right"},tr={class:"chart-canvas-wrapper"},sr={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(r,{emit:t}){const e=r,a=t,n=Y(()=>{var o;const i=((o=e.meta)==null?void 0:o.weeks)||[];return i.length>=2?i[i.length-2]:null}),l=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],c=V("line");Y(()=>{var i;return((i=e.meta)==null?void 0:i.weekNumber)??"‚Äî"});const v=()=>{var o,p;const i=((o=e.meta)==null?void 0:o.weeks)||[];return i.length>0?i.map(T=>`–ù–µ–¥–µ–ª—è ${T.weekNumber}`):[(p=e.meta)!=null&&p.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function m(i,o,p,T=.3,_=0){if(!o)return((F,C)=>{const L=parseInt(F.slice(1,3),16),B=parseInt(F.slice(3,5),16),j=parseInt(F.slice(5,7),16);return`rgba(${L}, ${B}, ${j}, ${C})`})(p,T);const k=(O,F)=>{const C=parseInt(O.slice(1,3),16),L=parseInt(O.slice(3,5),16),B=parseInt(O.slice(5,7),16);return`rgba(${C}, ${L}, ${B}, ${F})`},d=i.createLinearGradient(0,o.bottom,0,o.top);return d.addColorStop(0,k(p,T)),d.addColorStop(1,k(p,_)),d}const f=Y(()=>{var k,d,O,F;const i=v(),o=Array.isArray((k=e.data.series)==null?void 0:k.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],p=Array.isArray((d=e.data.series)==null?void 0:d.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],T=Array.isArray((O=e.data.series)==null?void 0:O.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],_=Array.isArray((F=e.data.series)==null?void 0:F.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:i,datasets:[{label:"–ù–æ–≤—ã–µ",data:o,backgroundColor:C=>{const L=C.chart,{ctx:B,chartArea:j}=L;return m(B,j,H.primary)},borderColor:H.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.primary},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:p,backgroundColor:C=>{const L=C.chart,{ctx:B,chartArea:j}=L;return m(B,j,H.success)},borderColor:H.success,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.success},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:T,backgroundColor:H.successLight,borderColor:H.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.successLight},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:_,backgroundColor:H.warning,borderColor:H.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.warning}]}}),A=Y(()=>{var _,k,d;const i=v(),o=Array.isArray((_=e.data.series)==null?void 0:_.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],p=Array.isArray((k=e.data.series)==null?void 0:k.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],T=Array.isArray((d=e.data.series)==null?void 0:d.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:[e.data.carryoverTicketsCreatedOtherWeek??0];return{labels:i,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:o,backgroundColor:O=>{const F=O.chart,{ctx:C,chartArea:L}=F;return m(C,L,H.carryover)},borderColor:H.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryover},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:p,backgroundColor:H.carryoverLight,borderColor:H.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryoverLight},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:T,backgroundColor:H.carryoverDark,borderColor:H.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryoverDark}]}}),x=Y(()=>{var C,L,B,j,re,ce,de,ue,ve;const i=((C=e.meta)==null?void 0:C.weeks)||[],o=i.length>0?i.map(ke=>`–ù–µ–¥–µ–ª—è ${ke.weekNumber}`):[(L=e.meta)!=null&&L.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],p=Array.isArray((B=e.data.series)==null?void 0:B.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],T=Array.isArray((j=e.data.series)==null?void 0:j.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],_=Array.isArray((re=e.data.series)==null?void 0:re.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],k=Array.isArray((ce=e.data.series)==null?void 0:ce.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],d=Array.isArray((de=e.data.series)==null?void 0:de.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],O=Array.isArray((ue=e.data.series)==null?void 0:ue.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],F=Array.isArray((ve=e.data.series)==null?void 0:ve.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:[e.data.carryoverTicketsCreatedOtherWeek??0];return{labels:o,datasets:[{label:"–ù–æ–≤—ã–µ",data:p,backgroundColor:H.primary,borderColor:H.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:T,backgroundColor:H.success,borderColor:H.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:_,backgroundColor:H.successLight,borderColor:H.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:k,backgroundColor:H.warning,borderColor:H.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:d,backgroundColor:H.carryover,borderColor:H.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:O,backgroundColor:H.carryoverLight,borderColor:H.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:F,backgroundColor:H.carryoverDark,borderColor:H.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),z=Y(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[H.primary,H.success,H.carryover],borderWidth:1}]})),q=Y(()=>{switch(c.value){case"line":return De;case"bar":return Zt;case"doughnut":return qt;default:return De}}),S=Y(()=>c.value==="doughnut"?z.value:x.value),W=i=>{if(!i)return"‚Äî";try{return new Date(i).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return i}};function b(i){return i==null||isNaN(i)?"0":i>=1e3?i.toLocaleString("ru-RU"):i.toString()}function u(i){const o=i%10,p=i%100;return p>=11&&p<=14?"—Ç–∏–∫–µ—Ç–æ–≤":o===1?"—Ç–∏–∫–µ—Ç":o>=2&&o<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const h=Y(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:i=>{var d,O,F,C,L,B;if(!i||i.length===0)return"";const o=(d=i[0])==null?void 0:d.dataIndex,p=((O=e.meta)==null?void 0:O.weeks)||[];if(p.length>0&&o!==void 0&&p[o]){const j=p[o];return`–ù–µ–¥–µ–ª—è ${j.weekNumber} (${W(j.weekStartUtc)} ‚Äî ${W(j.weekEndUtc)})`}const T=(F=e.meta)==null?void 0:F.weekNumber,_=(C=e.meta)==null?void 0:C.weekStartUtc,k=(L=e.meta)==null?void 0:L.weekEndUtc;return T&&_&&k?`–ù–µ–¥–µ–ª—è ${T} (${W(_)} ‚Äî ${W(k)})`:((B=i[0])==null?void 0:B.label)||""},label:i=>{const o=i.parsed.y,p=i.dataset.label||"";if(o==null||isNaN(o))return`${p}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const T=b(o),_=u(o);return`${p}: ${T} ${_}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:i=>pt.defaults.plugins.legend.labels.generateLabels(i).map((p,T)=>{const _=i.data.datasets[T],k=i.getDatasetMeta(T),d=_.borderDash&&Array.isArray(_.borderDash)&&_.borderDash.length>0||_.borderWidth===2||_.fill===!1;return k.hidden?(p.fontColor="#9ca3af",p.textDecoration="line-through",p.opacity=.5):d?p.fontColor="#6b7280":p.fontColor="#111827",p})},onClick:(i,o)=>{const p=o.datasetIndex;if(p==null){console.warn("[Legend] Invalid datasetIndex:",p);return}const T=i.chart;if(!T){console.warn("[Legend] Chart not found");return}const _=T.getDatasetMeta(p);if(!_){console.warn("[Legend] Dataset meta not found for index:",p);return}_.hidden=!_.hidden,T.update("active")},onHover:(i,o)=>{i.native&&i.native.target&&(i.native.target.style.cursor="pointer")},onLeave:(i,o)=>{i.native&&i.native.target&&(i.native.target.style.cursor="default")}}},scales:c.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:i=>i==null||isNaN(i)?"0":b(i)},title:{display:!1},grid:{color:i=>{if(!i||!i.tick||i.tick.value===void 0)return"#e5e7eb";const o=i.tick.value;return isNaN(o)||!isFinite(o)?"#e5e7eb":o===0||o%5===0?"#d1d5db":"#e5e7eb"},lineWidth:i=>{if(!i||!i.tick||i.tick.value===void 0)return 1;const o=i.tick.value;return isNaN(o)||!isFinite(o)?1:o===0||o%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),$=Y(()=>{var i,o,p,T;if((i=e.data)!=null&&i.series){const _=e.data.series,k=Math.max((Array.isArray(_.new)?_.new.length:0)-1,(Array.isArray(_.closed)?_.closed.length:0)-1,(Array.isArray(_.carryover)?_.carryover.length:0)-1,-1);if(k>=0){const d={newTickets:Array.isArray(_.new)&&_.new[k]!==void 0?_.new[k]:0,closedTickets:Array.isArray(_.closed)&&_.closed[k]!==void 0?_.closed[k]:0,closedTicketsCreatedThisWeek:Array.isArray(_.closedCreatedThisWeek)&&_.closedCreatedThisWeek[k]!==void 0?_.closedCreatedThisWeek[k]:0,closedTicketsCreatedOtherWeek:Array.isArray(_.closedCreatedOtherWeek)&&_.closedCreatedOtherWeek[k]!==void 0?_.closedCreatedOtherWeek[k]:0,carryoverTickets:Array.isArray(_.carryover)&&_.carryover[k]!==void 0?_.carryover[k]:0,carryoverTicketsCreatedThisWeek:Array.isArray(_.carryoverCreatedThisWeek)&&_.carryoverCreatedThisWeek[k]!==void 0?_.carryoverCreatedThisWeek[k]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(_.carryoverCreatedOtherWeek)&&_.carryoverCreatedOtherWeek[k]!==void 0?_.carryoverCreatedOtherWeek[k]:0};if(d.newTickets>0||d.closedTickets>0||d.carryoverTickets>0)return d}}if((o=e.data)!=null&&o.currentWeek&&typeof e.data.currentWeek=="object"){const _=e.data.currentWeek;if((_.newTickets??0)>0||(_.closedTickets??0)>0||(_.carryoverTickets??0)>0)return _}if((p=e.data)!=null&&p.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const _=e.data.weeksData[e.data.weeksData.length-1];if((_.newTickets??0)>0||(_.closedTickets??0)>0||(_.carryoverTickets??0)>0)return _}if((T=e.data)!=null&&T.series){const _=e.data.series,k=Math.max((Array.isArray(_.new)?_.new.length:0)-1,(Array.isArray(_.closed)?_.closed.length:0)-1,(Array.isArray(_.carryover)?_.carryover.length:0)-1,-1);if(k>=0)return{newTickets:Array.isArray(_.new)&&_.new[k]!==void 0?_.new[k]:0,closedTickets:Array.isArray(_.closed)&&_.closed[k]!==void 0?_.closed[k]:0,closedTicketsCreatedThisWeek:Array.isArray(_.closedCreatedThisWeek)&&_.closedCreatedThisWeek[k]!==void 0?_.closedCreatedThisWeek[k]:0,closedTicketsCreatedOtherWeek:Array.isArray(_.closedCreatedOtherWeek)&&_.closedCreatedOtherWeek[k]!==void 0?_.closedCreatedOtherWeek[k]:0,carryoverTickets:Array.isArray(_.carryover)&&_.carryover[k]!==void 0?_.carryover[k]:0,carryoverTicketsCreatedThisWeek:Array.isArray(_.carryoverCreatedThisWeek)&&_.carryoverCreatedThisWeek[k]!==void 0?_.carryoverCreatedThisWeek[k]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(_.carryoverCreatedOtherWeek)&&_.carryoverCreatedOtherWeek[k]!==void 0?_.carryoverCreatedOtherWeek[k]:0}}return e.data||{}}),E=Y(()=>{var o,p,T,_,k,d,O,F,C,L;const i=((o=e.meta)==null?void 0:o.weeks)||[];return i.length>0?i[i.length-1]:{weekNumber:((T=(p=e.meta)==null?void 0:p.currentWeek)==null?void 0:T.weekNumber)??((_=e.meta)==null?void 0:_.weekNumber)??null,weekStartUtc:((d=(k=e.meta)==null?void 0:k.currentWeek)==null?void 0:d.weekStartUtc)??((O=e.meta)==null?void 0:O.weekStartUtc)??null,weekEndUtc:((C=(F=e.meta)==null?void 0:F.currentWeek)==null?void 0:C.weekEndUtc)??((L=e.meta)==null?void 0:L.weekEndUtc)??null}}),D=Y(()=>{var i,o,p,T,_,k,d,O,F;if((i=e.data)!=null&&i.series){const C=e.data.series,L=Math.max((Array.isArray(C.new)?C.new.length:0)-1,(Array.isArray(C.closed)?C.closed.length:0)-1,(Array.isArray(C.closedCreatedThisWeek)?C.closedCreatedThisWeek.length:0)-1,(Array.isArray(C.closedCreatedOtherWeek)?C.closedCreatedOtherWeek.length:0)-1,(Array.isArray(C.carryover)?C.carryover.length:0)-1,(Array.isArray(C.carryoverCreatedThisWeek)?C.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(C.carryoverCreatedOtherWeek)?C.carryoverCreatedOtherWeek.length:0)-1,-1);if(L>=1){const B=L-1,j=(p=(o=e.meta)==null?void 0:o.weeks)==null?void 0:p[B],re={weekNumber:(j==null?void 0:j.weekNumber)??null,weekStartUtc:(j==null?void 0:j.weekStartUtc)??null,weekEndUtc:(j==null?void 0:j.weekEndUtc)??null,newTickets:Array.isArray(C.new)&&C.new[B]!==void 0?C.new[B]:0,closedTickets:Array.isArray(C.closed)&&C.closed[B]!==void 0?C.closed[B]:0,closedTicketsCreatedThisWeek:Array.isArray(C.closedCreatedThisWeek)&&C.closedCreatedThisWeek[B]!==void 0?C.closedCreatedThisWeek[B]:0,closedTicketsCreatedOtherWeek:Array.isArray(C.closedCreatedOtherWeek)&&C.closedCreatedOtherWeek[B]!==void 0?C.closedCreatedOtherWeek[B]:0,carryoverTickets:Array.isArray(C.carryover)&&C.carryover[B]!==void 0?C.carryover[B]:0,carryoverTicketsCreatedThisWeek:Array.isArray(C.carryoverCreatedThisWeek)&&C.carryoverCreatedThisWeek[B]!==void 0?C.carryoverCreatedThisWeek[B]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(C.carryoverCreatedOtherWeek)&&C.carryoverCreatedOtherWeek[B]!==void 0?C.carryoverCreatedOtherWeek[B]:0};if(re.newTickets>0||re.closedTickets>0||re.carryoverTickets>0)return re}}if((T=e.data)!=null&&T.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const C=e.data.weeksData.length-2,L=e.data.weeksData[C],B=(k=(_=e.meta)==null?void 0:_.weeks)==null?void 0:k[C];if((L.newTickets??0)>0||(L.closedTickets??0)>0||(L.carryoverTickets??0)>0)return{weekNumber:L.weekNumber??(B==null?void 0:B.weekNumber)??null,weekStartUtc:(B==null?void 0:B.weekStartUtc)??null,weekEndUtc:(B==null?void 0:B.weekEndUtc)??null,newTickets:L.newTickets??0,closedTickets:L.closedTickets??0,closedTicketsCreatedThisWeek:L.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:L.closedTicketsCreatedOtherWeek??0,carryoverTickets:L.carryoverTickets??0,carryoverTicketsCreatedThisWeek:L.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:L.carryoverTicketsCreatedOtherWeek??0}}if((d=e.data)!=null&&d.series){const C=e.data.series,L=Math.max((Array.isArray(C.new)?C.new.length:0)-1,(Array.isArray(C.closed)?C.closed.length:0)-1,(Array.isArray(C.carryover)?C.carryover.length:0)-1,-1);if(L>=1){const B=L-1,j=(F=(O=e.meta)==null?void 0:O.weeks)==null?void 0:F[B];return{weekNumber:(j==null?void 0:j.weekNumber)??null,weekStartUtc:(j==null?void 0:j.weekStartUtc)??null,weekEndUtc:(j==null?void 0:j.weekEndUtc)??null,newTickets:Array.isArray(C.new)&&C.new[B]!==void 0?C.new[B]:0,closedTickets:Array.isArray(C.closed)&&C.closed[B]!==void 0?C.closed[B]:0,closedTicketsCreatedThisWeek:Array.isArray(C.closedCreatedThisWeek)&&C.closedCreatedThisWeek[B]!==void 0?C.closedCreatedThisWeek[B]:0,closedTicketsCreatedOtherWeek:Array.isArray(C.closedCreatedOtherWeek)&&C.closedCreatedOtherWeek[B]!==void 0?C.closedCreatedOtherWeek[B]:0,carryoverTickets:Array.isArray(C.carryover)&&C.carryover[B]!==void 0?C.carryover[B]:0,carryoverTicketsCreatedThisWeek:Array.isArray(C.carryoverCreatedThisWeek)&&C.carryoverCreatedThisWeek[B]!==void 0?C.carryoverCreatedThisWeek[B]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(C.carryoverCreatedOtherWeek)&&C.carryoverCreatedOtherWeek[B]!==void 0?C.carryoverCreatedOtherWeek[B]:0}}}return null});function U(i,o){if(typeof i!="number"||isNaN(i)||o==null||typeof o!="number"||isNaN(o)||o===0)return null;if(i===o)return 0;const p=(i-o)/o*100;return!isFinite(p)||isNaN(p)?null:p}function P(i){return i==null||isNaN(i)?"":`${i>=0?"+":""}${i.toFixed(1)}%`}const N=Y(()=>{var i,o,p;if((i=e.data)!=null&&i.series){const T=e.data.series,_=Math.max((Array.isArray(T.new)?T.new.length:0)-1,(Array.isArray(T.closed)?T.closed.length:0)-1,(Array.isArray(T.carryover)?T.carryover.length:0)-1,-1);if(_>=2){const k=_-2,d=(p=(o=e.meta)==null?void 0:o.weeks)==null?void 0:p[k];return{weekNumber:(d==null?void 0:d.weekNumber)??null,newTickets:Array.isArray(T.new)&&T.new[k]!==void 0?T.new[k]:0,closedTickets:Array.isArray(T.closed)&&T.closed[k]!==void 0?T.closed[k]:0,carryoverTickets:Array.isArray(T.carryover)&&T.carryover[k]!==void 0?T.carryover[k]:0}}}return null}),I=Y(()=>{const i=$.value,o=D.value;return!i||!o?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:U(i.newTickets??0,o.newTickets??0),closedTickets:U(i.closedTickets??0,o.closedTickets??0),carryoverTickets:U(i.carryoverTickets??0,o.carryoverTickets??0)}}),M=Y(()=>{const i=D.value,o=N.value;return!i||!o?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:U(i.newTickets??0,o.newTickets??0),closedTickets:U(i.closedTickets??0,o.closedTickets??0),carryoverTickets:U(i.carryoverTickets??0,o.carryoverTickets??0)}});function G(i,o){if(!i||!o)return"";try{const p=new Date(i),T=new Date(o),_=p.getUTCDate(),k=p.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),d=p.getUTCFullYear(),O=T.getUTCDate(),F=T.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),C=T.getUTCFullYear();return d===C&&k===F?`${_} ‚Äî ${O} ${k}`:d===C?`${_} ${k} ‚Äî ${O} ${F}`:`${_} ${k} ${d} ‚Äî ${O} ${F} ${C}`}catch(p){return console.error("[formatWeekDates] Error:",p),""}}const R=i=>{var d;const o=$.value,p=(o==null?void 0:o.newTickets)??0,T=(o==null?void 0:o.closedTickets)??0,_=(o==null?void 0:o.carryoverTickets)??0,k=E.value;i==="new"&&p>0?a("open-stages",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc}):i==="closed"&&T>0?(((d=e.data)==null?void 0:d.responsible)||[]).length>0&&a("open-responsible",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc}):i==="carryover"&&_>0&&a("open-carryover",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc})},X=i=>{const o=D.value;if(!o)return;const p=(o==null?void 0:o.newTickets)??0,T=(o==null?void 0:o.closedTickets)??0,_=(o==null?void 0:o.carryoverTickets)??0,k=n.value;k&&(i==="new"&&p>0?a("open-stages",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc}):i==="closed"&&T>0?a("open-responsible",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc}):i==="carryover"&&_>0&&a("open-carryover",{weekNumber:k.weekNumber,weekStartUtc:k.weekStartUtc,weekEndUtc:k.weekEndUtc}))};return(i,o)=>{var p,T,_,k,d,O,F,C,L,B,j,re,ce,de,ue,ve,ke,fe,pe,ge,be,we,Te,Ce,Ee,qe,Ze,Xe,Je,Ke,Qe,et,tt,st,at,rt,ot,nt,lt,it,ct,dt,ut,vt;return y(),g("div",rs,[s("header",os,[s("div",null,[o[6]||(o[6]=s("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),s("p",ns," –ù–µ–¥–µ–ª—è "+w(((T=(p=r.meta)==null?void 0:p.currentWeek)==null?void 0:T.weekNumber)??((_=r.meta)==null?void 0:_.weekNumber)??"‚Äî")+" ¬∑ "+w((((d=(k=r.meta)==null?void 0:k.currentWeek)==null?void 0:d.weekStartUtc)??((O=r.meta)==null?void 0:O.weekStartUtc))||"‚Äî")+" ‚Äî "+w((((C=(F=r.meta)==null?void 0:F.currentWeek)==null?void 0:C.weekEndUtc)??((L=r.meta)==null?void 0:L.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),s("div",ls,[s("div",is,[(y(),g(K,null,Q(l,se=>s("button",{key:se.value,class:te(["chart-type-btn",{active:c.value===se.value}]),onClick:sc=>c.value=se.value},[s("span",ds,w(se.icon),1),s("span",us,w(se.label),1)],10,cs)),64))])])]),s("section",vs,[s("div",ks,[s("h3",hs,[o[7]||(o[7]=s("span",{class:"summary-week-block__title-text"},"–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),s("span",ms," –ù–µ–¥–µ–ª—è "+w(E.value.weekNumber??"‚Äî"),1),E.value.weekStartUtc?(y(),g("span",ys,w(G(E.value.weekStartUtc,E.value.weekEndUtc)),1)):Z("",!0)]),s("div",_s,[s("div",{class:"summary-card summary-card--new",onClick:o[0]||(o[0]=se=>R("new"))},[o[8]||(o[8]=s("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s("div",fs,[s("div",ps,w(((B=$.value)==null?void 0:B.newTickets)??0),1),I.value.newTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",I.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((j=D.value)==null?void 0:j.weekNumber)??"‚Äî"}): ${P(I.value.newTickets)}`},[s("span",bs,w(I.value.newTickets>=0?"‚Üë":"‚Üì"),1),s("span",ws,w(P(I.value.newTickets)),1),s("span",Ts,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((re=D.value)==null?void 0:re.weekNumber)??"‚Äî"),1)],10,gs)):Z("",!0)])]),s("div",{class:"summary-card summary-card--closed-breakdown",onClick:o[1]||(o[1]=se=>R("closed"))},[o[13]||(o[13]=s("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s("div",Cs,[s("div",$s,w(((ce=$.value)==null?void 0:ce.closedTickets)??0),1),I.value.closedTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",I.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((de=D.value)==null?void 0:de.weekNumber)??"‚Äî"}): ${P(I.value.closedTickets)}`},[s("span",Ds,w(I.value.closedTickets>=0?"‚Üë":"‚Üì"),1),s("span",Es,w(P(I.value.closedTickets)),1),s("span",As,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((ue=D.value)==null?void 0:ue.weekNumber)??"‚Äî"),1)],10,Ws)):Z("",!0)]),s("div",Ns,[s("div",Ss,[o[9]||(o[9]=s("span",{class:"breakdown-item__icon"},"‚úì",-1)),s("span",Us,w(((ve=$.value)==null?void 0:ve.closedTicketsCreatedThisWeek)??0),1),o[10]||(o[10]=s("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),s("div",Is,[o[11]||(o[11]=s("span",{class:"breakdown-item__icon"},"‚Üª",-1)),s("span",Ms,w(((ke=$.value)==null?void 0:ke.closedTicketsCreatedOtherWeek)??0),1),o[12]||(o[12]=s("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),s("div",{class:"summary-card summary-card--carryover-breakdown",onClick:o[2]||(o[2]=se=>R("carryover"))},[o[18]||(o[18]=s("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),s("div",Bs,[s("div",Os,w(((fe=$.value)==null?void 0:fe.carryoverTickets)??0),1),I.value.carryoverTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",I.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((pe=D.value)==null?void 0:pe.weekNumber)??"‚Äî"}): ${P(I.value.carryoverTickets)}`},[s("span",Rs,w(I.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),s("span",Ps,w(P(I.value.carryoverTickets)),1),s("span",Ls,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((ge=D.value)==null?void 0:ge.weekNumber)??"‚Äî"),1)],10,xs)):Z("",!0)]),s("div",Gs,[s("div",Fs,[o[14]||(o[14]=s("span",{class:"breakdown-item__icon"},"‚úì",-1)),s("span",Vs,w(((be=$.value)==null?void 0:be.carryoverTicketsCreatedThisWeek)??0),1),o[15]||(o[15]=s("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),s("div",Hs,[o[16]||(o[16]=s("span",{class:"breakdown-item__icon"},"‚Üª",-1)),s("span",Ys,w(((we=$.value)==null?void 0:we.carryoverTicketsCreatedOtherWeek)??0),1),o[17]||(o[17]=s("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö",-1))])])]),s("div",zs,[o[19]||(o[19]=s("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),s("div",js,[(y(!0),g(K,null,Q(r.data.stages||[],se=>(y(),g("span",{key:se.stageId,class:"stage-tag"},w(se.stageName||se.stageId)+" ‚Äî "+w(se.count),1))),128)),!r.data.stages||r.data.stages.length===0?(y(),g("span",qs," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])])]),D.value?(y(),g("div",Zs,[...o[20]||(o[20]=[s("div",{class:"summary-week-divider__line"},null,-1),s("div",{class:"summary-week-divider__label"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)])])):Z("",!0),D.value?(y(),g("div",Xs,[s("h3",Js,[o[21]||(o[21]=s("span",{class:"summary-week-block__title-text"},"–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è",-1)),s("span",Ks," –ù–µ–¥–µ–ª—è "+w(D.value.weekNumber??"‚Äî"),1),D.value.weekStartUtc?(y(),g("span",Qs,w(G(D.value.weekStartUtc,D.value.weekEndUtc)),1)):Z("",!0)]),s("div",ea,[s("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:o[3]||(o[3]=se=>X("new"))},[o[22]||(o[22]=s("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s("div",ta,[s("div",sa,[s("div",aa,[s("div",ra,w(((Te=D.value)==null?void 0:Te.newTickets)??0),1),s("span",oa,"–ù–µ–¥–µ–ª—è "+w(((Ce=D.value)==null?void 0:Ce.weekNumber)??"‚Äî"),1)]),s("div",na,[s("div",la,w(((Ee=N.value)==null?void 0:Ee.newTickets)??0),1),s("span",ia,"–ù–µ–¥–µ–ª—è "+w(((qe=N.value)==null?void 0:qe.weekNumber)??"‚Äî"),1)])]),M.value.newTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",M.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((Ze=N.value)==null?void 0:Ze.weekNumber)??"‚Äî"}): ${P(M.value.newTickets)}`},[s("span",da,w(M.value.newTickets>=0?"‚Üë":"‚Üì"),1),s("span",ua,w(P(M.value.newTickets)),1),s("span",va,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((Xe=N.value)==null?void 0:Xe.weekNumber)??"‚Äî"),1)],10,ca)):Z("",!0)])]),s("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:o[4]||(o[4]=se=>X("closed"))},[o[27]||(o[27]=s("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s("div",ka,[s("div",ha,[s("div",ma,[s("div",ya,w(((Je=D.value)==null?void 0:Je.closedTickets)??0),1),s("span",_a,"–ù–µ–¥–µ–ª—è "+w(((Ke=D.value)==null?void 0:Ke.weekNumber)??"‚Äî"),1)]),s("div",fa,[s("div",pa,w(((Qe=N.value)==null?void 0:Qe.closedTickets)??0),1),s("span",ga,"–ù–µ–¥–µ–ª—è "+w(((et=N.value)==null?void 0:et.weekNumber)??"‚Äî"),1)])]),M.value.closedTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",M.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((tt=N.value)==null?void 0:tt.weekNumber)??"‚Äî"}): ${P(M.value.closedTickets)}`},[s("span",wa,w(M.value.closedTickets>=0?"‚Üë":"‚Üì"),1),s("span",Ta,w(P(M.value.closedTickets)),1),s("span",Ca,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((st=N.value)==null?void 0:st.weekNumber)??"‚Äî"),1)],10,ba)):Z("",!0)]),s("div",$a,[s("div",Wa,[o[23]||(o[23]=s("span",{class:"breakdown-item__icon"},"‚úì",-1)),s("span",Da,w(((at=D.value)==null?void 0:at.closedTicketsCreatedThisWeek)??0),1),o[24]||(o[24]=s("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),s("div",Ea,[o[25]||(o[25]=s("span",{class:"breakdown-item__icon"},"‚Üª",-1)),s("span",Aa,w(((rt=D.value)==null?void 0:rt.closedTicketsCreatedOtherWeek)??0),1),o[26]||(o[26]=s("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),s("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:o[5]||(o[5]=se=>X("carryover"))},[o[32]||(o[32]=s("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),s("div",Na,[s("div",Sa,[s("div",Ua,[s("div",Ia,w(((ot=D.value)==null?void 0:ot.carryoverTickets)??0),1),s("span",Ma,"–ù–µ–¥–µ–ª—è "+w(((nt=D.value)==null?void 0:nt.weekNumber)??"‚Äî"),1)]),s("div",Ba,[s("div",Oa,w(((lt=N.value)==null?void 0:lt.carryoverTickets)??0),1),s("span",xa,"–ù–µ–¥–µ–ª—è "+w(((it=N.value)==null?void 0:it.weekNumber)??"‚Äî"),1)])]),M.value.carryoverTickets!==null?(y(),g("div",{key:0,class:te(["percentage-indicator",M.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–ø—Ä–µ–¥—ã–¥—É—â–µ–π –Ω–µ–¥–µ–ª–∏ (–ù–µ–¥–µ–ª—è ${((ct=N.value)==null?void 0:ct.weekNumber)??"‚Äî"}): ${P(M.value.carryoverTickets)}`},[s("span",Pa,w(M.value.carryoverTickets>=0?"‚Üë":"‚Üì"),1),s("span",La,w(P(M.value.carryoverTickets)),1),s("span",Ga,"–∫ –Ω–µ–¥–µ–ª–µ "+w(((dt=N.value)==null?void 0:dt.weekNumber)??"‚Äî"),1)],10,Ra)):Z("",!0)]),s("div",Fa,[s("div",Va,[o[28]||(o[28]=s("span",{class:"breakdown-item__icon"},"‚úì",-1)),s("span",Ha,w(((ut=D.value)==null?void 0:ut.carryoverTicketsCreatedThisWeek)??0),1),o[29]||(o[29]=s("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),s("div",Ya,[o[30]||(o[30]=s("span",{class:"breakdown-item__icon"},"‚Üª",-1)),s("span",za,w(((vt=D.value)==null?void 0:vt.carryoverTicketsCreatedOtherWeek)??0),1),o[31]||(o[31]=s("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö",-1))])])]),s("div",ja,[o[33]||(o[33]=s("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),s("div",qa,[(y(!0),g(K,null,Q(r.data.stages||[],se=>(y(),g("span",{key:se.stageId,class:"stage-tag"},w(se.stageName||se.stageId)+" ‚Äî "+w(se.count),1))),128)),!r.data.stages||r.data.stages.length===0?(y(),g("span",Za," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])])])):Z("",!0)]),s("div",Xa,[c.value==="line"?(y(),g("div",Ja,[s("div",Ka,[o[34]||(o[34]=s("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),s("div",Qa,[J(Pe(De),{data:f.value,options:h.value},null,8,["data","options"])])]),s("div",er,[o[35]||(o[35]=s("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),s("div",tr,[J(Pe(De),{data:A.value,options:h.value},null,8,["data","options"])])])])):(y(),ie(Ot(q.value),{key:1,data:S.value,options:h.value},null,8,["data","options"]))])])}}},ar=he(sr,[["__scopeId","data-v-26b9498b"]]),rr={class:"summary-cards-months"},or={class:"summary-card summary-card--new"},nr={class:"card-content"},lr={class:"card-main-value"},ir=["title"],cr={class:"card-month-breakdown"},dr={class:"month-name"},ur={class:"month-value"},vr={key:0,class:"month-item month-item--empty"},kr={class:"summary-card summary-card--closed"},hr={class:"card-content"},mr={class:"card-main-value"},yr=["title"],_r={class:"card-month-breakdown-hierarchical"},fr={class:"month-header"},pr={class:"month-name"},gr={class:"month-value"},br={class:"month-breakdown"},wr={class:"breakdown-item breakdown-this-week"},Tr={class:"breakdown-value"},Cr={class:"breakdown-item breakdown-other-week"},$r={class:"breakdown-value"},Wr={key:0,class:"month-item-hierarchical month-item--empty"},Dr={class:"summary-card summary-card--carryover"},Er={class:"card-content"},Ar={class:"card-current-value"},Nr={class:"current-value"},Sr=["title"],Ur={class:"card-month-breakdown"},Ir={class:"month-name"},Mr={class:"month-value"},Br={key:0,class:"month-item month-item--empty"},Or={class:"summary-card summary-card--stages"},xr={class:"card-content"},Rr={class:"stages-list"},Pr={class:"stage-icon"},Lr={class:"stage-name"},Gr={class:"stage-value"},Fr={key:0,class:"stage-item stage-item--empty"},Vr={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(r){const t=r;function e(b){return b==null||isNaN(b)?"0":b>=1e6?(b/1e6).toFixed(1)+"M":b>=1e3?b.toLocaleString("ru-RU"):b.toString()}function a(b){return b==null||isNaN(b)?"":`${b>=0?"+":""}${b.toFixed(1)}%`}function n(b,u){if(typeof b!="number"||isNaN(b)||u==null||typeof u!="number"||isNaN(u)||u===0)return null;if(b===u)return 0;const h=(b-u)/u*100;return!isFinite(h)||isNaN(h)?null:h}const l=Y(()=>{var b;return((b=t.data)==null?void 0:b.newTickets)||0}),c=Y(()=>e(l.value)),v=Y(()=>{var b;return((b=t.data)==null?void 0:b.newTicketsByMonth)||[]}),m=Y(()=>{var b;return((b=t.data)==null?void 0:b.closedTicketsByMonth)||[]}),f=Y(()=>{var b;return((b=t.data)==null?void 0:b.carryoverTicketsByMonth)||[]}),A=Y(()=>{const b=f.value;if(b.length===0)return 0;const u=b[b.length-1];return(u==null?void 0:u.count)||0}),x=Y(()=>{var h,$,E,D;const b=typeof((h=t.data)==null?void 0:h.newTickets)=="number"?t.data.newTickets:parseInt(($=t.data)==null?void 0:$.newTickets)||0,u=(D=(E=t.data)==null?void 0:E.previousPeriodData)==null?void 0:D.newTickets;return n(b,u)}),z=Y(()=>{var h,$,E,D;const b=typeof((h=t.data)==null?void 0:h.closedTickets)=="number"?t.data.closedTickets:parseInt(($=t.data)==null?void 0:$.closedTickets)||0,u=(D=(E=t.data)==null?void 0:E.previousPeriodData)==null?void 0:D.closedTickets;return n(b,u)}),q=Y(()=>{var $;const b=A.value,u=f.value,h=u.length>0?(($=u[0])==null?void 0:$.count)||0:null;return n(b,h)});function S(b){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[b]||""}function W(b){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[b]||"‚Ä¢"}return(b,u)=>(y(),g("div",rr,[s("div",or,[u[0]||(u[0]=s("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),s("div",nr,[s("div",lr,[le(w(c.value)+" ",1),x.value!==null?(y(),g("span",{key:0,class:te(["percentage-badge",x.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(x.value)}`},w(a(x.value)),11,ir)):Z("",!0)]),s("div",cr,[(y(!0),g(K,null,Q(v.value,h=>(y(),g("div",{key:`new-${h.month}`,class:"month-item"},[s("span",dr,w(h.monthName)+":",1),s("span",ur,w(e(h.count)),1)]))),128)),v.value.length===0?(y(),g("div",vr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),s("div",kr,[u[5]||(u[5]=s("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),s("div",hr,[s("div",mr,[le(w(e(r.data.closedTickets||0))+" ",1),z.value!==null?(y(),g("span",{key:0,class:te(["percentage-badge",z.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(z.value)}`},w(a(z.value)),11,yr)):Z("",!0)]),s("div",_r,[(y(!0),g(K,null,Q(m.value,h=>(y(),g("div",{key:`closed-${h.month}`,class:"month-item-hierarchical"},[s("div",fr,[s("span",pr,w(h.monthName)+":",1),s("span",gr,w(e(h.count||0)),1)]),s("div",br,[s("div",wr,[u[1]||(u[1]=s("span",{class:"breakdown-icon"},"‚úì",-1)),u[2]||(u[2]=s("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),s("span",Tr,w(e(h.closedCreatedThisWeek||0)),1)]),s("div",Cr,[u[3]||(u[3]=s("span",{class:"breakdown-icon"},"‚Üª",-1)),u[4]||(u[4]=s("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),s("span",$r,w(e(h.closedCreatedOtherWeek||0)),1)])])]))),128)),m.value.length===0?(y(),g("div",Wr," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),s("div",Dr,[u[7]||(u[7]=s("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),u[8]||(u[8]=s("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),s("div",Er,[s("div",Ar,[u[6]||(u[6]=s("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),s("span",Nr,[le(w(e(A.value))+" ",1),q.value!==null?(y(),g("span",{key:0,class:te(["percentage-badge",q.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${a(q.value)}`},w(a(q.value)),11,Sr)):Z("",!0)])]),s("div",Ur,[(y(!0),g(K,null,Q(f.value,h=>(y(),g("div",{key:`carryover-${h.month}`,class:"month-item"},[s("span",Ir,w(h.monthName)+":",1),s("span",Mr,w(e(h.count||0)),1)]))),128)),f.value.length===0?(y(),g("div",Br," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Z("",!0)])])]),s("div",Or,[u[10]||(u[10]=s("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),s("div",xr,[s("div",Rr,[(y(!0),g(K,null,Q(r.data.stages||[],h=>(y(),g("div",{key:h.stageId,class:te(["stage-item",S(h.stageId)])},[s("span",Pr,w(W(h.stageId)),1),s("span",Lr,w(h.stageName||h.stageId)+":",1),s("span",Gr,w(e(h.count||0)),1)],2))),128)),!r.data.stages||r.data.stages.length===0?(y(),g("div",Fr,[...u[9]||(u[9]=[s("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):Z("",!0)])])])]))}},Hr=he(Vr,[["__scopeId","data-v-15d88b90"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var yt=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var r=window.screen;if(r)return(r.deviceXDPI||1)/(r.logicalXDPI||1)}return 1}(),Ue={toTextLines:function(r){var t=[],e;for(r=[].concat(r);r.length;)e=r.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?r.push.apply(r,e):Ne(r)||t.unshift(""+e);return t},textSize:function(r,t,e){var a=[].concat(t),n=a.length,l=r.font,c=0,v;for(r.font=e.string,v=0;v<n;++v)c=Math.max(r.measureText(a[v]).width,c);return r.font=l,{height:n*e.lineHeight,width:c}},bound:function(r,t,e){return Math.max(r,Math.min(t,e))},arrayDiff:function(r,t){var e=r.slice(),a=[],n,l,c,v;for(n=0,c=t.length;n<c;++n)v=t[n],l=e.indexOf(v),l===-1?a.push([v,1]):e.splice(l,1);for(n=0,c=e.length;n<c;++n)a.push([e[n],-1]);return a},rasterize:function(r){return Math.round(r*yt)/yt}};function Ve(r,t){var e=t.x,a=t.y;if(e===null)return{x:0,y:-1};if(a===null)return{x:1,y:0};var n=r.x-e,l=r.y-a,c=Math.sqrt(n*n+l*l);return{x:c?n/c:0,y:c?l/c:-1}}function Yr(r,t,e,a,n){switch(n){case"center":e=a=0;break;case"bottom":e=0,a=1;break;case"right":e=1,a=0;break;case"left":e=-1,a=0;break;case"top":e=0,a=-1;break;case"start":e=-e,a=-a;break;case"end":break;default:n*=Math.PI/180,e=Math.cos(n),a=Math.sin(n);break}return{x:r,y:t,vx:e,vy:a}}var zr=0,$t=1,Wt=2,Dt=4,Et=8;function Be(r,t,e){var a=zr;return r<e.left?a|=$t:r>e.right&&(a|=Wt),t<e.top?a|=Et:t>e.bottom&&(a|=Dt),a}function jr(r,t){for(var e=r.x0,a=r.y0,n=r.x1,l=r.y1,c=Be(e,a,t),v=Be(n,l,t),m,f,A;!(!(c|v)||c&v);)m=c||v,m&Et?(f=e+(n-e)*(t.top-a)/(l-a),A=t.top):m&Dt?(f=e+(n-e)*(t.bottom-a)/(l-a),A=t.bottom):m&Wt?(A=a+(l-a)*(t.right-e)/(n-e),f=t.right):m&$t&&(A=a+(l-a)*(t.left-e)/(n-e),f=t.left),m===c?(e=f,a=A,c=Be(e,a,t)):(n=f,l=A,v=Be(n,l,t));return{x0:e,x1:n,y0:a,y1:l}}function Oe(r,t){var e=t.anchor,a=r,n,l;return t.clamp&&(a=jr(a,t.area)),e==="start"?(n=a.x0,l=a.y0):e==="end"?(n=a.x1,l=a.y1):(n=(a.x0+a.x1)/2,l=(a.y0+a.y1)/2),Yr(n,l,r.vx,r.vy,t.align)}var xe={arc:function(r,t){var e=(r.startAngle+r.endAngle)/2,a=Math.cos(e),n=Math.sin(e),l=r.innerRadius,c=r.outerRadius;return Oe({x0:r.x+a*l,y0:r.y+n*l,x1:r.x+a*c,y1:r.y+n*c,vx:a,vy:n},t)},point:function(r,t){var e=Ve(r,t.origin),a=e.x*r.options.radius,n=e.y*r.options.radius;return Oe({x0:r.x-a,y0:r.y-n,x1:r.x+a,y1:r.y+n,vx:e.x,vy:e.y},t)},bar:function(r,t){var e=Ve(r,t.origin),a=r.x,n=r.y,l=0,c=0;return r.horizontal?(a=Math.min(r.x,r.base),l=Math.abs(r.base-r.x)):(n=Math.min(r.y,r.base),c=Math.abs(r.base-r.y)),Oe({x0:a,y0:n+c,x1:a+l,y1:n,vx:e.x,vy:e.y},t)},fallback:function(r,t){var e=Ve(r,t.origin);return Oe({x0:r.x,y0:r.y,x1:r.x+(r.width||0),y1:r.y+(r.height||0),vx:e.x,vy:e.y},t)}},me=Ue.rasterize;function qr(r){var t=r.borderWidth||0,e=r.padding,a=r.size.height,n=r.size.width,l=-n/2,c=-a/2;return{frame:{x:l-e.left-t,y:c-e.top-t,w:n+e.width+t*2,h:a+e.height+t*2},text:{x:l,y:c,w:n,h:a}}}function Zr(r,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var a=e.getBasePixel();return r.horizontal?{x:a,y:null}:{x:null,y:a}}function Xr(r){return r instanceof Gt?xe.arc:r instanceof Ft?xe.point:r instanceof Vt?xe.bar:xe.fallback}function Jr(r,t,e,a,n,l){var c=Math.PI/2;if(l){var v=Math.min(l,n/2,a/2),m=t+v,f=e+v,A=t+a-v,x=e+n-v;r.moveTo(t,f),m<A&&f<x?(r.arc(m,f,v,-Math.PI,-c),r.arc(A,f,v,-c,0),r.arc(A,x,v,0,c),r.arc(m,x,v,c,Math.PI)):m<A?(r.moveTo(m,e),r.arc(A,f,v,-c,c),r.arc(m,f,v,c,Math.PI+c)):f<x?(r.arc(m,f,v,-Math.PI,0),r.arc(m,x,v,0,Math.PI)):r.arc(m,f,v,-Math.PI,Math.PI),r.closePath(),r.moveTo(t,e)}else r.rect(t,e,a,n)}function Kr(r,t,e){var a=e.backgroundColor,n=e.borderColor,l=e.borderWidth;!a&&(!n||!l)||(r.beginPath(),Jr(r,me(t.x)+l/2,me(t.y)+l/2,me(t.w)-l,me(t.h)-l,e.borderRadius),r.closePath(),a&&(r.fillStyle=a,r.fill()),n&&l&&(r.strokeStyle=n,r.lineWidth=l,r.lineJoin="miter",r.stroke()))}function Qr(r,t,e){var a=e.lineHeight,n=r.w,l=r.x,c=r.y+a/2;return t==="center"?l+=n/2:(t==="end"||t==="right")&&(l+=n),{h:a,w:n,x:l,y:c}}function eo(r,t,e){var a=r.shadowBlur,n=e.stroked,l=me(e.x),c=me(e.y),v=me(e.w);n&&r.strokeText(t,l,c,v),e.filled&&(a&&n&&(r.shadowBlur=0),r.fillText(t,l,c,v),a&&n&&(r.shadowBlur=a))}function to(r,t,e,a){var n=a.textAlign,l=a.color,c=!!l,v=a.font,m=t.length,f=a.textStrokeColor,A=a.textStrokeWidth,x=f&&A,z;if(!(!m||!c&&!x))for(e=Qr(e,n,v),r.font=v.string,r.textAlign=n,r.textBaseline="middle",r.shadowBlur=a.textShadowBlur,r.shadowColor=a.textShadowColor,c&&(r.fillStyle=l),x&&(r.lineJoin="round",r.lineWidth=A,r.strokeStyle=f),z=0,m=t.length;z<m;++z)eo(r,t[z],{stroked:x,filled:c,w:e.w,x:e.x,y:e.y+e.h*z})}var At=function(r,t,e,a){var n=this;n._config=r,n._index=a,n._model=null,n._rects=null,n._ctx=t,n._el=e};Me(At.prototype,{_modelize:function(r,t,e,a){var n=this,l=n._index,c=Rt(ae([e.font,{}],a,l)),v=ae([e.color,Pt.color],a,l);return{align:ae([e.align,"center"],a,l),anchor:ae([e.anchor,"center"],a,l),area:a.chart.chartArea,backgroundColor:ae([e.backgroundColor,null],a,l),borderColor:ae([e.borderColor,null],a,l),borderRadius:ae([e.borderRadius,0],a,l),borderWidth:ae([e.borderWidth,0],a,l),clamp:ae([e.clamp,!1],a,l),clip:ae([e.clip,!1],a,l),color:v,display:r,font:c,lines:t,offset:ae([e.offset,4],a,l),opacity:ae([e.opacity,1],a,l),origin:Zr(n._el,a),padding:Lt(ae([e.padding,4],a,l)),positioner:Xr(n._el),rotation:ae([e.rotation,0],a,l)*(Math.PI/180),size:Ue.textSize(n._ctx,t,c),textAlign:ae([e.textAlign,"start"],a,l),textShadowBlur:ae([e.textShadowBlur,0],a,l),textShadowColor:ae([e.textShadowColor,v],a,l),textStrokeColor:ae([e.textStrokeColor,v],a,l),textStrokeWidth:ae([e.textStrokeWidth,0],a,l)}},update:function(r){var t=this,e=null,a=null,n=t._index,l=t._config,c,v,m,f=ae([l.display,!0],r,n);f&&(c=r.dataset.data[n],v=xt(gt(l.formatter,[c,r]),c),m=Ne(v)?[]:Ue.toTextLines(v),m.length&&(e=t._modelize(f,m,l,r),a=qr(e))),t._model=e,t._rects=a},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(r,t){var e=this,a=r.ctx,n=e._model,l=e._rects,c;this.visible()&&(a.save(),n.clip&&(c=n.area,a.beginPath(),a.rect(c.left,c.top,c.right-c.left,c.bottom-c.top),a.clip()),a.globalAlpha=Ue.bound(0,n.opacity,1),a.translate(me(t.x),me(t.y)),a.rotate(n.rotation),Kr(a,l.frame,n),to(a,n.lines,l.text,n),a.restore())}});var so=Number.MIN_SAFE_INTEGER||-9007199254740991,ao=Number.MAX_SAFE_INTEGER||9007199254740991;function Ae(r,t,e){var a=Math.cos(e),n=Math.sin(e),l=t.x,c=t.y;return{x:l+a*(r.x-l)-n*(r.y-c),y:c+n*(r.x-l)+a*(r.y-c)}}function _t(r,t){var e=ao,a=so,n=t.origin,l,c,v,m,f;for(l=0;l<r.length;++l)c=r[l],v=c.x-n.x,m=c.y-n.y,f=t.vx*v+t.vy*m,e=Math.min(e,f),a=Math.max(a,f);return{min:e,max:a}}function Re(r,t){var e=t.x-r.x,a=t.y-r.y,n=Math.sqrt(e*e+a*a);return{vx:(t.x-r.x)/n,vy:(t.y-r.y)/n,origin:r,ln:n}}var Nt=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};Me(Nt.prototype,{center:function(){var r=this._rect;return{x:r.x+r.w/2,y:r.y+r.h/2}},update:function(r,t,e){this._rotation=e,this._rect={x:t.x+r.x,y:t.y+r.y,w:t.w,h:t.h}},contains:function(r){var t=this,e=1,a=t._rect;return r=Ae(r,t.center(),-t._rotation),!(r.x<a.x-e||r.y<a.y-e||r.x>a.x+a.w+e*2||r.y>a.y+a.h+e*2)},intersects:function(r){var t=this._points(),e=r._points(),a=[Re(t[0],t[1]),Re(t[0],t[3])],n,l,c;for(this._rotation!==r._rotation&&a.push(Re(e[0],e[1]),Re(e[0],e[3])),n=0;n<a.length;++n)if(l=_t(t,a[n]),c=_t(e,a[n]),l.max<c.min||c.max<l.min)return!1;return!0},_points:function(){var r=this,t=r._rect,e=r._rotation,a=r.center();return[Ae({x:t.x,y:t.y},a,e),Ae({x:t.x+t.w,y:t.y},a,e),Ae({x:t.x+t.w,y:t.y+t.h},a,e),Ae({x:t.x,y:t.y+t.h},a,e)]}});function St(r,t,e){var a=t.positioner(r,t),n=a.vx,l=a.vy;if(!n&&!l)return{x:a.x,y:a.y};var c=e.w,v=e.h,m=t.rotation,f=Math.abs(c/2*Math.cos(m))+Math.abs(v/2*Math.sin(m)),A=Math.abs(c/2*Math.sin(m))+Math.abs(v/2*Math.cos(m)),x=1/Math.max(Math.abs(n),Math.abs(l));return f*=n*x,A*=l*x,f+=t.offset*n,A+=t.offset*l,{x:a.x+f,y:a.y+A}}function ro(r,t){var e,a,n,l;for(e=r.length-1;e>=0;--e)for(n=r[e].$layout,a=e-1;a>=0&&n._visible;--a)l=r[a].$layout,l._visible&&n._box.intersects(l._box)&&t(n,l);return r}function oo(r){var t,e,a,n,l,c,v;for(t=0,e=r.length;t<e;++t)a=r[t],n=a.$layout,n._visible&&(v=new Proxy(a._el,{get:(m,f)=>m.getProps([f],!0)[f]}),l=a.geometry(),c=St(v,a.model(),l),n._box.update(c,l,a.rotation()));return ro(r,function(m,f){var A=m._hidable,x=f._hidable;A&&x||x?f._visible=!1:A&&(m._visible=!1)})}var Ie={prepare:function(r){var t=[],e,a,n,l,c;for(e=0,n=r.length;e<n;++e)for(a=0,l=r[e].length;a<l;++a)c=r[e][a],t.push(c),c.$layout={_box:new Nt,_hidable:!1,_visible:!0,_set:e,_idx:c._index};return t.sort(function(v,m){var f=v.$layout,A=m.$layout;return f._idx===A._idx?A._set-f._set:A._idx-f._idx}),this.update(t),t},update:function(r){var t=!1,e,a,n,l,c;for(e=0,a=r.length;e<a;++e)n=r[e],l=n.model(),c=n.$layout,c._hidable=l&&l.display==="auto",c._visible=n.visible(),t|=c._hidable;t&&oo(r)},lookup:function(r,t){var e,a;for(e=r.length-1;e>=0;--e)if(a=r[e].$layout,a&&a._visible&&a._box.contains(t))return r[e];return null},draw:function(r,t){var e,a,n,l,c,v;for(e=0,a=t.length;e<a;++e)n=t[e],l=n.$layout,l._visible&&(c=n.geometry(),v=St(n._el,n.model(),c),l._box.update(v,c,n.rotation()),n.draw(r,v))}},no=function(r){if(Ne(r))return null;var t=r,e,a,n;if(Ht(r))if(!Ne(r.label))t=r.label;else if(!Ne(r.r))t=r.r;else for(t="",e=Object.keys(r),n=0,a=e.length;n<a;++n)t+=(n!==0?", ":"")+e[n]+": "+r[e[n]];return""+t},lo={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:no,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},oe="$datalabels",Ut="$default";function io(r,t){var e=r.datalabels,a={},n=[],l,c;return e===!1?null:(e===!0&&(e={}),t=Me({},[t,e]),l=t.labels||{},c=Object.keys(l),delete t.labels,c.length?c.forEach(function(v){l[v]&&n.push(Me({},[t,l[v],{_key:v}]))}):n.push(t),a=n.reduce(function(v,m){return Yt(m.listeners||{},function(f,A){v[A]=v[A]||{},v[A][m._key||Ut]=f}),delete m.listeners,v},{}),{labels:n,listeners:a})}function He(r,t,e,a){if(t){var n=e.$context,l=e.$groups,c;t[l._set]&&(c=t[l._set][l._key],c&&gt(c,[n,a])===!0&&(r[oe]._dirty=!0,e.update(n)))}}function co(r,t,e,a,n){var l,c;!e&&!a||(e?a?e!==a&&(c=l=!0):c=!0:l=!0,c&&He(r,t.leave,e,n),l&&He(r,t.enter,a,n))}function uo(r,t){var e=r[oe],a=e._listeners,n,l;if(!(!a.enter&&!a.leave)){if(t.type==="mousemove")l=Ie.lookup(e._labels,t);else if(t.type!=="mouseout")return;n=e._hovered,e._hovered=l,co(r,a,n,l,t)}}function vo(r,t){var e=r[oe],a=e._listeners.click,n=a&&Ie.lookup(e._labels,t);n&&He(r,a,n,t)}var ko={id:"datalabels",defaults:lo,beforeInit:function(r){r[oe]={_actives:[]}},beforeUpdate:function(r){var t=r[oe];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(r,t,e){var a=t.index,n=r[oe],l=n._datasets[a]=[],c=r.isDatasetVisible(a),v=r.data.datasets[a],m=io(v,e),f=t.meta.data||[],A=r.ctx,x,z,q,S,W,b,u,h;for(A.save(),x=0,q=f.length;x<q;++x)if(u=f[x],u[oe]=[],c&&u&&r.getDataVisibility(x)&&!u.skip)for(z=0,S=m.labels.length;z<S;++z)W=m.labels[z],b=W._key,h=new At(W,A,u,x),h.$groups={_set:a,_key:b||Ut},h.$context={active:!1,chart:r,dataIndex:x,dataset:v,datasetIndex:a},h.update(h.$context),u[oe].push(h),l.push(h);A.restore(),Me(n._listeners,m.listeners,{merger:function($,E,D){E[$]=E[$]||{},E[$][t.index]=D[$],n._listened=!0}})},afterUpdate:function(r){r[oe]._labels=Ie.prepare(r[oe]._datasets)},afterDatasetsDraw:function(r){Ie.draw(r,r[oe]._labels)},beforeEvent:function(r,t){if(r[oe]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":uo(r,e);break;case"click":vo(r,e);break}}},afterEvent:function(r){var t=r[oe],e=t._actives,a=t._actives=r.getActiveElements(),n=Ue.arrayDiff(e,a),l,c,v,m,f,A,x;for(l=0,c=n.length;l<c;++l)if(f=n[l],f[1])for(x=f[0].element[oe]||[],v=0,m=x.length;v<m;++v)A=x[v],A.$context.active=f[1]===1,A.update(A.$context);(t._dirty||n.length)&&(Ie.update(t._labels),r.render()),delete t._dirty}};const ho={class:"line-chart-months"},mo={class:"chart-section"},yo={class:"chart-title"},_o={key:0,class:"chart-period"},fo={class:"chart-wrapper"},po={class:"chart-container"},go={class:"chart-summary"},bo={class:"summary-numbers"},wo={class:"summary-row"},To={class:"summary-values"},Co={class:"summary-row"},$o={class:"summary-values"},Wo={class:"summary-analysis"},Do=["innerHTML"],Eo={class:"chart-section"},Ao={class:"chart-title"},No={key:0,class:"chart-period"},So={class:"chart-wrapper"},Uo={class:"chart-container"},Io={class:"chart-analysis"},Mo={class:"analysis-content"},Bo=["innerHTML"],Oo={class:"chart-table-section"},xo={class:"chart-table-wrapper"},Ro={class:"data-table"},Po={class:"data-row data-row--new"},Lo={class:"data-row data-row--closed"},Go={class:"data-row data-row--carryover"},Fo={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(r){pt.register(ko);const t=r;function e(S){return S==null||isNaN(S)?"0":S>=1e3?S.toLocaleString("ru-RU"):S.toString()}const a=Y(()=>{var W,b,u;const S=new Set;return(W=t.data.newTicketsByMonth)==null||W.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&S.add($.weekNumber)})}),(b=t.data.closedTicketsByMonth)==null||b.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&S.add($.weekNumber)})}),(u=t.data.carryoverTicketsByMonth)==null||u.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach($=>{$&&$.weekNumber&&S.add($.weekNumber)})}),Array.from(S).sort((h,$)=>h-$)}),n=Y(()=>{const S=t.data.newTicketsByMonth||[],W=S.map(h=>h.monthName||`–ú–µ—Å—è—Ü ${h.month}`),b=S.map(h=>h.count||0),u=(t.data.closedTicketsByMonth||[]).map(h=>h.count||0);return{labels:W,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:b,borderColor:H.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:H.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:H.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:u,borderColor:H.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:H.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:H.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=Y(()=>{const S=t.data.carryoverTicketsByMonth||[],W=S.map(u=>u.monthName||`–ú–µ—Å—è—Ü ${u.month}`),b=S.map(u=>u.count||0);return{labels:W,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:b,borderColor:H.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:H.carryover}}]}}),c={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(S,W)=>S==null||isNaN(S)?"":S.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(S){const W=S.dataset.data[S.dataIndex];return W!=null&&!isNaN(W)&&isFinite(W)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function v(S){if(!S||S.length===0)return null;const W=S[0],b=S[S.length-1];if(!W||!b)return null;const u=W.monthName||`–ú–µ—Å—è—Ü ${W.month}`,h=b.monthName||`–ú–µ—Å—è—Ü ${b.month}`,$=W.year||new Date().getFullYear();return`${u} ‚Äî ${h} ${$}`}const m=Y(()=>{var S;return v(((S=t.data)==null?void 0:S.newTicketsByMonth)||[])}),f=Y(()=>{var S;return v(((S=t.data)==null?void 0:S.carryoverTicketsByMonth)||[])}),A=Y(()=>{var h,$;const S=((h=t.data)==null?void 0:h.newTicketsByMonth)||[],W=(($=t.data)==null?void 0:$.closedTicketsByMonth)||[];if(S.length===0)return{new:"‚Äî",closed:"‚Äî"};const b=S.map(E=>`${e(E.count||0)} (${E.monthName||E.month})`).join(" ‚Üí "),u=W.map(E=>`${e(E.count||0)} (${E.monthName||E.month})`).join(" ‚Üí ");return{new:b,closed:u}}),x=Y(()=>{var $,E;const S=(($=t.data)==null?void 0:$.newTicketsByMonth)||[],W=((E=t.data)==null?void 0:E.closedTicketsByMonth)||[];if(S.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const b=[],u=[],h=[];if(S.length>=2){const D=S[0],U=S[1],P=S[2];if(U&&D&&typeof D.count=="number"&&typeof U.count=="number"){const N=D.monthName||D.month,I=U.monthName||U.month,M=e(D.count||0),G=e(U.count||0);if(D.count>0){const R=(U.count-D.count)/D.count*100;if(isFinite(R)&&!isNaN(R)){const X=R>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(R),o=R>=0?"+":"-",p=R>=0?"#28a745":"#dc3545",T=R>=0?"#28a745":"#dc3545";u.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${M} (${N}) –¥–æ ${G} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${o}${i.toFixed(1)}%</span>`)}}else D.count===0&&U.count>0&&u.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${N}) –¥–æ ${G} (${I})`)}if(P&&U&&typeof U.count=="number"&&typeof P.count=="number"){const N=U.monthName||U.month,I=P.monthName||P.month,M=e(U.count||0),G=e(P.count||0);if(U.count>0){const R=(P.count-U.count)/U.count*100;if(isFinite(R)&&!isNaN(R))if(Math.abs(R)<.1)u.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${M} (${N}) ‚Üí ${G} (${I}) ‚Äî 0.0%`);else{const X=R>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(R),o=R>=0?"+":"-",p=R>=0?"#28a745":"#dc3545",T=R>=0?"#28a745":"#dc3545";u.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${M} (${N}) –¥–æ ${G} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${o}${i.toFixed(1)}%</span>`)}}else U.count===0&&P.count>0&&u.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${N}) –¥–æ ${G} (${I})`)}}if(W.length>=2){const D=W[0],U=W[1],P=W[2];if(U&&D&&typeof D.count=="number"&&typeof U.count=="number"){const N=D.monthName||D.month,I=U.monthName||U.month,M=e(D.count||0),G=e(U.count||0);if(D.count>0){const R=(U.count-D.count)/D.count*100;if(isFinite(R)&&!isNaN(R))if(Math.abs(R)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${M} (${N}) ‚Üí ${G} (${I}) ‚Äî 0.0%`);else{const X=R>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(R),o=R>=0?"+":"-",p=R>=0?"#28a745":"#dc3545",T=R>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${M} (${N}) –¥–æ ${G} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${o}${i.toFixed(1)}%</span>`)}}else D.count===0&&U.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${N}) –¥–æ ${G} (${I})`)}if(P&&U&&typeof U.count=="number"&&typeof P.count=="number"){const N=U.monthName||U.month,I=P.monthName||P.month,M=e(U.count||0),G=e(P.count||0);if(U.count>0){const R=(P.count-U.count)/U.count*100;if(isFinite(R)&&!isNaN(R))if(Math.abs(R)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${M} (${N}) ‚Üí ${G} (${I}) ‚Äî 0.0%`);else{const X=R>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",i=Math.abs(R),o=R>=0?"+":"-",p=R>=0?"#28a745":"#dc3545",T=R>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${p}; font-weight: 600;">${X}</span> —Å ${M} (${N}) –¥–æ ${G} (${I}) ‚Äî <span style="color: ${T}; font-weight: 600;">${o}${i.toFixed(1)}%</span>`)}}else U.count===0&&P.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${N}) –¥–æ ${G} (${I})`)}}if(u.length>0&&(b.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),b.push(...u)),h.length>0&&(b.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),b.push(...h)),S.length>=3&&W.length>=3){const D=S[0],U=S[S.length-1],P=W[0],N=W[W.length-1],I=D.count||0,M=U.count||0,G=P.count||0,R=N.count||0;if(I>0&&G>0){const X=(M-I)/I*100,i=(R-G)/G*100;if(isFinite(X)&&isFinite(i)){const o=D.monthName||D.month,p=U.monthName||U.month,T=P.monthName||P.month,_=N.monthName||N.month,k=X>=0?"#28a745":"#dc3545",d=X>=0?"#28a745":"#dc3545",O=i>=0?"#28a745":"#dc3545",F=i>=0?"#28a745":"#dc3545";b.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),b.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${k}; font-weight: 600;">${X>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(I)} (${o}) –¥–æ ${e(M)} (${p}) ‚Äî <span style="color: ${d}; font-weight: 600;">${X>=0?"+":"-"}${Math.abs(X).toFixed(1)}%</span>`),b.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${O}; font-weight: 600;">${i>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(G)} (${T}) –¥–æ ${e(R)} (${_}) ‚Äî <span style="color: ${F}; font-weight: 600;">${i>=0?"+":"-"}${Math.abs(i).toFixed(1)}%</span>`)}}}return b.length>0?b:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),z=Y(()=>{var h;const S=((h=t.data)==null?void 0:h.carryoverTicketsByMonth)||[];if(S.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const W=[],b=[],u=S.filter($=>$&&typeof $.count=="number").map($=>`${e($.count||0)} (${$.monthName||$.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(u&&W.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${u}`),S.length>=2){const $=S[0],E=S[1],D=S[2];if(E&&$&&typeof $.count=="number"&&typeof E.count=="number"){const U=$.monthName||$.month,P=E.monthName||E.month,N=e($.count||0),I=e(E.count||0);if($.count>0){const M=(E.count-$.count)/$.count*100;if(isFinite(M)&&!isNaN(M))if(Math.abs(M)<.1)b.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${N} (${U}) ‚Üí ${I} (${P}) ‚Äî 0.0%`);else{const G=M>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",R=Math.abs(M),X=M>=0?"+":"-",i=M>=0?"#28a745":"#dc3545",o=M>=0?"#28a745":"#dc3545";b.push(`  ‚Ä¢ <span style="color: ${i}; font-weight: 600;">${G}</span> —Å ${N} (${U}) –¥–æ ${I} (${P}) ‚Äî <span style="color: ${o}; font-weight: 600;">${X}${R.toFixed(1)}%</span>`)}}else $.count===0&&E.count>0&&b.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${I} (${P})`)}if(D&&E&&typeof E.count=="number"&&typeof D.count=="number"){const U=E.monthName||E.month,P=D.monthName||D.month,N=e(E.count||0),I=e(D.count||0);if(E.count>0){const M=(D.count-E.count)/E.count*100;if(isFinite(M)&&!isNaN(M))if(Math.abs(M)<.1)b.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${N} (${U}) ‚Üí ${I} (${P}) ‚Äî 0.0%`);else{const G=M>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",R=Math.abs(M),X=M>=0?"+":"-",i=M>=0?"#28a745":"#dc3545",o=M>=0?"#28a745":"#dc3545";b.push(`  ‚Ä¢ <span style="color: ${i}; font-weight: 600;">${G}</span> —Å ${N} (${U}) –¥–æ ${I} (${P}) ‚Äî <span style="color: ${o}; font-weight: 600;">${X}${R.toFixed(1)}%</span>`)}}else E.count===0&&D.count>0&&b.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${U}) –¥–æ ${I} (${P})`)}}if(b.length>0&&(W.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),W.push(...b)),S.length>=3){const $=S[0],E=S[S.length-1];if($&&E&&typeof $.count=="number"&&typeof E.count=="number"){const D=$.count||0,U=E.count||0,P=$.monthName||$.month,N=E.monthName||E.month,I=e(D),M=e(U);if(D>0){const G=(U-D)/D*100;if(isFinite(G)&&!isNaN(G))if(Math.abs(G)<1)W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${I} (${P}) ‚Üí ${M} (${N}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const R=G>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",X=Math.abs(G),i=G>=0?"+":"-",o=G>=0?"#28a745":"#dc3545",p=G>=0?"#28a745":"#dc3545";W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ <span style="color: ${o}; font-weight: 600;">${R}</span> —Å ${I} (${P}) –¥–æ ${M} (${N}) ‚Äî <span style="color: ${p}; font-weight: 600;">${i}${X.toFixed(1)}%</span>`)}}else D===0&&U>0?(W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${P}) –¥–æ ${M} (${N})`)):D>0&&U===0&&(W.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),W.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${I} (${P}) –¥–æ 0 (${N})`))}}return W.length>0?W:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function q(S,W){let b=[];switch(S){case"new":b=t.data.newTicketsByMonth||[];break;case"closed":b=t.data.closedTicketsByMonth||[];break;case"carryover":b=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const u of b){if(!u.weeks||!Array.isArray(u.weeks))continue;const h=u.weeks.find($=>$&&$.weekNumber===W);if(h){const $=h.count||0;return $>0?e($):"-"}}return"-"}return(S,W)=>(y(),g("div",ho,[s("div",mo,[s("h3",yo,[W[0]||(W[0]=le(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),m.value?(y(),g("span",_o,"("+w(m.value)+")",1)):Z("",!0)]),s("div",fo,[s("div",po,[J(Pe(De),{data:n.value,options:c},null,8,["data"])]),s("div",go,[W[3]||(W[3]=s("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),s("div",bo,[s("div",wo,[W[1]||(W[1]=s("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),s("span",To,w(A.value.new),1)]),s("div",Co,[W[2]||(W[2]=s("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),s("span",$o,w(A.value.closed),1)])]),s("div",Wo,[(y(!0),g(K,null,Q(x.value,(b,u)=>(y(),g("p",{key:u,innerHTML:b},null,8,Do))),128))])])])]),s("div",Eo,[s("h3",Ao,[W[4]||(W[4]=le(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),f.value?(y(),g("span",No,"("+w(f.value)+")",1)):Z("",!0)]),s("div",So,[s("div",Uo,[J(Pe(De),{data:l.value,options:c},null,8,["data"])]),s("div",Io,[W[5]||(W[5]=s("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),s("div",Mo,[(y(!0),g(K,null,Q(z.value,(b,u)=>(y(),g("p",{key:u,innerHTML:b},null,8,Bo))),128))])])])]),s("div",Oo,[W[10]||(W[10]=s("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),s("div",xo,[s("table",Ro,[s("thead",null,[s("tr",null,[W[6]||(W[6]=s("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(y(!0),g(K,null,Q(a.value,b=>(y(),g("th",{key:`week-${b}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+w(b),1))),128))])]),s("tbody",null,[s("tr",Po,[W[7]||(W[7]=s("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(y(!0),g(K,null,Q(a.value,b=>(y(),g("td",{key:`new-${b}`,class:"week-data-cell"},w(q("new",b)),1))),128))]),s("tr",Lo,[W[8]||(W[8]=s("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(y(!0),g(K,null,Q(a.value,b=>(y(),g("td",{key:`closed-${b}`,class:"week-data-cell"},w(q("closed",b)),1))),128))]),s("tr",Go,[W[9]||(W[9]=s("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(y(!0),g(K,null,Q(a.value,b=>(y(),g("td",{key:`carryover-${b}`,class:"week-data-cell"},w(q("carryover",b)),1))),128))])])])])])]))}},Vo=he(Fo,[["__scopeId","data-v-31a3d565"]]),Ho={class:"months-preloader"},Yo={class:"preloader-content"},zo={class:"progress-container"},jo={class:"progress-bar"},qo={class:"progress-text"},Zo={class:"preloader-message"},Xo={class:"stages-list"},Jo={class:"stage-icon"},Ko={class:"stage-text"},Qo={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:r=>r>=0&&r<=100},currentStage:{type:String,default:""}},setup(r){const t=r,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function a(l){return t.progress>=e[l].threshold}function n(l){const c=e[l].threshold,v=l>0?e[l-1].threshold:0;return t.progress>=v&&t.progress<c}return(l,c)=>(y(),g("div",Ho,[s("div",Yo,[c[0]||(c[0]=zt('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),s("div",zo,[s("div",jo,[s("div",{class:"progress-fill",style:_e({width:`${r.progress}%`})},null,4)]),s("div",qo,w(Math.round(r.progress))+"%",1)]),s("p",Zo,w(r.currentStage),1),s("div",Xo,[(y(),g(K,null,Q(e,(v,m)=>s("div",{key:m,class:te(["stage-item",{"stage-completed":a(m),"stage-current":n(m)}])},[s("span",Jo,w(a(m)?"‚úì":n(m)?"‚Üí":"‚óã"),1),s("span",Ko,w(v.label),1)],2)),64))])])]))}},en=he(Qo,[["__scopeId","data-v-b571fe67"]]),tn="/api/graph-1c-admission-closure.php";function sn(r){var a,n,l,c,v,m,f,A,x,z,q,S,W,b,u,h,$,E,D,U,P,N,I,M,G,R,X,i,o,p,T,_,k,d,O,F,C,L,B,j,re,ce,de,ue,ve,ke,fe,pe,ge,be,we,Te,Ce;if(!r)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},weeksData:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=r.data||r.result||r,e=t.meta||r.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((a=t.data)==null?void 0:a.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0}),newTickets:((l=(n=t.data)==null?void 0:n.currentWeek)==null?void 0:l.newTickets)??((c=t.data)==null?void 0:c.newTickets)??t.newTickets??0,closedTickets:((m=(v=t.data)==null?void 0:v.currentWeek)==null?void 0:m.closedTickets)??((f=t.data)==null?void 0:f.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((x=(A=t.data)==null?void 0:A.currentWeek)==null?void 0:x.closedTicketsCreatedThisWeek)??((z=t.data)==null?void 0:z.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((S=(q=t.data)==null?void 0:q.currentWeek)==null?void 0:S.closedTicketsCreatedOtherWeek)??((W=t.data)==null?void 0:W.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((u=(b=t.data)==null?void 0:b.currentWeek)==null?void 0:u.carryoverTickets)??((h=t.data)==null?void 0:h.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((E=($=t.data)==null?void 0:$.currentWeek)==null?void 0:E.carryoverTicketsCreatedThisWeek)??((D=t.data)==null?void 0:D.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((P=(U=t.data)==null?void 0:U.currentWeek)==null?void 0:P.carryoverTicketsCreatedOtherWeek)??((N=t.data)==null?void 0:N.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,series:{new:((M=(I=t.data)==null?void 0:I.series)==null?void 0:M.new)??((G=t.series)==null?void 0:G.new)??[0],closed:((X=(R=t.data)==null?void 0:R.series)==null?void 0:X.closed)??((i=t.series)==null?void 0:i.closed)??[0],closedCreatedThisWeek:((p=(o=t.data)==null?void 0:o.series)==null?void 0:p.closedCreatedThisWeek)??((T=t.series)==null?void 0:T.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((k=(_=t.data)==null?void 0:_.series)==null?void 0:k.closedCreatedOtherWeek)??((d=t.series)==null?void 0:d.closedCreatedOtherWeek)??[0],carryover:((F=(O=t.data)==null?void 0:O.series)==null?void 0:F.carryover)??((C=t.series)==null?void 0:C.carryover)??[0],carryoverCreatedThisWeek:((B=(L=t.data)==null?void 0:L.series)==null?void 0:B.carryoverCreatedThisWeek)??((j=t.series)==null?void 0:j.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((ce=(re=t.data)==null?void 0:re.series)==null?void 0:ce.carryoverCreatedOtherWeek)??((de=t.series)==null?void 0:de.carryoverCreatedOtherWeek)??[0]},weeksData:((ue=t.data)==null?void 0:ue.weeksData)??t.weeksData??[],stages:((ve=t.data)==null?void 0:ve.stages)??t.stages??[],responsible:((ke=t.data)==null?void 0:ke.responsible)??t.responsible??[],responsibleCreatedThisWeek:((fe=t.data)==null?void 0:fe.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((pe=t.data)==null?void 0:pe.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((ge=t.data)==null?void 0:ge.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((be=t.data)==null?void 0:be.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((we=t.data)==null?void 0:we.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((Te=t.data)==null?void 0:Te.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ce=t.data)==null?void 0:Ce.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function $e(r={}){const{endpoint:t=tn,product:e="1C",weekStartUtc:a=null,weekEndUtc:n=null,periodMode:l="weeks",useCache:c=!0,forceRefresh:v=!1,includeTickets:m=!1,includeNewTicketsByStages:f=!1,includeCarryoverTickets:A=!0,includeCarryoverTicketsByDuration:x=!1}=r,z={product:e,weekStartUtc:a,weekEndUtc:n,periodMode:l,useCache:c,forceRefresh:v,includeTickets:m,includeNewTicketsByStages:f,includeCarryoverTickets:A,includeCarryoverTicketsByDuration:x},q=jt(t),S=await fetch(q,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(z)});if(!S.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${S.status})`);const W=await S.json();if((W==null?void 0:W.success)===!1)throw new Error(W.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return sn(W)}const an={class:"ac-dashboard-months"},rn={key:"content"},on={class:"dashboard-header"},nn={class:"header-content"},ln={class:"breadcrumbs-row"},cn=["aria-label","aria-disabled","data-fallback","disabled"],dn={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},un={class:"dashboard-layout"},vn={class:"filters-container"},kn={class:"chart-container"},hn={__name:"GraphAdmissionClosureMonthsDashboard",setup(r){const t=bt(),e=V(!0),a=V(0),n=V("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),l=V(null),c=V(null),v=V({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),m=V(!1),f=Y(()=>typeof window>"u"?!1:window.history.length>1),A=Y(()=>f.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),x={name:"dashboard-sector-1c"};function z(N){var I;if((I=N==null?void 0:N.preventDefault)==null||I.call(N),!m.value){m.value=!0;try{if(f.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(x)}finally{m.value=!1}}}const q=V({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),S=Y(()=>{const N=q.value.customDateRange.startDate||q.value.customDateRange.endDate,I=q.value.employees.length===1&&q.value.employees.includes("all");return N||!I});async function W(N,I,M=500){const G=a.value,R=10,X=(N-G)/R,i=M/R;for(let o=0;o<R;o++)await new Promise(p=>setTimeout(p,i)),a.value=Math.min(G+X*(o+1),N);a.value=N,n.value=I}async function b(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,a.value=0,n.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let N=null,I=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await W(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const M=Date.now(),G=2e4;N=setInterval(()=>{const o=Date.now()-M,p=Math.min(5+o/G*85,90);a.value=p,p<35?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":p<65?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":p<85?n.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":n.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),I=setTimeout(()=>{N&&(clearInterval(N),N=null)},G+1e4);const R=await $e({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(I),N&&(clearInterval(N),N=null),a.value=90,n.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await W(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",R);const{meta:X,data:i}=R;c.value=X,v.value=i,console.log("[DEBUG MonthsDashboard] Data set, meta:",X,"data keys:",Object.keys(i)),await new Promise(o=>setTimeout(o,200))}catch(M){N&&(clearInterval(N),N=null),I&&(clearTimeout(I),I=null),console.error("[DEBUG MonthsDashboard] API call failed:",M),l.value=M instanceof Error?M:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",M),a.value=100,n.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function u(N){q.value.stages=N}function h(N){q.value.employees=N}function $(N){q.value.dateRange=N}function E(N){q.value.customDateRange=N}function D(){q.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},U()}function U(){b()}function P(N){if(!["weeks","months"].includes(N)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",N);return}N==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:N}}))}return ze(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),b()}),(N,I)=>{const M=wt("router-link");return y(),g("div",an,[J(ne,{name:"fade",mode:"out-in"},{default:ee(()=>[e.value?(y(),ie(en,{key:"preloader",progress:a.value,"current-stage":n.value},null,8,["progress","current-stage"])):(y(),g("div",rn,[s("div",on,[s("div",nn,[s("div",ln,[s("button",{class:"btn-back-link",type:"button",onClick:z,"aria-label":A.value,"aria-disabled":!f.value,"data-fallback":!f.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,cn),s("nav",dn,[J(M,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ee(()=>[...I[0]||(I[0]=[le(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),I[2]||(I[2]=s("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),J(M,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ee(()=>[...I[1]||(I[1]=[le(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),I[3]||(I[3]=s("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),I[4]||(I[4]=s("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),I[5]||(I[5]=s("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),I[6]||(I[6]=s("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),s("div",un,[s("div",vn,[J(Ct,{stages:q.value.stages,employees:q.value.employees,dateRange:q.value.dateRange,customDateRange:q.value.customDateRange,hasActiveFilters:S.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":u,"onUpdate:employees":h,"onUpdate:dateRange":$,"onUpdate:customDateRange":E,"onUpdate:periodMode":P,onReset:D,onApply:U},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),s("div",kn,[l.value?(y(),ie(Tt,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(y(),g(K,{key:1},[J(Hr,{data:v.value},null,8,["data"]),J(Vo,{data:v.value,meta:c.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},mn=he(hn,[["__scopeId","data-v-fe3ca7ed"]]);class Ye{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const a=await this.getEmployeesByIds(e);return console.log("Loaded employees:",a.length),{stages:this.groupTicketsByStages(t,a),employees:a,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const a of t){console.log(`Loading tickets for stage: ${a}`);const n=await this.getTicketsByStage(a);e.push(...n),console.log(`Loaded ${n.length} tickets for stage ${a}`)}return e}static async getTicketsByStage(t){const e=[];let a=0;const n=50;let l=!0;for(;l;)try{const v=await We.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:a,useOriginalUfNames:"Y"});let m=[];v&&v.result&&(Array.isArray(v.result)?m=v.result:v.result.items&&Array.isArray(v.result.items)?m=v.result.items:v.result.data&&Array.isArray(v.result.data)&&(m=v.result.data)),m.length>0?(e.push(...m),a+=m.length,l=m.length===n):l=!1}catch(v){console.error(`Error loading tickets batch for stage ${t} (start: ${a}):`,v),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const c=e.filter(v=>{const m=v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product||v.ufCrm7TypeProduct||v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product;return Array.isArray(m)?m.includes(this.SECTOR_TAG):typeof m=="object"&&m!==null?m.value===this.SECTOR_TAG||m===this.SECTOR_TAG:m===this.SECTOR_TAG});return console.log(`Filtered ${c.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),c}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(a=>{const n=a.assignedById||a.assignedByIdId||a.ASSIGNED_BY_ID||a.assignedById||a.assignedById&&typeof a.assignedById=="object"&&(a.assignedById.id||a.assignedById.ID)||a.assignedById&&typeof a.assignedById=="object"&&a.assignedById.value;if(n){const l=parseInt(n);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await We.call("user.get",{filter:{ID:t}});let a=[];return e&&e.result&&(Array.isArray(e.result)?a=e.result:console.warn("Unexpected user.get result format:",e)),a.map(n=>({id:parseInt(n.ID||n.id||0),name:`${n.NAME||n.name||""} ${n.LAST_NAME||n.lastName||""}`.trim()||n.EMAIL||n.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:n.WORK_POSITION||n.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:n.EMAIL||n.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const a=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(n=>({...n,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(n=>({...n,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(n=>({...n,tickets:[]}))}];return t.forEach(n=>{const l=this.mapStageId(n.stageId||n.STAGE_ID||""),c=a.find(v=>v.id===l);if(c){const v=n.assignedById||n.ASSIGNED_BY_ID||null,m=v?parseInt(v):null;if(m){let f=c.employees.find(A=>A.id===m);f||(f={id:m,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${m}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},c.employees.push(f)),f.tickets.push(this.mapTicket(n))}}}),a}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),a=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",n=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,c=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",v=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",m=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,f=ht(m),A=Xt(f);return{id:e,title:a,priorityId:f.id,priorityLabel:f.label,priorityColors:A,priority:f.id,priorityBitrixValue:f.bitrixValue||null,status:this.mapStatus(n),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(n),createdAt:c,modifiedAt:v,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return ht(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=mt(t);if(e&&e.bitrixValue)return e.bitrixValue;const a={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return a[t]?a[t]:mt(Jt).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(a=>!(a.assignedById||a.ASSIGNED_BY_ID)).forEach(a=>{const n=this.mapStageId(a.stageId||a.STAGE_ID||"");e[n]&&e[n].push(this.mapTicket(a))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,a){try{const n=this.mapStageIdToBitrix(a);return(await We.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:n}})).result===!0}catch(n){throw console.error("Error assigning ticket:",n),n}}static async createTicket(t){try{const e=await We.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await We.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await We.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(a){throw console.error("Error adding comment:",a),a}}}Fe(Ye,"ENTITY_TYPE_ID",140),Fe(Ye,"SECTOR_TAG","1C");const yn={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},_n={class:"modal"},fn={key:0,class:"modal__tabs"},pn={key:"level-0-categories",class:"level-0"},gn={class:"modal__header"},bn={class:"modal__title"},wn={key:0},Tn={class:"modal__body"},Cn={class:"categories-list"},$n=["onClick"],Wn={class:"category-item"},Dn={class:"category-item__icon"},En={key:0},An={key:1},Nn={class:"category-item__content"},Sn={class:"category-item__label"},Un={class:"category-item__count"},In={key:0,class:"category-item__arrow"},Mn={class:"modal__footer"},Bn={key:"level-1-categories",class:"level-1"},On={class:"modal__header"},xn={class:"modal__body"},Rn={key:"loading",class:"loading-names"},Pn={key:"empty",class:"modal__empty"},Ln={key:"list",class:"responsible-list"},Gn=["onClick"],Fn={class:"responsible-list__name"},Vn={class:"responsible-list__count"},Hn={key:0,class:"responsible-list__arrow"},Yn={class:"modal__footer"},zn={key:"level-2-categories",class:"level-2"},jn={class:"modal__header"},qn={class:"modal__title"},Zn={class:"modal__body"},Xn={key:"loading",class:"loading-state"},Jn={key:"error",class:"error-state"},Kn={class:"error-message"},Qn={key:"empty",class:"empty-state"},el={key:"tickets",class:"tickets-list-container"},tl={key:"level-0-employees",class:"level-0"},sl={class:"modal__header"},al={class:"modal__title"},rl={key:0},ol={class:"modal__body"},nl={key:"loading",class:"loading-names"},ll={key:"empty",class:"modal__empty"},il={key:"list",class:"responsible-list"},cl=["onClick"],dl={class:"responsible-list__name"},ul={class:"responsible-list__count"},vl={key:0,class:"responsible-list__arrow"},kl={class:"modal__footer"},hl={key:"level-1-employees",class:"level-1"},ml={class:"modal__header"},yl={class:"modal__title"},_l={class:"modal__body"},fl={class:"categories-list"},pl=["onClick"],gl={class:"category-item"},bl={class:"category-item__icon"},wl={key:0},Tl={key:1},Cl={class:"category-item__content"},$l={class:"category-item__label"},Wl={class:"category-item__count"},Dl={key:0,class:"category-item__arrow"},El={class:"modal__footer"},Al={key:"level-2-employees",class:"level-2"},Nl={class:"modal__header"},Sl={class:"modal__title"},Ul={class:"modal__body"},Il={key:"loading",class:"loading-state"},Ml={key:"error",class:"error-state"},Bl={class:"error-message"},Ol={key:"empty",class:"empty-state"},xl={class:"empty-state-message"},Rl={key:"tickets",class:"tickets-list-container"},Pl={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(r){const t=r,e=V(0),a=V("categories"),n=V(null),l=V(null),c=V(null),v=V([]),m=V(!1),f=V(null),A=V([]),x=V([]),z=V(!1),q=Y(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),S=Y(()=>{const i=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(o=>{const p=o.id??"unassigned";i.has(p)||i.set(p,{id:o.id,name:o.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const T=i.get(p);T.thisWeekCount=o.count??0,T.thisWeekTickets=o.tickets||[],T.totalCount+=T.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(o=>{const p=o.id??"unassigned";i.has(p)||i.set(p,{id:o.id,name:o.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const T=i.get(p);T.otherWeekCount=o.count??0,T.otherWeekTickets=o.tickets||[],T.totalCount+=T.otherWeekCount}),Array.from(i.values())}),W=Y(()=>{if(!l.value)return[];const i=l.value.thisWeekTickets||[],o=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:i.length,otherWeekTickets:o.length,employee:l.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.thisWeekCount??0,tickets:i,employeeId:l.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:l.value.otherWeekCount??0,tickets:o,employeeId:l.value.id}]}),b=Y(()=>(x.value||[]).length>0);async function u(i){const o=i.filter(p=>p.id!==null&&p.id!==void 0).map(p=>p.id);if(o.length===0)return i;try{const p=await Ye.getEmployeesByIds(o),T=new Map;return p.forEach(_=>{T.set(_.id,_.name)}),i.map(_=>_.id&&T.has(_.id)?{..._,name:T.get(_.id)}:_)}catch(p){return console.error("[ResponsibleModal] Error enriching names:",p),i}}ye([()=>a.value,()=>S.value],async([i,o])=>{if(!(i!=="employees"||e.value!==0)){if(!o||o.length===0){x.value=[];return}z.value=!0;try{x.value=await u(o)}catch(p){console.error("[ResponsibleModal] Error loading employee names:",p),x.value=o}finally{z.value=!1}}},{immediate:!0}),ye(()=>t.responsible,async i=>{if(!(e.value!==0||n.value||a.value!=="categories")){if(!i||i.length===0){A.value=[];return}z.value=!0;try{A.value=await u(i)}catch(o){console.error("[ResponsibleModal] Error loading employee names:",o),A.value=i}finally{z.value=!1}}},{immediate:!1});const h=Y(()=>(A.value||[]).length>0);function $(i){a.value!==i&&(a.value=i,e.value=0,n.value=null,l.value=null,c.value=null,v.value=[],f.value=null,A.value=[],x.value=[])}async function E(i){if(!(!i||i.count===0)){n.value=i,e.value=1,z.value=!0;try{A.value=await u(i.responsible)}catch(o){console.error("[ResponsibleModal] Error loading employee names:",o),A.value=i.responsible}finally{z.value=!1}}}async function D(i,o=null){var p,T;!i||!i.id||i.totalCount===0||(o&&o.currentTarget&&(o.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{o.currentTarget&&(o.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:i.id,name:i.name,thisWeekCount:i.thisWeekCount,otherWeekCount:i.otherWeekCount,thisWeekTickets:((p=i.thisWeekTickets)==null?void 0:p.length)||0,otherWeekTickets:((T=i.otherWeekTickets)==null?void 0:T.length)||0,employee:i}),l.value={...i,thisWeekTickets:i.thisWeekTickets||[],otherWeekTickets:i.otherWeekTickets||[]},e.value=1)}async function U(i){var p;if(!i||i.count===0)return;c.value=i,e.value=2;const o=i.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:i.id,label:i.label,count:i.count,ticketsInGradation:o.length,selectedEmployee:(p=l.value)==null?void 0:p.id}),o.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",o.length),await P(o)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await N(i))}async function P(i){m.value=!0,f.value=null;try{try{const{prepareTicketsForDisplay:o}=await Se(async()=>{const{prepareTicketsForDisplay:p}=await import("./ticketListUtils-Di3XI8Sv.js").then(T=>T.t);return{prepareTicketsForDisplay:p}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);v.value=await o(i,null,null)}catch(o){console.error("[ResponsibleModal] Error preparing tickets:",o),v.value=i}v.value.length===0&&(f.value=null)}catch(o){f.value=o.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",o),v.value=[]}finally{m.value=!1}}async function N(i){m.value=!0,f.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const o=await $e({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),p=i.id==="this-week"?o.data.responsibleCreatedThisWeek:o.data.responsibleCreatedOtherWeek,T=p==null?void 0:p.find(k=>k.id===l.value.id),_=(T==null?void 0:T.tickets)||[];try{const{prepareTicketsForDisplay:k}=await Se(async()=>{const{prepareTicketsForDisplay:d}=await import("./ticketListUtils-Di3XI8Sv.js").then(O=>O.t);return{prepareTicketsForDisplay:d}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);v.value=await k(_,null,null)}catch(k){console.error("[ResponsibleModal] Error preparing tickets:",k),v.value=_}v.value.length===0&&(f.value=null)}catch(o){f.value=o.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",o),v.value=[]}finally{m.value=!1}}async function I(i,o=null){!i||!i.id||i.count===0||(o&&o.currentTarget&&(o.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{o.currentTarget&&(o.currentTarget.style.transform="")},150)),l.value=i,e.value=2,await M(i.id))}async function M(i){var o;m.value=!0,f.value=null;try{let p=[];if(n.value&&n.value.responsible){const T=n.value.responsible.find(_=>_.id===i);p=(T==null?void 0:T.tickets)||[]}if(p.length===0&&t.weekStartUtc&&t.weekEndUtc){const T=await $e({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),_=((o=n.value)==null?void 0:o.id)==="created-this-week"?T.data.responsibleCreatedThisWeek:T.data.responsibleCreatedOtherWeek,k=_==null?void 0:_.find(d=>d.id===i);p=(k==null?void 0:k.tickets)||[]}try{const{prepareTicketsForDisplay:T}=await Se(async()=>{const{prepareTicketsForDisplay:_}=await import("./ticketListUtils-Di3XI8Sv.js").then(k=>k.t);return{prepareTicketsForDisplay:_}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);v.value=await T(p,null,null)}catch(T){console.error("[ResponsibleModal] Error preparing tickets:",T),v.value=p}v.value.length===0&&(f.value=null)}catch(p){f.value=p.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",p),v.value=[]}finally{m.value=!1}}function G(){e.value===2?(e.value=1,a.value==="categories"?l.value=null:c.value=null,v.value=[],f.value=null):e.value===1&&(e.value=0,a.value==="categories"?(n.value=null,A.value=[]):l.value=null)}function R(i){const o=je(i.id);window.open(o,"_blank")}function X(){a.value==="employees"&&c.value?P(c.value.tickets):a.value==="categories"&&l.value&&M(l.value.id)}return ye(()=>t.isVisible,i=>{i||(e.value=0,a.value="categories",n.value=null,l.value=null,c.value=null,v.value=[],f.value=null,A.value=[],x.value=[])}),(i,o)=>r.isVisible?(y(),g("div",yn,[s("div",_n,[e.value===0?(y(),g("div",fn,[s("button",{class:te(["modal__tab",{"modal__tab--active":a.value==="categories"}]),onClick:o[0]||(o[0]=p=>$("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),s("button",{class:te(["modal__tab",{"modal__tab--active":a.value==="employees"}]),onClick:o[1]||(o[1]=p=>$("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):Z("",!0),J(ne,{name:"level",mode:"out-in"},{default:ee(()=>{var p,T,_,k;return[a.value==="categories"&&e.value===0?(y(),g("div",pn,[s("header",gn,[s("h3",bn,[o[12]||(o[12]=le(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r.weekNumber?(y(),g("span",wn," ¬∑ –ù–µ–¥–µ–ª—è "+w(r.weekNumber),1)):Z("",!0)]),s("button",{class:"modal__close",onClick:o[2]||(o[2]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",Tn,[s("ul",Cn,[(y(!0),g(K,null,Q(q.value,d=>(y(),g("li",{key:d.id,class:te(["categories-list__item",{"categories-list__item--clickable":d.count>0}]),onClick:O=>E(d)},[s("div",Wn,[s("div",Dn,[d.id==="created-this-week"?(y(),g("span",En,"‚úì")):(y(),g("span",An,"‚Üª"))]),s("div",Nn,[s("div",Sn,w(d.label),1),s("div",Un,w(d.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),d.count>0?(y(),g("span",In,"‚Üí")):Z("",!0)])],10,$n))),128))])]),s("footer",Mn,[s("button",{class:"btn",onClick:o[3]||(o[3]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===1?(y(),g("div",Bn,[s("header",On,[s("button",{class:"btn-back",onClick:G,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o[13]||(o[13]=s("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),s("button",{class:"modal__close",onClick:o[4]||(o[4]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",xn,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>[z.value?(y(),g("div",Rn,[...o[14]||(o[14]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):h.value?(y(),g("ul",Ln,[(y(!0),g(K,null,Q(A.value,d=>(y(),g("li",{key:d.id||d.name,class:te(["responsible-list__item",{"responsible-list__item--clickable":d.id&&d.count>0}]),onClick:O=>I(d,O),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[s("span",Fn,w(d.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),s("span",Vn,w(d.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),d.id&&d.count>0?(y(),g("span",Hn,"‚Üí")):Z("",!0)],10,Gn))),128))])):(y(),g("p",Pn,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),s("footer",Yn,[s("button",{class:"btn",onClick:o[5]||(o[5]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="categories"&&e.value===2?(y(),g("div",zn,[s("header",jn,[s("button",{class:"btn-back",onClick:G,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),s("h3",qn,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+w(((p=l.value)==null?void 0:p.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),s("button",{class:"modal__close",onClick:o[6]||(o[6]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",Zn,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>[m.value?(y(),g("div",Xn,[...o[15]||(o[15]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(y(),g("div",Jn,[o[16]||(o[16]=s("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),o[17]||(o[17]=s("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),s("p",Kn,w(f.value),1),s("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(y(),g("div",Qn,[...o[18]||(o[18]=[s("div",{class:"empty-state-icon"},"üìã",-1),s("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(y(),g("div",el,[J(Le,{name:"ticket",tag:"div",class:"tickets-list"},{default:ee(()=>[(y(!0),g(K,null,Q(v.value,(d,O)=>(y(),ie(Ge,{key:d.id,ticket:d,draggable:!1,style:_e({"--ticket-index":O}),onClick:R},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):a.value==="employees"&&e.value===0?(y(),g("div",tl,[s("header",sl,[s("h3",al,[o[19]||(o[19]=le(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),r.weekNumber?(y(),g("span",rl," ¬∑ –ù–µ–¥–µ–ª—è "+w(r.weekNumber),1)):Z("",!0)]),s("button",{class:"modal__close",onClick:o[7]||(o[7]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",ol,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>[z.value?(y(),g("div",nl,[...o[20]||(o[20]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):b.value?(y(),g("ul",il,[(y(!0),g(K,null,Q(x.value,d=>(y(),g("li",{key:d.id||d.name,class:te(["responsible-list__item",{"responsible-list__item--clickable":d.id&&d.totalCount>0}]),onClick:O=>D(d,O),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[s("span",dl,w(d.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),s("span",ul,w(d.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),d.id&&d.totalCount>0?(y(),g("span",vl,"‚Üí")):Z("",!0)],10,cl))),128))])):(y(),g("p",ll,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),s("footer",kl,[s("button",{class:"btn",onClick:o[8]||(o[8]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===1?(y(),g("div",hl,[s("header",ml,[s("button",{class:"btn-back",onClick:G,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),s("h3",yl,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+w(((T=l.value)==null?void 0:T.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),s("button",{class:"modal__close",onClick:o[9]||(o[9]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",_l,[s("ul",fl,[(y(!0),g(K,null,Q(W.value,d=>(y(),g("li",{key:d.id,class:te(["categories-list__item",{"categories-list__item--clickable":d.count>0}]),onClick:O=>U(d)},[s("div",gl,[s("div",bl,[d.id==="this-week"?(y(),g("span",wl,"‚úì")):(y(),g("span",Tl,"‚Üª"))]),s("div",Cl,[s("div",$l,w(d.label),1),s("div",Wl,w(d.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),d.count>0?(y(),g("span",Dl,"‚Üí")):Z("",!0)])],10,pl))),128))])]),s("footer",El,[s("button",{class:"btn",onClick:o[10]||(o[10]=d=>i.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value==="employees"&&e.value===2?(y(),g("div",Al,[s("header",Nl,[s("button",{class:"btn-back",onClick:G,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),s("h3",Sl," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+w(((_=l.value)==null?void 0:_.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+w(((k=c.value)==null?void 0:k.label)||"")+") ",1),s("button",{class:"modal__close",onClick:o[11]||(o[11]=d=>i.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",Ul,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>{var d;return[m.value?(y(),g("div",Il,[...o[21]||(o[21]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(y(),g("div",Ml,[o[22]||(o[22]=s("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),o[23]||(o[23]=s("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),s("p",Bl,w(f.value),1),s("button",{class:"btn btn-retry",onClick:X},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(y(),g("div",Ol,[o[24]||(o[24]=s("div",{class:"empty-state-icon"},"üìã",-1)),s("p",xl,w(a.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((d=c.value)==null?void 0:d.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(y(),g("div",Rl,[J(Le,{name:"ticket",tag:"div",class:"tickets-list"},{default:ee(()=>[(y(!0),g(K,null,Q(v.value,(O,F)=>(y(),ie(Ge,{key:O.id,ticket:O,draggable:!1,style:_e({"--ticket-index":F}),onClick:R},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},Ll=he(Pl,[["__scopeId","data-v-3b229bb4"]]),Gl={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Fl={class:"modal"},Vl={key:"level-1",class:"level-1"},Hl={class:"modal__header"},Yl={class:"modal__title"},zl={key:0},jl={class:"modal__body"},ql={key:"loading",class:"loading-names"},Zl={key:"empty",class:"modal__empty"},Xl={key:"list",class:"stages-list"},Jl=["onClick"],Kl={class:"stages-list__name"},Ql={class:"stages-list__count"},ei={key:0,class:"stages-list__arrow"},ti={class:"modal__footer"},si={key:"level-2",class:"level-2"},ai={class:"modal__header"},ri={class:"modal__title"},oi={class:"modal__body"},ni={key:"loading",class:"loading-state"},li={key:"error",class:"error-state"},ii={class:"error-message"},ci={key:"empty",class:"empty-state"},di={class:"empty-state-message"},ui={key:"tickets",class:"tickets-list-container"},vi={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(r,{emit:t}){const e=r,a=V(1),n=V(null),l=V([]),c=V(!1),v=V(!1),m=V(null),f=V([]),A=Y(()=>f.value.length>0&&f.value.some(u=>u.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}v.value=!0,m.value=null;try{const u=await $e({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});f.value=u.data.newTicketsByStages||[]}catch(u){m.value=u.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",u),f.value=[]}finally{v.value=!1}}async function z(u,h=null){!u||u.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),n.value=u,a.value=2,await q(u.stageId))}async function q(u){var h;c.value=!0,m.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const E=(h=(await $e({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:h.find(U=>U.stageId===u),D=(E==null?void 0:E.tickets)||[];try{const{prepareTicketsForDisplay:U}=await Se(async()=>{const{prepareTicketsForDisplay:P}=await import("./ticketListUtils-Di3XI8Sv.js").then(N=>N.t);return{prepareTicketsForDisplay:P}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await U(D,null,null)}catch(U){console.error("[StagesModal] Error preparing tickets:",U),l.value=D}l.value.length===0&&(m.value=null)}catch($){m.value=$.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",$),l.value=[]}finally{c.value=!1}}function S(){a.value=1,n.value=null,l.value=[],m.value=null}function W(u){const h=je(u.id);window.open(h,"_blank")}function b(){n.value&&q(n.value.stageId)}return ye(()=>e.isVisible,u=>{u?x():(a.value=1,n.value=null,l.value=[],m.value=null,f.value=[])}),ye([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(u,h)=>r.isVisible?(y(),g("div",Gl,[s("div",Fl,[J(ne,{name:"level",mode:"out-in"},{default:ee(()=>{var $;return[a.value===1?(y(),g("div",Vl,[s("header",Hl,[s("h3",Yl,[h[3]||(h[3]=le(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),r.weekNumber?(y(),g("span",zl," ¬∑ –ù–µ–¥–µ–ª—è "+w(r.weekNumber),1)):Z("",!0)]),s("button",{class:"modal__close",onClick:h[0]||(h[0]=E=>u.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",jl,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>[v.value?(y(),g("div",ql,[...h[4]||(h[4]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):A.value?(y(),g("ul",Xl,[(y(!0),g(K,null,Q(f.value,E=>(y(),g("li",{key:E.stageId,class:te(["stages-list__item",{"stages-list__item--clickable":E.count>0}]),style:_e({"--stage-color":E.color}),onClick:D=>z(E,D),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[s("span",{class:"stages-list__color",style:_e({backgroundColor:E.color})},null,4),s("span",Kl,w(E.stageName),1),s("span",Ql,w(E.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),E.count>0?(y(),g("span",ei,"‚Üí")):Z("",!0)],14,Jl))),128))])):(y(),g("p",Zl," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),s("footer",ti,[s("button",{class:"btn",onClick:h[1]||(h[1]=E=>u.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(y(),g("div",si,[s("header",ai,[s("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),s("h3",ri," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+w((($=n.value)==null?void 0:$.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),s("button",{class:"modal__close",onClick:h[2]||(h[2]=E=>u.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",oi,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>{var E;return[c.value?(y(),g("div",ni,[...h[5]||(h[5]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(y(),g("div",li,[h[6]||(h[6]=s("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=s("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),s("p",ii,w(m.value),1),s("button",{class:"btn btn-retry",onClick:b},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(y(),g("div",ci,[h[8]||(h[8]=s("div",{class:"empty-state-icon"},"üìã",-1)),s("p",di," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+w((E=n.value)==null?void 0:E.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(y(),g("div",ui,[J(Le,{name:"ticket",tag:"div",class:"tickets-list"},{default:ee(()=>[(y(!0),g(K,null,Q(l.value,(D,U)=>(y(),ie(Ge,{key:D.id,ticket:D,draggable:!1,style:_e({"--ticket-index":U}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},ki=he(vi,[["__scopeId","data-v-4af0cfce"]]),hi={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},mi={class:"modal"},yi={key:"level-1",class:"level-1"},_i={class:"modal__header"},fi={class:"modal__title"},pi={key:0},gi={class:"modal__body"},bi={key:"loading",class:"loading-names"},wi={key:"empty",class:"modal__empty"},Ti={key:"list",class:"duration-list"},Ci=["onClick"],$i={class:"duration-list__name"},Wi={class:"duration-list__count"},Di={key:0,class:"duration-list__arrow"},Ei={class:"modal__footer"},Ai={key:"level-2",class:"level-2"},Ni={class:"modal__header"},Si={class:"modal__title"},Ui={class:"modal__body"},Ii={key:"loading",class:"loading-state"},Mi={key:"error",class:"error-state"},Bi={class:"error-message"},Oi={key:"empty",class:"empty-state"},xi={class:"empty-state-message"},Ri={key:"tickets",class:"tickets-list-container"},Pi={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(r,{emit:t}){const e=r,a=V(1),n=V(null),l=V([]),c=V(!1),v=V(!1),m=V(null),f=V([]),A=Y(()=>f.value.length>0&&f.value.some(u=>u.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}v.value=!0,m.value=null;try{const u=await $e({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});f.value=u.data.carryoverTicketsByDuration||[]}catch(u){m.value=u.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",u),f.value=[]}finally{v.value=!1}}async function z(u,h=null){!u||u.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),n.value=u,a.value=2,await q(u.durationCategory))}async function q(u){var h;c.value=!0,m.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const E=(h=(await $e({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:h.find(U=>U.durationCategory===u),D=(E==null?void 0:E.tickets)||[];try{const{prepareTicketsForDisplay:U}=await Se(async()=>{const{prepareTicketsForDisplay:P}=await import("./ticketListUtils-Di3XI8Sv.js").then(N=>N.t);return{prepareTicketsForDisplay:P}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await U(D,null,null)}catch(U){console.error("[CarryoverDurationModal] Error preparing tickets:",U),l.value=D}l.value.length===0&&(m.value=null)}catch($){m.value=$.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",$),l.value=[]}finally{c.value=!1}}function S(){a.value=1,n.value=null,l.value=[],m.value=null}function W(u){const h=je(u.id);window.open(h,"_blank")}function b(){n.value&&q(n.value.durationCategory)}return ye(()=>e.isVisible,u=>{u?x():(a.value=1,n.value=null,l.value=[],m.value=null,f.value=[])}),ye([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(u,h)=>r.isVisible?(y(),g("div",hi,[s("div",mi,[J(ne,{name:"level",mode:"out-in"},{default:ee(()=>{var $;return[a.value===1?(y(),g("div",yi,[s("header",_i,[s("h3",fi,[h[3]||(h[3]=le(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),r.weekNumber?(y(),g("span",pi," ¬∑ –ù–µ–¥–µ–ª—è "+w(r.weekNumber),1)):Z("",!0)]),s("button",{class:"modal__close",onClick:h[0]||(h[0]=E=>u.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",gi,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>[v.value?(y(),g("div",bi,[...h[4]||(h[4]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):A.value?(y(),g("ul",Ti,[(y(!0),g(K,null,Q(f.value,E=>(y(),g("li",{key:E.durationCategory,class:te(["duration-list__item",{"duration-list__item--clickable":E.count>0}]),style:_e({"--duration-color":E.color}),onClick:D=>z(E,D),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[s("span",{class:"duration-list__color",style:_e({backgroundColor:E.color})},null,4),s("span",$i,w(E.durationLabel),1),s("span",Wi,w(E.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),E.count>0?(y(),g("span",Di,"‚Üí")):Z("",!0)],14,Ci))),128))])):(y(),g("p",wi," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),s("footer",Ei,[s("button",{class:"btn",onClick:h[1]||(h[1]=E=>u.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):a.value===2?(y(),g("div",Ai,[s("header",Ni,[s("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),s("h3",Si," –¢–∏–∫–µ—Ç—ã: "+w((($=n.value)==null?void 0:$.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),s("button",{class:"modal__close",onClick:h[2]||(h[2]=E=>u.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),s("section",Ui,[J(ne,{name:"loading",mode:"out-in"},{default:ee(()=>{var E;return[c.value?(y(),g("div",Ii,[...h[5]||(h[5]=[s("div",{class:"loading-spinner"},null,-1),s("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(y(),g("div",Mi,[h[6]||(h[6]=s("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=s("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),s("p",Bi,w(m.value),1),s("button",{class:"btn btn-retry",onClick:b},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):l.value.length===0?(y(),g("div",Oi,[h[8]||(h[8]=s("div",{class:"empty-state-icon"},"üìã",-1)),s("p",xi," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+w((E=n.value)==null?void 0:E.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(y(),g("div",Ri,[J(Le,{name:"ticket",tag:"div",class:"tickets-list"},{default:ee(()=>[(y(!0),g(K,null,Q(l.value,(D,U)=>(y(),ie(Ge,{key:D.id,ticket:D,draggable:!1,style:_e({"--ticket-index":U}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Z("",!0)]}),_:1})])])):Z("",!0)}},Li=he(Pi,[["__scopeId","data-v-c26f06c2"]]),Gi={class:"ac-dashboard"},Fi={key:"preloader",class:"chart-preloader"},Vi={class:"preloader-content"},Hi={class:"preloader-message"},Yi={key:"content"},zi={key:1,class:"weeks-dashboard"},ji={class:"dashboard-header"},qi={class:"header-content"},Zi={class:"breadcrumbs-row"},Xi=["aria-label","aria-disabled","data-fallback","disabled"],Ji={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Ki={class:"dashboard-layout"},Qi={class:"filters-container"},ec={class:"chart-container"},tc={__name:"GraphAdmissionClosureDashboard",setup(r){const t=bt(),e=V(!1),a=V(null),n=V(null),l=V({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),c=V(!1),v=V(!1),m=V(!1),f=V(!0),A=V(null),x=V(!1),z=Y(()=>typeof window>"u"?!1:window.history.length>1),q=Y(()=>z.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),S={name:"dashboard-sector-1c"};function W(k){var d;if((d=k==null?void 0:k.preventDefault)==null||d.call(k),!x.value){x.value=!0;try{if(z.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(S)}finally{x.value=!1}}}const b=V({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),u=V("weeks"),h=Y(()=>{const k=b.value.customDateRange.startDate||b.value.customDateRange.endDate,d=b.value.employees.length===1&&b.value.employees.includes("all");return k||!d});async function $(){if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",u.value),console.log("[DEBUG] isLoading before:",e.value),u.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,a.value=null;const k=new Promise(d=>setTimeout(d,300));try{console.log("[DEBUG] Starting API call");const d=_(),O=d.weekStartUtc,F=d.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:O,weekEndUtc:F});const[C,L]=await Promise.all([k,$e({product:"1C",periodMode:"weeks",weekStartUtc:O,weekEndUtc:F,includeTickets:!0})]);console.log("[DEBUG] API call successful, result:",L);const{meta:B,data:j}=L;n.value=B,l.value=j,console.log("[DEBUG] Data set, meta:",B,"data keys:",Object.keys(j))}catch(d){console.error("[DEBUG] API call failed:",d),a.value=d instanceof Error?d:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",d)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function E(k){b.value.stages=k}function D(k){b.value.employees=k}function U(k){b.value.dateRange=k}function P(k){b.value.customDateRange=k}function N(k){if(!["weeks","months"].includes(k)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",k);return}k!==u.value&&(u.value=k,$())}function I(k){const{mode:d}=k.detail;["weeks","months"].includes(d)&&N(d)}function M(){b.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},G()}function G(){$()}function R(k){["weeks","months"].includes(k)&&(u.value=k)}function X(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",f.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",u.value),f.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",f.value),console.log("[DEBUG] isLoading after:",e.value),kt(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),i()})}function i(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",u.value),console.log("[DEBUG] showPeriodModeInfo:",f.value),console.log("[DEBUG] isLoading:",e.value),(!u.value||!["weeks","months"].includes(u.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),u.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",u.value),kt(()=>{console.log("[DEBUG] nextTick callback, periodMode:",u.value),console.log("[DEBUG] isLoading in nextTick:",e.value),u.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),$()):u.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function o(k=null){var d,O,F;k?A.value=k:A.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((O=n.value)==null?void 0:O.weekStartUtc)||null,weekEndUtc:((F=n.value)==null?void 0:F.weekEndUtc)||null},v.value=!0}function p(k=null){var d,O,F;k?A.value=k:A.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((O=n.value)==null?void 0:O.weekStartUtc)||null,weekEndUtc:((F=n.value)==null?void 0:F.weekEndUtc)||null},c.value=!0}function T(k=null){var d,O,F;k?A.value=k:A.value={weekNumber:((d=n.value)==null?void 0:d.weekNumber)||null,weekStartUtc:((O=n.value)==null?void 0:O.weekStartUtc)||null,weekEndUtc:((F=n.value)==null?void 0:F.weekEndUtc)||null},m.value=!0}ze(()=>{try{const k="graph-admission-closure-period-mode-info-shown";localStorage.getItem(k)&&localStorage.removeItem(k);const d="graph-admission-closure-period-mode";localStorage.getItem(d)&&localStorage.removeItem(d)}catch(k){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",k)}window.addEventListener("period-mode-change",I)}),ft(()=>{window.removeEventListener("period-mode-change",I)});function _(){const k=new Date,d=new Date(Date.UTC(k.getUTCFullYear(),k.getUTCMonth(),k.getUTCDate())),O=d.getUTCDay(),F=d.getUTCDate()-O+(O===0?-6:1),C=new Date(Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),F,0,0,0)),L=new Date(C);return L.setUTCDate(L.getUTCDate()+6),L.setUTCHours(23,59,59,999),{weekStartUtc:C.toISOString(),weekEndUtc:L.toISOString()}}return(k,d)=>{var F,C,L,B,j,re,ce,de,ue,ve,ke,fe,pe,ge,be,we,Te,Ce;const O=wt("router-link");return y(),g("div",Gi,[J(ne,{name:"fade",mode:"out-in"},{default:ee(()=>[e.value?(y(),g("div",Fi,[s("div",Vi,[d[3]||(d[3]=s("div",{class:"preloader-spinner"},[s("div",{class:"spinner-ring"}),s("div",{class:"spinner-ring"}),s("div",{class:"spinner-ring"})],-1)),d[4]||(d[4]=s("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),s("p",Hi," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+w(u.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),d[5]||(d[5]=s("div",{class:"preloader-dots"},[s("span",{class:"dot"}),s("span",{class:"dot"}),s("span",{class:"dot"})],-1))])])):!f.value&&!e.value?(y(),g("div",Yi,[u.value==="months"?(y(),ie(mn,{key:0})):(y(),g("div",zi,[s("div",ji,[s("div",qi,[s("div",Zi,[s("button",{class:"btn-back-link",type:"button",onClick:W,"aria-label":q.value,"aria-disabled":!z.value,"data-fallback":!z.value,disabled:x.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,Xi),s("nav",Ji,[J(O,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:ee(()=>[...d[6]||(d[6]=[le(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),d[8]||(d[8]=s("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),J(O,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:ee(()=>[...d[7]||(d[7]=[le(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),d[9]||(d[9]=s("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),d[10]||(d[10]=s("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),d[11]||(d[11]=s("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),d[12]||(d[12]=s("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),s("div",Ki,[s("div",Qi,[J(Ct,{stages:b.value.stages,employees:b.value.employees,dateRange:b.value.dateRange,customDateRange:b.value.customDateRange,hasActiveFilters:h.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":u.value,"onUpdate:stages":E,"onUpdate:employees":D,"onUpdate:dateRange":U,"onUpdate:customDateRange":P,"onUpdate:periodMode":N,onReset:M,onApply:G},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),s("div",ec,[a.value?(y(),ie(Tt,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:a.value.message},null,8,["message"])):(y(),ie(ar,{key:1,meta:n.value,data:l.value,onOpenResponsible:p,onOpenStages:o,onOpenCarryover:T},null,8,["meta","data"]))])])]))])):Z("",!0)]),_:1}),J(Ll,{"is-visible":c.value,responsible:l.value.responsible||[],"closed-tickets-created-this-week":l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":l.value.responsibleCreatedOtherWeek||[],"week-number":((F=A.value)==null?void 0:F.weekNumber)||((C=n.value)==null?void 0:C.weekNumber)||null,"week-start-utc":((L=A.value)==null?void 0:L.weekStartUtc)||((B=n.value)==null?void 0:B.weekStartUtc)||null,"week-end-utc":((j=A.value)==null?void 0:j.weekEndUtc)||((re=n.value)==null?void 0:re.weekEndUtc)||null,onClose:d[0]||(d[0]=Ee=>{c.value=!1,A.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),J(ki,{"is-visible":v.value,"week-number":((ce=A.value)==null?void 0:ce.weekNumber)||((de=n.value)==null?void 0:de.weekNumber)||null,"week-start-utc":((ue=A.value)==null?void 0:ue.weekStartUtc)||((ve=n.value)==null?void 0:ve.weekStartUtc)||null,"week-end-utc":((ke=A.value)==null?void 0:ke.weekEndUtc)||((fe=n.value)==null?void 0:fe.weekEndUtc)||null,onClose:d[1]||(d[1]=Ee=>{v.value=!1,A.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),J(Li,{"is-visible":m.value,"week-number":((pe=A.value)==null?void 0:pe.weekNumber)||((ge=n.value)==null?void 0:ge.weekNumber)||null,"week-start-utc":((be=A.value)==null?void 0:be.weekStartUtc)||((we=n.value)==null?void 0:we.weekStartUtc)||null,"week-end-utc":((Te=A.value)==null?void 0:Te.weekEndUtc)||((Ce=n.value)==null?void 0:Ce.weekEndUtc)||null,onClose:d[2]||(d[2]=Ee=>{m.value=!1,A.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),f.value?(y(),ie(as,{key:0,"is-visible":f.value,"current-mode":u.value,onClose:X,onSelectMode:R},null,8,["is-visible","current-mode"])):Z("",!0)])}}},ic=he(tc,[["__scopeId","data-v-7628f2d7"]]);export{ic as default};
