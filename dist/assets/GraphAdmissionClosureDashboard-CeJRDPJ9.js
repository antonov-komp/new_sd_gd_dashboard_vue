const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ticketListUtils-DRPNoSIF.js","assets/priority-config-13V8XS-y.js","assets/main-BAvF3HwN.js","assets/main-hkNOQW78.css","assets/priority-config-Bxxce_5E.css","assets/ticket-mapper-BMpCVH6d.js"])))=>i.map(i=>d[i]);
var me=Object.defineProperty;var ye=(T,t,s)=>t in T?me(T,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):T[t]=s;var ne=(T,t,s)=>ye(T,typeof t!="symbol"?t+"":t,s);import{_ as ae,g as C,c as L,a as u,o as n,b as e,t as b,F as V,e as j,n as Z,d as Y,f as K,G as pe,H as J,I as Q,j as O,k as P,B as q,T as le,l as x,J as se,m as ge,S as he,z as fe,r as be,y as de,L as Te}from"./main-BAvF3HwN.js";import{F as we}from"./FiltersPanel-BkpTh9Zd.js";import{L as ue,D as Ce,B as Ie}from"./index-BPW96U9X.js";import{B as te,g as ke,a as Ee,b as _e,D as $e,T as oe,c as ce}from"./priority-config-13V8XS-y.js";const De={class:"ac-chart"},Se={class:"ac-chart__header"},Ue={class:"ac-chart__subtitle"},We={class:"ac-chart__controls"},Ae={class:"chart-type-selector"},Be=["onClick"],Re={class:"chart-type-icon"},Oe={class:"chart-type-label"},Me={class:"ac-chart__summary"},Ne={class:"summary-card__value"},Pe={class:"summary-card__value-main"},Le={class:"summary-card__breakdown"},Fe={class:"breakdown-item breakdown-item--this-week"},Ye={class:"breakdown-item__value"},Ge={class:"breakdown-item breakdown-item--other-week"},Ve={class:"breakdown-item__value"},je={class:"summary-card__value-main"},He={class:"summary-card__breakdown"},qe={class:"breakdown-item breakdown-item--this-week"},ze={class:"breakdown-item__value"},Je={class:"breakdown-item breakdown-item--other-week"},Ze={class:"breakdown-item__value"},Xe={class:"summary-card summary-card--stages"},Ke={class:"summary-card__tags"},xe={key:0,class:"stage-tag stage-tag--empty"},Qe={class:"ac-chart__body"},et={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:null},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(T,{emit:t}){const s=T,l=t,r=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],i=C("line"),w=L(()=>{var $;return(($=s.meta)==null?void 0:$.weekNumber)??"‚Äî"}),k=L(()=>{var d,c,D;const $=["–¢–µ–∫—É—â–∞—è –Ω–µ–¥–µ–ª—è"],_=Array.isArray((d=s.data.series)==null?void 0:d.new)?s.data.series.new:[s.data.newTickets||0],S=Array.isArray((c=s.data.series)==null?void 0:c.closed)?s.data.series.closed:[s.data.closedTickets||0],N=Array.isArray((D=s.data.series)==null?void 0:D.carryover)?s.data.series.carryover:[s.data.carryoverTickets||0];return{labels:$,datasets:[{label:"–ù–æ–≤—ã–µ",data:_,backgroundColor:J.primary,borderColor:J.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ",data:S,backgroundColor:J.success,borderColor:J.success,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",data:N,backgroundColor:J.carryover,borderColor:J.carryover,tension:.3,fill:!1}]}}),v=L(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[s.data.newTickets||0,s.data.closedTickets||0,s.data.carryoverTickets||0],backgroundColor:[J.primary,J.success,J.carryover],borderWidth:1}]})),m=L(()=>{switch(i.value){case"line":return ue;case"bar":return Ie;case"doughnut":return Ce;default:return ue}}),E=L(()=>i.value==="doughnut"?v.value:k.value),R=L(()=>({responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{enabled:!0},legend:{position:"top"}},onClick:($,_,S)=>{var D,p,W;if(_.length===0)return;const d=_[0].datasetIndex,c=S.data.datasets[d];!c||!c.label||(c.label==="–ó–∞–∫—Ä—ã—Ç—ã–µ"?(((D=s.data)==null?void 0:D.responsible)||[]).length>0&&l("open-responsible"):c.label==="–ù–æ–≤—ã–µ"?(((p=s.data)==null?void 0:p.newTickets)||0)>0&&l("open-stages"):c.label==="–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"&&(((W=s.data)==null?void 0:W.carryoverTickets)||0)>0&&l("open-carryover"))},scales:i.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0}}}})),U=$=>{var _,S,N,d;$==="new"&&(((_=s.data)==null?void 0:_.newTickets)||0)>0?l("open-stages"):$==="closed"&&(((S=s.data)==null?void 0:S.closedTickets)||0)>0?(((N=s.data)==null?void 0:N.responsible)||[]).length>0&&l("open-responsible"):$==="carryover"&&(((d=s.data)==null?void 0:d.carryoverTickets)||0)>0&&l("open-carryover")};return($,_)=>{var S,N;return n(),u("div",De,[e("header",Se,[e("div",null,[_[3]||(_[3]=e("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),e("p",Ue," –ù–µ–¥–µ–ª—è "+b(w.value)+" ¬∑ "+b(((S=T.meta)==null?void 0:S.weekStartUtc)||"‚Äî")+" ‚Äî "+b(((N=T.meta)==null?void 0:N.weekEndUtc)||"‚Äî")+" (UTC) ",1)]),e("div",We,[e("div",Ae,[(n(),u(V,null,j(r,d=>e("button",{key:d.value,class:Z(["chart-type-btn",{active:i.value===d.value}]),onClick:c=>i.value=d.value},[e("span",Re,b(d.icon),1),e("span",Oe,b(d.label),1)],10,Be)),64))])])]),e("section",Me,[e("div",{class:"summary-card summary-card--new",onClick:_[0]||(_[0]=d=>U("new"))},[_[4]||(_[4]=e("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",Ne,b(T.data.newTickets??0),1)]),e("div",{class:"summary-card summary-card--closed-breakdown",onClick:_[1]||(_[1]=d=>U("closed"))},[_[9]||(_[9]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",Pe,b(T.data.closedTickets??0),1),e("div",Le,[e("div",Fe,[_[5]||(_[5]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",Ye,b(T.data.closedTicketsCreatedThisWeek??0),1),_[6]||(_[6]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),e("div",Ge,[_[7]||(_[7]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",Ve,b(T.data.closedTicketsCreatedOtherWeek??0),1),_[8]||(_[8]=e("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),e("div",{class:"summary-card summary-card--carryover-breakdown",onClick:_[2]||(_[2]=d=>U("carryover"))},[_[14]||(_[14]=e("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),e("div",je,b(T.data.carryoverTickets??0),1),e("div",He,[e("div",qe,[_[10]||(_[10]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",ze,b(T.data.carryoverTicketsCreatedThisWeek??0),1),_[11]||(_[11]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),e("div",Je,[_[12]||(_[12]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",Ze,b(T.data.carryoverTicketsCreatedOtherWeek??0),1),_[13]||(_[13]=e("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),e("div",Xe,[_[15]||(_[15]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("div",Ke,[(n(!0),u(V,null,j(T.data.stages||[],d=>(n(),u("span",{key:d.stageId,class:"stage-tag"},b(d.stageName||d.stageId)+" ‚Äî "+b(d.count),1))),128)),!T.data.stages||T.data.stages.length===0?(n(),u("span",xe," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Y("",!0)])])]),e("div",Qe,[(n(),K(pe(m.value),{data:E.value,options:R.value},null,8,["data","options"]))])])}}},tt=ae(et,[["__scopeId","data-v-9027d563"]]);class ie{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const s=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",s);const l=await this.getEmployeesByIds(s);return console.log("Loaded employees:",l.length),{stages:this.groupTicketsByStages(t,l),employees:l,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],s=[];for(const l of t){console.log(`Loading tickets for stage: ${l}`);const r=await this.getTicketsByStage(l);s.push(...r),console.log(`Loaded ${r.length} tickets for stage ${l}`)}return s}static async getTicketsByStage(t){const s=[];let l=0;const r=50;let i=!0;for(;i;)try{const k=await te.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:l,useOriginalUfNames:"Y"});let v=[];k&&k.result&&(Array.isArray(k.result)?v=k.result:k.result.items&&Array.isArray(k.result.items)?v=k.result.items:k.result.data&&Array.isArray(k.result.data)&&(v=k.result.data)),v.length>0?(s.push(...v),l+=v.length,i=v.length===r):i=!1}catch(k){console.error(`Error loading tickets batch for stage ${t} (start: ${l}):`,k),i=!1}s.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(s[0],null,2)),console.log("Sample ticket keys:",Object.keys(s[0])),console.log("Sample ticket assignedById variants:",{assignedById:s[0].assignedById,assignedByIdId:s[0].assignedByIdId,ASSIGNED_BY_ID:s[0].ASSIGNED_BY_ID}));const w=s.filter(k=>{const v=k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product||k.ufCrm7TypeProduct||k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product;return Array.isArray(v)?v.includes(this.SECTOR_TAG):typeof v=="object"&&v!==null?v.value===this.SECTOR_TAG||v===this.SECTOR_TAG:v===this.SECTOR_TAG});return console.log(`Filtered ${w.length} tickets from ${s.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),w}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const s=new Set;return t.forEach(l=>{const r=l.assignedById||l.assignedByIdId||l.ASSIGNED_BY_ID||l.assignedById||l.assignedById&&typeof l.assignedById=="object"&&(l.assignedById.id||l.assignedById.ID)||l.assignedById&&typeof l.assignedById=="object"&&l.assignedById.value;if(r){const i=parseInt(r);i&&!isNaN(i)&&i>0&&s.add(i)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(s))),Array.from(s)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const s=await te.call("user.get",{filter:{ID:t}});let l=[];return s&&s.result&&(Array.isArray(s.result)?l=s.result:console.warn("Unexpected user.get result format:",s)),l.map(r=>({id:parseInt(r.ID||r.id||0),name:`${r.NAME||r.name||""} ${r.LAST_NAME||r.lastName||""}`.trim()||r.EMAIL||r.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:r.WORK_POSITION||r.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:r.EMAIL||r.email||"",tickets:[]}))}catch(s){return console.error("Error getting employees by IDs:",s),[]}}static groupTicketsByStages(t,s){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(s)||(console.warn("Employees is not an array:",s),s=[]);const l=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:s.map(r=>({...r,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:s.map(r=>({...r,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:s.map(r=>({...r,tickets:[]}))}];return t.forEach(r=>{const i=this.mapStageId(r.stageId||r.STAGE_ID||""),w=l.find(k=>k.id===i);if(w){const k=r.assignedById||r.ASSIGNED_BY_ID||null,v=k?parseInt(k):null;if(v){let m=w.employees.find(E=>E.id===v);m||(m={id:v,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${v}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},w.employees.push(m)),m.tickets.push(this.mapTicket(r))}}}),l}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const s=parseInt(t.id||t.ID||0),l=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",r=t.stageId||t.STAGE_ID||"",i=t.assignedById||t.ASSIGNED_BY_ID||null,w=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",k=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",v=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,m=ke(v),E=Ee(m);return{id:s,title:l,priorityId:m.id,priorityLabel:m.label,priorityColors:E,priority:m.id,priorityBitrixValue:m.bitrixValue||null,status:this.mapStatus(r),assigneeId:i?parseInt(i):null,stageId:this.mapStageId(r),createdAt:w,modifiedAt:k,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return ke(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const s=_e(t);if(s&&s.bitrixValue)return s.bitrixValue;const l={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return l[t]?l[t]:_e($e).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const s={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(l=>!(l.assignedById||l.ASSIGNED_BY_ID)).forEach(l=>{const r=this.mapStageId(l.stageId||l.STAGE_ID||"");s[r]&&s[r].push(this.mapTicket(l))}),s):(console.warn("Tickets is not an array in getZeroPointTickets:",t),s)}static async assignTicket(t,s,l){try{const r=this.mapStageIdToBitrix(l);return(await te.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:s,stageId:r}})).result===!0}catch(r){throw console.error("Error assigning ticket:",r),r}}static async createTicket(t){try{const s=await te.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return s.result?parseInt(s.result):0}catch(s){throw console.error("Error creating ticket:",s),s}}static async getTicket(t){try{const s=await te.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(s.result)}catch(s){throw console.error("Error getting ticket:",s),s}}static async addComment(t,s){try{return(await te.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:s}})).result!==void 0}catch(l){throw console.error("Error adding comment:",l),l}}}ne(ie,"ENTITY_TYPE_ID",140),ne(ie,"SECTOR_TAG","1C");const st="/api/graph-1c-admission-closure.php";function at(T){var s,l,r,i,w,k,v,m,E,R,U,$,_,S,N,d,c,D,p,W,B,H;if(!T)return{meta:null,data:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0]},stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=T.data||T.result||T;return{meta:t.meta||T.meta||null,data:{newTickets:((s=t.data)==null?void 0:s.newTickets)??t.newTickets??0,closedTickets:((l=t.data)==null?void 0:l.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((r=t.data)==null?void 0:r.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((i=t.data)==null?void 0:i.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((w=t.data)==null?void 0:w.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((k=t.data)==null?void 0:k.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((v=t.data)==null?void 0:v.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,series:{new:((E=(m=t.data)==null?void 0:m.series)==null?void 0:E.new)??((R=t.series)==null?void 0:R.new)??[0],closed:(($=(U=t.data)==null?void 0:U.series)==null?void 0:$.closed)??((_=t.series)==null?void 0:_.closed)??[0],carryover:((N=(S=t.data)==null?void 0:S.series)==null?void 0:N.carryover)??((d=t.series)==null?void 0:d.carryover)??[0]},stages:((c=t.data)==null?void 0:c.stages)??t.stages??[],responsible:((D=t.data)==null?void 0:D.responsible)??t.responsible??[],responsibleCreatedThisWeek:((p=t.data)==null?void 0:p.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((W=t.data)==null?void 0:W.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((B=t.data)==null?void 0:B.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((H=t.data)==null?void 0:H.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null}}}async function ee(T={}){const{endpoint:t=st,product:s="1C",weekStartUtc:l=null,weekEndUtc:r=null,useCache:i=!0,forceRefresh:w=!1,includeTickets:k=!1,includeNewTicketsByStages:v=!1,includeCarryoverTickets:m=!0,includeCarryoverTicketsByDuration:E=!1}=T,U=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product:s,weekStartUtc:l,weekEndUtc:r,useCache:i,forceRefresh:w,includeTickets:k,includeNewTicketsByStages:v,includeCarryoverTickets:m,includeCarryoverTicketsByDuration:E})});if(!U.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${U.status})`);const $=await U.json();if(($==null?void 0:$.success)===!1)throw new Error($.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return at($)}const lt={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},ot={class:"modal"},rt={key:0,class:"modal__tabs"},nt={key:"level-0-categories",class:"level-0"},it={class:"modal__header"},ct={class:"modal__body"},dt={class:"categories-list"},ut=["onClick"],kt={class:"category-item"},_t={class:"category-item__icon"},vt={key:0},mt={key:1},yt={class:"category-item__content"},pt={class:"category-item__label"},gt={class:"category-item__count"},ht={key:0,class:"category-item__arrow"},ft={class:"modal__footer"},bt={key:"level-1-categories",class:"level-1"},Tt={class:"modal__header"},wt={class:"modal__body"},Ct={key:"loading",class:"loading-names"},It={key:"empty",class:"modal__empty"},Et={key:"list",class:"responsible-list"},$t=["onClick"],Dt={class:"responsible-list__name"},St={class:"responsible-list__count"},Ut={key:0,class:"responsible-list__arrow"},Wt={class:"modal__footer"},At={key:"level-2-categories",class:"level-2"},Bt={class:"modal__header"},Rt={class:"modal__title"},Ot={class:"modal__body"},Mt={key:"loading",class:"loading-state"},Nt={key:"error",class:"error-state"},Pt={class:"error-message"},Lt={key:"empty",class:"empty-state"},Ft={key:"tickets",class:"tickets-list-container"},Yt={key:"level-0-employees",class:"level-0"},Gt={class:"modal__header"},Vt={class:"modal__body"},jt={key:"loading",class:"loading-names"},Ht={key:"empty",class:"modal__empty"},qt={key:"list",class:"responsible-list"},zt=["onClick"],Jt={class:"responsible-list__name"},Zt={class:"responsible-list__count"},Xt={key:0,class:"responsible-list__arrow"},Kt={class:"modal__footer"},xt={key:"level-1-employees",class:"level-1"},Qt={class:"modal__header"},es={class:"modal__title"},ts={class:"modal__body"},ss={class:"categories-list"},as=["onClick"],ls={class:"category-item"},os={class:"category-item__icon"},rs={key:0},ns={key:1},is={class:"category-item__content"},cs={class:"category-item__label"},ds={class:"category-item__count"},us={key:0,class:"category-item__arrow"},ks={class:"modal__footer"},_s={key:"level-2-employees",class:"level-2"},vs={class:"modal__header"},ms={class:"modal__title"},ys={class:"modal__body"},ps={key:"loading",class:"loading-state"},gs={key:"error",class:"error-state"},hs={class:"error-message"},fs={key:"empty",class:"empty-state"},bs={class:"empty-state-message"},Ts={key:"tickets",class:"tickets-list-container"},ws={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(T){const t=T,s=C(0),l=C("categories"),r=C(null),i=C(null),w=C(null),k=C([]),v=C(!1),m=C(null),E=C([]),R=C([]),U=C(!1),$=L(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),_=L(()=>{const o=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(a=>{const g=a.id??"unassigned";o.has(g)||o.set(g,{id:a.id,name:a.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const f=o.get(g);f.thisWeekCount=a.count??0,f.thisWeekTickets=a.tickets||[],f.totalCount+=f.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(a=>{const g=a.id??"unassigned";o.has(g)||o.set(g,{id:a.id,name:a.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const f=o.get(g);f.otherWeekCount=a.count??0,f.otherWeekTickets=a.tickets||[],f.totalCount+=f.otherWeekCount}),Array.from(o.values())}),S=L(()=>{if(!i.value)return[];const o=i.value.thisWeekTickets||[],a=i.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:i.value.id,name:i.value.name,thisWeekCount:i.value.thisWeekCount,otherWeekCount:i.value.otherWeekCount,thisWeekTickets:o.length,otherWeekTickets:a.length,employee:i.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:i.value.thisWeekCount??0,tickets:o,employeeId:i.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:i.value.otherWeekCount??0,tickets:a,employeeId:i.value.id}]}),N=L(()=>(R.value||[]).length>0);async function d(o){const a=o.filter(g=>g.id!==null&&g.id!==void 0).map(g=>g.id);if(a.length===0)return o;try{const g=await ie.getEmployeesByIds(a),f=new Map;return g.forEach(A=>{f.set(A.id,A.name)}),o.map(A=>A.id&&f.has(A.id)?{...A,name:f.get(A.id)}:A)}catch(g){return console.error("[ResponsibleModal] Error enriching names:",g),o}}Q([()=>l.value,()=>_.value],async([o,a])=>{if(!(o!=="employees"||s.value!==0)){if(!a||a.length===0){R.value=[];return}U.value=!0;try{R.value=await d(a)}catch(g){console.error("[ResponsibleModal] Error loading employee names:",g),R.value=a}finally{U.value=!1}}},{immediate:!0}),Q(()=>t.responsible,async o=>{if(!(s.value!==0||r.value||l.value!=="categories")){if(!o||o.length===0){E.value=[];return}U.value=!0;try{E.value=await d(o)}catch(a){console.error("[ResponsibleModal] Error loading employee names:",a),E.value=o}finally{U.value=!1}}},{immediate:!1});const c=L(()=>(E.value||[]).length>0);function D(o){l.value!==o&&(l.value=o,s.value=0,r.value=null,i.value=null,w.value=null,k.value=[],m.value=null,E.value=[],R.value=[])}async function p(o){if(!(!o||o.count===0)){r.value=o,s.value=1,U.value=!0;try{E.value=await d(o.responsible)}catch(a){console.error("[ResponsibleModal] Error loading employee names:",a),E.value=o.responsible}finally{U.value=!1}}}async function W(o,a=null){var g,f;!o||!o.id||o.totalCount===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:o.id,name:o.name,thisWeekCount:o.thisWeekCount,otherWeekCount:o.otherWeekCount,thisWeekTickets:((g=o.thisWeekTickets)==null?void 0:g.length)||0,otherWeekTickets:((f=o.otherWeekTickets)==null?void 0:f.length)||0,employee:o}),i.value={...o,thisWeekTickets:o.thisWeekTickets||[],otherWeekTickets:o.otherWeekTickets||[]},s.value=1)}async function B(o){var g;if(!o||o.count===0)return;w.value=o,s.value=2;const a=o.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:o.id,label:o.label,count:o.count,ticketsInGradation:a.length,selectedEmployee:(g=i.value)==null?void 0:g.id}),a.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",a.length),await H(a)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await X(o))}async function H(o){v.value=!0,m.value=null;try{try{const{prepareTicketsForDisplay:a}=await se(async()=>{const{prepareTicketsForDisplay:g}=await import("./ticketListUtils-DRPNoSIF.js").then(f=>f.t);return{prepareTicketsForDisplay:g}},__vite__mapDeps([0,1,2,3,4,5]));k.value=await a(o,null,null)}catch(a){console.error("[ResponsibleModal] Error preparing tickets:",a),k.value=o}k.value.length===0&&(m.value=null)}catch(a){m.value=a.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",a),k.value=[]}finally{v.value=!1}}async function X(o){v.value=!0,m.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!i.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const a=await ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),g=o.id==="this-week"?a.data.responsibleCreatedThisWeek:a.data.responsibleCreatedOtherWeek,f=g==null?void 0:g.find(M=>M.id===i.value.id),A=(f==null?void 0:f.tickets)||[];try{const{prepareTicketsForDisplay:M}=await se(async()=>{const{prepareTicketsForDisplay:y}=await import("./ticketListUtils-DRPNoSIF.js").then(G=>G.t);return{prepareTicketsForDisplay:y}},__vite__mapDeps([0,1,2,3,4,5]));k.value=await M(A,null,null)}catch(M){console.error("[ResponsibleModal] Error preparing tickets:",M),k.value=A}k.value.length===0&&(m.value=null)}catch(a){m.value=a.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",a),k.value=[]}finally{v.value=!1}}async function re(o,a=null){!o||!o.id||o.count===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),i.value=o,s.value=2,await I(o.id))}async function I(o){var a;v.value=!0,m.value=null;try{let g=[];if(r.value&&r.value.responsible){const f=r.value.responsible.find(A=>A.id===o);g=(f==null?void 0:f.tickets)||[]}if(g.length===0&&t.weekStartUtc&&t.weekEndUtc){const f=await ee({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),A=((a=r.value)==null?void 0:a.id)==="created-this-week"?f.data.responsibleCreatedThisWeek:f.data.responsibleCreatedOtherWeek,M=A==null?void 0:A.find(y=>y.id===o);g=(M==null?void 0:M.tickets)||[]}try{const{prepareTicketsForDisplay:f}=await se(async()=>{const{prepareTicketsForDisplay:A}=await import("./ticketListUtils-DRPNoSIF.js").then(M=>M.t);return{prepareTicketsForDisplay:A}},__vite__mapDeps([0,1,2,3,4,5]));k.value=await f(g,null,null)}catch(f){console.error("[ResponsibleModal] Error preparing tickets:",f),k.value=g}k.value.length===0&&(m.value=null)}catch(g){m.value=g.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",g),k.value=[]}finally{v.value=!1}}function h(){s.value===2?(s.value=1,l.value==="categories"?i.value=null:w.value=null,k.value=[],m.value=null):s.value===1&&(s.value=0,l.value==="categories"?(r.value=null,E.value=[]):i.value=null)}function F(o){const a=ce(o.id);window.open(a,"_blank")}function z(){l.value==="employees"&&w.value?H(w.value.tickets):l.value==="categories"&&i.value&&I(i.value.id)}return Q(()=>t.isVisible,o=>{o||(s.value=0,l.value="categories",r.value=null,i.value=null,w.value=null,k.value=[],m.value=null,E.value=[],R.value=[])}),(o,a)=>T.isVisible?(n(),u("div",lt,[e("div",ot,[s.value===0?(n(),u("div",rt,[e("button",{class:Z(["modal__tab",{"modal__tab--active":l.value==="categories"}]),onClick:a[0]||(a[0]=g=>D("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),e("button",{class:Z(["modal__tab",{"modal__tab--active":l.value==="employees"}]),onClick:a[1]||(a[1]=g=>D("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):Y("",!0),O(q,{name:"level",mode:"out-in"},{default:P(()=>{var g,f,A,M;return[l.value==="categories"&&s.value===0?(n(),u("div",nt,[e("header",it,[a[12]||(a[12]=e("h3",{class:"modal__title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("button",{class:"modal__close",onClick:a[2]||(a[2]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ct,[e("ul",dt,[(n(!0),u(V,null,j($.value,y=>(n(),u("li",{key:y.id,class:Z(["categories-list__item",{"categories-list__item--clickable":y.count>0}]),onClick:G=>p(y)},[e("div",kt,[e("div",_t,[y.id==="created-this-week"?(n(),u("span",vt,"‚úì")):(n(),u("span",mt,"‚Üª"))]),e("div",yt,[e("div",pt,b(y.label),1),e("div",gt,b(y.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),y.count>0?(n(),u("span",ht,"‚Üí")):Y("",!0)])],10,ut))),128))])]),e("footer",ft,[e("button",{class:"btn",onClick:a[3]||(a[3]=y=>o.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="categories"&&s.value===1?(n(),u("div",bt,[e("header",Tt,[e("button",{class:"btn-back",onClick:h,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),a[13]||(a[13]=e("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("button",{class:"modal__close",onClick:a[4]||(a[4]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",wt,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>[U.value?(n(),u("div",Ct,[...a[14]||(a[14]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):c.value?(n(),u("ul",Et,[(n(!0),u(V,null,j(E.value,y=>(n(),u("li",{key:y.id||y.name,class:Z(["responsible-list__item",{"responsible-list__item--clickable":y.id&&y.count>0}]),onClick:G=>re(y,G),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",Dt,b(y.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",St,b(y.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),y.id&&y.count>0?(n(),u("span",Ut,"‚Üí")):Y("",!0)],10,$t))),128))])):(n(),u("p",It,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),e("footer",Wt,[e("button",{class:"btn",onClick:a[5]||(a[5]=y=>o.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="categories"&&s.value===2?(n(),u("div",At,[e("header",Bt,[e("button",{class:"btn-back",onClick:h,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",Rt,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((g=i.value)==null?void 0:g.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[6]||(a[6]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ot,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>[v.value?(n(),u("div",Mt,[...a[15]||(a[15]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(n(),u("div",Nt,[a[16]||(a[16]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[17]||(a[17]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",Pt,b(m.value),1),e("button",{class:"btn btn-retry",onClick:z},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(n(),u("div",Lt,[...a[18]||(a[18]=[e("div",{class:"empty-state-icon"},"üìã",-1),e("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(n(),u("div",Ft,[O(le,{name:"ticket",tag:"div",class:"tickets-list"},{default:P(()=>[(n(!0),u(V,null,j(k.value,(y,G)=>(n(),K(oe,{key:y.id,ticket:y,draggable:!1,style:x({"--ticket-index":G}),onClick:F},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):l.value==="employees"&&s.value===0?(n(),u("div",Yt,[e("header",Gt,[a[19]||(a[19]=e("h3",{class:"modal__title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("button",{class:"modal__close",onClick:a[7]||(a[7]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Vt,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>[U.value?(n(),u("div",jt,[...a[20]||(a[20]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):N.value?(n(),u("ul",qt,[(n(!0),u(V,null,j(R.value,y=>(n(),u("li",{key:y.id||y.name,class:Z(["responsible-list__item",{"responsible-list__item--clickable":y.id&&y.totalCount>0}]),onClick:G=>W(y,G),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",Jt,b(y.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",Zt,b(y.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),y.id&&y.totalCount>0?(n(),u("span",Xt,"‚Üí")):Y("",!0)],10,zt))),128))])):(n(),u("p",Ht,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),e("footer",Kt,[e("button",{class:"btn",onClick:a[8]||(a[8]=y=>o.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="employees"&&s.value===1?(n(),u("div",xt,[e("header",Qt,[e("button",{class:"btn-back",onClick:h,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",es,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((f=i.value)==null?void 0:f.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[9]||(a[9]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ts,[e("ul",ss,[(n(!0),u(V,null,j(S.value,y=>(n(),u("li",{key:y.id,class:Z(["categories-list__item",{"categories-list__item--clickable":y.count>0}]),onClick:G=>B(y)},[e("div",ls,[e("div",os,[y.id==="this-week"?(n(),u("span",rs,"‚úì")):(n(),u("span",ns,"‚Üª"))]),e("div",is,[e("div",cs,b(y.label),1),e("div",ds,b(y.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),y.count>0?(n(),u("span",us,"‚Üí")):Y("",!0)])],10,as))),128))])]),e("footer",ks,[e("button",{class:"btn",onClick:a[10]||(a[10]=y=>o.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="employees"&&s.value===2?(n(),u("div",_s,[e("header",vs,[e("button",{class:"btn-back",onClick:h,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",ms," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+b(((A=i.value)==null?void 0:A.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+b(((M=w.value)==null?void 0:M.label)||"")+") ",1),e("button",{class:"modal__close",onClick:a[11]||(a[11]=y=>o.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ys,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>{var y;return[v.value?(n(),u("div",ps,[...a[21]||(a[21]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):m.value?(n(),u("div",gs,[a[22]||(a[22]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[23]||(a[23]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",hs,b(m.value),1),e("button",{class:"btn btn-retry",onClick:z},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):k.value.length===0?(n(),u("div",fs,[a[24]||(a[24]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",bs,b(l.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((y=w.value)==null?void 0:y.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(n(),u("div",Ts,[O(le,{name:"ticket",tag:"div",class:"tickets-list"},{default:P(()=>[(n(!0),u(V,null,j(k.value,(G,ve)=>(n(),K(oe,{key:G.id,ticket:G,draggable:!1,style:x({"--ticket-index":ve}),onClick:F},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},Cs=ae(ws,[["__scopeId","data-v-a33ffe22"]]),Is={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Es={class:"modal"},$s={key:"level-1",class:"level-1"},Ds={class:"modal__header"},Ss={class:"modal__body"},Us={key:"loading",class:"loading-names"},Ws={key:"empty",class:"modal__empty"},As={key:"list",class:"stages-list"},Bs=["onClick"],Rs={class:"stages-list__name"},Os={class:"stages-list__count"},Ms={key:0,class:"stages-list__arrow"},Ns={class:"modal__footer"},Ps={key:"level-2",class:"level-2"},Ls={class:"modal__header"},Fs={class:"modal__title"},Ys={class:"modal__body"},Gs={key:"loading",class:"loading-state"},Vs={key:"error",class:"error-state"},js={class:"error-message"},Hs={key:"empty",class:"empty-state"},qs={class:"empty-state-message"},zs={key:"tickets",class:"tickets-list-container"},Js={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(T,{emit:t}){const s=T,l=C(1),r=C(null),i=C([]),w=C(!1),k=C(!1),v=C(null),m=C([]),E=L(()=>m.value.length>0&&m.value.some(d=>d.count>0));async function R(){if(!s.weekStartUtc||!s.weekEndUtc){m.value=[];return}k.value=!0,v.value=null;try{const d=await ee({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeNewTicketsByStages:!0});m.value=d.data.newTicketsByStages||[]}catch(d){v.value=d.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",d),m.value=[]}finally{k.value=!1}}async function U(d,c=null){!d||d.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),r.value=d,l.value=2,await $(d.stageId))}async function $(d){var c;w.value=!0,v.value=null;try{if(!s.weekStartUtc||!s.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const p=(c=(await ee({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:c.find(B=>B.stageId===d),W=(p==null?void 0:p.tickets)||[];try{const{prepareTicketsForDisplay:B}=await se(async()=>{const{prepareTicketsForDisplay:H}=await import("./ticketListUtils-DRPNoSIF.js").then(X=>X.t);return{prepareTicketsForDisplay:H}},__vite__mapDeps([0,1,2,3,4,5]));i.value=await B(W,null,null)}catch(B){console.error("[StagesModal] Error preparing tickets:",B),i.value=W}i.value.length===0&&(v.value=null)}catch(D){v.value=D.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",D),i.value=[]}finally{w.value=!1}}function _(){l.value=1,r.value=null,i.value=[],v.value=null}function S(d){const c=ce(d.id);window.open(c,"_blank")}function N(){r.value&&$(r.value.stageId)}return Q(()=>s.isVisible,d=>{d?R():(l.value=1,r.value=null,i.value=[],v.value=null,m.value=[])}),Q([()=>s.weekStartUtc,()=>s.weekEndUtc],()=>{s.isVisible&&R()}),(d,c)=>T.isVisible?(n(),u("div",Is,[e("div",Es,[O(q,{name:"level",mode:"out-in"},{default:P(()=>{var D;return[l.value===1?(n(),u("div",$s,[e("header",Ds,[c[3]||(c[3]=e("h3",{class:"modal__title"},"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("button",{class:"modal__close",onClick:c[0]||(c[0]=p=>d.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ss,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>[k.value?(n(),u("div",Us,[...c[4]||(c[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):E.value?(n(),u("ul",As,[(n(!0),u(V,null,j(m.value,p=>(n(),u("li",{key:p.stageId,class:Z(["stages-list__item",{"stages-list__item--clickable":p.count>0}]),style:x({"--stage-color":p.color}),onClick:W=>U(p,W),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[e("span",{class:"stages-list__color",style:x({backgroundColor:p.color})},null,4),e("span",Rs,b(p.stageName),1),e("span",Os,b(p.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),p.count>0?(n(),u("span",Ms,"‚Üí")):Y("",!0)],14,Bs))),128))])):(n(),u("p",Ws," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",Ns,[e("button",{class:"btn",onClick:c[1]||(c[1]=p=>d.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value===2?(n(),u("div",Ps,[e("header",Ls,[e("button",{class:"btn-back",onClick:_,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",Fs," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+b(((D=r.value)==null?void 0:D.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:c[2]||(c[2]=p=>d.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ys,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>{var p;return[w.value?(n(),u("div",Gs,[...c[5]||(c[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):v.value?(n(),u("div",Vs,[c[6]||(c[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",js,b(v.value),1),e("button",{class:"btn btn-retry",onClick:N},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):i.value.length===0?(n(),u("div",Hs,[c[8]||(c[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",qs," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+b((p=r.value)==null?void 0:p.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(n(),u("div",zs,[O(le,{name:"ticket",tag:"div",class:"tickets-list"},{default:P(()=>[(n(!0),u(V,null,j(i.value,(W,B)=>(n(),K(oe,{key:W.id,ticket:W,draggable:!1,style:x({"--ticket-index":B}),onClick:S},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},Zs=ae(Js,[["__scopeId","data-v-d15a3c66"]]),Xs={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Ks={class:"modal"},xs={key:"level-1",class:"level-1"},Qs={class:"modal__header"},ea={class:"modal__body"},ta={key:"loading",class:"loading-names"},sa={key:"empty",class:"modal__empty"},aa={key:"list",class:"duration-list"},la=["onClick"],oa={class:"duration-list__name"},ra={class:"duration-list__count"},na={key:0,class:"duration-list__arrow"},ia={class:"modal__footer"},ca={key:"level-2",class:"level-2"},da={class:"modal__header"},ua={class:"modal__title"},ka={class:"modal__body"},_a={key:"loading",class:"loading-state"},va={key:"error",class:"error-state"},ma={class:"error-message"},ya={key:"empty",class:"empty-state"},pa={class:"empty-state-message"},ga={key:"tickets",class:"tickets-list-container"},ha={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(T,{emit:t}){const s=T,l=C(1),r=C(null),i=C([]),w=C(!1),k=C(!1),v=C(null),m=C([]),E=L(()=>m.value.length>0&&m.value.some(d=>d.count>0));async function R(){if(!s.weekStartUtc||!s.weekEndUtc){m.value=[];return}k.value=!0,v.value=null;try{const d=await ee({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});m.value=d.data.carryoverTicketsByDuration||[]}catch(d){v.value=d.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",d),m.value=[]}finally{k.value=!1}}async function U(d,c=null){!d||d.count===0||(c&&c.currentTarget&&(c.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{c.currentTarget&&(c.currentTarget.style.transform="")},150)),r.value=d,l.value=2,await $(d.durationCategory))}async function $(d){var c;w.value=!0,v.value=null;try{if(!s.weekStartUtc||!s.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const p=(c=(await ee({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:c.find(B=>B.durationCategory===d),W=(p==null?void 0:p.tickets)||[];try{const{prepareTicketsForDisplay:B}=await se(async()=>{const{prepareTicketsForDisplay:H}=await import("./ticketListUtils-DRPNoSIF.js").then(X=>X.t);return{prepareTicketsForDisplay:H}},__vite__mapDeps([0,1,2,3,4,5]));i.value=await B(W,null,null)}catch(B){console.error("[CarryoverDurationModal] Error preparing tickets:",B),i.value=W}i.value.length===0&&(v.value=null)}catch(D){v.value=D.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",D),i.value=[]}finally{w.value=!1}}function _(){l.value=1,r.value=null,i.value=[],v.value=null}function S(d){const c=ce(d.id);window.open(c,"_blank")}function N(){r.value&&$(r.value.durationCategory)}return Q(()=>s.isVisible,d=>{d?R():(l.value=1,r.value=null,i.value=[],v.value=null,m.value=[])}),Q([()=>s.weekStartUtc,()=>s.weekEndUtc],()=>{s.isVisible&&R()}),(d,c)=>T.isVisible?(n(),u("div",Xs,[e("div",Ks,[O(q,{name:"level",mode:"out-in"},{default:P(()=>{var D;return[l.value===1?(n(),u("div",xs,[e("header",Qs,[c[3]||(c[3]=e("h3",{class:"modal__title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),e("button",{class:"modal__close",onClick:c[0]||(c[0]=p=>d.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ea,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>[k.value?(n(),u("div",ta,[...c[4]||(c[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):E.value?(n(),u("ul",aa,[(n(!0),u(V,null,j(m.value,p=>(n(),u("li",{key:p.durationCategory,class:Z(["duration-list__item",{"duration-list__item--clickable":p.count>0}]),style:x({"--duration-color":p.color}),onClick:W=>U(p,W),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[e("span",{class:"duration-list__color",style:x({backgroundColor:p.color})},null,4),e("span",oa,b(p.durationLabel),1),e("span",ra,b(p.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),p.count>0?(n(),u("span",na,"‚Üí")):Y("",!0)],14,la))),128))])):(n(),u("p",sa," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",ia,[e("button",{class:"btn",onClick:c[1]||(c[1]=p=>d.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value===2?(n(),u("div",ca,[e("header",da,[e("button",{class:"btn-back",onClick:_,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",ua," –¢–∏–∫–µ—Ç—ã: "+b(((D=r.value)==null?void 0:D.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:c[2]||(c[2]=p=>d.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ka,[O(q,{name:"loading",mode:"out-in"},{default:P(()=>{var p;return[w.value?(n(),u("div",_a,[...c[5]||(c[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):v.value?(n(),u("div",va,[c[6]||(c[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),c[7]||(c[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",ma,b(v.value),1),e("button",{class:"btn btn-retry",onClick:N},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):i.value.length===0?(n(),u("div",ya,[c[8]||(c[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",pa," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+b((p=r.value)==null?void 0:p.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(n(),u("div",ga,[O(le,{name:"ticket",tag:"div",class:"tickets-list"},{default:P(()=>[(n(!0),u(V,null,j(i.value,(W,B)=>(n(),K(oe,{key:W.id,ticket:W,draggable:!1,style:x({"--ticket-index":B}),onClick:S},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},fa=ae(ha,[["__scopeId","data-v-83a6f8c8"]]),ba={class:"ac-dashboard"},Ta={key:1},wa={class:"dashboard-header"},Ca={class:"header-content"},Ia={class:"breadcrumbs-row"},Ea=["aria-label","aria-disabled","data-fallback","disabled"],$a={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Da={class:"dashboard-layout"},Sa={class:"filters-container"},Ua={class:"chart-container"},Wa={__name:"GraphAdmissionClosureDashboard",setup(T){const t=fe(),s=C(!0),l=C(null),r=C(null),i=C({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),w=C(!1),k=C(!1),v=C(!1),m=C(!1),E=L(()=>typeof window>"u"?!1:window.history.length>1),R=L(()=>E.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),U={name:"dashboard-sector-1c"};function $(I){var h;if((h=I==null?void 0:I.preventDefault)==null||h.call(I),!m.value){m.value=!0;try{if(E.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(U)}finally{m.value=!1}}}const _=C({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),S=C(null),N=L(()=>{const I=_.value.customDateRange.startDate||_.value.customDateRange.endDate,h=_.value.employees.length===1&&_.value.employees.includes("all");return I||!h});async function d(){s.value=!0,l.value=null;try{let I,h;if(S.value)I=S.value.startUtc,h=S.value.endUtc;else{const o=re();I=o.weekStartUtc,h=o.weekEndUtc}const{meta:F,data:z}=await ee({product:"1C",weekStartUtc:I,weekEndUtc:h,includeTickets:!0});r.value=F,i.value=z,!S.value&&F&&(S.value={weekNumber:F.weekNumber,startUtc:F.weekStartUtc,endUtc:F.weekEndUtc})}catch(I){l.value=I instanceof Error?I:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",I)}finally{s.value=!1}}function c(I){_.value.stages=I}function D(I){_.value.employees=I}function p(I){_.value.dateRange=I}function W(I){_.value.customDateRange=I}function B(I){S.value=I}function H(){_.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},X()}function X(){d()}ge(()=>{d()});function re(){const I=new Date,h=new Date(Date.UTC(I.getUTCFullYear(),I.getUTCMonth(),I.getUTCDate())),F=h.getUTCDay(),z=h.getUTCDate()-F+(F===0?-6:1),o=new Date(Date.UTC(h.getUTCFullYear(),h.getUTCMonth(),z,0,0,0)),a=new Date(o);return a.setUTCDate(a.getUTCDate()+6),a.setUTCHours(23,59,59,999),{weekStartUtc:o.toISOString(),weekEndUtc:a.toISOString()}}return(I,h)=>{var z,o,a,g,f,A;const F=be("router-link");return n(),u("div",ba,[s.value?(n(),K(Te,{key:0,message:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."})):(n(),u("div",Ta,[e("div",wa,[e("div",Ca,[e("div",Ia,[e("button",{class:"btn-back-link",type:"button",onClick:$,"aria-label":R.value,"aria-disabled":!E.value,"data-fallback":!E.value,disabled:m.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,Ea),e("nav",$a,[O(F,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:P(()=>[...h[6]||(h[6]=[de(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),h[8]||(h[8]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),O(F,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:P(()=>[...h[7]||(h[7]=[de(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),h[9]||(h[9]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),h[10]||(h[10]=e("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),h[11]||(h[11]=e("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),h[12]||(h[12]=e("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),e("div",Da,[e("div",Sa,[O(we,{stages:_.value.stages,employees:_.value.employees,dateRange:_.value.dateRange,customDateRange:_.value.customDateRange,hasActiveFilters:N.value,hideStages:!0,weekPickerMode:!0,selectedWeek:S.value,weeksCount:52,"onUpdate:stages":c,"onUpdate:employees":D,"onUpdate:dateRange":p,"onUpdate:customDateRange":W,"onUpdate:selectedWeek":B,onReset:H,onApply:X},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","selectedWeek"])]),e("div",Ua,[l.value?(n(),K(he,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(n(),K(tt,{key:1,meta:r.value,data:i.value,onOpenResponsible:h[0]||(h[0]=M=>w.value=!0),onOpenStages:h[1]||(h[1]=M=>k.value=!0),onOpenCarryover:h[2]||(h[2]=M=>v.value=!0)},null,8,["meta","data"]))])])])),O(Cs,{"is-visible":w.value,responsible:i.value.responsible||[],"closed-tickets-created-this-week":i.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":i.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":i.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":i.value.responsibleCreatedOtherWeek||[],"week-start-utc":((z=r.value)==null?void 0:z.weekStartUtc)||null,"week-end-utc":((o=r.value)==null?void 0:o.weekEndUtc)||null,onClose:h[3]||(h[3]=M=>w.value=!1)},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-start-utc","week-end-utc"]),O(Zs,{"is-visible":k.value,"week-start-utc":((a=r.value)==null?void 0:a.weekStartUtc)||null,"week-end-utc":((g=r.value)==null?void 0:g.weekEndUtc)||null,onClose:h[4]||(h[4]=M=>k.value=!1)},null,8,["is-visible","week-start-utc","week-end-utc"]),O(fa,{"is-visible":v.value,"week-start-utc":((f=r.value)==null?void 0:f.weekStartUtc)||null,"week-end-utc":((A=r.value)==null?void 0:A.weekEndUtc)||null,onClose:h[5]||(h[5]=M=>v.value=!1)},null,8,["is-visible","week-start-utc","week-end-utc"])])}}},Na=ae(Wa,[["__scopeId","data-v-56000c45"]]);export{Na as default};
