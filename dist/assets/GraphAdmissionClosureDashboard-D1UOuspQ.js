const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ticketListUtils-6ViJOyvD.js","./priority-config-BXeNE02u.js","./main-dnhRka5M.js","./main-DFwah1ox.css","./priority-config-Bxxce_5E.css","./ticket-mapper-B9KLF8cV.js"])))=>i.map(i=>d[i]);
var xt=Object.defineProperty;var Lt=(r,t,e)=>t in r?xt(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var et=(r,t,e)=>Lt(r,typeof t!="symbol"?t+"":t,e);import{_ as be,g as Z,G as Ce,m as rt,H as Tt,f as ve,o as _,j as te,k as re,a as g,d as Q,b as a,y as ue,n as oe,B as de,I as Gt,c as q,J as H,K as $t,t as C,F as ae,e as se,L as Je,M as Ft,N as je,O as le,P as Vt,Q as Wt,R as Fe,S as Yt,U as Ht,V as jt,W as zt,X as qt,Y as Zt,Z as Xt,$ as Jt,x as Kt,l as Te,a0 as Qt,z as At,r as Dt,a1 as Et,a2 as Ae,T as Ke,a3 as Ve,a4 as pt}from"./main-dnhRka5M.js";import{F as Ut}from"./FiltersPanel-DkR0KMM5.js";import{L as De,D as ea,B as ta}from"./index-fep-qkzy.js";import{g as gt,a as aa,b as bt,D as sa,T as Qe,c as ot}from"./priority-config-BXeNE02u.js";const ra={key:0,class:"modal-overlay"},oa={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},na={class:"modal-body"},la={class:"mode-description"},ia={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:r=>["weeks","months"].includes(r)}},emits:["close","start-loading","select-mode"],setup(r,{emit:t}){const e=r,s=t,o=Z(e.currentMode);function l(y){if(!["weeks","months"].includes(y)){console.warn("[PeriodModeInfoModal] Invalid mode:",y);return}o.value=y,console.log("[DEBUG Modal] handleModeSelect: mode =",y),console.log("[DEBUG Modal] Emitting select-mode event"),s("select-mode",y),console.log("[DEBUG Modal] Emitting close event"),s("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),s("start-loading")},100)}function d(){console.log("[DEBUG Modal] handleClose called, selectedMode =",o.value),console.log("[DEBUG Modal] Emitting select-mode event with",o.value),s("select-mode",o.value),console.log("[DEBUG Modal] Emitting close event"),s("close")}function k(y){y.key==="Escape"&&e.isVisible&&d()}return Ce(()=>e.currentMode,y=>{["weeks","months"].includes(y)&&(o.value=y)}),rt(()=>{e.isVisible&&document.addEventListener("keydown",k)}),Tt(()=>{document.removeEventListener("keydown",k)}),Ce(()=>e.isVisible,y=>{y?(document.addEventListener("keydown",k),o.value=e.currentMode):document.removeEventListener("keydown",k)}),(y,f)=>(_(),ve(Gt,{to:"body"},[te(de,{name:"modal-fade"},{default:re(()=>[r.isVisible?(_(),g("div",ra,[a("div",oa,[a("div",{class:"modal-header"},[f[2]||(f[2]=a("h2",{id:"modal-title",class:"modal-title"},[a("span",{class:"modal-icon"},"â„¹ï¸"),ue(" Ð’Ñ‹Ð±Ð¾Ñ€ Ñ€ÐµÐ¶Ð¸Ð¼Ð° Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ")],-1)),a("button",{class:"modal-close-btn",onClick:d,"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ",type:"button"}," Ã— ")]),a("div",na,[f[5]||(f[5]=a("p",{class:"modal-description"}," Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹: ",-1)),a("div",la,[a("button",{class:oe(["mode-item mode-item--clickable",{"mode-item--selected":o.value==="weeks"}]),onClick:f[0]||(f[0]=E=>l("weeks")),type:"button"},[...f[3]||(f[3]=[a("div",{class:"mode-header"},[a("span",{class:"mode-icon"},"ðŸ“…"),a("h3",{class:"mode-title"},"4 Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð½ÐµÐ´ÐµÐ»Ð¸")],-1),a("p",{class:"mode-text"}," ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 4 Ð½ÐµÐ´ÐµÐ»Ð¸ Ñ Ð´ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ Ð¿Ð¾ Ð½ÐµÐ´ÐµÐ»ÑÐ¼. ÐŸÐ¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ ÐºÑ€Ð°Ñ‚ÐºÐ¾ÑÑ€Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð´Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ¸ Ð¿Ð¾ÑÑ‚ÑƒÐ¿Ð»ÐµÐ½Ð¸Ñ Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð². ",-1)])],2),a("button",{class:oe(["mode-item mode-item--clickable",{"mode-item--selected":o.value==="months"}]),onClick:f[1]||(f[1]=E=>l("months")),type:"button"},[...f[4]||(f[4]=[a("div",{class:"mode-header"},[a("span",{class:"mode-icon"},"ðŸ“Š"),a("h3",{class:"mode-title"},"3 Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… Ð¼ÐµÑÑÑ†Ð°")],-1),a("p",{class:"mode-text"}," ÐžÑ‚Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 3 Ð¼ÐµÑÑÑ†Ð° Ñ Ð´ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹ Ð¿Ð¾ Ð¼ÐµÑÑÑ†Ð°Ð¼ Ð¸ Ð½ÐµÐ´ÐµÐ»ÑÐ¼ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð¼ÐµÑÑÑ†ÐµÐ². ÐŸÐ¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ Ð´Ð¾Ð»Ð³Ð¾ÑÑ€Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¸ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ñ€ÐµÐ½Ð´Ð¾Ð². ",-1)])],2)])])])])):Q("",!0)]),_:1})]))}},ca=be(ia,[["__scopeId","data-v-4a42a9a6"]]),da={class:"ac-chart"},ua={class:"ac-chart__header"},va={class:"ac-chart__subtitle"},ka={class:"ac-chart__controls"},ha={class:"chart-type-selector"},ya=["onClick"],ma={class:"chart-type-icon"},_a={class:"chart-type-label"},fa={class:"ac-chart__summary"},pa={class:"summary-week-block summary-week-block--current"},ga={class:"summary-week-block__title"},ba={class:"summary-week-block__title-week"},wa={key:0,class:"summary-week-block__title-dates"},Ca={class:"summary-week-block__cards"},Ta={class:"summary-card__value-wrapper"},$a={class:"summary-card__value"},Wa=["title"],Aa={class:"percentage-indicator__arrow"},Da={class:"percentage-indicator__value"},Ea={class:"percentage-indicator__label"},Ua={class:"summary-card__value-wrapper"},Na={class:"summary-card__value-main"},Sa=["title"],Ia={class:"percentage-indicator__arrow"},Ma={class:"percentage-indicator__value"},Oa={class:"percentage-indicator__label"},Ba={class:"summary-card__breakdown"},Ra={class:"breakdown-item breakdown-item--this-week"},Pa={class:"breakdown-item__value"},xa={class:"breakdown-item breakdown-item--other-week"},La={class:"breakdown-item__value"},Ga={class:"summary-card__value-wrapper"},Fa={class:"summary-card__value-main"},Va=["title"],Ya={class:"percentage-indicator__arrow"},Ha={class:"percentage-indicator__value"},ja={class:"percentage-indicator__label"},za={class:"summary-card__breakdown"},qa={class:"breakdown-item breakdown-item--this-week"},Za={class:"breakdown-item__value"},Xa={class:"breakdown-item breakdown-item--previous-week"},Ja={class:"breakdown-item__value"},Ka={class:"breakdown-item breakdown-item--older"},Qa={class:"breakdown-item__value"},es={class:"summary-card summary-card--stages"},ts={class:"summary-card__tags"},as={key:0,class:"stage-tag stage-tag--empty"},ss={key:0,class:"summary-week-divider"},rs={key:1,class:"summary-week-block summary-week-block--previous"},os={class:"summary-week-block__title"},ns={class:"summary-week-block__title-week"},ls={key:0,class:"summary-week-block__title-dates"},is={class:"summary-week-block__cards"},cs={class:"summary-card__value-wrapper"},ds={class:"summary-card__values-comparison"},us={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},vs={class:"summary-card__value"},ks={class:"value-label"},hs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},ys={class:"summary-card__value summary-card__value--current-week"},ms={class:"value-label"},_s=["title"],fs={class:"percentage-indicator__arrow"},ps={class:"percentage-indicator__value"},gs={class:"percentage-indicator__label"},bs={class:"summary-card__value-wrapper"},ws={class:"summary-card__values-comparison"},Cs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Ts={class:"summary-card__value-main"},$s={class:"value-label"},Ws={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},As={class:"summary-card__value-main summary-card__value-main--current-week"},Ds={class:"value-label"},Es=["title"],Us={class:"percentage-indicator__arrow"},Ns={class:"percentage-indicator__value"},Ss={class:"percentage-indicator__label"},Is={class:"summary-card__breakdown"},Ms={class:"breakdown-item breakdown-item--this-week"},Os={class:"breakdown-item__value"},Bs={class:"breakdown-item breakdown-item--other-week"},Rs={class:"breakdown-item__value"},Ps={class:"summary-card__value-wrapper"},xs={class:"summary-card__values-comparison"},Ls={class:"summary-card__value-comparison-item summary-card__value-comparison-item--previous"},Gs={class:"summary-card__value-main"},Fs={class:"value-label"},Vs={class:"summary-card__value-comparison-item summary-card__value-comparison-item--current"},Ys={class:"summary-card__value-main summary-card__value-main--current-week"},Hs={class:"value-label"},js=["title"],zs={class:"percentage-indicator__arrow"},qs={class:"percentage-indicator__value"},Zs={class:"percentage-indicator__label"},Xs={class:"summary-card__breakdown"},Js={class:"breakdown-item breakdown-item--this-week"},Ks={class:"breakdown-item__value"},Qs={class:"breakdown-item breakdown-item--previous-week"},er={class:"breakdown-item__value"},tr={class:"breakdown-item breakdown-item--older"},ar={class:"breakdown-item__value"},sr={class:"summary-card summary-card--stages summary-card--previous"},rr={class:"summary-card__tags"},or={key:0,class:"stage-tag stage-tag--empty"},nr={class:"ac-chart__body"},lr={key:0,class:"split-charts-container"},ir={class:"chart-wrapper chart-wrapper--left"},cr={class:"chart-canvas-wrapper"},dr={class:"chart-wrapper chart-wrapper--right"},ur={class:"chart-canvas-wrapper"},vr={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0],carryoverCreatedOtherWeek:[0]},stagesByWeek:[],stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(r,{emit:t}){const e=r,s=t,o=q(()=>{var n;const u=((n=e.meta)==null?void 0:n.weeks)||[];return u.length>=2?u[u.length-2]:null}),l=[{value:"line",label:"Ð›Ð¸Ð½ÐµÐ¹Ð½Ñ‹Ð¹",icon:"ðŸ“ˆ"},{value:"bar",label:"Ð¡Ñ‚Ð¾Ð»Ð±Ñ‡Ð°Ñ‚Ñ‹Ð¹",icon:"ðŸ“Š"},{value:"doughnut",label:"ÐšÑ€ÑƒÐ³Ð¾Ð²Ð°Ñ",icon:"ðŸ©"}],d=Z("line");q(()=>{var u;return((u=e.meta)==null?void 0:u.weekNumber)??"â€”"});const k=()=>{var n,i;const u=((n=e.meta)==null?void 0:n.weeks)||[];return u.length>0?u.map(A=>`ÐÐµÐ´ÐµÐ»Ñ ${A.weekNumber}`):[(i=e.meta)!=null&&i.weekNumber?`ÐÐµÐ´ÐµÐ»Ñ ${e.meta.weekNumber}`:"ÐÐµÐ´ÐµÐ»Ñ"]};function y(u,n,i,A=.3,P=0){if(!n)return((p,c)=>{const F=parseInt(p.slice(1,3),16),I=parseInt(p.slice(3,5),16),J=parseInt(p.slice(5,7),16);return`rgba(${F}, ${I}, ${J}, ${c})`})(i,A);const B=(ee,p)=>{const c=parseInt(ee.slice(1,3),16),F=parseInt(ee.slice(3,5),16),I=parseInt(ee.slice(5,7),16);return`rgba(${c}, ${F}, ${I}, ${p})`},Y=u.createLinearGradient(0,n.bottom,0,n.top);return Y.addColorStop(0,B(i,A)),Y.addColorStop(1,B(i,P)),Y}const f=q(()=>{var B,Y,ee,p;const u=k(),n=Array.isArray((B=e.data.series)==null?void 0:B.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],i=Array.isArray((Y=e.data.series)==null?void 0:Y.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],A=Array.isArray((ee=e.data.series)==null?void 0:ee.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],P=Array.isArray((p=e.data.series)==null?void 0:p.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:u,datasets:[{label:"ÐÐ¾Ð²Ñ‹Ðµ",data:n,backgroundColor:c=>{const F=c.chart,{ctx:I,chartArea:J}=F;return y(I,J,H.primary)},borderColor:H.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.primary},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (Ð²ÑÐµ)",data:i,backgroundColor:c=>{const F=c.chart,{ctx:I,chartArea:J}=F;return y(I,J,H.success)},borderColor:H.success,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.success},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:A,backgroundColor:H.successLight,borderColor:H.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.successLight},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:P,backgroundColor:H.warning,borderColor:H.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.warning}]}}),E=q(()=>{var B,Y,ee,p,c;const u=k(),n=Array.isArray((B=e.data.series)==null?void 0:B.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],i=Array.isArray((Y=e.data.series)==null?void 0:Y.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],A=Array.isArray((ee=e.data.series)==null?void 0:ee.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],P=Array.isArray((p=e.data.series)==null?void 0:p.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((c=e.data.series)==null?void 0:c.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:u,datasets:[{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (Ð²ÑÐµ)",data:n,backgroundColor:F=>{const I=F.chart,{ctx:J,chartArea:ie}=I;return y(J,ie,H.carryover)},borderColor:H.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryover},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:i,backgroundColor:H.carryoverLight,borderColor:H.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryoverLight},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:A,backgroundColor:H.warning,borderColor:H.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.warning},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð½ÐµÐ´ÐµÐ»ÑÐ¼Ð¸)",data:P,backgroundColor:H.carryoverDark,borderColor:H.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:H.carryoverDark}]}}),x=q(()=>{var F,I,J,ie,ke,he,ye,me,_e,fe,pe;const u=((F=e.meta)==null?void 0:F.weeks)||[],n=u.length>0?u.map(ge=>`ÐÐµÐ´ÐµÐ»Ñ ${ge.weekNumber}`):[(I=e.meta)!=null&&I.weekNumber?`ÐÐµÐ´ÐµÐ»Ñ ${e.meta.weekNumber}`:"ÐÐµÐ´ÐµÐ»Ñ"],i=Array.isArray((J=e.data.series)==null?void 0:J.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],A=Array.isArray((ie=e.data.series)==null?void 0:ie.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],P=Array.isArray((ke=e.data.series)==null?void 0:ke.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],B=Array.isArray((he=e.data.series)==null?void 0:he.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],Y=Array.isArray((ye=e.data.series)==null?void 0:ye.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],ee=Array.isArray((me=e.data.series)==null?void 0:me.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],p=Array.isArray((_e=e.data.series)==null?void 0:_e.carryoverCreatedPreviousWeek)&&e.data.series.carryoverCreatedPreviousWeek.length>0?e.data.series.carryoverCreatedPreviousWeek:[e.data.carryoverTicketsCreatedPreviousWeek??0],c=Array.isArray((fe=e.data.series)==null?void 0:fe.carryoverCreatedOlder)&&e.data.series.carryoverCreatedOlder.length>0?e.data.series.carryoverCreatedOlder:[e.data.carryoverTicketsCreatedOlder??0];return Array.isArray((pe=e.data.series)==null?void 0:pe.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:e.data.carryoverTicketsCreatedOtherWeek,{labels:n,datasets:[{label:"ÐÐ¾Ð²Ñ‹Ðµ",data:i,backgroundColor:H.primary,borderColor:H.primary,tension:.3,fill:!1},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (Ð²ÑÐµ)",data:A,backgroundColor:H.success,borderColor:H.success,tension:.3,fill:!1},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:P,backgroundColor:H.successLight,borderColor:H.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:B,backgroundColor:H.warning,borderColor:H.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (Ð²ÑÐµ)",data:Y,backgroundColor:H.carryover,borderColor:H.carryover,tension:.3,fill:!1},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:ee,backgroundColor:H.carryoverLight,borderColor:H.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹)",data:p,backgroundColor:H.warning,borderColor:H.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð½ÐµÐ´ÐµÐ»ÑÐ¼Ð¸)",data:c,backgroundColor:H.carryoverDark,borderColor:H.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),X=q(()=>({labels:["ÐÐ¾Ð²Ñ‹Ðµ","Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ","ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[H.primary,H.success,H.carryover],borderWidth:1}]})),K=q(()=>{switch(d.value){case"line":return De;case"bar":return ta;case"doughnut":return ea;default:return De}}),U=q(()=>d.value==="doughnut"?X.value:x.value),W=u=>{if(!u)return"â€”";try{return new Date(u).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return u}};function b(u){return u==null||isNaN(u)?"0":u>=1e3?u.toLocaleString("ru-RU"):u.toString()}function v(u){const n=u%10,i=u%100;return i>=11&&i<=14?"Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²":n===1?"Ñ‚Ð¸ÐºÐµÑ‚":n>=2&&n<=4?"Ñ‚Ð¸ÐºÐµÑ‚Ð°":"Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²"}const h=q(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:u=>{var Y,ee,p,c,F,I;if(!u||u.length===0)return"";const n=(Y=u[0])==null?void 0:Y.dataIndex,i=((ee=e.meta)==null?void 0:ee.weeks)||[];if(i.length>0&&n!==void 0&&i[n]){const J=i[n];return`ÐÐµÐ´ÐµÐ»Ñ ${J.weekNumber} (${W(J.weekStartUtc)} â€” ${W(J.weekEndUtc)})`}const A=(p=e.meta)==null?void 0:p.weekNumber,P=(c=e.meta)==null?void 0:c.weekStartUtc,B=(F=e.meta)==null?void 0:F.weekEndUtc;return A&&P&&B?`ÐÐµÐ´ÐµÐ»Ñ ${A} (${W(P)} â€” ${W(B)})`:((I=u[0])==null?void 0:I.label)||""},label:u=>{const n=u.parsed.y,i=u.dataset.label||"";if(n==null||isNaN(n))return`${i}: 0 Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²`;const A=b(n),P=v(n);return`${i}: ${A} ${P}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:u=>$t.defaults.plugins.legend.labels.generateLabels(u).map((i,A)=>{const P=u.data.datasets[A],B=u.getDatasetMeta(A),Y=P.borderDash&&Array.isArray(P.borderDash)&&P.borderDash.length>0||P.borderWidth===2||P.fill===!1;return B.hidden?(i.fontColor="#9ca3af",i.textDecoration="line-through",i.opacity=.5):Y?i.fontColor="#6b7280":i.fontColor="#111827",i})},onClick:(u,n)=>{const i=n.datasetIndex;if(i==null){console.warn("[Legend] Invalid datasetIndex:",i);return}const A=u.chart;if(!A){console.warn("[Legend] Chart not found");return}const P=A.getDatasetMeta(i);if(!P){console.warn("[Legend] Dataset meta not found for index:",i);return}P.hidden=!P.hidden,A.update("active")},onHover:(u,n)=>{u.native&&u.native.target&&(u.native.target.style.cursor="pointer")},onLeave:(u,n)=>{u.native&&u.native.target&&(u.native.target.style.cursor="default")}}},scales:d.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:u=>u==null||isNaN(u)?"0":b(u)},title:{display:!1},grid:{color:u=>{if(!u||!u.tick||u.tick.value===void 0)return"#e5e7eb";const n=u.tick.value;return isNaN(n)||!isFinite(n)?"#e5e7eb":n===0||n%5===0?"#d1d5db":"#e5e7eb"},lineWidth:u=>{if(!u||!u.tick||u.tick.value===void 0)return 1;const n=u.tick.value;return isNaN(n)||!isFinite(n)?1:n===0||n%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),T=q(()=>{var u,n,i,A,P,B,Y,ee;if((u=e.data)!=null&&u.series){const p=e.data.series,c=Math.max((Array.isArray(p.new)?p.new.length:0)-1,(Array.isArray(p.closed)?p.closed.length:0)-1,(Array.isArray(p.closedCreatedThisWeek)?p.closedCreatedThisWeek.length:0)-1,(Array.isArray(p.closedCreatedOtherWeek)?p.closedCreatedOtherWeek.length:0)-1,(Array.isArray(p.carryover)?p.carryover.length:0)-1,(Array.isArray(p.carryoverCreatedThisWeek)?p.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(p.carryoverCreatedPreviousWeek)?p.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(p.carryoverCreatedOlder)?p.carryoverCreatedOlder.length:0)-1,(Array.isArray(p.carryoverCreatedOtherWeek)?p.carryoverCreatedOtherWeek.length:0)-1,-1);if(c>=0){const F={newTickets:Array.isArray(p.new)&&p.new[c]!==void 0?p.new[c]:0,closedTickets:Array.isArray(p.closed)&&p.closed[c]!==void 0?p.closed[c]:0,closedTicketsCreatedThisWeek:Array.isArray(p.closedCreatedThisWeek)&&p.closedCreatedThisWeek[c]!==void 0?p.closedCreatedThisWeek[c]:0,closedTicketsCreatedOtherWeek:Array.isArray(p.closedCreatedOtherWeek)&&p.closedCreatedOtherWeek[c]!==void 0?p.closedCreatedOtherWeek[c]:0,carryoverTickets:Array.isArray(p.carryover)&&p.carryover[c]!==void 0?p.carryover[c]:0,carryoverTicketsCreatedThisWeek:Array.isArray(p.carryoverCreatedThisWeek)&&p.carryoverCreatedThisWeek[c]!==void 0?p.carryoverCreatedThisWeek[c]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(p.carryoverCreatedPreviousWeek)&&p.carryoverCreatedPreviousWeek[c]!==void 0?p.carryoverCreatedPreviousWeek[c]:0,carryoverTicketsCreatedOlder:Array.isArray(p.carryoverCreatedOlder)&&p.carryoverCreatedOlder[c]!==void 0?p.carryoverCreatedOlder[c]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(p.carryoverCreatedOtherWeek)&&p.carryoverCreatedOtherWeek[c]!==void 0?p.carryoverCreatedOtherWeek[c]:0};if(F.carryoverTickets>0&&console.log("[DEBUG currentWeekData]",{total:F.carryoverTickets,thisWeek:F.carryoverTicketsCreatedThisWeek,previousWeek:F.carryoverTicketsCreatedPreviousWeek,older:F.carryoverTicketsCreatedOlder,otherWeek:F.carryoverTicketsCreatedOtherWeek,sum:F.carryoverTicketsCreatedThisWeek+F.carryoverTicketsCreatedPreviousWeek+F.carryoverTicketsCreatedOlder,lastIndex:c,series:{carryoverCreatedPreviousWeek:p.carryoverCreatedPreviousWeek,carryoverCreatedOlder:p.carryoverCreatedOlder,carryoverCreatedPreviousWeekLength:(n=p.carryoverCreatedPreviousWeek)==null?void 0:n.length,carryoverCreatedOlderLength:(i=p.carryoverCreatedOlder)==null?void 0:i.length,carryoverCreatedPreviousWeekLast:(A=p.carryoverCreatedPreviousWeek)==null?void 0:A[c],carryoverCreatedOlderLast:(P=p.carryoverCreatedOlder)==null?void 0:P[c]},currentWeek:e.data.currentWeek,data:{carryoverTicketsCreatedPreviousWeek:e.data.carryoverTicketsCreatedPreviousWeek,carryoverTicketsCreatedOlder:e.data.carryoverTicketsCreatedOlder}}),F.newTickets>0||F.closedTickets>0||F.carryoverTickets>0)return F}}if((B=e.data)!=null&&B.currentWeek&&typeof e.data.currentWeek=="object"){const p=e.data.currentWeek;if((p.newTickets??0)>0||(p.closedTickets??0)>0||(p.carryoverTickets??0)>0)return p}if((Y=e.data)!=null&&Y.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const p=e.data.weeksData[e.data.weeksData.length-1];if((p.newTickets??0)>0||(p.closedTickets??0)>0||(p.carryoverTickets??0)>0)return p}if((ee=e.data)!=null&&ee.series){const p=e.data.series,c=Math.max((Array.isArray(p.new)?p.new.length:0)-1,(Array.isArray(p.closed)?p.closed.length:0)-1,(Array.isArray(p.carryover)?p.carryover.length:0)-1,-1);if(c>=0)return{newTickets:Array.isArray(p.new)&&p.new[c]!==void 0?p.new[c]:0,closedTickets:Array.isArray(p.closed)&&p.closed[c]!==void 0?p.closed[c]:0,closedTicketsCreatedThisWeek:Array.isArray(p.closedCreatedThisWeek)&&p.closedCreatedThisWeek[c]!==void 0?p.closedCreatedThisWeek[c]:0,closedTicketsCreatedOtherWeek:Array.isArray(p.closedCreatedOtherWeek)&&p.closedCreatedOtherWeek[c]!==void 0?p.closedCreatedOtherWeek[c]:0,carryoverTickets:Array.isArray(p.carryover)&&p.carryover[c]!==void 0?p.carryover[c]:0,carryoverTicketsCreatedThisWeek:Array.isArray(p.carryoverCreatedThisWeek)&&p.carryoverCreatedThisWeek[c]!==void 0?p.carryoverCreatedThisWeek[c]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(p.carryoverCreatedPreviousWeek)&&p.carryoverCreatedPreviousWeek[c]!==void 0?p.carryoverCreatedPreviousWeek[c]:0,carryoverTicketsCreatedOlder:Array.isArray(p.carryoverCreatedOlder)&&p.carryoverCreatedOlder[c]!==void 0?p.carryoverCreatedOlder[c]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(p.carryoverCreatedOtherWeek)&&p.carryoverCreatedOtherWeek[c]!==void 0?p.carryoverCreatedOtherWeek[c]:0}}return e.data||{}}),D=q(()=>{var n,i,A,P,B,Y,ee,p,c,F;const u=((n=e.meta)==null?void 0:n.weeks)||[];return u.length>0?u[u.length-1]:{weekNumber:((A=(i=e.meta)==null?void 0:i.currentWeek)==null?void 0:A.weekNumber)??((P=e.meta)==null?void 0:P.weekNumber)??null,weekStartUtc:((Y=(B=e.meta)==null?void 0:B.currentWeek)==null?void 0:Y.weekStartUtc)??((ee=e.meta)==null?void 0:ee.weekStartUtc)??null,weekEndUtc:((c=(p=e.meta)==null?void 0:p.currentWeek)==null?void 0:c.weekEndUtc)??((F=e.meta)==null?void 0:F.weekEndUtc)??null}}),$=q(()=>{var u,n,i,A,P,B,Y,ee,p;if((u=e.data)!=null&&u.series){const c=e.data.series,F=Math.max((Array.isArray(c.new)?c.new.length:0)-1,(Array.isArray(c.closed)?c.closed.length:0)-1,(Array.isArray(c.closedCreatedThisWeek)?c.closedCreatedThisWeek.length:0)-1,(Array.isArray(c.closedCreatedOtherWeek)?c.closedCreatedOtherWeek.length:0)-1,(Array.isArray(c.carryover)?c.carryover.length:0)-1,(Array.isArray(c.carryoverCreatedThisWeek)?c.carryoverCreatedThisWeek.length:0)-1,(Array.isArray(c.carryoverCreatedPreviousWeek)?c.carryoverCreatedPreviousWeek.length:0)-1,(Array.isArray(c.carryoverCreatedOlder)?c.carryoverCreatedOlder.length:0)-1,(Array.isArray(c.carryoverCreatedOtherWeek)?c.carryoverCreatedOtherWeek.length:0)-1,-1);if(F>=1){const I=F-1,J=(i=(n=e.meta)==null?void 0:n.weeks)==null?void 0:i[I],ie={weekNumber:(J==null?void 0:J.weekNumber)??null,weekStartUtc:(J==null?void 0:J.weekStartUtc)??null,weekEndUtc:(J==null?void 0:J.weekEndUtc)??null,newTickets:Array.isArray(c.new)&&c.new[I]!==void 0?c.new[I]:0,closedTickets:Array.isArray(c.closed)&&c.closed[I]!==void 0?c.closed[I]:0,closedTicketsCreatedThisWeek:Array.isArray(c.closedCreatedThisWeek)&&c.closedCreatedThisWeek[I]!==void 0?c.closedCreatedThisWeek[I]:0,closedTicketsCreatedOtherWeek:Array.isArray(c.closedCreatedOtherWeek)&&c.closedCreatedOtherWeek[I]!==void 0?c.closedCreatedOtherWeek[I]:0,carryoverTickets:Array.isArray(c.carryover)&&c.carryover[I]!==void 0?c.carryover[I]:0,carryoverTicketsCreatedThisWeek:Array.isArray(c.carryoverCreatedThisWeek)&&c.carryoverCreatedThisWeek[I]!==void 0?c.carryoverCreatedThisWeek[I]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(c.carryoverCreatedPreviousWeek)&&c.carryoverCreatedPreviousWeek[I]!==void 0?c.carryoverCreatedPreviousWeek[I]:0,carryoverTicketsCreatedOlder:Array.isArray(c.carryoverCreatedOlder)&&c.carryoverCreatedOlder[I]!==void 0?c.carryoverCreatedOlder[I]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(c.carryoverCreatedOtherWeek)&&c.carryoverCreatedOtherWeek[I]!==void 0?c.carryoverCreatedOtherWeek[I]:0};if(ie.newTickets>0||ie.closedTickets>0||ie.carryoverTickets>0)return ie}}if((A=e.data)!=null&&A.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>=2){const c=e.data.weeksData.length-2,F=e.data.weeksData[c],I=(B=(P=e.meta)==null?void 0:P.weeks)==null?void 0:B[c];if((F.newTickets??0)>0||(F.closedTickets??0)>0||(F.carryoverTickets??0)>0)return{weekNumber:F.weekNumber??(I==null?void 0:I.weekNumber)??null,weekStartUtc:(I==null?void 0:I.weekStartUtc)??null,weekEndUtc:(I==null?void 0:I.weekEndUtc)??null,newTickets:F.newTickets??0,closedTickets:F.closedTickets??0,closedTicketsCreatedThisWeek:F.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:F.closedTicketsCreatedOtherWeek??0,carryoverTickets:F.carryoverTickets??0,carryoverTicketsCreatedThisWeek:F.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:F.carryoverTicketsCreatedOtherWeek??0}}if((Y=e.data)!=null&&Y.series){const c=e.data.series,F=Math.max((Array.isArray(c.new)?c.new.length:0)-1,(Array.isArray(c.closed)?c.closed.length:0)-1,(Array.isArray(c.carryover)?c.carryover.length:0)-1,-1);if(F>=1){const I=F-1,J=(p=(ee=e.meta)==null?void 0:ee.weeks)==null?void 0:p[I];return{weekNumber:(J==null?void 0:J.weekNumber)??null,weekStartUtc:(J==null?void 0:J.weekStartUtc)??null,weekEndUtc:(J==null?void 0:J.weekEndUtc)??null,newTickets:Array.isArray(c.new)&&c.new[I]!==void 0?c.new[I]:0,closedTickets:Array.isArray(c.closed)&&c.closed[I]!==void 0?c.closed[I]:0,closedTicketsCreatedThisWeek:Array.isArray(c.closedCreatedThisWeek)&&c.closedCreatedThisWeek[I]!==void 0?c.closedCreatedThisWeek[I]:0,closedTicketsCreatedOtherWeek:Array.isArray(c.closedCreatedOtherWeek)&&c.closedCreatedOtherWeek[I]!==void 0?c.closedCreatedOtherWeek[I]:0,carryoverTickets:Array.isArray(c.carryover)&&c.carryover[I]!==void 0?c.carryover[I]:0,carryoverTicketsCreatedThisWeek:Array.isArray(c.carryoverCreatedThisWeek)&&c.carryoverCreatedThisWeek[I]!==void 0?c.carryoverCreatedThisWeek[I]:0,carryoverTicketsCreatedPreviousWeek:Array.isArray(c.carryoverCreatedPreviousWeek)&&c.carryoverCreatedPreviousWeek[I]!==void 0?c.carryoverCreatedPreviousWeek[I]:0,carryoverTicketsCreatedOlder:Array.isArray(c.carryoverCreatedOlder)&&c.carryoverCreatedOlder[I]!==void 0?c.carryoverCreatedOlder[I]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(c.carryoverCreatedOtherWeek)&&c.carryoverCreatedOtherWeek[I]!==void 0?c.carryoverCreatedOtherWeek[I]:0}}}return null}),S=q(()=>{var n;const u=(n=e.data)==null?void 0:n.stagesByWeek;return Array.isArray(u)?u:null}),j=q(()=>{var n;const u=S.value;if(u&&u.length>0){const i=u.length-1,A=u[i];if(Array.isArray(A))return A}return((n=e.data)==null?void 0:n.stages)??[]}),N=q(()=>{const u=S.value;if(u&&u.length>=2){const n=u.length-2,i=u[n];if(Array.isArray(i))return i}return[]}),R=q(()=>{var u;return(u=$.value)!=null&&u.weekNumber?`ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð½ÐµÐ´ÐµÐ»Ð¸ ${$.value.weekNumber}`:"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…"});function L(u,n){if(typeof u!="number"||isNaN(u)||n==null||typeof n!="number"||isNaN(n)||n===0)return null;if(u===n)return 0;const i=(u-n)/n*100;return!isFinite(i)||isNaN(i)?null:i}function G(u){return u==null||isNaN(u)?"":`${u>=0?"+":""}${u.toFixed(1)}%`}const M=q(()=>{var u,n,i;if((u=e.data)!=null&&u.series){const A=e.data.series,P=Math.max((Array.isArray(A.new)?A.new.length:0)-1,(Array.isArray(A.closed)?A.closed.length:0)-1,(Array.isArray(A.carryover)?A.carryover.length:0)-1,-1);if(P>=2){const B=P-2,Y=(i=(n=e.meta)==null?void 0:n.weeks)==null?void 0:i[B];return{weekNumber:(Y==null?void 0:Y.weekNumber)??null,newTickets:Array.isArray(A.new)&&A.new[B]!==void 0?A.new[B]:0,closedTickets:Array.isArray(A.closed)&&A.closed[B]!==void 0?A.closed[B]:0,carryoverTickets:Array.isArray(A.carryover)&&A.carryover[B]!==void 0?A.carryover[B]:0}}}return null}),z=q(()=>{const u=T.value,n=$.value;return!u||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:L(u.newTickets??0,n.newTickets??0),closedTickets:L(u.closedTickets??0,n.closedTickets??0),carryoverTickets:L(u.carryoverTickets??0,n.carryoverTickets??0)}}),w=q(()=>{const u=$.value,n=M.value;return!u||!n?{newTickets:null,closedTickets:null,carryoverTickets:null}:{newTickets:L(u.newTickets??0,n.newTickets??0),closedTickets:L(u.closedTickets??0,n.closedTickets??0),carryoverTickets:L(u.carryoverTickets??0,n.carryoverTickets??0)}});function m(u,n){if(!u||!n)return"";try{const i=new Date(u),A=new Date(n),P=i.getUTCDate(),B=i.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),Y=i.getUTCFullYear(),ee=A.getUTCDate(),p=A.toLocaleDateString("ru-RU",{month:"short",timeZone:"UTC"}),c=A.getUTCFullYear();return Y===c&&B===p?`${P} â€” ${ee} ${B}`:Y===c?`${P} ${B} â€” ${ee} ${p}`:`${P} ${B} ${Y} â€” ${ee} ${p} ${c}`}catch(i){return console.error("[formatWeekDates] Error:",i),""}}const O=u=>{var Y;const n=T.value,i=(n==null?void 0:n.newTickets)??0,A=(n==null?void 0:n.closedTickets)??0,P=(n==null?void 0:n.carryoverTickets)??0,B=D.value;u==="new"&&i>0?s("open-stages",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc}):u==="closed"&&A>0?(((Y=e.data)==null?void 0:Y.responsible)||[]).length>0&&s("open-responsible",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc}):u==="carryover"&&P>0&&s("open-carryover",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc})},V=u=>{const n=$.value;if(!n)return;const i=(n==null?void 0:n.newTickets)??0,A=(n==null?void 0:n.closedTickets)??0,P=(n==null?void 0:n.carryoverTickets)??0,B=o.value;B&&(u==="new"&&i>0?s("open-stages",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc}):u==="closed"&&A>0?s("open-responsible",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc}):u==="carryover"&&P>0&&s("open-carryover",{weekNumber:B.weekNumber,weekStartUtc:B.weekStartUtc,weekEndUtc:B.weekEndUtc}))};return(u,n)=>{var i,A,P,B,Y,ee,p,c,F,I,J,ie,ke,he,ye,me,_e,fe,pe,ge,$e,Ee,Ue,Ne,Se,Ie,Me,Oe,Be,Re,Pe,xe,Le,nt,lt,it,ct,dt,ut,vt,kt,ht,yt,mt,_t,ft;return _(),g("div",da,[a("header",ua,[a("div",null,[n[6]||(n[6]=a("h2",{class:"ac-chart__title"},"Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹ ÑÐµÐºÑ‚Ð¾Ñ€Ð° 1Ð¡",-1)),a("p",va," ÐÐµÐ´ÐµÐ»Ñ "+C(((A=(i=r.meta)==null?void 0:i.currentWeek)==null?void 0:A.weekNumber)??((P=r.meta)==null?void 0:P.weekNumber)??"â€”")+" Â· "+C((((Y=(B=r.meta)==null?void 0:B.currentWeek)==null?void 0:Y.weekStartUtc)??((ee=r.meta)==null?void 0:ee.weekStartUtc))||"â€”")+" â€” "+C((((c=(p=r.meta)==null?void 0:p.currentWeek)==null?void 0:c.weekEndUtc)??((F=r.meta)==null?void 0:F.weekEndUtc))||"â€”")+" (UTC) ",1)]),a("div",ka,[a("div",ha,[(_(),g(ae,null,se(l,ne=>a("button",{key:ne.value,class:oe(["chart-type-btn",{active:d.value===ne.value}]),onClick:vc=>d.value=ne.value},[a("span",ma,C(ne.icon),1),a("span",_a,C(ne.label),1)],10,ya)),64))])])]),a("section",fa,[a("div",pa,[a("h3",ga,[n[7]||(n[7]=a("span",{class:"summary-week-block__title-text"},"Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð½ÐµÐ´ÐµÐ»Ñ",-1)),a("span",ba," ÐÐµÐ´ÐµÐ»Ñ "+C(D.value.weekNumber??"â€”"),1),D.value.weekStartUtc?(_(),g("span",wa,C(m(D.value.weekStartUtc,D.value.weekEndUtc)),1)):Q("",!0)]),a("div",Ca,[a("div",{class:"summary-card summary-card--new",onClick:n[0]||(n[0]=ne=>O("new"))},[n[8]||(n[8]=a("div",{class:"summary-card__label"},"ÐÐ¾Ð²Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),a("div",Ta,[a("div",$a,C(((I=T.value)==null?void 0:I.newTickets)??0),1),z.value.newTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",z.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((J=$.value)==null?void 0:J.weekNumber)??"â€”"}): ${G(z.value.newTickets)}`},[a("span",Aa,C(z.value.newTickets>=0?"â†‘":"â†“"),1),a("span",Da,C(G(z.value.newTickets)),1),a("span",Ea,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((ie=$.value)==null?void 0:ie.weekNumber)??"â€”"),1)],10,Wa)):Q("",!0)])]),a("div",{class:"summary-card summary-card--closed-breakdown",onClick:n[1]||(n[1]=ne=>O("closed"))},[n[13]||(n[13]=a("div",{class:"summary-card__label"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),a("div",Ua,[a("div",Na,C(((ke=T.value)==null?void 0:ke.closedTickets)??0),1),z.value.closedTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",z.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((he=$.value)==null?void 0:he.weekNumber)??"â€”"}): ${G(z.value.closedTickets)}`},[a("span",Ia,C(z.value.closedTickets>=0?"â†‘":"â†“"),1),a("span",Ma,C(G(z.value.closedTickets)),1),a("span",Oa,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((ye=$.value)==null?void 0:ye.weekNumber)??"â€”"),1)],10,Sa)):Q("",!0)]),a("div",Ba,[a("div",Ra,[n[9]||(n[9]=a("span",{class:"breakdown-item__icon"},"âœ“",-1)),a("span",Pa,C(((me=T.value)==null?void 0:me.closedTicketsCreatedThisWeek)??0),1),n[10]||(n[10]=a("span",{class:"breakdown-item__label"},"ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹",-1))]),a("div",xa,[n[11]||(n[11]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",La,C(((_e=T.value)==null?void 0:_e.closedTicketsCreatedOtherWeek)??0),1),n[12]||(n[12]=a("span",{class:"breakdown-item__label"},"Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹",-1))])])]),a("div",{class:"summary-card summary-card--carryover-breakdown",onClick:n[2]||(n[2]=ne=>O("carryover"))},[n[20]||(n[20]=a("div",{class:"summary-card__label"},"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ",-1)),a("div",Ga,[a("div",Fa,C(((fe=T.value)==null?void 0:fe.carryoverTickets)??0),1),z.value.carryoverTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",z.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((pe=$.value)==null?void 0:pe.weekNumber)??"â€”"}): ${G(z.value.carryoverTickets)}`},[a("span",Ya,C(z.value.carryoverTickets>=0?"â†‘":"â†“"),1),a("span",Ha,C(G(z.value.carryoverTickets)),1),a("span",ja,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((ge=$.value)==null?void 0:ge.weekNumber)??"â€”"),1)],10,Va)):Q("",!0)]),a("div",za,[a("div",qa,[n[14]||(n[14]=a("span",{class:"breakdown-item__icon"},"âœ“",-1)),a("span",Za,C((($e=T.value)==null?void 0:$e.carryoverTicketsCreatedThisWeek)??0),1),n[15]||(n[15]=a("span",{class:"breakdown-item__label"},"ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ð¸",-1))]),a("div",Xa,[n[16]||(n[16]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",Ja,C(((Ee=T.value)==null?void 0:Ee.carryoverTicketsCreatedPreviousWeek)??0),1),n[17]||(n[17]=a("span",{class:"breakdown-item__label"},"Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸",-1))]),a("div",Ka,[n[18]||(n[18]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",Qa,C(((Ue=T.value)==null?void 0:Ue.carryoverTicketsCreatedOlder)??0),1),n[19]||(n[19]=a("span",{class:"breakdown-item__label"},"Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ",-1))])])]),a("div",es,[n[21]||(n[21]=a("div",{class:"summary-card__label"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾ ÑÑ‚Ð°Ð´Ð¸ÑÐ¼",-1)),a("div",ts,[(_(!0),g(ae,null,se(j.value,ne=>(_(),g("span",{key:ne.stageId,class:"stage-tag"},C(ne.stageName||ne.stageId)+" â€” "+C(ne.count),1))),128)),!j.value||j.value.length===0?(_(),g("span",as," ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… ")):Q("",!0)])])])]),$.value?(_(),g("div",ss,[...n[22]||(n[22]=[a("div",{class:"summary-week-divider__line"},null,-1),a("div",{class:"summary-week-divider__label"},"ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð°Ñ Ð½ÐµÐ´ÐµÐ»Ñ",-1)])])):Q("",!0),$.value?(_(),g("div",rs,[a("h3",os,[n[23]||(n[23]=a("span",{class:"summary-week-block__title-text"},"ÐŸÑ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð°Ñ Ð½ÐµÐ´ÐµÐ»Ñ",-1)),a("span",ns," ÐÐµÐ´ÐµÐ»Ñ "+C($.value.weekNumber??"â€”"),1),$.value.weekStartUtc?(_(),g("span",ls,C(m($.value.weekStartUtc,$.value.weekEndUtc)),1)):Q("",!0)]),a("div",is,[a("div",{class:"summary-card summary-card--new summary-card--previous summary-card--clickable",onClick:n[3]||(n[3]=ne=>V("new"))},[n[24]||(n[24]=a("div",{class:"summary-card__label"},"ÐÐ¾Ð²Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),a("div",cs,[a("div",ds,[a("div",us,[a("div",vs,C(((Ne=$.value)==null?void 0:Ne.newTickets)??0),1),a("span",ks,"ÐÐµÐ´ÐµÐ»Ñ "+C(((Se=$.value)==null?void 0:Se.weekNumber)??"â€”"),1)]),a("div",hs,[a("div",ys,C(((Ie=M.value)==null?void 0:Ie.newTickets)??0),1),a("span",ms,"ÐÐµÐ´ÐµÐ»Ñ "+C(((Me=M.value)==null?void 0:Me.weekNumber)??"â€”"),1)])]),w.value.newTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",w.value.newTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((Oe=M.value)==null?void 0:Oe.weekNumber)??"â€”"}): ${G(w.value.newTickets)}`},[a("span",fs,C(w.value.newTickets>=0?"â†‘":"â†“"),1),a("span",ps,C(G(w.value.newTickets)),1),a("span",gs,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((Be=M.value)==null?void 0:Be.weekNumber)??"â€”"),1)],10,_s)):Q("",!0)])]),a("div",{class:"summary-card summary-card--closed-breakdown summary-card--previous summary-card--clickable",onClick:n[4]||(n[4]=ne=>V("closed"))},[n[29]||(n[29]=a("div",{class:"summary-card__label"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),a("div",bs,[a("div",ws,[a("div",Cs,[a("div",Ts,C(((Re=$.value)==null?void 0:Re.closedTickets)??0),1),a("span",$s,"ÐÐµÐ´ÐµÐ»Ñ "+C(((Pe=$.value)==null?void 0:Pe.weekNumber)??"â€”"),1)]),a("div",Ws,[a("div",As,C(((xe=M.value)==null?void 0:xe.closedTickets)??0),1),a("span",Ds,"ÐÐµÐ´ÐµÐ»Ñ "+C(((Le=M.value)==null?void 0:Le.weekNumber)??"â€”"),1)])]),w.value.closedTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",w.value.closedTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((nt=M.value)==null?void 0:nt.weekNumber)??"â€”"}): ${G(w.value.closedTickets)}`},[a("span",Us,C(w.value.closedTickets>=0?"â†‘":"â†“"),1),a("span",Ns,C(G(w.value.closedTickets)),1),a("span",Ss,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((lt=M.value)==null?void 0:lt.weekNumber)??"â€”"),1)],10,Es)):Q("",!0)]),a("div",Is,[a("div",Ms,[n[25]||(n[25]=a("span",{class:"breakdown-item__icon"},"âœ“",-1)),a("span",Os,C(((it=$.value)==null?void 0:it.closedTicketsCreatedThisWeek)??0),1),n[26]||(n[26]=a("span",{class:"breakdown-item__label"},"ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹",-1))]),a("div",Bs,[n[27]||(n[27]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",Rs,C(((ct=$.value)==null?void 0:ct.closedTicketsCreatedOtherWeek)??0),1),n[28]||(n[28]=a("span",{class:"breakdown-item__label"},"Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÐµÐ¹",-1))])])]),a("div",{class:"summary-card summary-card--carryover-breakdown summary-card--previous summary-card--clickable",onClick:n[5]||(n[5]=ne=>V("carryover"))},[n[36]||(n[36]=a("div",{class:"summary-card__label"},"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ",-1)),a("div",Ps,[a("div",xs,[a("div",Ls,[a("div",Gs,C(((dt=$.value)==null?void 0:dt.carryoverTickets)??0),1),a("span",Fs,"ÐÐµÐ´ÐµÐ»Ñ "+C(((ut=$.value)==null?void 0:ut.weekNumber)??"â€”"),1)]),a("div",Vs,[a("div",Ys,C(((vt=M.value)==null?void 0:vt.carryoverTickets)??0),1),a("span",Hs,"ÐÐµÐ´ÐµÐ»Ñ "+C(((kt=M.value)==null?void 0:kt.weekNumber)??"â€”"),1)])]),w.value.carryoverTickets!==null?(_(),g("div",{key:0,class:oe(["percentage-indicator",w.value.carryoverTickets>=0?"percentage-indicator--positive":"percentage-indicator--negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸ (ÐÐµÐ´ÐµÐ»Ñ ${((ht=M.value)==null?void 0:ht.weekNumber)??"â€”"}): ${G(w.value.carryoverTickets)}`},[a("span",zs,C(w.value.carryoverTickets>=0?"â†‘":"â†“"),1),a("span",qs,C(G(w.value.carryoverTickets)),1),a("span",Zs,"Ðº Ð½ÐµÐ´ÐµÐ»Ðµ "+C(((yt=M.value)==null?void 0:yt.weekNumber)??"â€”"),1)],10,js)):Q("",!0)]),a("div",Xs,[a("div",Js,[n[30]||(n[30]=a("span",{class:"breakdown-item__icon"},"âœ“",-1)),a("span",Ks,C(((mt=$.value)==null?void 0:mt.carryoverTicketsCreatedThisWeek)??0),1),n[31]||(n[31]=a("span",{class:"breakdown-item__label"},"ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ð¸",-1))]),a("div",Qs,[n[32]||(n[32]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",er,C(((_t=$.value)==null?void 0:_t.carryoverTicketsCreatedPreviousWeek)??0),1),n[33]||(n[33]=a("span",{class:"breakdown-item__label"},"Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ¹ Ð½ÐµÐ´ÐµÐ»Ð¸",-1))]),a("div",tr,[n[34]||(n[34]=a("span",{class:"breakdown-item__icon"},"â†»",-1)),a("span",ar,C(((ft=$.value)==null?void 0:ft.carryoverTicketsCreatedOlder)??0),1),n[35]||(n[35]=a("span",{class:"breakdown-item__label"},"Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ",-1))])])]),a("div",sr,[n[37]||(n[37]=a("div",{class:"summary-card__label"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾ ÑÑ‚Ð°Ð´Ð¸ÑÐ¼",-1)),a("div",rr,[(_(!0),g(ae,null,se(N.value,ne=>(_(),g("span",{key:ne.stageId,class:"stage-tag"},C(ne.stageName||ne.stageId)+" â€” "+C(ne.count),1))),128)),!N.value||N.value.length===0?(_(),g("span",or,C(R.value),1)):Q("",!0)])])])])):Q("",!0)]),a("div",nr,[d.value==="line"?(_(),g("div",lr,[a("div",ir,[n[38]||(n[38]=a("h3",{class:"chart-subtitle"},"ÐÐ¾Ð²Ñ‹Ðµ Ð¸ Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹",-1)),a("div",cr,[te(Je(De),{data:f.value,options:h.value},null,8,["data","options"])])]),a("div",dr,[n[39]||(n[39]=a("h3",{class:"chart-subtitle"},"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹",-1)),a("div",ur,[te(Je(De),{data:E.value,options:h.value},null,8,["data","options"])])])])):(_(),ve(Ft(K.value),{key:1,data:U.value,options:h.value},null,8,["data","options"]))])])}}},kr=be(vr,[["__scopeId","data-v-6332c85c"]]),hr={class:"summary-cards-months"},yr={class:"summary-card summary-card--new"},mr={class:"card-content"},_r={class:"card-main-value"},fr=["title"],pr={class:"card-month-breakdown"},gr={class:"month-name"},br={class:"month-value"},wr={key:0,class:"month-item month-item--empty"},Cr={class:"summary-card summary-card--closed"},Tr={class:"card-content"},$r={class:"card-main-value"},Wr=["title"],Ar={class:"card-month-breakdown-hierarchical"},Dr={class:"month-header"},Er={class:"month-name"},Ur={class:"month-value"},Nr={class:"month-breakdown"},Sr={class:"breakdown-item breakdown-this-week"},Ir={class:"breakdown-value"},Mr={class:"breakdown-item breakdown-other-week"},Or={class:"breakdown-value"},Br={key:0,class:"month-item-hierarchical month-item--empty"},Rr={class:"summary-card summary-card--carryover"},Pr={class:"card-content"},xr={class:"card-current-value"},Lr={class:"current-value"},Gr=["title"],Fr={class:"card-month-breakdown"},Vr={class:"month-name"},Yr={class:"month-value"},Hr={key:0,class:"month-item month-item--empty"},jr={class:"summary-card summary-card--stages"},zr={class:"card-content"},qr={class:"stages-list"},Zr={class:"stage-icon"},Xr={class:"stage-name"},Jr={class:"stage-value"},Kr={key:0,class:"stage-item stage-item--empty"},Qr={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(r){const t=r;function e(b){return b==null||isNaN(b)?"0":b>=1e6?(b/1e6).toFixed(1)+"M":b>=1e3?b.toLocaleString("ru-RU"):b.toString()}function s(b){return b==null||isNaN(b)?"":`${b>=0?"+":""}${b.toFixed(1)}%`}function o(b,v){if(typeof b!="number"||isNaN(b)||v==null||typeof v!="number"||isNaN(v)||v===0)return null;if(b===v)return 0;const h=(b-v)/v*100;return!isFinite(h)||isNaN(h)?null:h}const l=q(()=>{var b;return((b=t.data)==null?void 0:b.newTickets)||0}),d=q(()=>e(l.value)),k=q(()=>{var b;return((b=t.data)==null?void 0:b.newTicketsByMonth)||[]}),y=q(()=>{var b;return((b=t.data)==null?void 0:b.closedTicketsByMonth)||[]}),f=q(()=>{var b;return((b=t.data)==null?void 0:b.carryoverTicketsByMonth)||[]}),E=q(()=>{const b=f.value;if(b.length===0)return 0;const v=b[b.length-1];return(v==null?void 0:v.count)||0}),x=q(()=>{var h,T,D,$;const b=typeof((h=t.data)==null?void 0:h.newTickets)=="number"?t.data.newTickets:parseInt((T=t.data)==null?void 0:T.newTickets)||0,v=($=(D=t.data)==null?void 0:D.previousPeriodData)==null?void 0:$.newTickets;return o(b,v)}),X=q(()=>{var h,T,D,$;const b=typeof((h=t.data)==null?void 0:h.closedTickets)=="number"?t.data.closedTickets:parseInt((T=t.data)==null?void 0:T.closedTickets)||0,v=($=(D=t.data)==null?void 0:D.previousPeriodData)==null?void 0:$.closedTickets;return o(b,v)}),K=q(()=>{var T;const b=E.value,v=f.value,h=v.length>0?((T=v[0])==null?void 0:T.count)||0:null;return o(b,h)});function U(b){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[b]||""}function W(b){return{"DT140_12:SUCCESS":"âœ“","DT140_12:FAIL":"âœ—","DT140_12:UC_0GBU8Z":"âš "}[b]||"â€¢"}return(b,v)=>(_(),g("div",hr,[a("div",yr,[v[0]||(v[0]=a("h3",{class:"card-title"},"ÐÐ¾Ð²Ñ‹Ðµ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´",-1)),a("div",mr,[a("div",_r,[ue(C(d.value)+" ",1),x.value!==null?(_(),g("span",{key:0,class:oe(["percentage-badge",x.value>=0?"positive":"negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°: ${s(x.value)}`},C(s(x.value)),11,fr)):Q("",!0)]),a("div",pr,[(_(!0),g(ae,null,se(k.value,h=>(_(),g("div",{key:`new-${h.month}`,class:"month-item"},[a("span",gr,C(h.monthName)+":",1),a("span",br,C(e(h.count)),1)]))),128)),k.value.length===0?(_(),g("div",wr," ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… ")):Q("",!0)])])]),a("div",Cr,[v[5]||(v[5]=a("h3",{class:"card-title"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð²ÑÐµÐ³Ð¾",-1)),a("div",Tr,[a("div",$r,[ue(C(e(r.data.closedTickets||0))+" ",1),X.value!==null?(_(),g("span",{key:0,class:oe(["percentage-badge",X.value>=0?"positive":"negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°: ${s(X.value)}`},C(s(X.value)),11,Wr)):Q("",!0)]),a("div",Ar,[(_(!0),g(ae,null,se(y.value,h=>(_(),g("div",{key:`closed-${h.month}`,class:"month-item-hierarchical"},[a("div",Dr,[a("span",Er,C(h.monthName)+":",1),a("span",Ur,C(e(h.count||0)),1)]),a("div",Nr,[a("div",Sr,[v[1]||(v[1]=a("span",{class:"breakdown-icon"},"âœ“",-1)),v[2]||(v[2]=a("span",{class:"breakdown-label"},"ÑÑ‚Ð¾Ð³Ð¾ Ð¼ÐµÑÑÑ†Ð°:",-1)),a("span",Ir,C(e(h.closedCreatedThisWeek||0)),1)]),a("div",Mr,[v[3]||(v[3]=a("span",{class:"breakdown-icon"},"â†»",-1)),v[4]||(v[4]=a("span",{class:"breakdown-label"},"Ð´Ñ€ÑƒÐ³Ð¾Ð³Ð¾ Ð¼ÐµÑÑÑ†Ð°:",-1)),a("span",Or,C(e(h.closedCreatedOtherWeek||0)),1)])])]))),128)),y.value.length===0?(_(),g("div",Br," ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… ")):Q("",!0)])])]),a("div",Rr,[v[7]||(v[7]=a("h3",{class:"card-title"},"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ð²ÑÐµÐ³Ð¾",-1)),v[8]||(v[8]=a("p",{class:"card-hint"},"ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹ ÑÐµÐºÑ‚Ð¾Ñ€Ð° Ð² Ñ‚Ñ€ÐµÑ… Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ñ… ÑÑ‚Ð°Ð´Ð¸ÑÑ… (Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ)",-1)),a("div",Pr,[a("div",xr,[v[6]||(v[6]=a("span",{class:"current-label"},"Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:",-1)),a("span",Lr,[ue(C(e(E.value))+" ",1),K.value!==null?(_(),g("span",{key:0,class:oe(["percentage-badge",K.value>=0?"positive":"negative"]),title:`Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð½Ð¾ÑÐ¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð°: ${s(K.value)}`},C(s(K.value)),11,Gr)):Q("",!0)])]),a("div",Fr,[(_(!0),g(ae,null,se(f.value,h=>(_(),g("div",{key:`carryover-${h.month}`,class:"month-item"},[a("span",Vr,C(h.monthName)+":",1),a("span",Yr,C(e(h.count||0)),1)]))),128)),f.value.length===0?(_(),g("div",Hr," ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… ")):Q("",!0)])])]),a("div",jr,[v[10]||(v[10]=a("h3",{class:"card-title"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ Ð¿Ð¾ ÑÑ‚Ð°Ð´Ð¸ÑÐ¼",-1)),a("div",zr,[a("div",qr,[(_(!0),g(ae,null,se(r.data.stages||[],h=>(_(),g("div",{key:h.stageId,class:oe(["stage-item",U(h.stageId)])},[a("span",Zr,C(W(h.stageId)),1),a("span",Xr,C(h.stageName||h.stageId)+":",1),a("span",Jr,C(e(h.count||0)),1)],2))),128)),!r.data.stages||r.data.stages.length===0?(_(),g("div",Kr,[...v[9]||(v[9]=[a("span",{class:"stage-name"},"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…",-1)])])):Q("",!0)])])])]))}},eo=be(Qr,[["__scopeId","data-v-15d88b90"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var wt=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var r=window.screen;if(r)return(r.deviceXDPI||1)/(r.logicalXDPI||1)}return 1}(),Ye={toTextLines:function(r){var t=[],e;for(r=[].concat(r);r.length;)e=r.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?r.push.apply(r,e):Fe(r)||t.unshift(""+e);return t},textSize:function(r,t,e){var s=[].concat(t),o=s.length,l=r.font,d=0,k;for(r.font=e.string,k=0;k<o;++k)d=Math.max(r.measureText(s[k]).width,d);return r.font=l,{height:o*e.lineHeight,width:d}},bound:function(r,t,e){return Math.max(r,Math.min(t,e))},arrayDiff:function(r,t){var e=r.slice(),s=[],o,l,d,k;for(o=0,d=t.length;o<d;++o)k=t[o],l=e.indexOf(k),l===-1?s.push([k,1]):e.splice(l,1);for(o=0,d=e.length;o<d;++o)s.push([e[o],-1]);return s},rasterize:function(r){return Math.round(r*wt)/wt}};function tt(r,t){var e=t.x,s=t.y;if(e===null)return{x:0,y:-1};if(s===null)return{x:1,y:0};var o=r.x-e,l=r.y-s,d=Math.sqrt(o*o+l*l);return{x:d?o/d:0,y:d?l/d:-1}}function to(r,t,e,s,o){switch(o){case"center":e=s=0;break;case"bottom":e=0,s=1;break;case"right":e=1,s=0;break;case"left":e=-1,s=0;break;case"top":e=0,s=-1;break;case"start":e=-e,s=-s;break;case"end":break;default:o*=Math.PI/180,e=Math.cos(o),s=Math.sin(o);break}return{x:r,y:t,vx:e,vy:s}}var ao=0,Nt=1,St=2,It=4,Mt=8;function ze(r,t,e){var s=ao;return r<e.left?s|=Nt:r>e.right&&(s|=St),t<e.top?s|=Mt:t>e.bottom&&(s|=It),s}function so(r,t){for(var e=r.x0,s=r.y0,o=r.x1,l=r.y1,d=ze(e,s,t),k=ze(o,l,t),y,f,E;!(!(d|k)||d&k);)y=d||k,y&Mt?(f=e+(o-e)*(t.top-s)/(l-s),E=t.top):y&It?(f=e+(o-e)*(t.bottom-s)/(l-s),E=t.bottom):y&St?(E=s+(l-s)*(t.right-e)/(o-e),f=t.right):y&Nt&&(E=s+(l-s)*(t.left-e)/(o-e),f=t.left),y===d?(e=f,s=E,d=ze(e,s,t)):(o=f,l=E,k=ze(o,l,t));return{x0:e,x1:o,y0:s,y1:l}}function qe(r,t){var e=t.anchor,s=r,o,l;return t.clamp&&(s=so(s,t.area)),e==="start"?(o=s.x0,l=s.y0):e==="end"?(o=s.x1,l=s.y1):(o=(s.x0+s.x1)/2,l=(s.y0+s.y1)/2),to(o,l,r.vx,r.vy,t.align)}var Ze={arc:function(r,t){var e=(r.startAngle+r.endAngle)/2,s=Math.cos(e),o=Math.sin(e),l=r.innerRadius,d=r.outerRadius;return qe({x0:r.x+s*l,y0:r.y+o*l,x1:r.x+s*d,y1:r.y+o*d,vx:s,vy:o},t)},point:function(r,t){var e=tt(r,t.origin),s=e.x*r.options.radius,o=e.y*r.options.radius;return qe({x0:r.x-s,y0:r.y-o,x1:r.x+s,y1:r.y+o,vx:e.x,vy:e.y},t)},bar:function(r,t){var e=tt(r,t.origin),s=r.x,o=r.y,l=0,d=0;return r.horizontal?(s=Math.min(r.x,r.base),l=Math.abs(r.base-r.x)):(o=Math.min(r.y,r.base),d=Math.abs(r.base-r.y)),qe({x0:s,y0:o+d,x1:s+l,y1:o,vx:e.x,vy:e.y},t)},fallback:function(r,t){var e=tt(r,t.origin);return qe({x0:r.x,y0:r.y,x1:r.x+(r.width||0),y1:r.y+(r.height||0),vx:e.x,vy:e.y},t)}},we=Ye.rasterize;function ro(r){var t=r.borderWidth||0,e=r.padding,s=r.size.height,o=r.size.width,l=-o/2,d=-s/2;return{frame:{x:l-e.left-t,y:d-e.top-t,w:o+e.width+t*2,h:s+e.height+t*2},text:{x:l,y:d,w:o,h:s}}}function oo(r,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var s=e.getBasePixel();return r.horizontal?{x:s,y:null}:{x:null,y:s}}function no(r){return r instanceof zt?Ze.arc:r instanceof qt?Ze.point:r instanceof Zt?Ze.bar:Ze.fallback}function lo(r,t,e,s,o,l){var d=Math.PI/2;if(l){var k=Math.min(l,o/2,s/2),y=t+k,f=e+k,E=t+s-k,x=e+o-k;r.moveTo(t,f),y<E&&f<x?(r.arc(y,f,k,-Math.PI,-d),r.arc(E,f,k,-d,0),r.arc(E,x,k,0,d),r.arc(y,x,k,d,Math.PI)):y<E?(r.moveTo(y,e),r.arc(E,f,k,-d,d),r.arc(y,f,k,d,Math.PI+d)):f<x?(r.arc(y,f,k,-Math.PI,0),r.arc(y,x,k,0,Math.PI)):r.arc(y,f,k,-Math.PI,Math.PI),r.closePath(),r.moveTo(t,e)}else r.rect(t,e,s,o)}function io(r,t,e){var s=e.backgroundColor,o=e.borderColor,l=e.borderWidth;!s&&(!o||!l)||(r.beginPath(),lo(r,we(t.x)+l/2,we(t.y)+l/2,we(t.w)-l,we(t.h)-l,e.borderRadius),r.closePath(),s&&(r.fillStyle=s,r.fill()),o&&l&&(r.strokeStyle=o,r.lineWidth=l,r.lineJoin="miter",r.stroke()))}function co(r,t,e){var s=e.lineHeight,o=r.w,l=r.x,d=r.y+s/2;return t==="center"?l+=o/2:(t==="end"||t==="right")&&(l+=o),{h:s,w:o,x:l,y:d}}function uo(r,t,e){var s=r.shadowBlur,o=e.stroked,l=we(e.x),d=we(e.y),k=we(e.w);o&&r.strokeText(t,l,d,k),e.filled&&(s&&o&&(r.shadowBlur=0),r.fillText(t,l,d,k),s&&o&&(r.shadowBlur=s))}function vo(r,t,e,s){var o=s.textAlign,l=s.color,d=!!l,k=s.font,y=t.length,f=s.textStrokeColor,E=s.textStrokeWidth,x=f&&E,X;if(!(!y||!d&&!x))for(e=co(e,o,k),r.font=k.string,r.textAlign=o,r.textBaseline="middle",r.shadowBlur=s.textShadowBlur,r.shadowColor=s.textShadowColor,d&&(r.fillStyle=l),x&&(r.lineJoin="round",r.lineWidth=E,r.strokeStyle=f),X=0,y=t.length;X<y;++X)uo(r,t[X],{stroked:x,filled:d,w:e.w,x:e.x,y:e.y+e.h*X})}var Ot=function(r,t,e,s){var o=this;o._config=r,o._index=s,o._model=null,o._rects=null,o._ctx=t,o._el=e};je(Ot.prototype,{_modelize:function(r,t,e,s){var o=this,l=o._index,d=Yt(le([e.font,{}],s,l)),k=le([e.color,Ht.color],s,l);return{align:le([e.align,"center"],s,l),anchor:le([e.anchor,"center"],s,l),area:s.chart.chartArea,backgroundColor:le([e.backgroundColor,null],s,l),borderColor:le([e.borderColor,null],s,l),borderRadius:le([e.borderRadius,0],s,l),borderWidth:le([e.borderWidth,0],s,l),clamp:le([e.clamp,!1],s,l),clip:le([e.clip,!1],s,l),color:k,display:r,font:d,lines:t,offset:le([e.offset,4],s,l),opacity:le([e.opacity,1],s,l),origin:oo(o._el,s),padding:jt(le([e.padding,4],s,l)),positioner:no(o._el),rotation:le([e.rotation,0],s,l)*(Math.PI/180),size:Ye.textSize(o._ctx,t,d),textAlign:le([e.textAlign,"start"],s,l),textShadowBlur:le([e.textShadowBlur,0],s,l),textShadowColor:le([e.textShadowColor,k],s,l),textStrokeColor:le([e.textStrokeColor,k],s,l),textStrokeWidth:le([e.textStrokeWidth,0],s,l)}},update:function(r){var t=this,e=null,s=null,o=t._index,l=t._config,d,k,y,f=le([l.display,!0],r,o);f&&(d=r.dataset.data[o],k=Vt(Wt(l.formatter,[d,r]),d),y=Fe(k)?[]:Ye.toTextLines(k),y.length&&(e=t._modelize(f,y,l,r),s=ro(e))),t._model=e,t._rects=s},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(r,t){var e=this,s=r.ctx,o=e._model,l=e._rects,d;this.visible()&&(s.save(),o.clip&&(d=o.area,s.beginPath(),s.rect(d.left,d.top,d.right-d.left,d.bottom-d.top),s.clip()),s.globalAlpha=Ye.bound(0,o.opacity,1),s.translate(we(t.x),we(t.y)),s.rotate(o.rotation),io(s,l.frame,o),vo(s,o.lines,l.text,o),s.restore())}});var ko=Number.MIN_SAFE_INTEGER||-9007199254740991,ho=Number.MAX_SAFE_INTEGER||9007199254740991;function Ge(r,t,e){var s=Math.cos(e),o=Math.sin(e),l=t.x,d=t.y;return{x:l+s*(r.x-l)-o*(r.y-d),y:d+o*(r.x-l)+s*(r.y-d)}}function Ct(r,t){var e=ho,s=ko,o=t.origin,l,d,k,y,f;for(l=0;l<r.length;++l)d=r[l],k=d.x-o.x,y=d.y-o.y,f=t.vx*k+t.vy*y,e=Math.min(e,f),s=Math.max(s,f);return{min:e,max:s}}function Xe(r,t){var e=t.x-r.x,s=t.y-r.y,o=Math.sqrt(e*e+s*s);return{vx:(t.x-r.x)/o,vy:(t.y-r.y)/o,origin:r,ln:o}}var Bt=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};je(Bt.prototype,{center:function(){var r=this._rect;return{x:r.x+r.w/2,y:r.y+r.h/2}},update:function(r,t,e){this._rotation=e,this._rect={x:t.x+r.x,y:t.y+r.y,w:t.w,h:t.h}},contains:function(r){var t=this,e=1,s=t._rect;return r=Ge(r,t.center(),-t._rotation),!(r.x<s.x-e||r.y<s.y-e||r.x>s.x+s.w+e*2||r.y>s.y+s.h+e*2)},intersects:function(r){var t=this._points(),e=r._points(),s=[Xe(t[0],t[1]),Xe(t[0],t[3])],o,l,d;for(this._rotation!==r._rotation&&s.push(Xe(e[0],e[1]),Xe(e[0],e[3])),o=0;o<s.length;++o)if(l=Ct(t,s[o]),d=Ct(e,s[o]),l.max<d.min||d.max<l.min)return!1;return!0},_points:function(){var r=this,t=r._rect,e=r._rotation,s=r.center();return[Ge({x:t.x,y:t.y},s,e),Ge({x:t.x+t.w,y:t.y},s,e),Ge({x:t.x+t.w,y:t.y+t.h},s,e),Ge({x:t.x,y:t.y+t.h},s,e)]}});function Rt(r,t,e){var s=t.positioner(r,t),o=s.vx,l=s.vy;if(!o&&!l)return{x:s.x,y:s.y};var d=e.w,k=e.h,y=t.rotation,f=Math.abs(d/2*Math.cos(y))+Math.abs(k/2*Math.sin(y)),E=Math.abs(d/2*Math.sin(y))+Math.abs(k/2*Math.cos(y)),x=1/Math.max(Math.abs(o),Math.abs(l));return f*=o*x,E*=l*x,f+=t.offset*o,E+=t.offset*l,{x:s.x+f,y:s.y+E}}function yo(r,t){var e,s,o,l;for(e=r.length-1;e>=0;--e)for(o=r[e].$layout,s=e-1;s>=0&&o._visible;--s)l=r[s].$layout,l._visible&&o._box.intersects(l._box)&&t(o,l);return r}function mo(r){var t,e,s,o,l,d,k;for(t=0,e=r.length;t<e;++t)s=r[t],o=s.$layout,o._visible&&(k=new Proxy(s._el,{get:(y,f)=>y.getProps([f],!0)[f]}),l=s.geometry(),d=Rt(k,s.model(),l),o._box.update(d,l,s.rotation()));return yo(r,function(y,f){var E=y._hidable,x=f._hidable;E&&x||x?f._visible=!1:E&&(y._visible=!1)})}var He={prepare:function(r){var t=[],e,s,o,l,d;for(e=0,o=r.length;e<o;++e)for(s=0,l=r[e].length;s<l;++s)d=r[e][s],t.push(d),d.$layout={_box:new Bt,_hidable:!1,_visible:!0,_set:e,_idx:d._index};return t.sort(function(k,y){var f=k.$layout,E=y.$layout;return f._idx===E._idx?E._set-f._set:E._idx-f._idx}),this.update(t),t},update:function(r){var t=!1,e,s,o,l,d;for(e=0,s=r.length;e<s;++e)o=r[e],l=o.model(),d=o.$layout,d._hidable=l&&l.display==="auto",d._visible=o.visible(),t|=d._hidable;t&&mo(r)},lookup:function(r,t){var e,s;for(e=r.length-1;e>=0;--e)if(s=r[e].$layout,s&&s._visible&&s._box.contains(t))return r[e];return null},draw:function(r,t){var e,s,o,l,d,k;for(e=0,s=t.length;e<s;++e)o=t[e],l=o.$layout,l._visible&&(d=o.geometry(),k=Rt(o._el,o.model(),d),l._box.update(k,d,o.rotation()),o.draw(r,k))}},_o=function(r){if(Fe(r))return null;var t=r,e,s,o;if(Xt(r))if(!Fe(r.label))t=r.label;else if(!Fe(r.r))t=r.r;else for(t="",e=Object.keys(r),o=0,s=e.length;o<s;++o)t+=(o!==0?", ":"")+e[o]+": "+r[e[o]];return""+t},fo={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:_o,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},ce="$datalabels",Pt="$default";function po(r,t){var e=r.datalabels,s={},o=[],l,d;return e===!1?null:(e===!0&&(e={}),t=je({},[t,e]),l=t.labels||{},d=Object.keys(l),delete t.labels,d.length?d.forEach(function(k){l[k]&&o.push(je({},[t,l[k],{_key:k}]))}):o.push(t),s=o.reduce(function(k,y){return Jt(y.listeners||{},function(f,E){k[E]=k[E]||{},k[E][y._key||Pt]=f}),delete y.listeners,k},{}),{labels:o,listeners:s})}function at(r,t,e,s){if(t){var o=e.$context,l=e.$groups,d;t[l._set]&&(d=t[l._set][l._key],d&&Wt(d,[o,s])===!0&&(r[ce]._dirty=!0,e.update(o)))}}function go(r,t,e,s,o){var l,d;!e&&!s||(e?s?e!==s&&(d=l=!0):d=!0:l=!0,d&&at(r,t.leave,e,o),l&&at(r,t.enter,s,o))}function bo(r,t){var e=r[ce],s=e._listeners,o,l;if(!(!s.enter&&!s.leave)){if(t.type==="mousemove")l=He.lookup(e._labels,t);else if(t.type!=="mouseout")return;o=e._hovered,e._hovered=l,go(r,s,o,l,t)}}function wo(r,t){var e=r[ce],s=e._listeners.click,o=s&&He.lookup(e._labels,t);o&&at(r,s,o,t)}var Co={id:"datalabels",defaults:fo,beforeInit:function(r){r[ce]={_actives:[]}},beforeUpdate:function(r){var t=r[ce];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(r,t,e){var s=t.index,o=r[ce],l=o._datasets[s]=[],d=r.isDatasetVisible(s),k=r.data.datasets[s],y=po(k,e),f=t.meta.data||[],E=r.ctx,x,X,K,U,W,b,v,h;for(E.save(),x=0,K=f.length;x<K;++x)if(v=f[x],v[ce]=[],d&&v&&r.getDataVisibility(x)&&!v.skip)for(X=0,U=y.labels.length;X<U;++X)W=y.labels[X],b=W._key,h=new Ot(W,E,v,x),h.$groups={_set:s,_key:b||Pt},h.$context={active:!1,chart:r,dataIndex:x,dataset:k,datasetIndex:s},h.update(h.$context),v[ce].push(h),l.push(h);E.restore(),je(o._listeners,y.listeners,{merger:function(T,D,$){D[T]=D[T]||{},D[T][t.index]=$[T],o._listened=!0}})},afterUpdate:function(r){r[ce]._labels=He.prepare(r[ce]._datasets)},afterDatasetsDraw:function(r){He.draw(r,r[ce]._labels)},beforeEvent:function(r,t){if(r[ce]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":bo(r,e);break;case"click":wo(r,e);break}}},afterEvent:function(r){var t=r[ce],e=t._actives,s=t._actives=r.getActiveElements(),o=Ye.arrayDiff(e,s),l,d,k,y,f,E,x;for(l=0,d=o.length;l<d;++l)if(f=o[l],f[1])for(x=f[0].element[ce]||[],k=0,y=x.length;k<y;++k)E=x[k],E.$context.active=f[1]===1,E.update(E.$context);(t._dirty||o.length)&&(He.update(t._labels),r.render()),delete t._dirty}};const To={class:"line-chart-months"},$o={class:"chart-section"},Wo={class:"chart-title"},Ao={key:0,class:"chart-period"},Do={class:"chart-wrapper"},Eo={class:"chart-container"},Uo={class:"chart-summary"},No={class:"summary-numbers"},So={class:"summary-row"},Io={class:"summary-values"},Mo={class:"summary-row"},Oo={class:"summary-values"},Bo={class:"summary-analysis"},Ro=["innerHTML"],Po={class:"chart-section"},xo={class:"chart-title"},Lo={key:0,class:"chart-period"},Go={class:"chart-wrapper"},Fo={class:"chart-container"},Vo={class:"chart-analysis"},Yo={class:"analysis-content"},Ho=["innerHTML"],jo={class:"chart-table-section"},zo={class:"chart-table-wrapper"},qo={class:"data-table"},Zo={class:"data-row data-row--new"},Xo={class:"data-row data-row--closed"},Jo={class:"data-row data-row--carryover"},Ko={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(r){$t.register(Co);const t=r;function e(U){return U==null||isNaN(U)?"0":U>=1e3?U.toLocaleString("ru-RU"):U.toString()}const s=q(()=>{var W,b,v;const U=new Set;return(W=t.data.newTicketsByMonth)==null||W.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(T=>{T&&T.weekNumber&&U.add(T.weekNumber)})}),(b=t.data.closedTicketsByMonth)==null||b.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(T=>{T&&T.weekNumber&&U.add(T.weekNumber)})}),(v=t.data.carryoverTicketsByMonth)==null||v.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(T=>{T&&T.weekNumber&&U.add(T.weekNumber)})}),Array.from(U).sort((h,T)=>h-T)}),o=q(()=>{const U=t.data.newTicketsByMonth||[],W=U.map(h=>h.monthName||`ÐœÐµÑÑÑ† ${h.month}`),b=U.map(h=>h.count||0),v=(t.data.closedTicketsByMonth||[]).map(h=>h.count||0);return{labels:W,datasets:[{label:"ÐÐ¾Ð²Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹",data:b,borderColor:H.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:H.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:H.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹",data:v,borderColor:H.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:H.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:H.success,borderWidth:1,borderRadius:4,padding:4}}]}}),l=q(()=>{const U=t.data.carryoverTicketsByMonth||[],W=U.map(v=>v.monthName||`ÐœÐµÑÑÑ† ${v.month}`),b=U.map(v=>v.count||0);return{labels:W,datasets:[{label:"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹",data:b,borderColor:H.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:H.carryover}}]}}),d={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:(U,W)=>U==null||isNaN(U)?"":U.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function(U){const W=U.dataset.data[U.dataIndex];return W!=null&&!isNaN(W)&&isFinite(W)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function k(U){if(!U||U.length===0)return null;const W=U[0],b=U[U.length-1];if(!W||!b)return null;const v=W.monthName||`ÐœÐµÑÑÑ† ${W.month}`,h=b.monthName||`ÐœÐµÑÑÑ† ${b.month}`,T=W.year||new Date().getFullYear();return`${v} â€” ${h} ${T}`}const y=q(()=>{var U;return k(((U=t.data)==null?void 0:U.newTicketsByMonth)||[])}),f=q(()=>{var U;return k(((U=t.data)==null?void 0:U.carryoverTicketsByMonth)||[])}),E=q(()=>{var h,T;const U=((h=t.data)==null?void 0:h.newTicketsByMonth)||[],W=((T=t.data)==null?void 0:T.closedTicketsByMonth)||[];if(U.length===0)return{new:"â€”",closed:"â€”"};const b=U.map(D=>`${e(D.count||0)} (${D.monthName||D.month})`).join(" â†’ "),v=W.map(D=>`${e(D.count||0)} (${D.monthName||D.month})`).join(" â†’ ");return{new:b,closed:v}}),x=q(()=>{var T,D;const U=((T=t.data)==null?void 0:T.newTicketsByMonth)||[],W=((D=t.data)==null?void 0:D.closedTicketsByMonth)||[];if(U.length<2)return["ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°"];const b=[],v=[],h=[];if(U.length>=2){const $=U[0],S=U[1],j=U[2];if(S&&$&&typeof $.count=="number"&&typeof S.count=="number"){const N=$.monthName||$.month,R=S.monthName||S.month,L=e($.count||0),G=e(S.count||0);if($.count>0){const M=(S.count-$.count)/$.count*100;if(isFinite(M)&&!isNaN(M)){const z=M>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",w=Math.abs(M),m=M>=0?"+":"-",O=M>=0?"#28a745":"#dc3545",V=M>=0?"#28a745":"#dc3545";v.push(`  â€¢ <span style="color: ${O}; font-weight: 600;">${z}</span> Ñ ${L} (${N}) Ð´Ð¾ ${G} (${R}) â€” <span style="color: ${V}; font-weight: 600;">${m}${w.toFixed(1)}%</span>`)}}else $.count===0&&S.count>0&&v.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ 0 (${N}) Ð´Ð¾ ${G} (${R})`)}if(j&&S&&typeof S.count=="number"&&typeof j.count=="number"){const N=S.monthName||S.month,R=j.monthName||j.month,L=e(S.count||0),G=e(j.count||0);if(S.count>0){const M=(j.count-S.count)/S.count*100;if(isFinite(M)&&!isNaN(M))if(Math.abs(M)<.1)v.push(`  â€¢ Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹: ${L} (${N}) â†’ ${G} (${R}) â€” 0.0%`);else{const z=M>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",w=Math.abs(M),m=M>=0?"+":"-",O=M>=0?"#28a745":"#dc3545",V=M>=0?"#28a745":"#dc3545";v.push(`  â€¢ <span style="color: ${O}; font-weight: 600;">${z}</span> Ñ ${L} (${N}) Ð´Ð¾ ${G} (${R}) â€” <span style="color: ${V}; font-weight: 600;">${m}${w.toFixed(1)}%</span>`)}}else S.count===0&&j.count>0&&v.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ 0 (${N}) Ð´Ð¾ ${G} (${R})`)}}if(W.length>=2){const $=W[0],S=W[1],j=W[2];if(S&&$&&typeof $.count=="number"&&typeof S.count=="number"){const N=$.monthName||$.month,R=S.monthName||S.month,L=e($.count||0),G=e(S.count||0);if($.count>0){const M=(S.count-$.count)/$.count*100;if(isFinite(M)&&!isNaN(M))if(Math.abs(M)<.1)h.push(`  â€¢ Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹: ${L} (${N}) â†’ ${G} (${R}) â€” 0.0%`);else{const z=M>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",w=Math.abs(M),m=M>=0?"+":"-",O=M>=0?"#28a745":"#dc3545",V=M>=0?"#28a745":"#dc3545";h.push(`  â€¢ <span style="color: ${O}; font-weight: 600;">${z}</span> Ñ ${L} (${N}) Ð´Ð¾ ${G} (${R}) â€” <span style="color: ${V}; font-weight: 600;">${m}${w.toFixed(1)}%</span>`)}}else $.count===0&&S.count>0&&h.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹: Ñ 0 (${N}) Ð´Ð¾ ${G} (${R})`)}if(j&&S&&typeof S.count=="number"&&typeof j.count=="number"){const N=S.monthName||S.month,R=j.monthName||j.month,L=e(S.count||0),G=e(j.count||0);if(S.count>0){const M=(j.count-S.count)/S.count*100;if(isFinite(M)&&!isNaN(M))if(Math.abs(M)<.1)h.push(`  â€¢ Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹: ${L} (${N}) â†’ ${G} (${R}) â€” 0.0%`);else{const z=M>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",w=Math.abs(M),m=M>=0?"+":"-",O=M>=0?"#28a745":"#dc3545",V=M>=0?"#28a745":"#dc3545";h.push(`  â€¢ <span style="color: ${O}; font-weight: 600;">${z}</span> Ñ ${L} (${N}) Ð´Ð¾ ${G} (${R}) â€” <span style="color: ${V}; font-weight: 600;">${m}${w.toFixed(1)}%</span>`)}}else S.count===0&&j.count>0&&h.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹: Ñ 0 (${N}) Ð´Ð¾ ${G} (${R})`)}}if(v.length>0&&(b.push("ÐÐ¾Ð²Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹:"),b.push(...v)),h.length>0&&(b.push("Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹:"),b.push(...h)),U.length>=3&&W.length>=3){const $=U[0],S=U[U.length-1],j=W[0],N=W[W.length-1],R=$.count||0,L=S.count||0,G=j.count||0,M=N.count||0;if(R>0&&G>0){const z=(L-R)/R*100,w=(M-G)/G*100;if(isFinite(z)&&isFinite(w)){const m=$.monthName||$.month,O=S.monthName||S.month,V=j.monthName||j.month,u=N.monthName||N.month,n=z>=0?"#28a745":"#dc3545",i=z>=0?"#28a745":"#dc3545",A=w>=0?"#28a745":"#dc3545",P=w>=0?"#28a745":"#dc3545";b.push("ÐžÐ±Ñ‰Ð°Ñ Ð´Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´:"),b.push(`  â€¢ ÐÐ¾Ð²Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹: <span style="color: ${n}; font-weight: 600;">${z>=0?"Ñ€Ð¾ÑÑ‚":"ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ðµ"}</span> Ñ ${e(R)} (${m}) Ð´Ð¾ ${e(L)} (${O}) â€” <span style="color: ${i}; font-weight: 600;">${z>=0?"+":"-"}${Math.abs(z).toFixed(1)}%</span>`),b.push(`  â€¢ Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹: <span style="color: ${A}; font-weight: 600;">${w>=0?"Ñ€Ð¾ÑÑ‚":"ÑÐ½Ð¸Ð¶ÐµÐ½Ð¸Ðµ"}</span> Ñ ${e(G)} (${V}) Ð´Ð¾ ${e(M)} (${u}) â€” <span style="color: ${P}; font-weight: 600;">${w>=0?"+":"-"}${Math.abs(w).toFixed(1)}%</span>`)}}}return b.length>0?b:["ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°"]}),X=q(()=>{var h;const U=((h=t.data)==null?void 0:h.carryoverTicketsByMonth)||[];if(U.length===0)return["ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°"];const W=[],b=[],v=U.filter(T=>T&&typeof T.count=="number").map(T=>`${e(T.count||0)} (${T.monthName||T.month||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"})`).join(" â†’ ");if(v&&W.push(`ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹: ${v}`),U.length>=2){const T=U[0],D=U[1],$=U[2];if(D&&T&&typeof T.count=="number"&&typeof D.count=="number"){const S=T.monthName||T.month,j=D.monthName||D.month,N=e(T.count||0),R=e(D.count||0);if(T.count>0){const L=(D.count-T.count)/T.count*100;if(isFinite(L)&&!isNaN(L))if(Math.abs(L)<.1)b.push(`  â€¢ Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹: ${N} (${S}) â†’ ${R} (${j}) â€” 0.0%`);else{const G=L>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",M=Math.abs(L),z=L>=0?"+":"-",w=L>=0?"#28a745":"#dc3545",m=L>=0?"#28a745":"#dc3545";b.push(`  â€¢ <span style="color: ${w}; font-weight: 600;">${G}</span> Ñ ${N} (${S}) Ð´Ð¾ ${R} (${j}) â€” <span style="color: ${m}; font-weight: 600;">${z}${M.toFixed(1)}%</span>`)}}else T.count===0&&D.count>0&&b.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ 0 (${S}) Ð´Ð¾ ${R} (${j})`)}if($&&D&&typeof D.count=="number"&&typeof $.count=="number"){const S=D.monthName||D.month,j=$.monthName||$.month,N=e(D.count||0),R=e($.count||0);if(D.count>0){const L=($.count-D.count)/D.count*100;if(isFinite(L)&&!isNaN(L))if(Math.abs(L)<.1)b.push(`  â€¢ Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹: ${N} (${S}) â†’ ${R} (${j}) â€” 0.0%`);else{const G=L>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",M=Math.abs(L),z=L>=0?"+":"-",w=L>=0?"#28a745":"#dc3545",m=L>=0?"#28a745":"#dc3545";b.push(`  â€¢ <span style="color: ${w}; font-weight: 600;">${G}</span> Ñ ${N} (${S}) Ð´Ð¾ ${R} (${j}) â€” <span style="color: ${m}; font-weight: 600;">${z}${M.toFixed(1)}%</span>`)}}else D.count===0&&$.count>0&&b.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ 0 (${S}) Ð´Ð¾ ${R} (${j})`)}}if(b.length>0&&(W.push("Ð”Ð¸Ð½Ð°Ð¼Ð¸ÐºÐ° Ð¿Ð¾ Ð¼ÐµÑÑÑ†Ð°Ð¼:"),W.push(...b)),U.length>=3){const T=U[0],D=U[U.length-1];if(T&&D&&typeof T.count=="number"&&typeof D.count=="number"){const $=T.count||0,S=D.count||0,j=T.monthName||T.month,N=D.monthName||D.month,R=e($),L=e(S);if($>0){const G=(S-$)/$*100;if(isFinite(G)&&!isNaN(G))if(Math.abs(G)<1)W.push("Ð¢ÐµÐ½Ð´ÐµÐ½Ñ†Ð¸Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´:"),W.push(`  â€¢ Ð¡Ñ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾: ${R} (${j}) â†’ ${L} (${N}) â€” Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼ÐµÐ½ÐµÐµ 1%`);else{const M=G>=0?"Ð Ð¾ÑÑ‚":"Ð¡Ð½Ð¸Ð¶ÐµÐ½Ð¸Ðµ",z=Math.abs(G),w=G>=0?"+":"-",m=G>=0?"#28a745":"#dc3545",O=G>=0?"#28a745":"#dc3545";W.push("Ð¢ÐµÐ½Ð´ÐµÐ½Ñ†Ð¸Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´:"),W.push(`  â€¢ <span style="color: ${m}; font-weight: 600;">${M}</span> Ñ ${R} (${j}) Ð´Ð¾ ${L} (${N}) â€” <span style="color: ${O}; font-weight: 600;">${w}${z.toFixed(1)}%</span>`)}}else $===0&&S>0?(W.push("Ð¢ÐµÐ½Ð´ÐµÐ½Ñ†Ð¸Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´:"),W.push(`  â€¢ ÐŸÐ¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ 0 (${j}) Ð´Ð¾ ${L} (${N})`)):$>0&&S===0&&(W.push("Ð¢ÐµÐ½Ð´ÐµÐ½Ñ†Ð¸Ñ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´:"),W.push(`  â€¢ ÐŸÐ¾Ð»Ð½Ð¾Ðµ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²: Ñ ${R} (${j}) Ð´Ð¾ 0 (${N})`))}}return W.length>0?W:["ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°"]});function K(U,W){let b=[];switch(U){case"new":b=t.data.newTicketsByMonth||[];break;case"closed":b=t.data.closedTicketsByMonth||[];break;case"carryover":b=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const v of b){if(!v.weeks||!Array.isArray(v.weeks))continue;const h=v.weeks.find(T=>T&&T.weekNumber===W);if(h){const T=h.count||0;return T>0?e(T):"-"}}return"-"}return(U,W)=>(_(),g("div",To,[a("div",$o,[a("h3",Wo,[W[0]||(W[0]=ue(" ÐÐ¾Ð²Ñ‹Ðµ Ð¸ Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹ ",-1)),y.value?(_(),g("span",Ao,"("+C(y.value)+")",1)):Q("",!0)]),a("div",Do,[a("div",Eo,[te(Je(De),{data:o.value,options:d},null,8,["data"])]),a("div",Uo,[W[3]||(W[3]=a("h4",{class:"summary-title"},"Ð¡Ð²Ð¾Ð´Ð½Ñ‹Ð¹ Ð¸Ñ‚Ð¾Ð³",-1)),a("div",No,[a("div",So,[W[1]||(W[1]=a("span",{class:"summary-label"},"ÐÐ¾Ð²Ñ‹Ðµ:",-1)),a("span",Io,C(E.value.new),1)]),a("div",Mo,[W[2]||(W[2]=a("span",{class:"summary-label"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ:",-1)),a("span",Oo,C(E.value.closed),1)])]),a("div",Bo,[(_(!0),g(ae,null,se(x.value,(b,v)=>(_(),g("p",{key:v,innerHTML:b},null,8,Ro))),128))])])])]),a("div",Po,[a("h3",xo,[W[4]||(W[4]=ue(" ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹ ",-1)),f.value?(_(),g("span",Lo,"("+C(f.value)+")",1)):Q("",!0)]),a("div",Go,[a("div",Fo,[te(Je(De),{data:l.value,options:d},null,8,["data"])]),a("div",Vo,[W[5]||(W[5]=a("h4",{class:"analysis-title"},"ÐÐ½Ð°Ð»Ð¸Ð·",-1)),a("div",Yo,[(_(!0),g(ae,null,se(X.value,(b,v)=>(_(),g("p",{key:v,innerHTML:b},null,8,Ho))),128))])])])]),a("div",jo,[W[10]||(W[10]=a("h3",{class:"chart-title"},"Ð”ÐµÑ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ð¼ÐµÑÑÑ†Ð°Ð¼ Ð¸ Ð½ÐµÐ´ÐµÐ»ÑÐ¼",-1)),a("div",zo,[a("table",qo,[a("thead",null,[a("tr",null,[W[6]||(W[6]=a("th",{class:"month-header-cell"},"ÐœÐµÑÑÑ†",-1)),(_(!0),g(ae,null,se(s.value,b=>(_(),g("th",{key:`week-${b}`,class:"week-header-cell"}," ÐÐµÐ´ÐµÐ»Ñ "+C(b),1))),128))])]),a("tbody",null,[a("tr",Zo,[W[7]||(W[7]=a("td",{class:"data-type-cell"},"ÐÐ¾Ð²Ñ‹Ðµ",-1)),(_(!0),g(ae,null,se(s.value,b=>(_(),g("td",{key:`new-${b}`,class:"week-data-cell"},C(K("new",b)),1))),128))]),a("tr",Xo,[W[8]||(W[8]=a("td",{class:"data-type-cell"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ",-1)),(_(!0),g(ae,null,se(s.value,b=>(_(),g("td",{key:`closed-${b}`,class:"week-data-cell"},C(K("closed",b)),1))),128))]),a("tr",Jo,[W[9]||(W[9]=a("td",{class:"data-type-cell"},"ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ",-1)),(_(!0),g(ae,null,se(s.value,b=>(_(),g("td",{key:`carryover-${b}`,class:"week-data-cell"},C(K("carryover",b)),1))),128))])])])])])]))}},Qo=be(Ko,[["__scopeId","data-v-31a3d565"]]),en={class:"months-preloader"},tn={class:"preloader-content"},an={class:"progress-container"},sn={class:"progress-bar"},rn={class:"progress-text"},on={class:"preloader-message"},nn={class:"stages-list"},ln={class:"stage-icon"},cn={class:"stage-text"},dn={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:r=>r>=0&&r<=100},currentStage:{type:String,default:""}},setup(r){const t=r,e=[{label:"ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…...",threshold:5},{label:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 1)...",threshold:35},{label:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 2)...",threshold:65},{label:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 3)...",threshold:85},{label:"ÐÐ³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…...",threshold:90},{label:"Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð²...",threshold:100}];function s(l){return t.progress>=e[l].threshold}function o(l){const d=e[l].threshold,k=l>0?e[l-1].threshold:0;return t.progress>=k&&t.progress<d}return(l,d)=>(_(),g("div",en,[a("div",tn,[d[0]||(d[0]=Kt('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° 3 Ð¼ÐµÑÑÑ†Ð°</h3>',2)),a("div",an,[a("div",sn,[a("div",{class:"progress-fill",style:Te({width:`${r.progress}%`})},null,4)]),a("div",rn,C(Math.round(r.progress))+"%",1)]),a("p",on,C(r.currentStage),1),a("div",nn,[(_(),g(ae,null,se(e,(k,y)=>a("div",{key:y,class:oe(["stage-item",{"stage-completed":s(y),"stage-current":o(y)}])},[a("span",ln,C(s(y)?"âœ“":o(y)?"â†’":"â—‹"),1),a("span",cn,C(k.label),1)],2)),64))])])]))}},un=be(dn,[["__scopeId","data-v-b571fe67"]]),vn="/api/graph-1c-admission-closure.php";function kn(r){var s,o,l,d,k,y,f,E,x,X,K,U,W,b,v,h,T,D,$,S,j,N,R,L,G,M,z,w,m,O,V,u,n,i,A,P,B,Y,ee,p,c,F,I,J,ie,ke,he,ye,me,_e,fe,pe,ge,$e,Ee,Ue,Ne,Se,Ie,Me,Oe,Be,Re,Pe,xe,Le;if(!r)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0],carryoverCreatedPreviousWeek:[0],carryoverCreatedOlder:[0]},weeksData:[],stagesByWeek:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=r.data||r.result||r,e=t.meta||r.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((s=t.data)==null?void 0:s.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:t.data.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:t.data.carryoverTicketsCreatedOlder??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,carryoverTicketsCreatedPreviousWeek:0,carryoverTicketsCreatedOlder:0}),newTickets:((l=(o=t.data)==null?void 0:o.currentWeek)==null?void 0:l.newTickets)??((d=t.data)==null?void 0:d.newTickets)??t.newTickets??0,closedTickets:((y=(k=t.data)==null?void 0:k.currentWeek)==null?void 0:y.closedTickets)??((f=t.data)==null?void 0:f.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((x=(E=t.data)==null?void 0:E.currentWeek)==null?void 0:x.closedTicketsCreatedThisWeek)??((X=t.data)==null?void 0:X.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((U=(K=t.data)==null?void 0:K.currentWeek)==null?void 0:U.closedTicketsCreatedOtherWeek)??((W=t.data)==null?void 0:W.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((v=(b=t.data)==null?void 0:b.currentWeek)==null?void 0:v.carryoverTickets)??((h=t.data)==null?void 0:h.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((D=(T=t.data)==null?void 0:T.currentWeek)==null?void 0:D.carryoverTicketsCreatedThisWeek)??(($=t.data)==null?void 0:$.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((j=(S=t.data)==null?void 0:S.currentWeek)==null?void 0:j.carryoverTicketsCreatedOtherWeek)??((N=t.data)==null?void 0:N.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,carryoverTicketsCreatedPreviousWeek:((L=(R=t.data)==null?void 0:R.currentWeek)==null?void 0:L.carryoverTicketsCreatedPreviousWeek)??((G=t.data)==null?void 0:G.carryoverTicketsCreatedPreviousWeek)??t.carryoverTicketsCreatedPreviousWeek??0,carryoverTicketsCreatedOlder:((z=(M=t.data)==null?void 0:M.currentWeek)==null?void 0:z.carryoverTicketsCreatedOlder)??((w=t.data)==null?void 0:w.carryoverTicketsCreatedOlder)??t.carryoverTicketsCreatedOlder??0,series:{new:((O=(m=t.data)==null?void 0:m.series)==null?void 0:O.new)??((V=t.series)==null?void 0:V.new)??[0],closed:((n=(u=t.data)==null?void 0:u.series)==null?void 0:n.closed)??((i=t.series)==null?void 0:i.closed)??[0],closedCreatedThisWeek:((P=(A=t.data)==null?void 0:A.series)==null?void 0:P.closedCreatedThisWeek)??((B=t.series)==null?void 0:B.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((ee=(Y=t.data)==null?void 0:Y.series)==null?void 0:ee.closedCreatedOtherWeek)??((p=t.series)==null?void 0:p.closedCreatedOtherWeek)??[0],carryover:((F=(c=t.data)==null?void 0:c.series)==null?void 0:F.carryover)??((I=t.series)==null?void 0:I.carryover)??[0],carryoverCreatedThisWeek:((ie=(J=t.data)==null?void 0:J.series)==null?void 0:ie.carryoverCreatedThisWeek)??((ke=t.series)==null?void 0:ke.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((ye=(he=t.data)==null?void 0:he.series)==null?void 0:ye.carryoverCreatedOtherWeek)??((me=t.series)==null?void 0:me.carryoverCreatedOtherWeek)??[0],carryoverCreatedPreviousWeek:((fe=(_e=t.data)==null?void 0:_e.series)==null?void 0:fe.carryoverCreatedPreviousWeek)??((pe=t.series)==null?void 0:pe.carryoverCreatedPreviousWeek)??[0],carryoverCreatedOlder:(($e=(ge=t.data)==null?void 0:ge.series)==null?void 0:$e.carryoverCreatedOlder)??((Ee=t.series)==null?void 0:Ee.carryoverCreatedOlder)??[0]},weeksData:((Ue=t.data)==null?void 0:Ue.weeksData)??t.weeksData??[],stagesByWeek:((Ne=t.data)==null?void 0:Ne.stagesByWeek)??t.stagesByWeek??[],stages:((Se=t.data)==null?void 0:Se.stages)??t.stages??[],responsible:((Ie=t.data)==null?void 0:Ie.responsible)??t.responsible??[],responsibleCreatedThisWeek:((Me=t.data)==null?void 0:Me.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((Oe=t.data)==null?void 0:Oe.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Be=t.data)==null?void 0:Be.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Re=t.data)==null?void 0:Re.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((Pe=t.data)==null?void 0:Pe.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((xe=t.data)==null?void 0:xe.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Le=t.data)==null?void 0:Le.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function We(r={}){const{endpoint:t=vn,product:e="1C",weekStartUtc:s=null,weekEndUtc:o=null,periodMode:l="weeks",useCache:d=!0,forceRefresh:k=!1,includeTickets:y=!1,includeNewTicketsByStages:f=!1,includeCarryoverTickets:E=!0,includeCarryoverTicketsByDuration:x=!1}=r,X={product:e,weekStartUtc:s,weekEndUtc:o,periodMode:l,useCache:d,forceRefresh:k,includeTickets:y,includeNewTicketsByStages:f,includeCarryoverTickets:E,includeCarryoverTicketsByDuration:x},K=Qt(t),U=await fetch(K,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(X)});if(!U.ok)throw new Error(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° (${U.status})`);const W=await U.json();if((W==null?void 0:W.success)===!1)throw new Error(W.message||"Ð‘ÑÐºÐµÐ½Ð´ Ð²ÐµÑ€Ð½ÑƒÐ» Ð¾ÑˆÐ¸Ð±ÐºÑƒ");return kn(W)}const hn={class:"ac-dashboard-months"},yn={key:"content"},mn={class:"dashboard-header"},_n={class:"header-content"},fn={class:"breadcrumbs-row"},pn=["aria-label","aria-disabled","data-fallback","disabled"],gn={class:"breadcrumbs","aria-label":"ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ"},bn={class:"dashboard-layout"},wn={class:"filters-container"},Cn={class:"chart-container"},Tn={__name:"GraphAdmissionClosureMonthsDashboard",setup(r){const t=At(),e=Z(!0),s=Z(0),o=Z("ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…..."),l=Z(null),d=Z(null),k=Z({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),y=Z(!1),f=q(()=>typeof window>"u"?!1:window.history.length>1),E=q(()=>f.value?"Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð½Ð° Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ":"Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ"),x={name:"dashboard-sector-1c"};function X(N){var R;if((R=N==null?void 0:N.preventDefault)==null||R.call(N),!y.value){y.value=!0;try{if(f.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(x)}finally{y.value=!1}}}const K=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),U=q(()=>{const N=K.value.customDateRange.startDate||K.value.customDateRange.endDate,R=K.value.employees.length===1&&K.value.employees.includes("all");return N||!R});async function W(N,R,L=500){const G=s.value,M=10,z=(N-G)/M,w=L/M;for(let m=0;m<M;m++)await new Promise(O=>setTimeout(O,w)),s.value=Math.min(G+z*(m+1),N);s.value=N,o.value=R}async function b(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,l.value=null,s.value=0,o.value="ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let N=null,R=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await W(5,"ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…...",200);const L=Date.now(),G=2e4;N=setInterval(()=>{const m=Date.now()-L,O=Math.min(5+m/G*85,90);s.value=O,O<35?o.value="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 1)...":O<65?o.value="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 2)...":O<85?o.value="Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ (Ð·Ð°Ð¿Ñ€Ð¾Ñ 3)...":o.value="ÐÐ³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…..."},500),R=setTimeout(()=>{N&&(clearInterval(N),N=null)},G+1e4);const M=await We({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(R),N&&(clearInterval(N),N=null),s.value=90,o.value="ÐÐ³Ñ€ÐµÐ³Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°",await W(100,"Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ¾Ð²...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",M);const{meta:z,data:w}=M;d.value=z,k.value=w,console.log("[DEBUG MonthsDashboard] Data set, meta:",z,"data keys:",Object.keys(w)),await new Promise(m=>setTimeout(m,200))}catch(L){N&&(clearInterval(N),N=null),R&&(clearTimeout(R),R=null),console.error("[DEBUG MonthsDashboard] API call failed:",L),l.value=L instanceof Error?L:new Error("ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",L),s.value=100,o.value="ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function v(N){K.value.stages=N}function h(N){K.value.employees=N}function T(N){K.value.dateRange=N}function D(N){K.value.customDateRange=N}function $(){K.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},S()}function S(){b()}function j(N){if(!["weeks","months"].includes(N)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",N);return}N==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:N}}))}return rt(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),b()}),(N,R)=>{const L=Dt("router-link");return _(),g("div",hn,[te(de,{name:"fade",mode:"out-in"},{default:re(()=>[e.value?(_(),ve(un,{key:"preloader",progress:s.value,"current-stage":o.value},null,8,["progress","current-stage"])):(_(),g("div",yn,[a("div",mn,[a("div",_n,[a("div",fn,[a("button",{class:"btn-back-link",type:"button",onClick:X,"aria-label":E.value,"aria-disabled":!f.value,"data-fallback":!f.value,disabled:y.value,title:"ÐÐ°Ð·Ð°Ð´"}," â† ",8,pn),a("nav",gn,[te(L,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:re(()=>[...R[0]||(R[0]=[ue(" Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ ÑÐµÐºÑ‚Ð¾Ñ€Ð° 1Ð¡ ",-1)])]),_:1}),R[2]||(R[2]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),te(L,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:re(()=>[...R[1]||(R[1]=[ue(" Ð“Ñ€Ð°Ñ„Ð¸Ðº ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ ",-1)])]),_:1}),R[3]||(R[3]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),R[4]||(R[4]=a("span",{class:"breadcrumb-current"},"Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹",-1))])]),R[5]||(R[5]=a("h1",{class:"dashboard-title"},"Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹ ÑÐµÐºÑ‚Ð¾Ñ€Ð° 1Ð¡",-1)),R[6]||(R[6]=a("p",{class:"dashboard-subtitle"}," Ð”Ð¾ÑÑ‚ÑƒÐ¿Ñ‹ Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð°Ð½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ñ‹ Â«Ð“Ñ€Ð°Ñ„Ð¸ÐºÑƒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÑÂ», ÑÐµÐ»ÐµÐºÑ‚Ð¾Ñ€ ÑÑ‚Ð°Ð¿Ð¾Ð² ÑÐºÑ€Ñ‹Ñ‚. ",-1))])]),a("div",bn,[a("div",wn,[te(Ut,{stages:K.value.stages,employees:K.value.employees,dateRange:K.value.dateRange,customDateRange:K.value.customDateRange,hasActiveFilters:U.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":v,"onUpdate:employees":h,"onUpdate:dateRange":T,"onUpdate:customDateRange":D,"onUpdate:periodMode":j,onReset:$,onApply:S},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),a("div",Cn,[l.value?(_(),ve(Et,{key:0,type:"error",title:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",message:l.value.message},null,8,["message"])):(_(),g(ae,{key:1},[te(eo,{data:k.value},null,8,["data"]),te(Qo,{data:k.value,meta:d.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},$n=be(Tn,[["__scopeId","data-v-fe3ca7ed"]]);class st{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const s=await this.getEmployeesByIds(e);return console.log("Loaded employees:",s.length),{stages:this.groupTicketsByStages(t,s),employees:s,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const s of t){console.log(`Loading tickets for stage: ${s}`);const o=await this.getTicketsByStage(s);e.push(...o),console.log(`Loaded ${o.length} tickets for stage ${s}`)}return e}static async getTicketsByStage(t){const e=[];let s=0;const o=50;let l=!0;for(;l;)try{const k=await Ae.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:s,useOriginalUfNames:"Y"});let y=[];k&&k.result&&(Array.isArray(k.result)?y=k.result:k.result.items&&Array.isArray(k.result.items)?y=k.result.items:k.result.data&&Array.isArray(k.result.data)&&(y=k.result.data)),y.length>0?(e.push(...y),s+=y.length,l=y.length===o):l=!1}catch(k){console.error(`Error loading tickets batch for stage ${t} (start: ${s}):`,k),l=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const d=e.filter(k=>{const y=k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product||k.ufCrm7TypeProduct||k.UF_CRM_7_TYPE_PRODUCT||k.uf_crm_7_type_product;return Array.isArray(y)?y.includes(this.SECTOR_TAG):typeof y=="object"&&y!==null?y.value===this.SECTOR_TAG||y===this.SECTOR_TAG:y===this.SECTOR_TAG});return console.log(`Filtered ${d.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),d}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(s=>{const o=s.assignedById||s.assignedByIdId||s.ASSIGNED_BY_ID||s.assignedById||s.assignedById&&typeof s.assignedById=="object"&&(s.assignedById.id||s.assignedById.ID)||s.assignedById&&typeof s.assignedById=="object"&&s.assignedById.value;if(o){const l=parseInt(o);l&&!isNaN(l)&&l>0&&e.add(l)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await Ae.call("user.get",{filter:{ID:t}});let s=[];return e&&e.result&&(Array.isArray(e.result)?s=e.result:console.warn("Unexpected user.get result format:",e)),s.map(o=>({id:parseInt(o.ID||o.id||0),name:`${o.NAME||o.name||""} ${o.LAST_NAME||o.lastName||""}`.trim()||o.EMAIL||o.email||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹",position:o.WORK_POSITION||o.workPosition||"Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº",email:o.EMAIL||o.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const s=[{id:"formed",name:"Ð¡Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð¾Ð±Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ðµ",color:"#007bff",employees:e.map(o=>({...o,tickets:[]}))},{id:"review",name:"Ð Ð°ÑÑÐ¼Ð¾Ñ‚Ñ€ÐµÐ½Ð¸Ðµ Ð¢Ð—",color:"#ffc107",employees:e.map(o=>({...o,tickets:[]}))},{id:"execution",name:"Ð˜ÑÐ¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ",color:"#28a745",employees:e.map(o=>({...o,tickets:[]}))}];return t.forEach(o=>{const l=this.mapStageId(o.stageId||o.STAGE_ID||""),d=s.find(k=>k.id===l);if(d){const k=o.assignedById||o.ASSIGNED_BY_ID||null,y=k?parseInt(k):null;if(y){let f=d.employees.find(E=>E.id===y);f||(f={id:y,name:`Ð¡Ð¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº #${y}`,position:"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾",email:"",tickets:[]},d.employees.push(f)),f.tickets.push(this.mapTicket(o))}}}),s}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),s=t.title||t.TITLE||"Ð‘ÐµÐ· Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ñ",o=t.stageId||t.STAGE_ID||"",l=t.assignedById||t.ASSIGNED_BY_ID||null,d=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",k=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",y=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,f=gt(y),E=aa(f);return{id:e,title:s,priorityId:f.id,priorityLabel:f.label,priorityColors:E,priority:f.id,priorityBitrixValue:f.bitrixValue||null,status:this.mapStatus(o),assigneeId:l?parseInt(l):null,stageId:this.mapStageId(o),createdAt:d,modifiedAt:k,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return gt(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=bt(t);if(e&&e.bitrixValue)return e.bitrixValue;const s={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return s[t]?s[t]:bt(sa).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(s=>!(s.assignedById||s.ASSIGNED_BY_ID)).forEach(s=>{const o=this.mapStageId(s.stageId||s.STAGE_ID||"");e[o]&&e[o].push(this.mapTicket(s))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,s){try{const o=this.mapStageIdToBitrix(s);return(await Ae.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:o}})).result===!0}catch(o){throw console.error("Error assigning ticket:",o),o}}static async createTicket(t){try{const e=await Ae.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await Ae.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await Ae.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(s){throw console.error("Error adding comment:",s),s}}}et(st,"ENTITY_TYPE_ID",140),et(st,"SECTOR_TAG","1C");const Wn={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},An={class:"modal"},Dn={key:0,class:"modal__tabs"},En={key:"level-0-categories",class:"level-0"},Un={class:"modal__header"},Nn={class:"modal__title"},Sn={key:0},In={class:"modal__body"},Mn={class:"categories-list"},On=["onClick"],Bn={class:"category-item"},Rn={class:"category-item__icon"},Pn={key:0},xn={key:1},Ln={class:"category-item__content"},Gn={class:"category-item__label"},Fn={class:"category-item__count"},Vn={key:0,class:"category-item__arrow"},Yn={class:"modal__footer"},Hn={key:"level-1-categories",class:"level-1"},jn={class:"modal__header"},zn={class:"modal__body"},qn={key:"loading",class:"loading-names"},Zn={key:"empty",class:"modal__empty"},Xn={key:"list",class:"responsible-list"},Jn=["onClick"],Kn={class:"responsible-list__name"},Qn={class:"responsible-list__count"},el={key:0,class:"responsible-list__arrow"},tl={class:"modal__footer"},al={key:"level-2-categories",class:"level-2"},sl={class:"modal__header"},rl={class:"modal__title"},ol={class:"modal__body"},nl={key:"loading",class:"loading-state"},ll={key:"error",class:"error-state"},il={class:"error-message"},cl={key:"empty",class:"empty-state"},dl={key:"tickets",class:"tickets-list-container"},ul={key:"level-0-employees",class:"level-0"},vl={class:"modal__header"},kl={class:"modal__title"},hl={key:0},yl={class:"modal__body"},ml={key:"loading",class:"loading-names"},_l={key:"empty",class:"modal__empty"},fl={key:"list",class:"responsible-list"},pl=["onClick"],gl={class:"responsible-list__name"},bl={class:"responsible-list__count"},wl={key:0,class:"responsible-list__arrow"},Cl={class:"modal__footer"},Tl={key:"level-1-employees",class:"level-1"},$l={class:"modal__header"},Wl={class:"modal__title"},Al={class:"modal__body"},Dl={class:"categories-list"},El=["onClick"],Ul={class:"category-item"},Nl={class:"category-item__icon"},Sl={key:0},Il={key:1},Ml={class:"category-item__content"},Ol={class:"category-item__label"},Bl={class:"category-item__count"},Rl={key:0,class:"category-item__arrow"},Pl={class:"modal__footer"},xl={key:"level-2-employees",class:"level-2"},Ll={class:"modal__header"},Gl={class:"modal__title"},Fl={class:"modal__body"},Vl={key:"loading",class:"loading-state"},Yl={key:"error",class:"error-state"},Hl={class:"error-message"},jl={key:"empty",class:"empty-state"},zl={class:"empty-state-message"},ql={key:"tickets",class:"tickets-list-container"},Zl={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(r){const t=r,e=Z(0),s=Z("categories"),o=Z(null),l=Z(null),d=Z(null),k=Z([]),y=Z(!1),f=Z(null),E=Z([]),x=Z([]),X=Z(!1),K=q(()=>[{id:"created-this-week",label:"Ð¢Ð¸ÐºÐµÑ‚Ñ‹ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÑŒÑŽ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÑŒÑŽ",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"Ð¢Ð¸ÐºÐµÑ‚Ñ‹ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»ÑŒÑŽ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ€Ð°Ð½ÐµÐµ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),U=q(()=>{const w=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(m=>{const O=m.id??"unassigned";w.has(O)||w.set(O,{id:m.id,name:m.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const V=w.get(O);V.thisWeekCount=m.count??0,V.thisWeekTickets=m.tickets||[],V.totalCount+=V.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(m=>{const O=m.id??"unassigned";w.has(O)||w.set(O,{id:m.id,name:m.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const V=w.get(O);V.otherWeekCount=m.count??0,V.otherWeekTickets=m.tickets||[],V.totalCount+=V.otherWeekCount}),Array.from(w.values())}),W=q(()=>{if(!l.value)return[];const w=l.value.thisWeekTickets||[],m=l.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:l.value.id,name:l.value.name,thisWeekCount:l.value.thisWeekCount,otherWeekCount:l.value.otherWeekCount,thisWeekTickets:w.length,otherWeekTickets:m.length,employee:l.value}),[{id:"this-week",label:"ÐÐ° ÑÑ‚Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ðµ",count:l.value.thisWeekCount??0,tickets:w,employeeId:l.value.id},{id:"other-week",label:"ÐÐ° Ð´Ñ€ÑƒÐ³Ð¾Ð¹ Ð½ÐµÐ´ÐµÐ»Ðµ",count:l.value.otherWeekCount??0,tickets:m,employeeId:l.value.id}]}),b=q(()=>(x.value||[]).length>0);async function v(w){const m=w.filter(O=>O.id!==null&&O.id!==void 0).map(O=>O.id);if(m.length===0)return w;try{const O=await st.getEmployeesByIds(m),V=new Map;return O.forEach(u=>{V.set(u.id,u.name)}),w.map(u=>u.id&&V.has(u.id)?{...u,name:V.get(u.id)}:u)}catch(O){return console.error("[ResponsibleModal] Error enriching names:",O),w}}Ce([()=>s.value,()=>U.value],async([w,m])=>{if(!(w!=="employees"||e.value!==0)){if(!m||m.length===0){x.value=[];return}X.value=!0;try{x.value=await v(m)}catch(O){console.error("[ResponsibleModal] Error loading employee names:",O),x.value=m}finally{X.value=!1}}},{immediate:!0}),Ce(()=>t.responsible,async w=>{if(!(e.value!==0||o.value||s.value!=="categories")){if(!w||w.length===0){E.value=[];return}X.value=!0;try{E.value=await v(w)}catch(m){console.error("[ResponsibleModal] Error loading employee names:",m),E.value=w}finally{X.value=!1}}},{immediate:!1});const h=q(()=>(E.value||[]).length>0);function T(w){s.value!==w&&(s.value=w,e.value=0,o.value=null,l.value=null,d.value=null,k.value=[],f.value=null,E.value=[],x.value=[])}async function D(w){if(!(!w||w.count===0)){o.value=w,e.value=1,X.value=!0;try{E.value=await v(w.responsible)}catch(m){console.error("[ResponsibleModal] Error loading employee names:",m),E.value=w.responsible}finally{X.value=!1}}}async function $(w,m=null){var O,V;!w||!w.id||w.totalCount===0||(m&&m.currentTarget&&(m.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{m.currentTarget&&(m.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:w.id,name:w.name,thisWeekCount:w.thisWeekCount,otherWeekCount:w.otherWeekCount,thisWeekTickets:((O=w.thisWeekTickets)==null?void 0:O.length)||0,otherWeekTickets:((V=w.otherWeekTickets)==null?void 0:V.length)||0,employee:w}),l.value={...w,thisWeekTickets:w.thisWeekTickets||[],otherWeekTickets:w.otherWeekTickets||[]},e.value=1)}async function S(w){var O;if(!w||w.count===0)return;d.value=w,e.value=2;const m=w.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:w.id,label:w.label,count:w.count,ticketsInGradation:m.length,selectedEmployee:(O=l.value)==null?void 0:O.id}),m.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",m.length),await j(m)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await N(w))}async function j(w){y.value=!0,f.value=null;try{try{const{prepareTicketsForDisplay:m}=await Ve(async()=>{const{prepareTicketsForDisplay:O}=await import("./ticketListUtils-6ViJOyvD.js").then(V=>V.t);return{prepareTicketsForDisplay:O}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await m(w,null,null)}catch(m){console.error("[ResponsibleModal] Error preparing tickets:",m),k.value=w}k.value.length===0&&(f.value=null)}catch(m){f.value=m.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",console.error("[ResponsibleModal] Error loading tickets:",m),k.value=[]}finally{y.value=!1}}async function N(w){y.value=!0,f.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!l.value)throw new Error("ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð½ÐµÐ´ÐµÐ»Ð¸ Ð¸Ð»Ð¸ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸Ðº");const m=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),O=w.id==="this-week"?m.data.responsibleCreatedThisWeek:m.data.responsibleCreatedOtherWeek,V=O==null?void 0:O.find(n=>n.id===l.value.id),u=(V==null?void 0:V.tickets)||[];try{const{prepareTicketsForDisplay:n}=await Ve(async()=>{const{prepareTicketsForDisplay:i}=await import("./ticketListUtils-6ViJOyvD.js").then(A=>A.t);return{prepareTicketsForDisplay:i}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await n(u,null,null)}catch(n){console.error("[ResponsibleModal] Error preparing tickets:",n),k.value=u}k.value.length===0&&(f.value=null)}catch(m){f.value=m.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",console.error("[ResponsibleModal] Error loading tickets from API:",m),k.value=[]}finally{y.value=!1}}async function R(w,m=null){!w||!w.id||w.count===0||(m&&m.currentTarget&&(m.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{m.currentTarget&&(m.currentTarget.style.transform="")},150)),l.value=w,e.value=2,await L(w.id))}async function L(w){var m;y.value=!0,f.value=null;try{let O=[];if(o.value&&o.value.responsible){const V=o.value.responsible.find(u=>u.id===w);O=(V==null?void 0:V.tickets)||[]}if(O.length===0&&t.weekStartUtc&&t.weekEndUtc){const V=await We({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),u=((m=o.value)==null?void 0:m.id)==="created-this-week"?V.data.responsibleCreatedThisWeek:V.data.responsibleCreatedOtherWeek,n=u==null?void 0:u.find(i=>i.id===w);O=(n==null?void 0:n.tickets)||[]}try{const{prepareTicketsForDisplay:V}=await Ve(async()=>{const{prepareTicketsForDisplay:u}=await import("./ticketListUtils-6ViJOyvD.js").then(n=>n.t);return{prepareTicketsForDisplay:u}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);k.value=await V(O,null,null)}catch(V){console.error("[ResponsibleModal] Error preparing tickets:",V),k.value=O}k.value.length===0&&(f.value=null)}catch(O){f.value=O.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",console.error("[ResponsibleModal] Error loading tickets:",O),k.value=[]}finally{y.value=!1}}function G(){e.value===2?(e.value=1,s.value==="categories"?l.value=null:d.value=null,k.value=[],f.value=null):e.value===1&&(e.value=0,s.value==="categories"?(o.value=null,E.value=[]):l.value=null)}function M(w){const m=ot(w.id);window.open(m,"_blank")}function z(){s.value==="employees"&&d.value?j(d.value.tickets):s.value==="categories"&&l.value&&L(l.value.id)}return Ce(()=>t.isVisible,w=>{w||(e.value=0,s.value="categories",o.value=null,l.value=null,d.value=null,k.value=[],f.value=null,E.value=[],x.value=[])}),(w,m)=>r.isVisible?(_(),g("div",Wn,[a("div",An,[e.value===0?(_(),g("div",Dn,[a("button",{class:oe(["modal__tab",{"modal__tab--active":s.value==="categories"}]),onClick:m[0]||(m[0]=O=>T("categories"))}," ÐŸÐ¾ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸ÑÐ¼ ",2),a("button",{class:oe(["modal__tab",{"modal__tab--active":s.value==="employees"}]),onClick:m[1]||(m[1]=O=>T("employees"))}," ÐŸÐ¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°Ð¼ ",2)])):Q("",!0),te(de,{name:"level",mode:"out-in"},{default:re(()=>{var O,V,u,n;return[s.value==="categories"&&e.value===0?(_(),g("div",En,[a("header",Un,[a("h3",Nn,[m[12]||(m[12]=ue(" Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),r.weekNumber?(_(),g("span",Sn," Â· ÐÐµÐ´ÐµÐ»Ñ "+C(r.weekNumber),1)):Q("",!0)]),a("button",{class:"modal__close",onClick:m[2]||(m[2]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",In,[a("ul",Mn,[(_(!0),g(ae,null,se(K.value,i=>(_(),g("li",{key:i.id,class:oe(["categories-list__item",{"categories-list__item--clickable":i.count>0}]),onClick:A=>D(i)},[a("div",Bn,[a("div",Rn,[i.id==="created-this-week"?(_(),g("span",Pn,"âœ“")):(_(),g("span",xn,"â†»"))]),a("div",Ln,[a("div",Gn,C(i.label),1),a("div",Fn,C(i.count)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",1)]),i.count>0?(_(),g("span",Vn,"â†’")):Q("",!0)])],10,On))),128))])]),a("footer",Yn,[a("button",{class:"btn",onClick:m[3]||(m[3]=i=>w.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value==="categories"&&e.value===1?(_(),g("div",Hn,[a("header",jn,[a("button",{class:"btn-back",onClick:G,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),m[13]||(m[13]=a("h3",{class:"modal__title"},"ÐžÑ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),a("button",{class:"modal__close",onClick:m[4]||(m[4]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",zn,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>[X.value?(_(),g("div",qn,[...m[14]||(m[14]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð¼Ñ‘Ð½ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²...",-1)])])):h.value?(_(),g("ul",Xn,[(_(!0),g(ae,null,se(E.value,i=>(_(),g("li",{key:i.id||i.name,class:oe(["responsible-list__item",{"responsible-list__item--clickable":i.id&&i.count>0}]),onClick:A=>R(i,A),title:"ÐšÐ»Ð¸ÐºÐ½Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°"},[a("span",Kn,C(i.name||"ÐÐµ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½"),1),a("span",Qn,C(i.count??0)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ",1),i.id&&i.count>0?(_(),g("span",el,"â†’")):Q("",!0)],10,Jn))),128))])):(_(),g("p",Zn,"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼"))]),_:1})]),a("footer",tl,[a("button",{class:"btn",onClick:m[5]||(m[5]=i=>w.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value==="categories"&&e.value===2?(_(),g("div",al,[a("header",sl,[a("button",{class:"btn-back",onClick:G,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),a("h3",rl,"Ð¢Ð¸ÐºÐµÑ‚Ñ‹ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°: "+C(((O=l.value)==null?void 0:O.name)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),1),a("button",{class:"modal__close",onClick:m[6]||(m[6]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",ol,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>[y.value?(_(),g("div",nl,[...m[15]||(m[15]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²...",-1)])])):f.value?(_(),g("div",ll,[m[16]||(m[16]=a("div",{class:"error-icon"},"âš ï¸",-1)),m[17]||(m[17]=a("p",{class:"error-title"},"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",-1)),a("p",il,C(f.value),1),a("button",{class:"btn btn-retry",onClick:z},"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ")])):k.value.length===0?(_(),g("div",cl,[...m[18]||(m[18]=[a("div",{class:"empty-state-icon"},"ðŸ“‹",-1),a("p",{class:"empty-state-message"},"Ð£ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð½ÐµÑ‚ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)])])):(_(),g("div",dl,[te(Ke,{name:"ticket",tag:"div",class:"tickets-list"},{default:re(()=>[(_(!0),g(ae,null,se(k.value,(i,A)=>(_(),ve(Qe,{key:i.id,ticket:i,draggable:!1,style:Te({"--ticket-index":A}),onClick:M},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):s.value==="employees"&&e.value===0?(_(),g("div",ul,[a("header",vl,[a("h3",kl,[m[19]||(m[19]=ue(" Ð—Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ðµ Ð·Ð° Ð½ÐµÐ´ÐµÐ»ÑŽ",-1)),r.weekNumber?(_(),g("span",hl," Â· ÐÐµÐ´ÐµÐ»Ñ "+C(r.weekNumber),1)):Q("",!0)]),a("button",{class:"modal__close",onClick:m[7]||(m[7]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",yl,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>[X.value?(_(),g("div",ml,[...m[20]||(m[20]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¸Ð¼Ñ‘Ð½ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²...",-1)])])):b.value?(_(),g("ul",fl,[(_(!0),g(ae,null,se(x.value,i=>(_(),g("li",{key:i.id||i.name,class:oe(["responsible-list__item",{"responsible-list__item--clickable":i.id&&i.totalCount>0}]),onClick:A=>$(i,A),title:"ÐšÐ»Ð¸ÐºÐ½Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ð³Ñ€Ð°Ð´Ð°Ñ†Ð¸Ð¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°"},[a("span",gl,C(i.name||"ÐÐµ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½"),1),a("span",bl,C(i.totalCount??0)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ",1),i.id&&i.totalCount>0?(_(),g("span",wl,"â†’")):Q("",!0)],10,pl))),128))])):(_(),g("p",_l,"ÐÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°Ð¼"))]),_:1})]),a("footer",Cl,[a("button",{class:"btn",onClick:m[8]||(m[8]=i=>w.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value==="employees"&&e.value===1?(_(),g("div",Tl,[a("header",$l,[a("button",{class:"btn-back",onClick:G,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),a("h3",Wl,"Ð¢Ð¸ÐºÐµÑ‚Ñ‹ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°: "+C(((V=l.value)==null?void 0:V.name)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),1),a("button",{class:"modal__close",onClick:m[9]||(m[9]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",Al,[a("ul",Dl,[(_(!0),g(ae,null,se(W.value,i=>(_(),g("li",{key:i.id,class:oe(["categories-list__item",{"categories-list__item--clickable":i.count>0}]),onClick:A=>S(i)},[a("div",Ul,[a("div",Nl,[i.id==="this-week"?(_(),g("span",Sl,"âœ“")):(_(),g("span",Il,"â†»"))]),a("div",Ml,[a("div",Ol,C(i.label),1),a("div",Bl,C(i.count)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",1)]),i.count>0?(_(),g("span",Rl,"â†’")):Q("",!0)])],10,El))),128))])]),a("footer",Pl,[a("button",{class:"btn",onClick:m[10]||(m[10]=i=>w.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value==="employees"&&e.value===2?(_(),g("div",xl,[a("header",Ll,[a("button",{class:"btn-back",onClick:G,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),a("h3",Gl," Ð¢Ð¸ÐºÐµÑ‚Ñ‹ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ°: "+C(((u=l.value)==null?void 0:u.name)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾")+" ("+C(((n=d.value)==null?void 0:n.label)||"")+") ",1),a("button",{class:"modal__close",onClick:m[11]||(m[11]=i=>w.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",Fl,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>{var i;return[y.value?(_(),g("div",Vl,[...m[21]||(m[21]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²...",-1)])])):f.value?(_(),g("div",Yl,[m[22]||(m[22]=a("div",{class:"error-icon"},"âš ï¸",-1)),m[23]||(m[23]=a("p",{class:"error-title"},"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",-1)),a("p",Hl,C(f.value),1),a("button",{class:"btn btn-retry",onClick:z},"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ")])):k.value.length===0?(_(),g("div",jl,[m[24]||(m[24]=a("div",{class:"empty-state-icon"},"ðŸ“‹",-1)),a("p",zl,C(s.value==="employees"?`Ð£ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð½ÐµÑ‚ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ "${((i=d.value)==null?void 0:i.label)||""}"`:"Ð£ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ° Ð½ÐµÑ‚ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ"),1)])):(_(),g("div",ql,[te(Ke,{name:"ticket",tag:"div",class:"tickets-list"},{default:re(()=>[(_(!0),g(ae,null,se(k.value,(A,P)=>(_(),ve(Qe,{key:A.id,ticket:A,draggable:!1,style:Te({"--ticket-index":P}),onClick:M},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Q("",!0)]}),_:1})])])):Q("",!0)}},Xl=be(Zl,[["__scopeId","data-v-3b229bb4"]]),Jl={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Kl={class:"modal"},Ql={key:"level-1",class:"level-1"},ei={class:"modal__header"},ti={class:"modal__title"},ai={key:0},si={class:"modal__body"},ri={key:"loading",class:"loading-names"},oi={key:"empty",class:"modal__empty"},ni={key:"list",class:"stages-list"},li=["onClick"],ii={class:"stages-list__name"},ci={class:"stages-list__count"},di={key:0,class:"stages-list__arrow"},ui={class:"modal__footer"},vi={key:"level-2",class:"level-2"},ki={class:"modal__header"},hi={class:"modal__title"},yi={class:"modal__body"},mi={key:"loading",class:"loading-state"},_i={key:"error",class:"error-state"},fi={class:"error-message"},pi={key:"empty",class:"empty-state"},gi={class:"empty-state-message"},bi={key:"tickets",class:"tickets-list-container"},wi={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(r,{emit:t}){const e=r,s=Z(1),o=Z(null),l=Z([]),d=Z(!1),k=Z(!1),y=Z(null),f=Z([]),E=q(()=>f.value.length>0&&f.value.some(v=>v.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}k.value=!0,y.value=null;try{const v=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});f.value=v.data.newTicketsByStages||[]}catch(v){y.value=v.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÑÑ‚Ð°Ð´Ð¸Ð¹",console.error("[StagesModal] Error loading stages:",v),f.value=[]}finally{k.value=!1}}async function X(v,h=null){!v||v.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),o.value=v,s.value=2,await K(v.stageId))}async function K(v){var h;d.value=!0,y.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð½ÐµÐ´ÐµÐ»Ð¸");const D=(h=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:h.find(S=>S.stageId===v),$=(D==null?void 0:D.tickets)||[];try{const{prepareTicketsForDisplay:S}=await Ve(async()=>{const{prepareTicketsForDisplay:j}=await import("./ticketListUtils-6ViJOyvD.js").then(N=>N.t);return{prepareTicketsForDisplay:j}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await S($,null,null)}catch(S){console.error("[StagesModal] Error preparing tickets:",S),l.value=$}l.value.length===0&&(y.value=null)}catch(T){y.value=T.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",console.error("[StagesModal] Error loading tickets:",T),l.value=[]}finally{d.value=!1}}function U(){s.value=1,o.value=null,l.value=[],y.value=null}function W(v){const h=ot(v.id);window.open(h,"_blank")}function b(){o.value&&K(o.value.stageId)}return Ce(()=>e.isVisible,v=>{v?x():(s.value=1,o.value=null,l.value=[],y.value=null,f.value=[])}),Ce([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(v,h)=>r.isVisible?(_(),g("div",Jl,[a("div",Kl,[te(de,{name:"level",mode:"out-in"},{default:re(()=>{var T;return[s.value===1?(_(),g("div",Ql,[a("header",ei,[a("h3",ti,[h[3]||(h[3]=ue(" ÐÐ¾Ð²Ñ‹Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹ Ð¿Ð¾ ÑÑ‚Ð°Ð´Ð¸ÑÐ¼",-1)),r.weekNumber?(_(),g("span",ai," Â· ÐÐµÐ´ÐµÐ»Ñ "+C(r.weekNumber),1)):Q("",!0)]),a("button",{class:"modal__close",onClick:h[0]||(h[0]=D=>v.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",si,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>[k.value?(_(),g("div",ri,[...h[4]||(h[4]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÑÑ‚Ð°Ð´Ð¸Ð¹...",-1)])])):E.value?(_(),g("ul",ni,[(_(!0),g(ae,null,se(f.value,D=>(_(),g("li",{key:D.stageId,class:oe(["stages-list__item",{"stages-list__item--clickable":D.count>0}]),style:Te({"--stage-color":D.color}),onClick:$=>X(D,$),title:"ÐšÐ»Ð¸ÐºÐ½Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ÑÑ‚Ð°Ð´Ð¸Ð¸"},[a("span",{class:"stages-list__color",style:Te({backgroundColor:D.color})},null,4),a("span",ii,C(D.stageName),1),a("span",ci,C(D.count)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ",1),D.count>0?(_(),g("span",di,"â†’")):Q("",!0)],14,li))),128))])):(_(),g("p",oi," ÐÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ "))]),_:1})]),a("footer",ui,[a("button",{class:"btn",onClick:h[1]||(h[1]=D=>v.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value===2?(_(),g("div",vi,[a("header",ki,[a("button",{class:"btn-back",onClick:U,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),a("h3",hi," Ð¢Ð¸ÐºÐµÑ‚Ñ‹ ÑÑ‚Ð°Ð´Ð¸Ð¸: "+C(((T=o.value)==null?void 0:T.stageName)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),1),a("button",{class:"modal__close",onClick:h[2]||(h[2]=D=>v.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",yi,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>{var D;return[d.value?(_(),g("div",mi,[...h[5]||(h[5]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²...",-1)])])):y.value?(_(),g("div",_i,[h[6]||(h[6]=a("div",{class:"error-icon"},"âš ï¸",-1)),h[7]||(h[7]=a("p",{class:"error-title"},"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",-1)),a("p",fi,C(y.value),1),a("button",{class:"btn btn-retry",onClick:b},"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ")])):l.value.length===0?(_(),g("div",pi,[h[8]||(h[8]=a("div",{class:"empty-state-icon"},"ðŸ“‹",-1)),a("p",gi," ÐÐ° ÑÑ‚Ð°Ð´Ð¸Ð¸ Â«"+C((D=o.value)==null?void 0:D.stageName)+"Â» Ð½ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ ",1)])):(_(),g("div",bi,[te(Ke,{name:"ticket",tag:"div",class:"tickets-list"},{default:re(()=>[(_(!0),g(ae,null,se(l.value,($,S)=>(_(),ve(Qe,{key:$.id,ticket:$,draggable:!1,style:Te({"--ticket-index":S}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Q("",!0)]}),_:1})])])):Q("",!0)}},Ci=be(wi,[["__scopeId","data-v-4af0cfce"]]),Ti={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},$i={class:"modal"},Wi={key:"level-1",class:"level-1"},Ai={class:"modal__header"},Di={class:"modal__title"},Ei={key:0},Ui={class:"modal__body"},Ni={key:"loading",class:"loading-names"},Si={key:"empty",class:"modal__empty"},Ii={key:"list",class:"duration-list"},Mi=["onClick"],Oi={class:"duration-list__name"},Bi={class:"duration-list__count"},Ri={key:0,class:"duration-list__arrow"},Pi={class:"modal__footer"},xi={key:"level-2",class:"level-2"},Li={class:"modal__header"},Gi={class:"modal__title"},Fi={class:"modal__body"},Vi={key:"loading",class:"loading-state"},Yi={key:"error",class:"error-state"},Hi={class:"error-message"},ji={key:"empty",class:"empty-state"},zi={class:"empty-state-message"},qi={key:"tickets",class:"tickets-list-container"},Zi={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(r,{emit:t}){const e=r,s=Z(1),o=Z(null),l=Z([]),d=Z(!1),k=Z(!1),y=Z(null),f=Z([]),E=q(()=>f.value.length>0&&f.value.some(v=>v.count>0));async function x(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}k.value=!0,y.value=null;try{const v=await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});f.value=v.data.carryoverTicketsByDuration||[]}catch(v){y.value=v.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹",console.error("[CarryoverDurationModal] Error loading categories:",v),f.value=[]}finally{k.value=!1}}async function X(v,h=null){!v||v.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),o.value=v,s.value=2,await K(v.durationCategory))}async function K(v){var h;d.value=!0,y.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("ÐÐµ ÑƒÐºÐ°Ð·Ð°Ð½Ñ‹ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ð½ÐµÐ´ÐµÐ»Ð¸");const D=(h=(await We({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:h.find(S=>S.durationCategory===v),$=(D==null?void 0:D.tickets)||[];try{const{prepareTicketsForDisplay:S}=await Ve(async()=>{const{prepareTicketsForDisplay:j}=await import("./ticketListUtils-6ViJOyvD.js").then(N=>N.t);return{prepareTicketsForDisplay:j}},__vite__mapDeps([0,1,2,3,4,5]),import.meta.url);l.value=await S($,null,null)}catch(S){console.error("[CarryoverDurationModal] Error preparing tickets:",S),l.value=$}l.value.length===0&&(y.value=null)}catch(T){y.value=T.message||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²",console.error("[CarryoverDurationModal] Error loading tickets:",T),l.value=[]}finally{d.value=!1}}function U(){s.value=1,o.value=null,l.value=[],y.value=null}function W(v){const h=ot(v.id);window.open(h,"_blank")}function b(){o.value&&K(o.value.durationCategory)}return Ce(()=>e.isVisible,v=>{v?x():(s.value=1,o.value=null,l.value=[],y.value=null,f.value=[])}),Ce([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&x()}),(v,h)=>r.isVisible?(_(),g("div",Ti,[a("div",$i,[te(de,{name:"level",mode:"out-in"},{default:re(()=>{var T;return[s.value===1?(_(),g("div",Wi,[a("header",Ai,[a("h3",Di,[h[3]||(h[3]=ue(" ÐŸÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ðµ Ñ‚Ð¸ÐºÐµÑ‚Ñ‹ Ð¿Ð¾ ÑÑ€Ð¾ÐºÐ°Ð¼",-1)),r.weekNumber?(_(),g("span",Ei," Â· ÐÐµÐ´ÐµÐ»Ñ "+C(r.weekNumber),1)):Q("",!0)]),a("button",{class:"modal__close",onClick:h[0]||(h[0]=D=>v.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",Ui,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>[k.value?(_(),g("div",Ni,[...h[4]||(h[4]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¹...",-1)])])):E.value?(_(),g("ul",Ii,[(_(!0),g(ae,null,se(f.value,D=>(_(),g("li",{key:D.durationCategory,class:oe(["duration-list__item",{"duration-list__item--clickable":D.count>0}]),style:Te({"--duration-color":D.color}),onClick:$=>X(D,$),title:"ÐšÐ»Ð¸ÐºÐ½Ð¸Ñ‚Ðµ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€Ð° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸"},[a("span",{class:"duration-list__color",style:Te({backgroundColor:D.color})},null,4),a("span",Oi,C(D.durationLabel),1),a("span",Bi,C(D.count)+" Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ",1),D.count>0?(_(),g("span",Ri,"â†’")):Q("",!0)],14,Mi))),128))])):(_(),g("p",Si," ÐÐµÑ‚ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² Ð·Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð½ÐµÐ´ÐµÐ»ÑŽ "))]),_:1})]),a("footer",Pi,[a("button",{class:"btn",onClick:h[1]||(h[1]=D=>v.$emit("close"))},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ")])])):s.value===2?(_(),g("div",xi,[a("header",Li,[a("button",{class:"btn-back",onClick:U,"aria-label":"ÐÐ°Ð·Ð°Ð´"},"â† ÐÐ°Ð·Ð°Ð´"),a("h3",Gi," Ð¢Ð¸ÐºÐµÑ‚Ñ‹: "+C(((T=o.value)==null?void 0:T.durationLabel)||"ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð¾"),1),a("button",{class:"modal__close",onClick:h[2]||(h[2]=D=>v.$emit("close")),"aria-label":"Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ"}," âœ• ")]),a("section",Fi,[te(de,{name:"loading",mode:"out-in"},{default:re(()=>{var D;return[d.value?(_(),g("div",Vi,[...h[5]||(h[5]=[a("div",{class:"loading-spinner"},null,-1),a("p",null,"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð²...",-1)])])):y.value?(_(),g("div",Yi,[h[6]||(h[6]=a("div",{class:"error-icon"},"âš ï¸",-1)),h[7]||(h[7]=a("p",{class:"error-title"},"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",-1)),a("p",Hi,C(y.value),1),a("button",{class:"btn btn-retry",onClick:b},"ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ")])):l.value.length===0?(_(),g("div",ji,[h[8]||(h[8]=a("div",{class:"empty-state-icon"},"ðŸ“‹",-1)),a("p",zi," Ð’ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Â«"+C((D=o.value)==null?void 0:D.durationLabel)+"Â» Ð½ÐµÑ‚ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ÑÑ‰Ð¸Ñ… Ñ‚Ð¸ÐºÐµÑ‚Ð¾Ð² ",1)])):(_(),g("div",qi,[te(Ke,{name:"ticket",tag:"div",class:"tickets-list"},{default:re(()=>[(_(!0),g(ae,null,se(l.value,($,S)=>(_(),ve(Qe,{key:$.id,ticket:$,draggable:!1,style:Te({"--ticket-index":S}),onClick:W},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Q("",!0)]}),_:1})])])):Q("",!0)}},Xi=be(Zi,[["__scopeId","data-v-c26f06c2"]]),Ji={class:"ac-dashboard"},Ki={key:"preloader",class:"chart-preloader"},Qi={class:"preloader-content"},ec={class:"preloader-message"},tc={key:"content"},ac={key:1,class:"weeks-dashboard"},sc={class:"dashboard-header"},rc={class:"header-content"},oc={class:"breadcrumbs-row"},nc=["aria-label","aria-disabled","data-fallback","disabled"],lc={class:"breadcrumbs","aria-label":"ÐÐ°Ð²Ð¸Ð³Ð°Ñ†Ð¸Ñ"},ic={class:"dashboard-layout"},cc={class:"filters-container"},dc={class:"chart-container"},uc={__name:"GraphAdmissionClosureDashboard",setup(r){const t=At(),e=Z(!1),s=Z(null),o=Z(null),l=Z({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),d=Z(!1),k=Z(!1),y=Z(!1),f=Z(!0),E=Z(null),x=Z(!1),X=q(()=>typeof window>"u"?!1:window.history.length>1),K=q(()=>X.value?"Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð½Ð° Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ":"Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð½Ð° Ð³Ð»Ð°Ð²Ð½ÑƒÑŽ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ"),U={name:"dashboard-sector-1c"};function W(n){var i;if((i=n==null?void 0:n.preventDefault)==null||i.call(n),!x.value){x.value=!0;try{if(X.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(U)}finally{x.value=!1}}}const b=Z({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),v=Z("weeks"),h=q(()=>{const n=b.value.customDateRange.startDate||b.value.customDateRange.endDate,i=b.value.employees.length===1&&b.value.employees.includes("all");return n||!i});async function T(){if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",v.value),console.log("[DEBUG] isLoading before:",e.value),v.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,s.value=null;const n=new Promise(i=>setTimeout(i,300));try{console.log("[DEBUG] Starting API call");const i=u(),A=i.weekStartUtc,P=i.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:A,weekEndUtc:P});const[B,Y]=await Promise.all([n,We({product:"1C",periodMode:"weeks",weekStartUtc:A,weekEndUtc:P,includeTickets:!0})]);console.log("[DEBUG] API call successful, result:",Y);const{meta:ee,data:p,carryoverDebug:c}=Y;o.value=ee,l.value=p,console.log("[DEBUG] Data set, meta:",ee,"data keys:",Object.keys(p)),c&&(console.log("[CARRYOVER-DEBUG] ========================================"),console.log("[CARRYOVER-DEBUG] Total:",c.total),console.log("[CARRYOVER-DEBUG] ThisWeek:",c.thisWeek),console.log("[CARRYOVER-DEBUG] PreviousWeek:",c.previousWeek),console.log("[CARRYOVER-DEBUG] Older:",c.older),console.log("[CARRYOVER-DEBUG] Sum:",c.sum,"(expected:",c.total,")"),console.log("[CARRYOVER-DEBUG] Series:",c.series),console.log("[CARRYOVER-DEBUG] CurrentWeekData:",c.currentWeekData),console.log("[CARRYOVER-DEBUG] WeeksData:",c.weeksData),console.log("[CARRYOVER-DEBUG] Full object:",c),console.log("[CARRYOVER-DEBUG] ========================================"))}catch(i){console.error("[DEBUG] API call failed:",i),s.value=i instanceof Error?i:new Error("ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸"),console.error("[GraphAdmissionClosureDashboard] loadData error:",i)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function D(n){b.value.stages=n}function $(n){b.value.employees=n}function S(n){b.value.dateRange=n}function j(n){b.value.customDateRange=n}function N(n){if(!["weeks","months"].includes(n)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",n);return}n!==v.value&&(v.value=n,T())}function R(n){const{mode:i}=n.detail;["weeks","months"].includes(i)&&N(i)}function L(){b.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},G()}function G(){T()}function M(n){["weeks","months"].includes(n)&&(v.value=n)}function z(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",f.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",v.value),f.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",f.value),console.log("[DEBUG] isLoading after:",e.value),pt(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),w()})}function w(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",v.value),console.log("[DEBUG] showPeriodModeInfo:",f.value),console.log("[DEBUG] isLoading:",e.value),(!v.value||!["weeks","months"].includes(v.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),v.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",v.value),pt(()=>{console.log("[DEBUG] nextTick callback, periodMode:",v.value),console.log("[DEBUG] isLoading in nextTick:",e.value),v.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),T()):v.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}function m(n=null){var i,A,P;n?E.value=n:E.value={weekNumber:((i=o.value)==null?void 0:i.weekNumber)||null,weekStartUtc:((A=o.value)==null?void 0:A.weekStartUtc)||null,weekEndUtc:((P=o.value)==null?void 0:P.weekEndUtc)||null},k.value=!0}function O(n=null){var i,A,P;n?E.value=n:E.value={weekNumber:((i=o.value)==null?void 0:i.weekNumber)||null,weekStartUtc:((A=o.value)==null?void 0:A.weekStartUtc)||null,weekEndUtc:((P=o.value)==null?void 0:P.weekEndUtc)||null},d.value=!0}function V(n=null){var i,A,P;n?E.value=n:E.value={weekNumber:((i=o.value)==null?void 0:i.weekNumber)||null,weekStartUtc:((A=o.value)==null?void 0:A.weekStartUtc)||null,weekEndUtc:((P=o.value)==null?void 0:P.weekEndUtc)||null},y.value=!0}rt(()=>{try{const n="graph-admission-closure-period-mode-info-shown";localStorage.getItem(n)&&localStorage.removeItem(n);const i="graph-admission-closure-period-mode";localStorage.getItem(i)&&localStorage.removeItem(i)}catch(n){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",n)}window.addEventListener("period-mode-change",R)}),Tt(()=>{window.removeEventListener("period-mode-change",R)});function u(){const n=new Date,i=new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())),A=i.getUTCDay(),P=i.getUTCDate()-A+(A===0?-6:1),B=new Date(Date.UTC(i.getUTCFullYear(),i.getUTCMonth(),P,0,0,0)),Y=new Date(B);return Y.setUTCDate(Y.getUTCDate()+6),Y.setUTCHours(23,59,59,999),{weekStartUtc:B.toISOString(),weekEndUtc:Y.toISOString()}}return(n,i)=>{var P,B,Y,ee,p,c,F,I,J,ie,ke,he,ye,me,_e,fe,pe,ge;const A=Dt("router-link");return _(),g("div",Ji,[te(de,{name:"fade",mode:"out-in"},{default:re(()=>[e.value?(_(),g("div",Ki,[a("div",Qi,[i[3]||(i[3]=a("div",{class:"preloader-spinner"},[a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"}),a("div",{class:"spinner-ring"})],-1)),i[4]||(i[4]=a("h3",{class:"preloader-title"},"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ°",-1)),a("p",ec," ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð·Ð° "+C(v.value==="weeks"?"4 Ð½ÐµÐ´ÐµÐ»Ð¸":"3 Ð¼ÐµÑÑÑ†Ð°")+"... ",1),i[5]||(i[5]=a("div",{class:"preloader-dots"},[a("span",{class:"dot"}),a("span",{class:"dot"}),a("span",{class:"dot"})],-1))])])):!f.value&&!e.value?(_(),g("div",tc,[v.value==="months"?(_(),ve($n,{key:0})):(_(),g("div",ac,[a("div",sc,[a("div",rc,[a("div",oc,[a("button",{class:"btn-back-link",type:"button",onClick:W,"aria-label":K.value,"aria-disabled":!X.value,"data-fallback":!X.value,disabled:x.value,title:"ÐÐ°Ð·Ð°Ð´"}," â† ",8,nc),a("nav",lc,[te(A,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:re(()=>[...i[6]||(i[6]=[ue(" Ð”Ð°ÑˆÐ±Ð¾Ñ€Ð´ ÑÐµÐºÑ‚Ð¾Ñ€Ð° 1Ð¡ ",-1)])]),_:1}),i[8]||(i[8]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),te(A,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:re(()=>[...i[7]||(i[7]=[ue(" Ð“Ñ€Ð°Ñ„Ð¸Ðº ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ ",-1)])]),_:1}),i[9]||(i[9]=a("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),i[10]||(i[10]=a("span",{class:"breadcrumb-current"},"Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹",-1))])]),i[11]||(i[11]=a("h1",{class:"dashboard-title"},"Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð¸ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ð¹ ÑÐµÐºÑ‚Ð¾Ñ€Ð° 1Ð¡",-1)),i[12]||(i[12]=a("p",{class:"dashboard-subtitle"}," Ð”Ð¾ÑÑ‚ÑƒÐ¿Ñ‹ Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹ Ð°Ð½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ñ‹ Â«Ð“Ñ€Ð°Ñ„Ð¸ÐºÑƒ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸ÑÂ», ÑÐµÐ»ÐµÐºÑ‚Ð¾Ñ€ ÑÑ‚Ð°Ð¿Ð¾Ð² ÑÐºÑ€Ñ‹Ñ‚. ",-1))])]),a("div",ic,[a("div",cc,[te(Ut,{stages:b.value.stages,employees:b.value.employees,dateRange:b.value.dateRange,customDateRange:b.value.customDateRange,hasActiveFilters:h.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":v.value,"onUpdate:stages":D,"onUpdate:employees":$,"onUpdate:dateRange":S,"onUpdate:customDateRange":j,"onUpdate:periodMode":N,onReset:L,onApply:G},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),a("div",dc,[s.value?(_(),ve(Et,{key:0,type:"error",title:"ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",message:s.value.message},null,8,["message"])):(_(),ve(kr,{key:1,meta:o.value,data:l.value,onOpenResponsible:O,onOpenStages:m,onOpenCarryover:V},null,8,["meta","data"]))])])]))])):Q("",!0)]),_:1}),te(Xl,{"is-visible":d.value,responsible:l.value.responsible||[],"closed-tickets-created-this-week":l.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":l.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":l.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":l.value.responsibleCreatedOtherWeek||[],"week-number":((P=E.value)==null?void 0:P.weekNumber)||((B=o.value)==null?void 0:B.weekNumber)||null,"week-start-utc":((Y=E.value)==null?void 0:Y.weekStartUtc)||((ee=o.value)==null?void 0:ee.weekStartUtc)||null,"week-end-utc":((p=E.value)==null?void 0:p.weekEndUtc)||((c=o.value)==null?void 0:c.weekEndUtc)||null,onClose:i[0]||(i[0]=$e=>{d.value=!1,E.value.value=null})},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),te(Ci,{"is-visible":k.value,"week-number":((F=E.value)==null?void 0:F.weekNumber)||((I=o.value)==null?void 0:I.weekNumber)||null,"week-start-utc":((J=E.value)==null?void 0:J.weekStartUtc)||((ie=o.value)==null?void 0:ie.weekStartUtc)||null,"week-end-utc":((ke=E.value)==null?void 0:ke.weekEndUtc)||((he=o.value)==null?void 0:he.weekEndUtc)||null,onClose:i[1]||(i[1]=$e=>{k.value=!1,E.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),te(Xi,{"is-visible":y.value,"week-number":((ye=E.value)==null?void 0:ye.weekNumber)||((me=o.value)==null?void 0:me.weekNumber)||null,"week-start-utc":((_e=E.value)==null?void 0:_e.weekStartUtc)||((fe=o.value)==null?void 0:fe.weekStartUtc)||null,"week-end-utc":((pe=E.value)==null?void 0:pe.weekEndUtc)||((ge=o.value)==null?void 0:ge.weekEndUtc)||null,onClose:i[2]||(i[2]=$e=>{y.value=!1,E.value.value=null})},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),f.value?(_(),ve(ca,{key:0,"is-visible":f.value,"current-mode":v.value,onClose:z,onSelectMode:M},null,8,["is-visible","current-mode"])):Q("",!0)])}}},fc=be(uc,[["__scopeId","data-v-de18647a"]]);export{fc as default};
