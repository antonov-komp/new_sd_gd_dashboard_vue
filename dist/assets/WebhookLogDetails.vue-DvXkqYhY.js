import{_ as q,n as w,i as N,d as G,b as H,e as Q}from"./main-C7-AlynL.js";import{c as l,b as f,o as r,e as o,t as c,F as z,l as F,n as W,g as S,j as m,s as $}from"./chunk-B8Oau2YK.js";import"./chunk-DOWfazO3.js";import"./chunk-DUUYZoSI.js";import"./chunk-Cp0XlrP4.js";import"./chunk-hUs429I0.js";import"./chunk-dtLAlr5J.js";const tt={name:"WebhookLogDetails",props:{log:{type:Object,default:null}},emits:["close"],setup(h,{emit:a}){const g=S(!1),e=S(null),C=S(!1),_=S(!1),n=5e4,y=2e5,s=m(()=>{if(!h.log)return null;const t=w(h.log);return N(t)?t:(console.error("[WebhookLogDetails] Invalid log entry:",h.log),null)}),B=m(()=>!s.value||!s.value.details?null:G(s.value.details)?s.value.details:(console.warn("[WebhookLogDetails] Invalid event details:",s.value.details),null)),L=m(()=>P.value>y),A=m(()=>M.value>y),D=async t=>{g.value=!1,e.value=null;try{if(!navigator.clipboard)throw new Error("Clipboard API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è");await navigator.clipboard.writeText(t),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch(d){console.error("Failed to copy:",d),e.value=d.message;try{const i=document.createElement("textarea");i.value=t,i.style.position="fixed",i.style.left="-999999px",document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch{e.value="–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å"}}},O=()=>{if(!(!s.value||!s.value.payload))try{const t=JSON.stringify(s.value.payload,null,2);D(t)}catch(t){console.error("[WebhookLogDetails] Error copying payload:",t),e.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ payload"}},T=(t,d)=>{try{const i=`${t}: ${typeof d=="object"?p(d,2):d}`;D(i)}catch(i){console.error("[WebhookLogDetails] Error copying field:",i),e.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—è"}},J=m(()=>{if(!s.value)return{};const t=s.value;return{timestamp:t.timestamp,event:t.event,category:t.category,ip:t.ip||"N/A"}}),j=t=>t?Q(t,"long"):"‚Äî",x=t=>t?H(t):"‚Äî",V=t=>`category-${t}`,X=t=>t?.startsWith("ONTASK")?"event-task":t?.startsWith("ONCRMDYNAMIC")?"event-smart-process":"event-other",Y=t=>({timestamp:"–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è",event:"–¢–∏–ø —Å–æ–±—ã—Ç–∏—è",category:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è",ip:"IP –∞–¥—Ä–µ—Å",task_id:"ID –∑–∞–¥–∞—á–∏",task_title:"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",entity_id:"ID —Å—É—â–Ω–æ—Å—Ç–∏",title:"–ù–∞–∑–≤–∞–Ω–∏–µ",comment_text:"–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è"})[t]||t.charAt(0).toUpperCase()+t.slice(1).replace(/_/g," "),Z=t=>{if(t==null)return"N/A";if(typeof t=="boolean")return t?"–î–∞":"–ù–µ—Ç";if(typeof t=="object"){if(Array.isArray(t))return t.length===0?"–ü—É—Å—Ç–æ":t.join(", ");try{return p(t,2)}catch{return"[–ù–µ —É–¥–∞–ª–æ—Å—å —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å]"}}return String(t)},E=new WeakMap,p=(t,d=2)=>{const i=new WeakSet;return JSON.stringify(t,(v,u)=>{if(typeof u=="object"&&u!==null){if(i.has(u))return"[Circular]";i.add(u)}return u},d)},I=(t,d=null,i=!1)=>{if(!t)return"N/A";try{if(E.has(t)&&!i){const k=E.get(t);if(k.maxSize===d&&k.showFull===i)return k.result}const v=p(t,2),u=new Blob([v]).size;let b;return d&&u>d&&!i?b=v.substring(0,d)+`

... [JSON –æ–±—Ä–µ–∑–∞–Ω, –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞]`:b=v,u<1e5&&E.set(t,{result:b,maxSize:d,showFull:i,size:u}),b}catch(v){return console.error("[WebhookLogDetails] Error formatting JSON:",v),`[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON: ${v.message}]`}},P=m(()=>{if(!s.value||!s.value.payload)return 0;try{const t=JSON.stringify(s.value.payload);return new Blob([t]).size}catch(t){return console.error("[WebhookLogDetails] Error calculating payload size:",t),0}}),M=m(()=>{if(!s.value?.metadata)return 0;try{const t=p(s.value.metadata);return new Blob([t]).size}catch(t){return console.warn("[WebhookLogDetails] Error calculating metadata size:",t),0}}),K=m(()=>{if(!s.value||!s.value.payload)return"{}";if(L.value)return"";try{return JSON.stringify(s.value.payload,null,2)}catch(t){return console.error("[WebhookLogDetails] Error formatting payload:",t),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è]"}}),R=m(()=>{if(!s.value?.metadata)return"N/A";if(A.value)return"";try{return I(s.value.metadata,_.value?null:n,_.value)}catch(t){return console.error("[WebhookLogDetails] Error formatting metadata:",t),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è metadata]"}}),U=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`;return $(()=>h.log,t=>{if(C.value=!1,_.value=!1,t){const d=w(t);N(d)||console.error("[WebhookLogDetails] Invalid log entry received:",t)}},{immediate:!0}),{validatedLog:s,validatedDetails:B,copySuccess:g,copyError:e,copyToClipboard:D,copyFullPayload:O,copyField:T,mainInfo:J,formatTimestamp:j,getCategoryLabel:x,getCategoryClass:V,getEventClass:X,formatKey:Y,formatValue:Z,formatJson:I,formattedPayload:K,formattedMetadata:R,payloadSize:P,metadataSize:M,showFullPayload:C,showFullMetadata:_,MAX_DISPLAY_SIZE:n,isPayloadTooLarge:L,isMetadataTooLarge:A,formatBytes:U,handleClose:()=>{a("close")}}}},et={key:0,class:"webhook-log-details"},ot={class:"details-header"},at={class:"header-actions"},nt={class:"details-content"},st={key:0,class:"copy-success-message"},lt={key:1,class:"copy-error-message"},rt={class:"details-section"},it={class:"info-grid"},dt={class:"info-value-wrapper"},ct={key:0},yt={key:1},ut={key:2},ft={key:3},mt=["onClick"],gt={key:2,class:"details-section"},vt={class:"info-grid"},ht={class:"details-section"},_t={class:"section-header"},pt={class:"section-actions"},bt={key:0,class:"size-warning"},kt={class:"json-container"},St={key:0,class:"json-content"},Ct={key:1,class:"payload-too-large"},Dt={key:3,class:"details-section"},Et={class:"section-header"},Lt={class:"section-actions"},At={key:0,class:"size-warning"},It={class:"json-container"},Pt={key:0,class:"json-content"},Mt={key:1,class:"payload-too-large"},wt={class:"details-footer"};function Nt(h,a,g,e,C,_){return e.validatedLog?(r(),l("div",et,[o("div",ot,[a[7]||(a[7]=o("h3",null,"–î–µ—Ç–∞–ª–∏ –ª–æ–≥–∞ –≤–µ–±—Ö—É–∫–∞",-1)),o("div",at,[o("button",{onClick:a[0]||(a[0]=(...n)=>e.copyFullPayload&&e.copyFullPayload(...n)),class:"btn-copy",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON "),o("button",{onClick:a[1]||(a[1]=(...n)=>e.handleClose&&e.handleClose(...n)),class:"btn-close"},"√ó")])]),o("div",nt,[e.copySuccess?(r(),l("div",st," ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! ")):f("",!0),e.copyError?(r(),l("div",lt," ‚ùå "+c(e.copyError),1)):f("",!0),o("div",rt,[a[8]||(a[8]=o("h4",null,"–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),o("div",it,[(r(!0),l(z,null,F(e.mainInfo,(n,y)=>(r(),l("div",{key:y,class:"info-item"},[o("label",null,c(e.formatKey(y))+":",1),o("div",dt,[y==="event"?(r(),l("span",ct,[o("span",{class:W(["event-badge",e.getEventClass(n)])},c(n),3)])):y==="category"?(r(),l("span",yt,[o("span",{class:W(["category-badge",e.getCategoryClass(n)])},c(e.getCategoryLabel(n)),3)])):y==="timestamp"?(r(),l("span",ut,c(e.formatTimestamp(n)),1)):(r(),l("span",ft,c(n||"N/A"),1)),o("button",{onClick:s=>e.copyField(y,n),class:"btn-copy-field",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ"}," üìã ",8,mt)])]))),128))])]),e.validatedDetails&&Object.keys(e.validatedDetails).length>0?(r(),l("div",gt,[a[9]||(a[9]=o("h4",null,"–î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è",-1)),o("div",vt,[(r(!0),l(z,null,F(e.validatedDetails,(n,y)=>(r(),l("div",{key:y,class:"info-item"},[o("label",null,c(e.formatKey(y))+":",1),o("span",null,c(e.formatValue(n)),1)]))),128))])])):f("",!0),o("div",ht,[o("div",_t,[a[10]||(a[10]=o("h4",null,"–ü–æ–ª–Ω—ã–π payload",-1)),o("div",pt,[e.payloadSize>e.MAX_DISPLAY_SIZE?(r(),l("span",bt," –ë–æ–ª—å—à–æ–π JSON ("+c(e.formatBytes(e.payloadSize))+") ",1)):f("",!0),e.payloadSize>e.MAX_DISPLAY_SIZE&&!e.showFullPayload?(r(),l("button",{key:1,onClick:a[2]||(a[2]=n=>e.showFullPayload=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):f("",!0),o("button",{onClick:a[3]||(a[3]=(...n)=>e.copyFullPayload&&e.copyFullPayload(...n)),class:"btn-copy-section",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ")])]),o("div",kt,[e.isPayloadTooLarge?(r(),l("div",Ct,[o("p",null,"‚ö†Ô∏è Payload —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+c(e.formatBytes(e.payloadSize))+")",1),a[11]||(a[11]=o("p",null,'–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏.',-1)),o("button",{onClick:a[4]||(a[4]=(...n)=>e.copyFullPayload&&e.copyFullPayload(...n)),class:"btn-copy-section"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å payload ")])):(r(),l("pre",St,c(e.formattedPayload),1))])]),g.log.metadata?(r(),l("div",Dt,[o("div",Et,[a[12]||(a[12]=o("h4",null,"–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ",-1)),o("div",Lt,[e.metadataSize>e.MAX_DISPLAY_SIZE?(r(),l("span",At," –ë–æ–ª—å—à–æ–π JSON ("+c(e.formatBytes(e.metadataSize))+") ",1)):f("",!0),e.metadataSize>e.MAX_DISPLAY_SIZE&&!e.showFullMetadata?(r(),l("button",{key:1,onClick:a[5]||(a[5]=n=>e.showFullMetadata=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):f("",!0)])]),o("div",It,[e.isMetadataTooLarge?(r(),l("div",Mt,[o("p",null,"‚ö†Ô∏è Metadata —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+c(e.formatBytes(e.metadataSize))+")",1),a[13]||(a[13]=o("p",null,"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.",-1))])):(r(),l("pre",Pt,c(e.formattedMetadata),1))])])):f("",!0)]),o("div",wt,[o("button",{onClick:a[6]||(a[6]=(...n)=>e.handleClose&&e.handleClose(...n)),class:"btn-close-details"},"–ó–∞–∫—Ä—ã—Ç—å")])])):f("",!0)}const xt=q(tt,[["render",Nt],["__scopeId","data-v-59ae6997"]]);export{xt as default};
