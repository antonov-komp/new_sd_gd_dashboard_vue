const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ticketListUtils-DgoQZRmm.js","assets/priority-config-CRG0BYQv.js","assets/main-BGvIMOai.js","assets/main-hkNOQW78.css","assets/priority-config-Bxxce_5E.css","assets/ticket-mapper-DQ9s4OZq.js"])))=>i.map(i=>d[i]);
var Fe=Object.defineProperty;var Ge=(g,s,t)=>s in g?Fe(g,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):g[s]=t;var ve=(g,s,t)=>Ge(g,typeof s!="symbol"?s+"":s,t);import{_ as te,m as ke,G as Re,a as n,o,b as e,y as X,n as J,g as A,H as Oe,I as ae,f as ee,j as N,k as z,d as G,p as Ye,v as xe,i as ze,B as K,J as je,c as L,K as P,t as T,F as j,e as H,L as de,M as qe,x as He,l as se,z as Ne,r as Pe,S as Le,T as ce,N as ie}from"./main-BGvIMOai.js";import{F as Ve}from"./FiltersPanel-CvSUpUYF.js";import{L as ne,D as Ze,B as Ke}from"./index-DBIRlgdp.js";import{B as le,g as Me,a as Je,b as Be,D as Xe,T as ue,c as me}from"./priority-config-CRG0BYQv.js";const Qe={class:"period-mode-selector"},et={class:"selector-options"},tt=["checked"],st=["checked"],he="graph-admission-closure-period-mode",at={__name:"PeriodModeSelector",props:{modelValue:{type:String,required:!0,validator:g=>["weeks","months"].includes(g)?!0:(console.warn(`[PeriodModeSelector] Invalid modelValue: ${g}. Using default 'weeks'.`),!1)}},emits:["update:modelValue","change"],setup(g,{emit:s}){const t=g,l=s;function i(_){if(!["weeks","months"].includes(_)){console.warn(`[PeriodModeSelector] Invalid value: ${_}. Ignoring change.`);return}try{localStorage.setItem(he,_),l("update:modelValue",_),l("change",_)}catch(v){console.warn("[PeriodModeSelector] Failed to save to localStorage:",v),l("update:modelValue",_),l("change",_)}}function d(_){_.key===he&&_.newValue&&(_.newValue==="weeks"||_.newValue==="months")&&_.newValue!==t.modelValue&&l("update:modelValue",_.newValue)}return ke(()=>{try{const _=localStorage.getItem(he);(_==="weeks"||_==="months")&&_!==t.modelValue&&l("update:modelValue",_)}catch(_){console.warn("[PeriodModeSelector] Failed to read from localStorage:",_)}window.addEventListener("storage",d)}),Re(()=>{window.removeEventListener("storage",d)}),(_,v)=>(o(),n("div",Qe,[v[4]||(v[4]=e("h3",{class:"selector-title"},[e("span",{class:"selector-icon"},"üìÖ"),X(" –†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),e("div",et,[e("label",{class:J(["option-label",{"option-selected":g.modelValue==="weeks"}])},[e("input",{type:"radio",value:"weeks",checked:g.modelValue==="weeks",onChange:v[0]||(v[0]=c=>i("weeks")),class:"option-input","aria-label":"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏"},null,40,tt),v[2]||(v[2]=e("span",{class:"option-text"},[e("span",{class:"option-icon"},"üìÖ"),X(" 4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏ ")],-1))],2),e("label",{class:J(["option-label",{"option-selected":g.modelValue==="months"}])},[e("input",{type:"radio",value:"months",checked:g.modelValue==="months",onChange:v[1]||(v[1]=c=>i("months")),class:"option-input","aria-label":"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞"},null,40,st),v[3]||(v[3]=e("span",{class:"option-text"},[e("span",{class:"option-icon"},"üìä"),X(" 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞ ")],-1))],2)])]))}},rt=te(at,[["__scopeId","data-v-3786bef5"]]),ot={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},lt={class:"modal-body"},nt={class:"modal-checkbox"},it={class:"checkbox-label"},dt={class:"modal-footer"},ct="graph-admission-closure-period-mode-info-shown",ut={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0}},emits:["close"],setup(g,{emit:s}){const t=g,l=s,i=A(!1),d=A(null);function _(){if(i.value)try{localStorage.setItem(ct,"true")}catch(c){console.warn("[PeriodModeInfoModal] Failed to save to localStorage:",c)}l("close")}function v(c){c.key==="Escape"&&t.isVisible&&_()}return ke(()=>{t.isVisible&&(document.addEventListener("keydown",v),Oe(()=>{d.value&&d.value.focus()}))}),Re(()=>{document.removeEventListener("keydown",v)}),ae(()=>t.isVisible,c=>{c?(document.addEventListener("keydown",v),Oe(()=>{d.value&&d.value.focus()})):document.removeEventListener("keydown",v)}),(c,h)=>(o(),ee(je,{to:"body"},[N(K,{name:"modal-fade"},{default:z(()=>[g.isVisible?(o(),n("div",{key:0,class:"modal-overlay",onClick:ze(_,["self"])},[e("div",ot,[e("div",{class:"modal-header"},[h[1]||(h[1]=e("h2",{id:"modal-title",class:"modal-title"},[e("span",{class:"modal-icon"},"‚ÑπÔ∏è"),X(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),e("button",{class:"modal-close-btn",onClick:_,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),e("div",lt,[h[3]||(h[3]=e("div",{class:"mode-description"},[e("div",{class:"mode-item"},[e("div",{class:"mode-header"},[e("span",{class:"mode-icon"},"üìÖ"),e("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")]),e("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ")]),e("div",{class:"mode-item"},[e("div",{class:"mode-header"},[e("span",{class:"mode-icon"},"üìä"),e("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")]),e("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ")])],-1)),e("div",nt,[e("label",it,[Ye(e("input",{type:"checkbox","onUpdate:modelValue":h[0]||(h[0]=y=>i.value=y),class:"checkbox-input"},null,512),[[xe,i.value]]),h[2]||(h[2]=e("span",{class:"checkbox-text"},"–ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–Ω–æ–≤–∞",-1))])])]),e("div",dt,[e("button",{ref_key:"closeButtonRef",ref:d,class:"btn btn-primary",onClick:_,type:"button"}," –ü–æ–Ω—è—Ç–Ω–æ ",512)])])])):G("",!0)]),_:1})]))}},kt=te(ut,[["__scopeId","data-v-1012d11f"]]),vt={class:"ac-chart"},ht={class:"ac-chart__header"},yt={class:"ac-chart__subtitle"},mt={class:"ac-chart__controls"},_t={class:"chart-type-selector"},pt=["onClick"],gt={class:"chart-type-icon"},bt={class:"chart-type-label"},ft={class:"ac-chart__summary"},wt={class:"summary-card__value"},Tt={class:"summary-card__value-main"},Ct={class:"summary-card__breakdown"},$t={class:"breakdown-item breakdown-item--this-week"},Wt={class:"breakdown-item__value"},Dt={class:"breakdown-item breakdown-item--other-week"},Et={class:"breakdown-item__value"},St={class:"summary-card__value-main"},It={class:"summary-card__breakdown"},At={class:"breakdown-item breakdown-item--this-week"},Ut={class:"breakdown-item__value"},Ot={class:"breakdown-item breakdown-item--other-week"},Mt={class:"breakdown-item__value"},Bt={class:"summary-card summary-card--stages"},Rt={class:"summary-card__tags"},Nt={key:0,class:"stage-tag stage-tag--empty"},Pt={class:"ac-chart__body"},Lt={key:0,class:"split-charts-container"},Vt={class:"chart-wrapper chart-wrapper--left"},Ft={class:"chart-canvas-wrapper"},Gt={class:"chart-wrapper chart-wrapper--right"},Yt={class:"chart-canvas-wrapper"},xt={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(g,{emit:s}){const t=g,l=s,i=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],d=A("line");L(()=>{var m;return((m=t.meta)==null?void 0:m.weekNumber)??"‚Äî"});const _=()=>{var a,O;const m=((a=t.meta)==null?void 0:a.weeks)||[];return m.length>0?m.map(w=>`–ù–µ–¥–µ–ª—è ${w.weekNumber}`):[(O=t.meta)!=null&&O.weekNumber?`–ù–µ–¥–µ–ª—è ${t.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]},v=L(()=>{var p,D,U,V;const m=_(),a=Array.isArray((p=t.data.series)==null?void 0:p.new)&&t.data.series.new.length>0?t.data.series.new:[t.data.newTickets??0],O=Array.isArray((D=t.data.series)==null?void 0:D.closed)&&t.data.series.closed.length>0?t.data.series.closed:[t.data.closedTickets??0],w=Array.isArray((U=t.data.series)==null?void 0:U.closedCreatedThisWeek)&&t.data.series.closedCreatedThisWeek.length>0?t.data.series.closedCreatedThisWeek:[t.data.closedTicketsCreatedThisWeek??0],u=Array.isArray((V=t.data.series)==null?void 0:V.closedCreatedOtherWeek)&&t.data.series.closedCreatedOtherWeek.length>0?t.data.series.closedCreatedOtherWeek:[t.data.closedTicketsCreatedOtherWeek??0];return{labels:m,datasets:[{label:"–ù–æ–≤—ã–µ",data:a,backgroundColor:P.primary,borderColor:P.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:O,backgroundColor:P.success,borderColor:P.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:w,backgroundColor:P.successLight,borderColor:P.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:u,backgroundColor:P.warning,borderColor:P.warning,tension:.3,fill:!1,borderDash:[5,5]}]}}),c=L(()=>{var u,p,D;const m=_(),a=Array.isArray((u=t.data.series)==null?void 0:u.carryover)&&t.data.series.carryover.length>0?t.data.series.carryover:[t.data.carryoverTickets??0],O=Array.isArray((p=t.data.series)==null?void 0:p.carryoverCreatedThisWeek)&&t.data.series.carryoverCreatedThisWeek.length>0?t.data.series.carryoverCreatedThisWeek:[t.data.carryoverTicketsCreatedThisWeek??0],w=Array.isArray((D=t.data.series)==null?void 0:D.carryoverCreatedOtherWeek)&&t.data.series.carryoverCreatedOtherWeek.length>0?t.data.series.carryoverCreatedOtherWeek:[t.data.carryoverTicketsCreatedOtherWeek??0];return{labels:m,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:a,backgroundColor:P.carryover,borderColor:P.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:O,backgroundColor:P.carryoverLight,borderColor:P.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:w,backgroundColor:P.carryoverDark,borderColor:P.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),h=L(()=>{var q,S,b,F,k,r,C,I,B;const m=((q=t.meta)==null?void 0:q.weeks)||[],a=m.length>0?m.map(R=>`–ù–µ–¥–µ–ª—è ${R.weekNumber}`):[(S=t.meta)!=null&&S.weekNumber?`–ù–µ–¥–µ–ª—è ${t.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],O=Array.isArray((b=t.data.series)==null?void 0:b.new)&&t.data.series.new.length>0?t.data.series.new:[t.data.newTickets??0],w=Array.isArray((F=t.data.series)==null?void 0:F.closed)&&t.data.series.closed.length>0?t.data.series.closed:[t.data.closedTickets??0],u=Array.isArray((k=t.data.series)==null?void 0:k.closedCreatedThisWeek)&&t.data.series.closedCreatedThisWeek.length>0?t.data.series.closedCreatedThisWeek:[t.data.closedTicketsCreatedThisWeek??0],p=Array.isArray((r=t.data.series)==null?void 0:r.closedCreatedOtherWeek)&&t.data.series.closedCreatedOtherWeek.length>0?t.data.series.closedCreatedOtherWeek:[t.data.closedTicketsCreatedOtherWeek??0],D=Array.isArray((C=t.data.series)==null?void 0:C.carryover)&&t.data.series.carryover.length>0?t.data.series.carryover:[t.data.carryoverTickets??0],U=Array.isArray((I=t.data.series)==null?void 0:I.carryoverCreatedThisWeek)&&t.data.series.carryoverCreatedThisWeek.length>0?t.data.series.carryoverCreatedThisWeek:[t.data.carryoverTicketsCreatedThisWeek??0],V=Array.isArray((B=t.data.series)==null?void 0:B.carryoverCreatedOtherWeek)&&t.data.series.carryoverCreatedOtherWeek.length>0?t.data.series.carryoverCreatedOtherWeek:[t.data.carryoverTicketsCreatedOtherWeek??0];return{labels:a,datasets:[{label:"–ù–æ–≤—ã–µ",data:O,backgroundColor:P.primary,borderColor:P.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:w,backgroundColor:P.success,borderColor:P.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:u,backgroundColor:P.successLight,borderColor:P.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:p,backgroundColor:P.warning,borderColor:P.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:D,backgroundColor:P.carryover,borderColor:P.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:U,backgroundColor:P.carryoverLight,borderColor:P.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:V,backgroundColor:P.carryoverDark,borderColor:P.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),y=L(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[t.data.newTickets??0,t.data.closedTickets??0,t.data.carryoverTickets??0],backgroundColor:[P.primary,P.success,P.carryover],borderWidth:1}]})),$=L(()=>{switch(d.value){case"line":return ne;case"bar":return Ke;case"doughnut":return Ze;default:return ne}}),f=L(()=>d.value==="doughnut"?y.value:h.value),E=m=>{if(!m)return"‚Äî";try{return new Date(m).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return m}},Y=L(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,plugins:{tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12,callbacks:{title:m=>{var D,U,V,q,S,b;const a=(D=m[0])==null?void 0:D.dataIndex,O=((U=t.meta)==null?void 0:U.weeks)||[];if(O.length>0&&a!==void 0&&O[a]){const F=O[a];return`–ù–µ–¥–µ–ª—è ${F.weekNumber} (${E(F.weekStartUtc)} ‚Äî ${E(F.weekEndUtc)})`}const w=(V=t.meta)==null?void 0:V.weekNumber,u=(q=t.meta)==null?void 0:q.weekStartUtc,p=(S=t.meta)==null?void 0:S.weekEndUtc;return w&&u&&p?`–ù–µ–¥–µ–ª—è ${w} (${E(u)} ‚Äî ${E(p)})`:((b=m[0])==null?void 0:b.label)||""}}},legend:{position:"top",labels:{font:{size:15,weight:"500"},padding:16,boxWidth:20,boxHeight:12}}},scales:d.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},title:{display:!1},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10},title:{display:!1},grid:{lineWidth:1.5}}}})),M=L(()=>{var m,a,O,w;if((m=t.data)!=null&&m.series){const u=t.data.series,p=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,-1);if(p>=0){const D={newTickets:Array.isArray(u.new)&&u.new[p]!==void 0?u.new[p]:0,closedTickets:Array.isArray(u.closed)&&u.closed[p]!==void 0?u.closed[p]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[p]!==void 0?u.closedCreatedThisWeek[p]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[p]!==void 0?u.closedCreatedOtherWeek[p]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[p]!==void 0?u.carryover[p]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[p]!==void 0?u.carryoverCreatedThisWeek[p]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[p]!==void 0?u.carryoverCreatedOtherWeek[p]:0};if(D.newTickets>0||D.closedTickets>0||D.carryoverTickets>0)return D}}if((a=t.data)!=null&&a.currentWeek&&typeof t.data.currentWeek=="object"){const u=t.data.currentWeek;if((u.newTickets??0)>0||(u.closedTickets??0)>0||(u.carryoverTickets??0)>0)return u}if((O=t.data)!=null&&O.weeksData&&Array.isArray(t.data.weeksData)&&t.data.weeksData.length>0){const u=t.data.weeksData[t.data.weeksData.length-1];if((u.newTickets??0)>0||(u.closedTickets??0)>0||(u.carryoverTickets??0)>0)return u}if((w=t.data)!=null&&w.series){const u=t.data.series,p=Math.max((Array.isArray(u.new)?u.new.length:0)-1,(Array.isArray(u.closed)?u.closed.length:0)-1,(Array.isArray(u.carryover)?u.carryover.length:0)-1,-1);if(p>=0)return{newTickets:Array.isArray(u.new)&&u.new[p]!==void 0?u.new[p]:0,closedTickets:Array.isArray(u.closed)&&u.closed[p]!==void 0?u.closed[p]:0,closedTicketsCreatedThisWeek:Array.isArray(u.closedCreatedThisWeek)&&u.closedCreatedThisWeek[p]!==void 0?u.closedCreatedThisWeek[p]:0,closedTicketsCreatedOtherWeek:Array.isArray(u.closedCreatedOtherWeek)&&u.closedCreatedOtherWeek[p]!==void 0?u.closedCreatedOtherWeek[p]:0,carryoverTickets:Array.isArray(u.carryover)&&u.carryover[p]!==void 0?u.carryover[p]:0,carryoverTicketsCreatedThisWeek:Array.isArray(u.carryoverCreatedThisWeek)&&u.carryoverCreatedThisWeek[p]!==void 0?u.carryoverCreatedThisWeek[p]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(u.carryoverCreatedOtherWeek)&&u.carryoverCreatedOtherWeek[p]!==void 0?u.carryoverCreatedOtherWeek[p]:0}}return t.data||{}}),x=m=>{var p;const a=M.value,O=(a==null?void 0:a.newTickets)??0,w=(a==null?void 0:a.closedTickets)??0,u=(a==null?void 0:a.carryoverTickets)??0;m==="new"&&O>0?l("open-stages"):m==="closed"&&w>0?(((p=t.data)==null?void 0:p.responsible)||[]).length>0&&l("open-responsible"):m==="carryover"&&u>0&&l("open-carryover")};return(m,a)=>{var O,w,u,p,D,U,V,q,S,b,F,k,r,C,I,B;return o(),n("div",vt,[e("header",ht,[e("div",null,[a[3]||(a[3]=e("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),e("p",yt," –ù–µ–¥–µ–ª—è "+T(((w=(O=g.meta)==null?void 0:O.currentWeek)==null?void 0:w.weekNumber)??((u=g.meta)==null?void 0:u.weekNumber)??"‚Äî")+" ¬∑ "+T((((D=(p=g.meta)==null?void 0:p.currentWeek)==null?void 0:D.weekStartUtc)??((U=g.meta)==null?void 0:U.weekStartUtc))||"‚Äî")+" ‚Äî "+T((((q=(V=g.meta)==null?void 0:V.currentWeek)==null?void 0:q.weekEndUtc)??((S=g.meta)==null?void 0:S.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),e("div",mt,[e("div",_t,[(o(),n(j,null,H(i,R=>e("button",{key:R.value,class:J(["chart-type-btn",{active:d.value===R.value}]),onClick:W=>d.value=R.value},[e("span",gt,T(R.icon),1),e("span",bt,T(R.label),1)],10,pt)),64))])])]),e("section",ft,[e("div",{class:"summary-card summary-card--new",onClick:a[0]||(a[0]=R=>x("new"))},[a[4]||(a[4]=e("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",wt,T(((b=M.value)==null?void 0:b.newTickets)??0),1)]),e("div",{class:"summary-card summary-card--closed-breakdown",onClick:a[1]||(a[1]=R=>x("closed"))},[a[9]||(a[9]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("div",Tt,T(((F=M.value)==null?void 0:F.closedTickets)??0),1),e("div",Ct,[e("div",$t,[a[5]||(a[5]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",Wt,T(((k=M.value)==null?void 0:k.closedTicketsCreatedThisWeek)??0),1),a[6]||(a[6]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),e("div",Dt,[a[7]||(a[7]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",Et,T(((r=M.value)==null?void 0:r.closedTicketsCreatedOtherWeek)??0),1),a[8]||(a[8]=e("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),e("div",{class:"summary-card summary-card--carryover-breakdown",onClick:a[2]||(a[2]=R=>x("carryover"))},[a[14]||(a[14]=e("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),e("div",St,T(((C=M.value)==null?void 0:C.carryoverTickets)??0),1),e("div",It,[e("div",At,[a[10]||(a[10]=e("span",{class:"breakdown-item__icon"},"‚úì",-1)),e("span",Ut,T(((I=M.value)==null?void 0:I.carryoverTicketsCreatedThisWeek)??0),1),a[11]||(a[11]=e("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),e("div",Ot,[a[12]||(a[12]=e("span",{class:"breakdown-item__icon"},"‚Üª",-1)),e("span",Mt,T(((B=M.value)==null?void 0:B.carryoverTicketsCreatedOtherWeek)??0),1),a[13]||(a[13]=e("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö",-1))])])]),e("div",Bt,[a[15]||(a[15]=e("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("div",Rt,[(o(!0),n(j,null,H(g.data.stages||[],R=>(o(),n("span",{key:R.stageId,class:"stage-tag"},T(R.stageName||R.stageId)+" ‚Äî "+T(R.count),1))),128)),!g.data.stages||g.data.stages.length===0?(o(),n("span",Nt," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):G("",!0)])])]),e("div",Pt,[d.value==="line"?(o(),n("div",Lt,[e("div",Vt,[a[16]||(a[16]=e("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",Ft,[N(de(ne),{data:v.value,options:Y.value},null,8,["data","options"])])]),e("div",Gt,[a[17]||(a[17]=e("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",Yt,[N(de(ne),{data:c.value,options:Y.value},null,8,["data","options"])])])])):(o(),ee(qe($.value),{key:1,data:f.value,options:Y.value},null,8,["data","options"]))])])}}},zt=te(xt,[["__scopeId","data-v-73ab5a50"]]),jt={class:"summary-cards-months"},qt={class:"summary-card summary-card--new"},Ht={class:"card-content"},Zt={class:"card-main-value"},Kt={class:"card-month-breakdown"},Jt={class:"month-name"},Xt={class:"month-value"},Qt={key:0,class:"month-item month-item--empty"},es={class:"summary-card summary-card--closed"},ts={class:"card-content"},ss={class:"card-main-value"},as={class:"card-month-breakdown-hierarchical"},rs={class:"month-header"},os={class:"month-name"},ls={class:"month-value"},ns={class:"month-breakdown"},is={class:"breakdown-item breakdown-this-week"},ds={class:"breakdown-value"},cs={class:"breakdown-item breakdown-other-week"},us={class:"breakdown-value"},ks={key:0,class:"month-item-hierarchical month-item--empty"},vs={class:"summary-card summary-card--carryover"},hs={class:"card-content"},ys={class:"card-main-value"},ms={class:"card-month-breakdown"},_s={class:"month-name"},ps={class:"month-value"},gs={key:0,class:"month-item month-item--empty"},bs={class:"summary-card summary-card--stages"},fs={class:"card-content"},ws={class:"stages-list"},Ts={class:"stage-icon"},Cs={class:"stage-name"},$s={class:"stage-value"},Ws={key:0,class:"stage-item stage-item--empty"},Ds={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(g){const s=g;function t(y){return y==null||isNaN(y)?"0":y>=1e6?(y/1e6).toFixed(1)+"M":y>=1e3?y.toLocaleString("ru-RU"):y.toString()}const l=L(()=>{var y;return((y=s.data)==null?void 0:y.newTickets)||0}),i=L(()=>t(l.value)),d=L(()=>{var y;return((y=s.data)==null?void 0:y.newTicketsByMonth)||[]}),_=L(()=>{var y;return((y=s.data)==null?void 0:y.closedTicketsByMonth)||[]}),v=L(()=>{var y;return((y=s.data)==null?void 0:y.carryoverTicketsByMonth)||[]});function c(y){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[y]||""}function h(y){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[y]||"‚Ä¢"}return(y,$)=>(o(),n("div",jt,[e("div",qt,[$[0]||($[0]=e("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),e("div",Ht,[e("div",Zt,T(i.value),1),e("div",Kt,[(o(!0),n(j,null,H(d.value,f=>(o(),n("div",{key:`new-${f.month}`,class:"month-item"},[e("span",Jt,T(f.monthName)+":",1),e("span",Xt,T(t(f.count)),1)]))),128)),d.value.length===0?(o(),n("div",Qt," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):G("",!0)])])]),e("div",es,[$[5]||($[5]=e("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),e("div",ts,[e("div",ss,T(t(g.data.closedTickets||0)),1),e("div",as,[(o(!0),n(j,null,H(_.value,f=>(o(),n("div",{key:`closed-${f.month}`,class:"month-item-hierarchical"},[e("div",rs,[e("span",os,T(f.monthName)+":",1),e("span",ls,T(t(f.count||0)),1)]),e("div",ns,[e("div",is,[$[1]||($[1]=e("span",{class:"breakdown-icon"},"‚úì",-1)),$[2]||($[2]=e("span",{class:"breakdown-label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π:",-1)),e("span",ds,T(t(f.closedCreatedThisWeek||0)),1)]),e("div",cs,[$[3]||($[3]=e("span",{class:"breakdown-icon"},"‚Üª",-1)),$[4]||($[4]=e("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π:",-1)),e("span",us,T(t(f.closedCreatedOtherWeek||0)),1)])])]))),128)),_.value.length===0?(o(),n("div",ks," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):G("",!0)])])]),e("div",vs,[$[6]||($[6]=e("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),e("div",hs,[e("div",ys,T(t(g.data.carryoverTickets||0)),1),e("div",ms,[(o(!0),n(j,null,H(v.value,f=>(o(),n("div",{key:`carryover-${f.month}`,class:"month-item"},[e("span",_s,T(f.monthName)+":",1),e("span",ps,T(t(f.count||0)),1)]))),128)),v.value.length===0?(o(),n("div",gs," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):G("",!0)])])]),e("div",bs,[$[8]||($[8]=e("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),e("div",fs,[e("div",ws,[(o(!0),n(j,null,H(g.data.stages||[],f=>(o(),n("div",{key:f.stageId,class:J(["stage-item",c(f.stageId)])},[e("span",Ts,T(h(f.stageId)),1),e("span",Cs,T(f.stageName||f.stageId)+":",1),e("span",$s,T(t(f.count||0)),1)],2))),128)),!g.data.stages||g.data.stages.length===0?(o(),n("div",Ws,[...$[7]||($[7]=[e("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):G("",!0)])])])]))}},Es=te(Ds,[["__scopeId","data-v-7325e15b"]]),Ss={class:"line-chart-months"},Is={class:"chart-section"},As={class:"chart-container"},Us={class:"chart-section"},Os={class:"chart-container"},Ms={class:"chart-table-section"},Bs={class:"chart-table-wrapper"},Rs={class:"data-table"},Ns={class:"data-row data-row--new"},Ps={class:"data-row data-row--closed"},Ls={class:"data-row data-row--carryover"},Vs={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(g){const s=g;function t(c){return c==null||isNaN(c)?"0":c>=1e3?c.toLocaleString("ru-RU"):c.toString()}const l=L(()=>{var h,y,$;const c=new Set;return(h=s.data.newTicketsByMonth)==null||h.forEach(f=>{f.weeks&&Array.isArray(f.weeks)&&f.weeks.forEach(E=>{E&&E.weekNumber&&c.add(E.weekNumber)})}),(y=s.data.closedTicketsByMonth)==null||y.forEach(f=>{f.weeks&&Array.isArray(f.weeks)&&f.weeks.forEach(E=>{E&&E.weekNumber&&c.add(E.weekNumber)})}),($=s.data.carryoverTicketsByMonth)==null||$.forEach(f=>{f.weeks&&Array.isArray(f.weeks)&&f.weeks.forEach(E=>{E&&E.weekNumber&&c.add(E.weekNumber)})}),Array.from(c).sort((f,E)=>f-E)}),i=L(()=>{const c=s.data.newTicketsByMonth||[],h=c.map(f=>f.monthName||`–ú–µ—Å—è—Ü ${f.month}`),y=c.map(f=>f.count||0),$=(s.data.closedTicketsByMonth||[]).map(f=>f.count||0);return{labels:h,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:y,borderColor:P.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:$,borderColor:P.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1}]}}),d=L(()=>{const c=s.data.carryoverTicketsByMonth||[],h=c.map($=>$.monthName||`–ú–µ—Å—è—Ü ${$.month}`),y=c.map($=>$.count||0);return{labels:h,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:y,borderColor:P.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1}]}}),_={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function v(c,h){let y=[];switch(c){case"new":y=s.data.newTicketsByMonth||[];break;case"closed":y=s.data.closedTicketsByMonth||[];break;case"carryover":y=s.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const $ of y){if(!$.weeks||!Array.isArray($.weeks))continue;const f=$.weeks.find(E=>E&&E.weekNumber===h);if(f){const E=f.count||0;return E>0?t(E):"-"}}return"-"}return(c,h)=>(o(),n("div",Ss,[e("div",Is,[h[0]||(h[0]=e("h3",{class:"chart-title"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",As,[N(de(ne),{data:i.value,options:_},null,8,["data"])])]),e("div",Us,[h[1]||(h[1]=e("h3",{class:"chart-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),e("div",Os,[N(de(ne),{data:d.value,options:_},null,8,["data"])])]),e("div",Ms,[h[6]||(h[6]=e("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),e("div",Bs,[e("table",Rs,[e("thead",null,[e("tr",null,[h[2]||(h[2]=e("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(o(!0),n(j,null,H(l.value,y=>(o(),n("th",{key:`week-${y}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+T(y),1))),128))])]),e("tbody",null,[e("tr",Ns,[h[3]||(h[3]=e("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(o(!0),n(j,null,H(l.value,y=>(o(),n("td",{key:`new-${y}`,class:"week-data-cell"},T(v("new",y)),1))),128))]),e("tr",Ps,[h[4]||(h[4]=e("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(o(!0),n(j,null,H(l.value,y=>(o(),n("td",{key:`closed-${y}`,class:"week-data-cell"},T(v("closed",y)),1))),128))]),e("tr",Ls,[h[5]||(h[5]=e("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(o(!0),n(j,null,H(l.value,y=>(o(),n("td",{key:`carryover-${y}`,class:"week-data-cell"},T(v("carryover",y)),1))),128))])])])])])]))}},Fs=te(Vs,[["__scopeId","data-v-f048a2de"]]),Gs={class:"months-preloader"},Ys={class:"preloader-content"},xs={class:"progress-container"},zs={class:"progress-bar"},js={class:"progress-text"},qs={class:"preloader-message"},Hs={class:"stages-list"},Zs={class:"stage-icon"},Ks={class:"stage-text"},Js={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:g=>g>=0&&g<=100},currentStage:{type:String,default:""}},setup(g){const s=g,t=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:10},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–∫—Ç—è–±—Ä—å...",threshold:40},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–æ—è–±—Ä—å...",threshold:70},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–∫–∞–±—Ä—å...",threshold:90},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:95},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function l(d){return s.progress>=t[d].threshold}function i(d){const _=t[d].threshold,v=d>0?t[d-1].threshold:0;return s.progress>=v&&s.progress<_}return(d,_)=>(o(),n("div",Gs,[e("div",Ys,[_[0]||(_[0]=He('<div class="preloader-spinner" data-v-23ab71eb><div class="spinner-ring" data-v-23ab71eb></div><div class="spinner-ring" data-v-23ab71eb></div><div class="spinner-ring" data-v-23ab71eb></div></div><h3 class="preloader-title" data-v-23ab71eb>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),e("div",xs,[e("div",zs,[e("div",{class:"progress-fill",style:se({width:`${g.progress}%`})},null,4)]),e("div",js,T(Math.round(g.progress))+"%",1)]),e("p",qs,T(g.currentStage),1),e("div",Hs,[(o(),n(j,null,H(t,(v,c)=>e("div",{key:c,class:J(["stage-item",{"stage-completed":l(c),"stage-current":i(c)}])},[e("span",Zs,T(l(c)?"‚úì":i(c)?"‚Üí":"‚óã"),1),e("span",Ks,T(v.label),1)],2)),64))])])]))}},Xs=te(Js,[["__scopeId","data-v-23ab71eb"]]),Qs="/api/graph-1c-admission-closure.php";function ea(g){var l,i,d,_,v,c,h,y,$,f,E,Y,M,x,m,a,O,w,u,p,D,U,V,q,S,b,F,k,r,C,I,B,R,W,Z,oe,Q,_e,pe,ge,be,fe,we,Te,Ce,$e,We,De,Ee,Se,Ie,Ae,Ue;if(!g)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},weeksData:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const s=g.data||g.result||g,t=s.meta||g.meta||null;return{meta:{...t,currentWeek:(t==null?void 0:t.currentWeek)||(t?{weekNumber:t.weekNumber,weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc}:null),weeks:(t==null?void 0:t.weeks)||[]},data:{currentWeek:((l=s.data)==null?void 0:l.currentWeek)||(s.data?{newTickets:s.data.newTickets??0,closedTickets:s.data.closedTickets??0,closedTicketsCreatedThisWeek:s.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:s.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:s.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:s.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:s.data.carryoverTicketsCreatedOtherWeek??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0}),newTickets:((d=(i=s.data)==null?void 0:i.currentWeek)==null?void 0:d.newTickets)??((_=s.data)==null?void 0:_.newTickets)??s.newTickets??0,closedTickets:((c=(v=s.data)==null?void 0:v.currentWeek)==null?void 0:c.closedTickets)??((h=s.data)==null?void 0:h.closedTickets)??s.closedTickets??0,closedTicketsCreatedThisWeek:(($=(y=s.data)==null?void 0:y.currentWeek)==null?void 0:$.closedTicketsCreatedThisWeek)??((f=s.data)==null?void 0:f.closedTicketsCreatedThisWeek)??s.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:((Y=(E=s.data)==null?void 0:E.currentWeek)==null?void 0:Y.closedTicketsCreatedOtherWeek)??((M=s.data)==null?void 0:M.closedTicketsCreatedOtherWeek)??s.closedTicketsCreatedOtherWeek??0,carryoverTickets:((m=(x=s.data)==null?void 0:x.currentWeek)==null?void 0:m.carryoverTickets)??((a=s.data)==null?void 0:a.carryoverTickets)??s.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((w=(O=s.data)==null?void 0:O.currentWeek)==null?void 0:w.carryoverTicketsCreatedThisWeek)??((u=s.data)==null?void 0:u.carryoverTicketsCreatedThisWeek)??s.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((D=(p=s.data)==null?void 0:p.currentWeek)==null?void 0:D.carryoverTicketsCreatedOtherWeek)??((U=s.data)==null?void 0:U.carryoverTicketsCreatedOtherWeek)??s.carryoverTicketsCreatedOtherWeek??0,series:{new:((q=(V=s.data)==null?void 0:V.series)==null?void 0:q.new)??((S=s.series)==null?void 0:S.new)??[0],closed:((F=(b=s.data)==null?void 0:b.series)==null?void 0:F.closed)??((k=s.series)==null?void 0:k.closed)??[0],closedCreatedThisWeek:((C=(r=s.data)==null?void 0:r.series)==null?void 0:C.closedCreatedThisWeek)??((I=s.series)==null?void 0:I.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((R=(B=s.data)==null?void 0:B.series)==null?void 0:R.closedCreatedOtherWeek)??((W=s.series)==null?void 0:W.closedCreatedOtherWeek)??[0],carryover:((oe=(Z=s.data)==null?void 0:Z.series)==null?void 0:oe.carryover)??((Q=s.series)==null?void 0:Q.carryover)??[0],carryoverCreatedThisWeek:((pe=(_e=s.data)==null?void 0:_e.series)==null?void 0:pe.carryoverCreatedThisWeek)??((ge=s.series)==null?void 0:ge.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((fe=(be=s.data)==null?void 0:be.series)==null?void 0:fe.carryoverCreatedOtherWeek)??((we=s.series)==null?void 0:we.carryoverCreatedOtherWeek)??[0]},weeksData:((Te=s.data)==null?void 0:Te.weeksData)??s.weeksData??[],stages:((Ce=s.data)==null?void 0:Ce.stages)??s.stages??[],responsible:(($e=s.data)==null?void 0:$e.responsible)??s.responsible??[],responsibleCreatedThisWeek:((We=s.data)==null?void 0:We.responsibleCreatedThisWeek)??s.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((De=s.data)==null?void 0:De.responsibleCreatedOtherWeek)??s.responsibleCreatedOtherWeek??[],newTicketsByStages:((Ee=s.data)==null?void 0:Ee.newTicketsByStages)??s.newTicketsByStages??null,carryoverTicketsByDuration:((Se=s.data)==null?void 0:Se.carryoverTicketsByDuration)??s.carryoverTicketsByDuration??null,newTicketsByMonth:((Ie=s.data)==null?void 0:Ie.newTicketsByMonth)??s.newTicketsByMonth??[],closedTicketsByMonth:((Ae=s.data)==null?void 0:Ae.closedTicketsByMonth)??s.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ue=s.data)==null?void 0:Ue.carryoverTicketsByMonth)??s.carryoverTicketsByMonth??[]}}}async function re(g={}){const{endpoint:s=Qs,product:t="1C",weekStartUtc:l=null,weekEndUtc:i=null,periodMode:d="weeks",useCache:_=!0,forceRefresh:v=!1,includeTickets:c=!1,includeNewTicketsByStages:h=!1,includeCarryoverTickets:y=!0,includeCarryoverTicketsByDuration:$=!1}=g,E=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product:t,weekStartUtc:l,weekEndUtc:i,periodMode:d,useCache:_,forceRefresh:v,includeTickets:c,includeNewTicketsByStages:h,includeCarryoverTickets:y,includeCarryoverTicketsByDuration:$})});if(!E.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${E.status})`);const Y=await E.json();if((Y==null?void 0:Y.success)===!1)throw new Error(Y.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return ea(Y)}const ta={class:"ac-dashboard-months"},sa={key:"content"},aa={class:"dashboard-header"},ra={class:"header-content"},oa={class:"breadcrumbs-row"},la=["aria-label","aria-disabled","data-fallback","disabled"],na={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},ia={class:"dashboard-layout"},da={class:"filters-container"},ca={class:"chart-container"},ua={__name:"GraphAdmissionClosureMonthsDashboard",setup(g){const s=Ne(),t=A(!0),l=A(0),i=A("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),d=A(null),_=A(null),v=A({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]}),c=A(!1),h=L(()=>typeof window>"u"?!1:window.history.length>1),y=L(()=>h.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),$={name:"dashboard-sector-1c"};function f(D){var U;if((U=D==null?void 0:D.preventDefault)==null||U.call(D),!c.value){c.value=!0;try{if(h.value){s.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),s.push($)}finally{c.value=!1}}}const E=A({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),Y=L(()=>{const D=E.value.customDateRange.startDate||E.value.customDateRange.endDate,U=E.value.employees.length===1&&E.value.employees.includes("all");return D||!U});async function M(D,U,V=500){const q=l.value,S=10,b=(D-q)/S,F=V/S;for(let k=0;k<S;k++)await new Promise(r=>setTimeout(r,F)),l.value=Math.min(q+b*(k+1),D);l.value=D,i.value=U}async function x(){t.value=!0,d.value=null,l.value=0,i.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...";try{await M(10,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",300),await M(40,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –æ–∫—Ç—è–±—Ä—å...",800),await M(70,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –Ω–æ—è–±—Ä—å...",800),await M(90,"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –¥–µ–∫–∞–±—Ä—å...",800),await M(95,"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",400);const D=await re({product:"1C",periodMode:"months",includeTickets:!0});await M(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300);const{meta:U,data:V}=D;_.value=U,v.value=V,await new Promise(q=>setTimeout(q,200))}catch(D){d.value=D instanceof Error?D:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",D),l.value=100}finally{t.value=!1}}function m(D){E.value.stages=D}function a(D){E.value.employees=D}function O(D){E.value.dateRange=D}function w(D){E.value.customDateRange=D}function u(){E.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},p()}function p(){x()}return ke(()=>{x()}),(D,U)=>{const V=Pe("router-link");return o(),n("div",ta,[N(K,{name:"fade",mode:"out-in"},{default:z(()=>[t.value?(o(),ee(Xs,{key:"preloader",progress:l.value,"current-stage":i.value},null,8,["progress","current-stage"])):(o(),n("div",sa,[e("div",aa,[e("div",ra,[e("div",oa,[e("button",{class:"btn-back-link",type:"button",onClick:f,"aria-label":y.value,"aria-disabled":!h.value,"data-fallback":!h.value,disabled:c.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,la),e("nav",na,[N(V,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:z(()=>[...U[0]||(U[0]=[X(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),U[2]||(U[2]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),N(V,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:z(()=>[...U[1]||(U[1]=[X(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),U[3]||(U[3]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),U[4]||(U[4]=e("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),U[5]||(U[5]=e("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),U[6]||(U[6]=e("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),e("div",ia,[e("div",da,[N(Ve,{stages:E.value.stages,employees:E.value.employees,dateRange:E.value.dateRange,customDateRange:E.value.customDateRange,hasActiveFilters:Y.value,hideStages:!0,weekPickerMode:!1,"onUpdate:stages":m,"onUpdate:employees":a,"onUpdate:dateRange":O,"onUpdate:customDateRange":w,onReset:u,onApply:p},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),e("div",ca,[d.value?(o(),ee(Le,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:d.value.message},null,8,["message"])):(o(),n(j,{key:1},[N(Es,{data:v.value},null,8,["data"]),N(Fs,{data:v.value,meta:_.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},ka=te(ua,[["__scopeId","data-v-117104d3"]]);class ye{static async getSectorData(){try{const s=await this.getAllTickets();console.log("Total tickets loaded:",s.length);const t=this.extractUniqueEmployeeIds(s);console.log("Unique employee IDs:",t);const l=await this.getEmployeesByIds(t);return console.log("Loaded employees:",l.length),{stages:this.groupTicketsByStages(s,l),employees:l,zeroPointTickets:this.getZeroPointTickets(s)}}catch(s){throw console.error("Error getting sector data:",s),s}}static async getAllTickets(){const s=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],t=[];for(const l of s){console.log(`Loading tickets for stage: ${l}`);const i=await this.getTicketsByStage(l);t.push(...i),console.log(`Loaded ${i.length} tickets for stage ${l}`)}return t}static async getTicketsByStage(s){const t=[];let l=0;const i=50;let d=!0;for(;d;)try{const v=await le.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:s},select:["*"],order:{id:"DESC"},start:l,useOriginalUfNames:"Y"});let c=[];v&&v.result&&(Array.isArray(v.result)?c=v.result:v.result.items&&Array.isArray(v.result.items)?c=v.result.items:v.result.data&&Array.isArray(v.result.data)&&(c=v.result.data)),c.length>0?(t.push(...c),l+=c.length,d=c.length===i):d=!1}catch(v){console.error(`Error loading tickets batch for stage ${s} (start: ${l}):`,v),d=!1}t.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(t[0],null,2)),console.log("Sample ticket keys:",Object.keys(t[0])),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}));const _=t.filter(v=>{const c=v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product||v.ufCrm7TypeProduct||v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product;return Array.isArray(c)?c.includes(this.SECTOR_TAG):typeof c=="object"&&c!==null?c.value===this.SECTOR_TAG||c===this.SECTOR_TAG:c===this.SECTOR_TAG});return console.log(`Filtered ${_.length} tickets from ${t.length} for stage ${s} (sector tag: ${this.SECTOR_TAG})`),_}static extractUniqueEmployeeIds(s){if(!Array.isArray(s))return[];const t=new Set;return s.forEach(l=>{const i=l.assignedById||l.assignedByIdId||l.ASSIGNED_BY_ID||l.assignedById||l.assignedById&&typeof l.assignedById=="object"&&(l.assignedById.id||l.assignedById.ID)||l.assignedById&&typeof l.assignedById=="object"&&l.assignedById.value;if(i){const d=parseInt(i);d&&!isNaN(d)&&d>0&&t.add(d)}}),s.length>0&&(console.log("Sample ticket for employee extraction:",s[0]),console.log("Sample ticket assignedById variants:",{assignedById:s[0].assignedById,assignedByIdId:s[0].assignedByIdId,ASSIGNED_BY_ID:s[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(t))),Array.from(t)}static async getEmployeesByIds(s){if(!Array.isArray(s)||s.length===0)return[];try{const t=await le.call("user.get",{filter:{ID:s}});let l=[];return t&&t.result&&(Array.isArray(t.result)?l=t.result:console.warn("Unexpected user.get result format:",t)),l.map(i=>({id:parseInt(i.ID||i.id||0),name:`${i.NAME||i.name||""} ${i.LAST_NAME||i.lastName||""}`.trim()||i.EMAIL||i.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:i.WORK_POSITION||i.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:i.EMAIL||i.email||"",tickets:[]}))}catch(t){return console.error("Error getting employees by IDs:",t),[]}}static groupTicketsByStages(s,t){Array.isArray(s)||(console.warn("Tickets is not an array:",s),s=[]),Array.isArray(t)||(console.warn("Employees is not an array:",t),t=[]);const l=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:t.map(i=>({...i,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:t.map(i=>({...i,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:t.map(i=>({...i,tickets:[]}))}];return s.forEach(i=>{const d=this.mapStageId(i.stageId||i.STAGE_ID||""),_=l.find(v=>v.id===d);if(_){const v=i.assignedById||i.ASSIGNED_BY_ID||null,c=v?parseInt(v):null;if(c){let h=_.employees.find(y=>y.id===c);h||(h={id:c,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${c}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},_.employees.push(h)),h.tickets.push(this.mapTicket(i))}}}),l}static mapStageId(s){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[s]||"formed"}static mapStageIdToBitrix(s){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[s]||"DT140_12:UC_0VHWE2"}static mapTicket(s){const t=parseInt(s.id||s.ID||0),l=s.title||s.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",i=s.stageId||s.STAGE_ID||"",d=s.assignedById||s.ASSIGNED_BY_ID||null,_=s.createdTime||s.CREATED_DATE||s.CREATED_TIME||"",v=s.updatedTime||s.MODIFY_DATE||s.UPDATED_TIME||"",c=s.UF_CRM_7_UF_PRIORITY||s.uf_crm_7_uf_priority||s.ufCrm7UfPriority||s.UF_CRM_7_UF_PRIORITY||s.uf_crm_7_uf_priority||s.priority||s.PRIORITY||null,h=Me(c),y=Je(h);return{id:t,title:l,priorityId:h.id,priorityLabel:h.label,priorityColors:y,priority:h.id,priorityBitrixValue:h.bitrixValue||null,status:this.mapStatus(i),assigneeId:d?parseInt(d):null,stageId:this.mapStageId(i),createdAt:_,modifiedAt:v,amount:s.opportunity||s.OPPORTUNITY||0,currency:s.currencyId||s.CURRENCY_ID||"RUB",description:s.comments||s.COMMENTS||""}}static mapPriority(s){return Me(s).id}static mapPriorityToBitrix(s){if(s&&typeof s=="object")return s.bitrixValue||null;const t=Be(s);if(t&&t.bitrixValue)return t.bitrixValue;const l={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return l[s]?l[s]:Be(Xe).bitrixValue}static mapStatus(s){return"in_progress"}static getZeroPointTickets(s){const t={formed:[],review:[],execution:[]};return Array.isArray(s)?(s.filter(l=>!(l.assignedById||l.ASSIGNED_BY_ID)).forEach(l=>{const i=this.mapStageId(l.stageId||l.STAGE_ID||"");t[i]&&t[i].push(this.mapTicket(l))}),t):(console.warn("Tickets is not an array in getZeroPointTickets:",s),t)}static async assignTicket(s,t,l){try{const i=this.mapStageIdToBitrix(l);return(await le.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:s,fields:{assignedById:t,stageId:i}})).result===!0}catch(i){throw console.error("Error assigning ticket:",i),i}}static async createTicket(s){try{const t=await le.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:s.title,assignedById:s.employeeId,stageId:this.mapStageIdToBitrix(s.stageId)}});return t.result?parseInt(t.result):0}catch(t){throw console.error("Error creating ticket:",t),t}}static async getTicket(s){try{const t=await le.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:s});return this.mapTicket(t.result)}catch(t){throw console.error("Error getting ticket:",t),t}}static async addComment(s,t){try{return(await le.call("crm.timeline.comment.add",{fields:{entityId:s,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:t}})).result!==void 0}catch(l){throw console.error("Error adding comment:",l),l}}}ve(ye,"ENTITY_TYPE_ID",140),ve(ye,"SECTOR_TAG","1C");const va={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},ha={class:"modal"},ya={key:0,class:"modal__tabs"},ma={key:"level-0-categories",class:"level-0"},_a={class:"modal__header"},pa={class:"modal__title"},ga={key:0},ba={class:"modal__body"},fa={class:"categories-list"},wa=["onClick"],Ta={class:"category-item"},Ca={class:"category-item__icon"},$a={key:0},Wa={key:1},Da={class:"category-item__content"},Ea={class:"category-item__label"},Sa={class:"category-item__count"},Ia={key:0,class:"category-item__arrow"},Aa={class:"modal__footer"},Ua={key:"level-1-categories",class:"level-1"},Oa={class:"modal__header"},Ma={class:"modal__body"},Ba={key:"loading",class:"loading-names"},Ra={key:"empty",class:"modal__empty"},Na={key:"list",class:"responsible-list"},Pa=["onClick"],La={class:"responsible-list__name"},Va={class:"responsible-list__count"},Fa={key:0,class:"responsible-list__arrow"},Ga={class:"modal__footer"},Ya={key:"level-2-categories",class:"level-2"},xa={class:"modal__header"},za={class:"modal__title"},ja={class:"modal__body"},qa={key:"loading",class:"loading-state"},Ha={key:"error",class:"error-state"},Za={class:"error-message"},Ka={key:"empty",class:"empty-state"},Ja={key:"tickets",class:"tickets-list-container"},Xa={key:"level-0-employees",class:"level-0"},Qa={class:"modal__header"},er={class:"modal__title"},tr={key:0},sr={class:"modal__body"},ar={key:"loading",class:"loading-names"},rr={key:"empty",class:"modal__empty"},or={key:"list",class:"responsible-list"},lr=["onClick"],nr={class:"responsible-list__name"},ir={class:"responsible-list__count"},dr={key:0,class:"responsible-list__arrow"},cr={class:"modal__footer"},ur={key:"level-1-employees",class:"level-1"},kr={class:"modal__header"},vr={class:"modal__title"},hr={class:"modal__body"},yr={class:"categories-list"},mr=["onClick"],_r={class:"category-item"},pr={class:"category-item__icon"},gr={key:0},br={key:1},fr={class:"category-item__content"},wr={class:"category-item__label"},Tr={class:"category-item__count"},Cr={key:0,class:"category-item__arrow"},$r={class:"modal__footer"},Wr={key:"level-2-employees",class:"level-2"},Dr={class:"modal__header"},Er={class:"modal__title"},Sr={class:"modal__body"},Ir={key:"loading",class:"loading-state"},Ar={key:"error",class:"error-state"},Ur={class:"error-message"},Or={key:"empty",class:"empty-state"},Mr={class:"empty-state-message"},Br={key:"tickets",class:"tickets-list-container"},Rr={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(g){const s=g,t=A(0),l=A("categories"),i=A(null),d=A(null),_=A(null),v=A([]),c=A(!1),h=A(null),y=A([]),$=A([]),f=A(!1),E=L(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:s.closedTicketsCreatedThisWeek??0,responsible:s.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:s.closedTicketsCreatedOtherWeek??0,responsible:s.responsibleCreatedOtherWeek??[]}]),Y=L(()=>{const k=new Map;return(s.responsibleCreatedThisWeek||[]).forEach(r=>{const C=r.id??"unassigned";k.has(C)||k.set(C,{id:r.id,name:r.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const I=k.get(C);I.thisWeekCount=r.count??0,I.thisWeekTickets=r.tickets||[],I.totalCount+=I.thisWeekCount}),(s.responsibleCreatedOtherWeek||[]).forEach(r=>{const C=r.id??"unassigned";k.has(C)||k.set(C,{id:r.id,name:r.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const I=k.get(C);I.otherWeekCount=r.count??0,I.otherWeekTickets=r.tickets||[],I.totalCount+=I.otherWeekCount}),Array.from(k.values())}),M=L(()=>{if(!d.value)return[];const k=d.value.thisWeekTickets||[],r=d.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:d.value.id,name:d.value.name,thisWeekCount:d.value.thisWeekCount,otherWeekCount:d.value.otherWeekCount,thisWeekTickets:k.length,otherWeekTickets:r.length,employee:d.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:d.value.thisWeekCount??0,tickets:k,employeeId:d.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:d.value.otherWeekCount??0,tickets:r,employeeId:d.value.id}]}),x=L(()=>($.value||[]).length>0);async function m(k){const r=k.filter(C=>C.id!==null&&C.id!==void 0).map(C=>C.id);if(r.length===0)return k;try{const C=await ye.getEmployeesByIds(r),I=new Map;return C.forEach(B=>{I.set(B.id,B.name)}),k.map(B=>B.id&&I.has(B.id)?{...B,name:I.get(B.id)}:B)}catch(C){return console.error("[ResponsibleModal] Error enriching names:",C),k}}ae([()=>l.value,()=>Y.value],async([k,r])=>{if(!(k!=="employees"||t.value!==0)){if(!r||r.length===0){$.value=[];return}f.value=!0;try{$.value=await m(r)}catch(C){console.error("[ResponsibleModal] Error loading employee names:",C),$.value=r}finally{f.value=!1}}},{immediate:!0}),ae(()=>s.responsible,async k=>{if(!(t.value!==0||i.value||l.value!=="categories")){if(!k||k.length===0){y.value=[];return}f.value=!0;try{y.value=await m(k)}catch(r){console.error("[ResponsibleModal] Error loading employee names:",r),y.value=k}finally{f.value=!1}}},{immediate:!1});const a=L(()=>(y.value||[]).length>0);function O(k){l.value!==k&&(l.value=k,t.value=0,i.value=null,d.value=null,_.value=null,v.value=[],h.value=null,y.value=[],$.value=[])}async function w(k){if(!(!k||k.count===0)){i.value=k,t.value=1,f.value=!0;try{y.value=await m(k.responsible)}catch(r){console.error("[ResponsibleModal] Error loading employee names:",r),y.value=k.responsible}finally{f.value=!1}}}async function u(k,r=null){var C,I;!k||!k.id||k.totalCount===0||(r&&r.currentTarget&&(r.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{r.currentTarget&&(r.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:k.id,name:k.name,thisWeekCount:k.thisWeekCount,otherWeekCount:k.otherWeekCount,thisWeekTickets:((C=k.thisWeekTickets)==null?void 0:C.length)||0,otherWeekTickets:((I=k.otherWeekTickets)==null?void 0:I.length)||0,employee:k}),d.value={...k,thisWeekTickets:k.thisWeekTickets||[],otherWeekTickets:k.otherWeekTickets||[]},t.value=1)}async function p(k){var C;if(!k||k.count===0)return;_.value=k,t.value=2;const r=k.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:k.id,label:k.label,count:k.count,ticketsInGradation:r.length,selectedEmployee:(C=d.value)==null?void 0:C.id}),r.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",r.length),await D(r)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await U(k))}async function D(k){c.value=!0,h.value=null;try{try{const{prepareTicketsForDisplay:r}=await ie(async()=>{const{prepareTicketsForDisplay:C}=await import("./ticketListUtils-DgoQZRmm.js").then(I=>I.t);return{prepareTicketsForDisplay:C}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await r(k,null,null)}catch(r){console.error("[ResponsibleModal] Error preparing tickets:",r),v.value=k}v.value.length===0&&(h.value=null)}catch(r){h.value=r.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",r),v.value=[]}finally{c.value=!1}}async function U(k){c.value=!0,h.value=null;try{if(!s.weekStartUtc||!s.weekEndUtc||!d.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const r=await re({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeTickets:!0}),C=k.id==="this-week"?r.data.responsibleCreatedThisWeek:r.data.responsibleCreatedOtherWeek,I=C==null?void 0:C.find(R=>R.id===d.value.id),B=(I==null?void 0:I.tickets)||[];try{const{prepareTicketsForDisplay:R}=await ie(async()=>{const{prepareTicketsForDisplay:W}=await import("./ticketListUtils-DgoQZRmm.js").then(Z=>Z.t);return{prepareTicketsForDisplay:W}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await R(B,null,null)}catch(R){console.error("[ResponsibleModal] Error preparing tickets:",R),v.value=B}v.value.length===0&&(h.value=null)}catch(r){h.value=r.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",r),v.value=[]}finally{c.value=!1}}async function V(k,r=null){!k||!k.id||k.count===0||(r&&r.currentTarget&&(r.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{r.currentTarget&&(r.currentTarget.style.transform="")},150)),d.value=k,t.value=2,await q(k.id))}async function q(k){var r;c.value=!0,h.value=null;try{let C=[];if(i.value&&i.value.responsible){const I=i.value.responsible.find(B=>B.id===k);C=(I==null?void 0:I.tickets)||[]}if(C.length===0&&s.weekStartUtc&&s.weekEndUtc){const I=await re({product:"1C",weekStartUtc:s.weekStartUtc,weekEndUtc:s.weekEndUtc,includeTickets:!0}),B=((r=i.value)==null?void 0:r.id)==="created-this-week"?I.data.responsibleCreatedThisWeek:I.data.responsibleCreatedOtherWeek,R=B==null?void 0:B.find(W=>W.id===k);C=(R==null?void 0:R.tickets)||[]}try{const{prepareTicketsForDisplay:I}=await ie(async()=>{const{prepareTicketsForDisplay:B}=await import("./ticketListUtils-DgoQZRmm.js").then(R=>R.t);return{prepareTicketsForDisplay:B}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await I(C,null,null)}catch(I){console.error("[ResponsibleModal] Error preparing tickets:",I),v.value=C}v.value.length===0&&(h.value=null)}catch(C){h.value=C.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",C),v.value=[]}finally{c.value=!1}}function S(){t.value===2?(t.value=1,l.value==="categories"?d.value=null:_.value=null,v.value=[],h.value=null):t.value===1&&(t.value=0,l.value==="categories"?(i.value=null,y.value=[]):d.value=null)}function b(k){const r=me(k.id);window.open(r,"_blank")}function F(){l.value==="employees"&&_.value?D(_.value.tickets):l.value==="categories"&&d.value&&q(d.value.id)}return ae(()=>s.isVisible,k=>{k||(t.value=0,l.value="categories",i.value=null,d.value=null,_.value=null,v.value=[],h.value=null,y.value=[],$.value=[])}),(k,r)=>g.isVisible?(o(),n("div",va,[e("div",ha,[t.value===0?(o(),n("div",ya,[e("button",{class:J(["modal__tab",{"modal__tab--active":l.value==="categories"}]),onClick:r[0]||(r[0]=C=>O("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),e("button",{class:J(["modal__tab",{"modal__tab--active":l.value==="employees"}]),onClick:r[1]||(r[1]=C=>O("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):G("",!0),N(K,{name:"level",mode:"out-in"},{default:z(()=>{var C,I,B,R;return[l.value==="categories"&&t.value===0?(o(),n("div",ma,[e("header",_a,[e("h3",pa,[r[12]||(r[12]=X(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),g.weekNumber?(o(),n("span",ga," ¬∑ –ù–µ–¥–µ–ª—è "+T(g.weekNumber),1)):G("",!0)]),e("button",{class:"modal__close",onClick:r[2]||(r[2]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ba,[e("ul",fa,[(o(!0),n(j,null,H(E.value,W=>(o(),n("li",{key:W.id,class:J(["categories-list__item",{"categories-list__item--clickable":W.count>0}]),onClick:Z=>w(W)},[e("div",Ta,[e("div",Ca,[W.id==="created-this-week"?(o(),n("span",$a,"‚úì")):(o(),n("span",Wa,"‚Üª"))]),e("div",Da,[e("div",Ea,T(W.label),1),e("div",Sa,T(W.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),W.count>0?(o(),n("span",Ia,"‚Üí")):G("",!0)])],10,wa))),128))])]),e("footer",Aa,[e("button",{class:"btn",onClick:r[3]||(r[3]=W=>k.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="categories"&&t.value===1?(o(),n("div",Ua,[e("header",Oa,[e("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),r[13]||(r[13]=e("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),e("button",{class:"modal__close",onClick:r[4]||(r[4]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Ma,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>[f.value?(o(),n("div",Ba,[...r[14]||(r[14]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):a.value?(o(),n("ul",Na,[(o(!0),n(j,null,H(y.value,W=>(o(),n("li",{key:W.id||W.name,class:J(["responsible-list__item",{"responsible-list__item--clickable":W.id&&W.count>0}]),onClick:Z=>V(W,Z),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",La,T(W.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",Va,T(W.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),W.id&&W.count>0?(o(),n("span",Fa,"‚Üí")):G("",!0)],10,Pa))),128))])):(o(),n("p",Ra,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),e("footer",Ga,[e("button",{class:"btn",onClick:r[5]||(r[5]=W=>k.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="categories"&&t.value===2?(o(),n("div",Ya,[e("header",xa,[e("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",za,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+T(((C=d.value)==null?void 0:C.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:r[6]||(r[6]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",ja,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>[c.value?(o(),n("div",qa,[...r[15]||(r[15]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):h.value?(o(),n("div",Ha,[r[16]||(r[16]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),r[17]||(r[17]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",Za,T(h.value),1),e("button",{class:"btn btn-retry",onClick:F},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(o(),n("div",Ka,[...r[18]||(r[18]=[e("div",{class:"empty-state-icon"},"üìã",-1),e("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(o(),n("div",Ja,[N(ce,{name:"ticket",tag:"div",class:"tickets-list"},{default:z(()=>[(o(!0),n(j,null,H(v.value,(W,Z)=>(o(),ee(ue,{key:W.id,ticket:W,draggable:!1,style:se({"--ticket-index":Z}),onClick:b},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):l.value==="employees"&&t.value===0?(o(),n("div",Xa,[e("header",Qa,[e("h3",er,[r[19]||(r[19]=X(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),g.weekNumber?(o(),n("span",tr," ¬∑ –ù–µ–¥–µ–ª—è "+T(g.weekNumber),1)):G("",!0)]),e("button",{class:"modal__close",onClick:r[7]||(r[7]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",sr,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>[f.value?(o(),n("div",ar,[...r[20]||(r[20]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):x.value?(o(),n("ul",or,[(o(!0),n(j,null,H($.value,W=>(o(),n("li",{key:W.id||W.name,class:J(["responsible-list__item",{"responsible-list__item--clickable":W.id&&W.totalCount>0}]),onClick:Z=>u(W,Z),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[e("span",nr,T(W.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),e("span",ir,T(W.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),W.id&&W.totalCount>0?(o(),n("span",dr,"‚Üí")):G("",!0)],10,lr))),128))])):(o(),n("p",rr,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),e("footer",cr,[e("button",{class:"btn",onClick:r[8]||(r[8]=W=>k.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="employees"&&t.value===1?(o(),n("div",ur,[e("header",kr,[e("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",vr,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+T(((I=d.value)==null?void 0:I.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:r[9]||(r[9]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",hr,[e("ul",yr,[(o(!0),n(j,null,H(M.value,W=>(o(),n("li",{key:W.id,class:J(["categories-list__item",{"categories-list__item--clickable":W.count>0}]),onClick:Z=>p(W)},[e("div",_r,[e("div",pr,[W.id==="this-week"?(o(),n("span",gr,"‚úì")):(o(),n("span",br,"‚Üª"))]),e("div",fr,[e("div",wr,T(W.label),1),e("div",Tr,T(W.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),W.count>0?(o(),n("span",Cr,"‚Üí")):G("",!0)])],10,mr))),128))])]),e("footer",$r,[e("button",{class:"btn",onClick:r[10]||(r[10]=W=>k.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value==="employees"&&t.value===2?(o(),n("div",Wr,[e("header",Dr,[e("button",{class:"btn-back",onClick:S,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",Er," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+T(((B=d.value)==null?void 0:B.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+T(((R=_.value)==null?void 0:R.label)||"")+") ",1),e("button",{class:"modal__close",onClick:r[11]||(r[11]=W=>k.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Sr,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>{var W;return[c.value?(o(),n("div",Ir,[...r[21]||(r[21]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):h.value?(o(),n("div",Ar,[r[22]||(r[22]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),r[23]||(r[23]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",Ur,T(h.value),1),e("button",{class:"btn btn-retry",onClick:F},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(o(),n("div",Or,[r[24]||(r[24]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",Mr,T(l.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((W=_.value)==null?void 0:W.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(o(),n("div",Br,[N(ce,{name:"ticket",tag:"div",class:"tickets-list"},{default:z(()=>[(o(!0),n(j,null,H(v.value,(Z,oe)=>(o(),ee(ue,{key:Z.id,ticket:Z,draggable:!1,style:se({"--ticket-index":oe}),onClick:b},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):G("",!0)]}),_:1})])])):G("",!0)}},Nr=te(Rr,[["__scopeId","data-v-3b229bb4"]]),Pr={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Lr={class:"modal"},Vr={key:"level-1",class:"level-1"},Fr={class:"modal__header"},Gr={class:"modal__title"},Yr={key:0},xr={class:"modal__body"},zr={key:"loading",class:"loading-names"},jr={key:"empty",class:"modal__empty"},qr={key:"list",class:"stages-list"},Hr=["onClick"],Zr={class:"stages-list__name"},Kr={class:"stages-list__count"},Jr={key:0,class:"stages-list__arrow"},Xr={class:"modal__footer"},Qr={key:"level-2",class:"level-2"},eo={class:"modal__header"},to={class:"modal__title"},so={class:"modal__body"},ao={key:"loading",class:"loading-state"},ro={key:"error",class:"error-state"},oo={class:"error-message"},lo={key:"empty",class:"empty-state"},no={class:"empty-state-message"},io={key:"tickets",class:"tickets-list-container"},co={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(g,{emit:s}){const t=g,l=A(1),i=A(null),d=A([]),_=A(!1),v=A(!1),c=A(null),h=A([]),y=L(()=>h.value.length>0&&h.value.some(m=>m.count>0));async function $(){if(!t.weekStartUtc||!t.weekEndUtc){h.value=[];return}v.value=!0,c.value=null;try{const m=await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeNewTicketsByStages:!0});h.value=m.data.newTicketsByStages||[]}catch(m){c.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",m),h.value=[]}finally{v.value=!1}}async function f(m,a=null){!m||m.count===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),i.value=m,l.value=2,await E(m.stageId))}async function E(m){var a;_.value=!0,c.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const w=(a=(await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:a.find(p=>p.stageId===m),u=(w==null?void 0:w.tickets)||[];try{const{prepareTicketsForDisplay:p}=await ie(async()=>{const{prepareTicketsForDisplay:D}=await import("./ticketListUtils-DgoQZRmm.js").then(U=>U.t);return{prepareTicketsForDisplay:D}},__vite__mapDeps([0,1,2,3,4,5]));d.value=await p(u,null,null)}catch(p){console.error("[StagesModal] Error preparing tickets:",p),d.value=u}d.value.length===0&&(c.value=null)}catch(O){c.value=O.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",O),d.value=[]}finally{_.value=!1}}function Y(){l.value=1,i.value=null,d.value=[],c.value=null}function M(m){const a=me(m.id);window.open(a,"_blank")}function x(){i.value&&E(i.value.stageId)}return ae(()=>t.isVisible,m=>{m?$():(l.value=1,i.value=null,d.value=[],c.value=null,h.value=[])}),ae([()=>t.weekStartUtc,()=>t.weekEndUtc],()=>{t.isVisible&&$()}),(m,a)=>g.isVisible?(o(),n("div",Pr,[e("div",Lr,[N(K,{name:"level",mode:"out-in"},{default:z(()=>{var O;return[l.value===1?(o(),n("div",Vr,[e("header",Fr,[e("h3",Gr,[a[3]||(a[3]=X(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),g.weekNumber?(o(),n("span",Yr," ¬∑ –ù–µ–¥–µ–ª—è "+T(g.weekNumber),1)):G("",!0)]),e("button",{class:"modal__close",onClick:a[0]||(a[0]=w=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",xr,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>[v.value?(o(),n("div",zr,[...a[4]||(a[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):y.value?(o(),n("ul",qr,[(o(!0),n(j,null,H(h.value,w=>(o(),n("li",{key:w.stageId,class:J(["stages-list__item",{"stages-list__item--clickable":w.count>0}]),style:se({"--stage-color":w.color}),onClick:u=>f(w,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[e("span",{class:"stages-list__color",style:se({backgroundColor:w.color})},null,4),e("span",Zr,T(w.stageName),1),e("span",Kr,T(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.count>0?(o(),n("span",Jr,"‚Üí")):G("",!0)],14,Hr))),128))])):(o(),n("p",jr," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",Xr,[e("button",{class:"btn",onClick:a[1]||(a[1]=w=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value===2?(o(),n("div",Qr,[e("header",eo,[e("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",to," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+T(((O=i.value)==null?void 0:O.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[2]||(a[2]=w=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",so,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>{var w;return[_.value?(o(),n("div",ao,[...a[5]||(a[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):c.value?(o(),n("div",ro,[a[6]||(a[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[7]||(a[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",oo,T(c.value),1),e("button",{class:"btn btn-retry",onClick:x},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(o(),n("div",lo,[a[8]||(a[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",no," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+T((w=i.value)==null?void 0:w.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(o(),n("div",io,[N(ce,{name:"ticket",tag:"div",class:"tickets-list"},{default:z(()=>[(o(!0),n(j,null,H(d.value,(u,p)=>(o(),ee(ue,{key:u.id,ticket:u,draggable:!1,style:se({"--ticket-index":p}),onClick:M},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):G("",!0)]}),_:1})])])):G("",!0)}},uo=te(co,[["__scopeId","data-v-4af0cfce"]]),ko={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},vo={class:"modal"},ho={key:"level-1",class:"level-1"},yo={class:"modal__header"},mo={class:"modal__title"},_o={key:0},po={class:"modal__body"},go={key:"loading",class:"loading-names"},bo={key:"empty",class:"modal__empty"},fo={key:"list",class:"duration-list"},wo=["onClick"],To={class:"duration-list__name"},Co={class:"duration-list__count"},$o={key:0,class:"duration-list__arrow"},Wo={class:"modal__footer"},Do={key:"level-2",class:"level-2"},Eo={class:"modal__header"},So={class:"modal__title"},Io={class:"modal__body"},Ao={key:"loading",class:"loading-state"},Uo={key:"error",class:"error-state"},Oo={class:"error-message"},Mo={key:"empty",class:"empty-state"},Bo={class:"empty-state-message"},Ro={key:"tickets",class:"tickets-list-container"},No={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(g,{emit:s}){const t=g,l=A(1),i=A(null),d=A([]),_=A(!1),v=A(!1),c=A(null),h=A([]),y=L(()=>h.value.length>0&&h.value.some(m=>m.count>0));async function $(){if(!t.weekStartUtc||!t.weekEndUtc){h.value=[];return}v.value=!0,c.value=null;try{const m=await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});h.value=m.data.carryoverTicketsByDuration||[]}catch(m){c.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",m),h.value=[]}finally{v.value=!1}}async function f(m,a=null){!m||m.count===0||(a&&a.currentTarget&&(a.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{a.currentTarget&&(a.currentTarget.style.transform="")},150)),i.value=m,l.value=2,await E(m.durationCategory))}async function E(m){var a;_.value=!0,c.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const w=(a=(await re({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:a.find(p=>p.durationCategory===m),u=(w==null?void 0:w.tickets)||[];try{const{prepareTicketsForDisplay:p}=await ie(async()=>{const{prepareTicketsForDisplay:D}=await import("./ticketListUtils-DgoQZRmm.js").then(U=>U.t);return{prepareTicketsForDisplay:D}},__vite__mapDeps([0,1,2,3,4,5]));d.value=await p(u,null,null)}catch(p){console.error("[CarryoverDurationModal] Error preparing tickets:",p),d.value=u}d.value.length===0&&(c.value=null)}catch(O){c.value=O.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",O),d.value=[]}finally{_.value=!1}}function Y(){l.value=1,i.value=null,d.value=[],c.value=null}function M(m){const a=me(m.id);window.open(a,"_blank")}function x(){i.value&&E(i.value.durationCategory)}return ae(()=>t.isVisible,m=>{m?$():(l.value=1,i.value=null,d.value=[],c.value=null,h.value=[])}),ae([()=>t.weekStartUtc,()=>t.weekEndUtc],()=>{t.isVisible&&$()}),(m,a)=>g.isVisible?(o(),n("div",ko,[e("div",vo,[N(K,{name:"level",mode:"out-in"},{default:z(()=>{var O;return[l.value===1?(o(),n("div",ho,[e("header",yo,[e("h3",mo,[a[3]||(a[3]=X(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),g.weekNumber?(o(),n("span",_o," ¬∑ –ù–µ–¥–µ–ª—è "+T(g.weekNumber),1)):G("",!0)]),e("button",{class:"modal__close",onClick:a[0]||(a[0]=w=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",po,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>[v.value?(o(),n("div",go,[...a[4]||(a[4]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):y.value?(o(),n("ul",fo,[(o(!0),n(j,null,H(h.value,w=>(o(),n("li",{key:w.durationCategory,class:J(["duration-list__item",{"duration-list__item--clickable":w.count>0}]),style:se({"--duration-color":w.color}),onClick:u=>f(w,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[e("span",{class:"duration-list__color",style:se({backgroundColor:w.color})},null,4),e("span",To,T(w.durationLabel),1),e("span",Co,T(w.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),w.count>0?(o(),n("span",$o,"‚Üí")):G("",!0)],14,wo))),128))])):(o(),n("p",bo," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),e("footer",Wo,[e("button",{class:"btn",onClick:a[1]||(a[1]=w=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):l.value===2?(o(),n("div",Do,[e("header",Eo,[e("button",{class:"btn-back",onClick:Y,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),e("h3",So," –¢–∏–∫–µ—Ç—ã: "+T(((O=i.value)==null?void 0:O.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),e("button",{class:"modal__close",onClick:a[2]||(a[2]=w=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),e("section",Io,[N(K,{name:"loading",mode:"out-in"},{default:z(()=>{var w;return[_.value?(o(),n("div",Ao,[...a[5]||(a[5]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):c.value?(o(),n("div",Uo,[a[6]||(a[6]=e("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),a[7]||(a[7]=e("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),e("p",Oo,T(c.value),1),e("button",{class:"btn btn-retry",onClick:x},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):d.value.length===0?(o(),n("div",Mo,[a[8]||(a[8]=e("div",{class:"empty-state-icon"},"üìã",-1)),e("p",Bo," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+T((w=i.value)==null?void 0:w.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(o(),n("div",Ro,[N(ce,{name:"ticket",tag:"div",class:"tickets-list"},{default:z(()=>[(o(!0),n(j,null,H(d.value,(u,p)=>(o(),ee(ue,{key:u.id,ticket:u,draggable:!1,style:se({"--ticket-index":p}),onClick:M},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):G("",!0)]}),_:1})])])):G("",!0)}},Po=te(No,[["__scopeId","data-v-c26f06c2"]]),Lo={class:"ac-dashboard"},Vo={key:"preloader",class:"chart-preloader"},Fo={key:"content"},Go={class:"period-selector-container"},Yo={key:1,class:"weeks-dashboard"},xo={class:"dashboard-header"},zo={class:"header-content"},jo={class:"breadcrumbs-row"},qo=["aria-label","aria-disabled","data-fallback","disabled"],Ho={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},Zo={class:"dashboard-layout"},Ko={class:"filters-container"},Jo={class:"chart-container"},Xo={__name:"GraphAdmissionClosureDashboard",setup(g){const s=Ne(),t=A(!0),l=A(null),i=A(null),d=A({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),_=A(!1),v=A(!1),c=A(!1),h=A(!1),y=A(!1),$=L(()=>typeof window>"u"?!1:window.history.length>1),f=L(()=>$.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),E={name:"dashboard-sector-1c"};function Y(S){var b;if((b=S==null?void 0:S.preventDefault)==null||b.call(S),!y.value){y.value=!0;try{if($.value){s.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),s.push(E)}finally{y.value=!1}}}const M=A({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),x=A("weeks"),m=L(()=>{const S=M.value.customDateRange.startDate||M.value.customDateRange.endDate,b=M.value.employees.length===1&&M.value.employees.includes("all");return S||!b});async function a(){if(x.value!=="weeks")return;t.value=!0,l.value=null;const S=new Promise(b=>setTimeout(b,300));try{const b=q(),F=b.weekStartUtc,k=b.weekEndUtc,[r,C]=await Promise.all([S,re({product:"1C",periodMode:"weeks",weekStartUtc:F,weekEndUtc:k,includeTickets:!0})]),{meta:I,data:B}=C;i.value=I,d.value=B}catch(b){l.value=b instanceof Error?b:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",b)}finally{t.value=!1}}function O(S){M.value.stages=S}function w(S){M.value.employees=S}function u(S){M.value.dateRange=S}function p(S){M.value.customDateRange=S}function D(S){x.value=S,a()}function U(){M.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},V()}function V(){a()}ke(()=>{try{const S=localStorage.getItem("graph-admission-closure-period-mode");(S==="weeks"||S==="months")&&(x.value=S)}catch(S){console.warn("[GraphAdmissionClosureDashboard] Failed to read from localStorage:",S)}try{const b=localStorage.getItem("graph-admission-closure-period-mode-info-shown");(!b||b!=="true")&&(h.value=!0)}catch(S){console.warn("[GraphAdmissionClosureDashboard] Failed to read info modal flag from localStorage:",S),h.value=!0}a()});function q(){const S=new Date,b=new Date(Date.UTC(S.getUTCFullYear(),S.getUTCMonth(),S.getUTCDate())),F=b.getUTCDay(),k=b.getUTCDate()-F+(F===0?-6:1),r=new Date(Date.UTC(b.getUTCFullYear(),b.getUTCMonth(),k,0,0,0)),C=new Date(r);return C.setUTCDate(C.getUTCDate()+6),C.setUTCHours(23,59,59,999),{weekStartUtc:r.toISOString(),weekEndUtc:C.toISOString()}}return(S,b)=>{var k,r,C,I,B,R,W,Z,oe;const F=Pe("router-link");return o(),n("div",Lo,[N(K,{name:"fade",mode:"out-in"},{default:z(()=>[t.value?(o(),n("div",Vo,[...b[8]||(b[8]=[e("div",{class:"preloader-content"},[e("div",{class:"preloader-spinner"},[e("div",{class:"spinner-ring"}),e("div",{class:"spinner-ring"}),e("div",{class:"spinner-ring"})]),e("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞"),e("p",{class:"preloader-message"}," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 4 –Ω–µ–¥–µ–ª–∏... "),e("div",{class:"preloader-dots"},[e("span",{class:"dot"}),e("span",{class:"dot"}),e("span",{class:"dot"})])],-1)])])):(o(),n("div",Fo,[e("div",Go,[N(rt,{modelValue:x.value,"onUpdate:modelValue":b[0]||(b[0]=Q=>x.value=Q),onChange:D},null,8,["modelValue"])]),x.value==="months"?(o(),ee(ka,{key:0})):(o(),n("div",Yo,[e("div",xo,[e("div",zo,[e("div",jo,[e("button",{class:"btn-back-link",type:"button",onClick:Y,"aria-label":f.value,"aria-disabled":!$.value,"data-fallback":!$.value,disabled:y.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,qo),e("nav",Ho,[N(F,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:z(()=>[...b[9]||(b[9]=[X(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),b[11]||(b[11]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),N(F,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:z(()=>[...b[10]||(b[10]=[X(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),b[12]||(b[12]=e("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),b[13]||(b[13]=e("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),b[14]||(b[14]=e("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),b[15]||(b[15]=e("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),e("div",Zo,[e("div",Ko,[N(Ve,{stages:M.value.stages,employees:M.value.employees,dateRange:M.value.dateRange,customDateRange:M.value.customDateRange,hasActiveFilters:m.value,hideStages:!0,weekPickerMode:!1,"onUpdate:stages":O,"onUpdate:employees":w,"onUpdate:dateRange":u,"onUpdate:customDateRange":p,onReset:U,onApply:V},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),e("div",Jo,[l.value?(o(),ee(Le,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:l.value.message},null,8,["message"])):(o(),ee(zt,{key:1,meta:i.value,data:d.value,onOpenResponsible:b[1]||(b[1]=Q=>_.value=!0),onOpenStages:b[2]||(b[2]=Q=>v.value=!0),onOpenCarryover:b[3]||(b[3]=Q=>c.value=!0)},null,8,["meta","data"]))])])]))]))]),_:1}),N(Nr,{"is-visible":_.value,responsible:d.value.responsible||[],"closed-tickets-created-this-week":d.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":d.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":d.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":d.value.responsibleCreatedOtherWeek||[],"week-number":((k=i.value)==null?void 0:k.weekNumber)||null,"week-start-utc":((r=i.value)==null?void 0:r.weekStartUtc)||null,"week-end-utc":((C=i.value)==null?void 0:C.weekEndUtc)||null,onClose:b[4]||(b[4]=Q=>_.value=!1)},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),N(uo,{"is-visible":v.value,"week-number":((I=i.value)==null?void 0:I.weekNumber)||null,"week-start-utc":((B=i.value)==null?void 0:B.weekStartUtc)||null,"week-end-utc":((R=i.value)==null?void 0:R.weekEndUtc)||null,onClose:b[5]||(b[5]=Q=>v.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),N(Po,{"is-visible":c.value,"week-number":((W=i.value)==null?void 0:W.weekNumber)||null,"week-start-utc":((Z=i.value)==null?void 0:Z.weekStartUtc)||null,"week-end-utc":((oe=i.value)==null?void 0:oe.weekEndUtc)||null,onClose:b[6]||(b[6]=Q=>c.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),N(kt,{"is-visible":h.value,onClose:b[7]||(b[7]=Q=>h.value=!1)},null,8,["is-visible"])])}}},rl=te(Xo,[["__scopeId","data-v-e01d0b8c"]]);export{rl as default};
