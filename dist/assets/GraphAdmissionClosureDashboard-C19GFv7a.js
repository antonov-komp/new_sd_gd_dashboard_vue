const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ticketListUtils-BHM22wDD.js","assets/priority-config-CheZi3lE.js","assets/main-BzIj4snT.js","assets/main-hkNOQW78.css","assets/priority-config-Bxxce_5E.css","assets/ticket-mapper-CRRyimW4.js"])))=>i.map(i=>d[i]);
var ht=Object.defineProperty;var vt=(a,t,e)=>t in a?ht(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var We=(a,t,e)=>vt(a,typeof t!="symbol"?t+"":t,e);import{_ as ae,g as O,G as re,m as Se,H as Je,f as se,o as _,j as V,k as Z,a as T,d as Y,b as o,y as te,n as K,B as ee,I as kt,c as F,J as R,K as Ke,t as S,F as q,e as X,L as $e,M as mt,N as _e,O as J,P as yt,Q as Qe,R as ye,S as ft,U as pt,V as gt,W as _t,X as bt,Y as wt,Z as Tt,$ as Ct,x as $t,l as ne,z as et,r as tt,a0 as st,a1 as ce,T as De,a2 as fe,a3 as ze}from"./main-BzIj4snT.js";import{F as at}from"./FiltersPanel-CuW3sjww.js";import{L as ue,D as Dt,B as Et}from"./index-DZ_SE5rG.js";import{g as je,a as Wt,b as qe,D as Mt,T as Ee,c as Be}from"./priority-config-CheZi3lE.js";const It={key:0,class:"modal-overlay"},At={class:"modal-container",role:"dialog","aria-labelledby":"modal-title","aria-modal":"true"},St={class:"modal-body"},Bt={class:"mode-description"},Nt={__name:"PeriodModeInfoModal",props:{isVisible:{type:Boolean,required:!0},currentMode:{type:String,default:"weeks",validator:a=>["weeks","months"].includes(a)}},emits:["close","start-loading","select-mode"],setup(a,{emit:t}){const e=a,s=t,r=O(e.currentMode);function n(k){if(!["weeks","months"].includes(k)){console.warn("[PeriodModeInfoModal] Invalid mode:",k);return}r.value=k,console.log("[DEBUG Modal] handleModeSelect: mode =",k),console.log("[DEBUG Modal] Emitting select-mode event"),s("select-mode",k),console.log("[DEBUG Modal] Emitting close event"),s("close"),console.log("[DEBUG Modal] Scheduling start-loading event in 100ms"),setTimeout(()=>{console.log("[DEBUG Modal] Emitting start-loading event"),s("start-loading")},100)}function d(){console.log("[DEBUG Modal] handleClose called, selectedMode =",r.value),console.log("[DEBUG Modal] Emitting select-mode event with",r.value),s("select-mode",r.value),console.log("[DEBUG Modal] Emitting close event"),s("close")}function v(k){k.key==="Escape"&&e.isVisible&&d()}return re(()=>e.currentMode,k=>{["weeks","months"].includes(k)&&(r.value=k)}),Se(()=>{e.isVisible&&document.addEventListener("keydown",v)}),Je(()=>{document.removeEventListener("keydown",v)}),re(()=>e.isVisible,k=>{k?(document.addEventListener("keydown",v),r.value=e.currentMode):document.removeEventListener("keydown",v)}),(k,f)=>(_(),se(kt,{to:"body"},[V(ee,{name:"modal-fade"},{default:Z(()=>[a.isVisible?(_(),T("div",It,[o("div",At,[o("div",{class:"modal-header"},[f[2]||(f[2]=o("h2",{id:"modal-title",class:"modal-title"},[o("span",{class:"modal-icon"},"‚ÑπÔ∏è"),te(" –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ")],-1)),o("button",{class:"modal-close-btn",onClick:d,"aria-label":"–ó–∞–∫—Ä—ã—Ç—å",type:"button"}," √ó ")]),o("div",St,[f[5]||(f[5]=o("p",{class:"modal-description"}," –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π: ",-1)),o("div",Bt,[o("button",{class:K(["mode-item mode-item--clickable",{"mode-item--selected":r.value==="weeks"}]),onClick:f[0]||(f[0]=W=>n("weeks")),type:"button"},[...f[3]||(f[3]=[o("div",{class:"mode-header"},[o("span",{class:"mode-icon"},"üìÖ"),o("h3",{class:"mode-title"},"4 –ø–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–µ–¥–µ–ª–∏")],-1),o("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 4 –Ω–µ–¥–µ–ª–∏ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –Ω–µ–¥–µ–ª—è–º. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–æ–≤. ",-1)])],2),o("button",{class:K(["mode-item mode-item--clickable",{"mode-item--selected":r.value==="months"}]),onClick:f[1]||(f[1]=W=>n("months")),type:"button"},[...f[4]||(f[4]=[o("div",{class:"mode-header"},[o("span",{class:"mode-icon"},"üìä"),o("h3",{class:"mode-title"},"3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—Ü–∞")],-1),o("p",{class:"mode-text"}," –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–µ–≤. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤—ã—è–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–æ–≤. ",-1)])],2)])])])])):Y("",!0)]),_:1})]))}},Ut=ae(Nt,[["__scopeId","data-v-4a42a9a6"]]),xt={class:"ac-chart"},Rt={class:"ac-chart__header"},Ot={class:"ac-chart__subtitle"},Pt={class:"ac-chart__controls"},Lt={class:"chart-type-selector"},Gt=["onClick"],Ft={class:"chart-type-icon"},Vt={class:"chart-type-label"},Ht={class:"ac-chart__summary"},Yt={class:"summary-card__value"},zt={class:"summary-card__value-main"},jt={class:"summary-card__breakdown"},qt={class:"breakdown-item breakdown-item--this-week"},Xt={class:"breakdown-item__value"},Zt={class:"breakdown-item breakdown-item--other-week"},Jt={class:"breakdown-item__value"},Kt={class:"summary-card__value-main"},Qt={class:"summary-card__breakdown"},es={class:"breakdown-item breakdown-item--this-week"},ts={class:"breakdown-item__value"},ss={class:"breakdown-item breakdown-item--other-week"},as={class:"breakdown-item__value"},os={class:"summary-card summary-card--stages"},rs={class:"summary-card__tags"},ns={key:0,class:"stage-tag stage-tag--empty"},ls={class:"ac-chart__body"},is={key:0,class:"split-charts-container"},ds={class:"chart-wrapper chart-wrapper--left"},cs={class:"chart-canvas-wrapper"},us={class:"chart-wrapper chart-wrapper--right"},hs={class:"chart-canvas-wrapper"},vs={__name:"GraphAdmissionClosureChart",props:{meta:{type:Object,default:()=>({weekNumber:null,weekStartUtc:null,weekEndUtc:null})},data:{type:Object,default:()=>({newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},stages:[],responsible:[]})}},emits:["open-responsible","open-stages","open-carryover"],setup(a,{emit:t}){const e=a,s=t,r=[{value:"line",label:"–õ–∏–Ω–µ–π–Ω—ã–π",icon:"üìà"},{value:"bar",label:"–°—Ç–æ–ª–±—á–∞—Ç—ã–π",icon:"üìä"},{value:"doughnut",label:"–ö—Ä—É–≥–æ–≤–∞—è",icon:"üç©"}],n=O("line");F(()=>{var c;return((c=e.meta)==null?void 0:c.weekNumber)??"‚Äî"});const d=()=>{var u,b;const c=((u=e.meta)==null?void 0:u.weeks)||[];return c.length>0?c.map(M=>`–ù–µ–¥–µ–ª—è ${M.weekNumber}`):[(b=e.meta)!=null&&b.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"]};function v(c,u,b,M=.3,i=0){if(!u)return((I,x)=>{const g=parseInt(I.slice(1,3),16),l=parseInt(I.slice(3,5),16),y=parseInt(I.slice(5,7),16);return`rgba(${g}, ${l}, ${y}, ${x})`})(b,M);const w=(B,I)=>{const x=parseInt(B.slice(1,3),16),g=parseInt(B.slice(3,5),16),l=parseInt(B.slice(5,7),16);return`rgba(${x}, ${g}, ${l}, ${I})`},E=c.createLinearGradient(0,u.bottom,0,u.top);return E.addColorStop(0,w(b,M)),E.addColorStop(1,w(b,i)),E}const k=F(()=>{var w,E,B,I;const c=d(),u=Array.isArray((w=e.data.series)==null?void 0:w.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],b=Array.isArray((E=e.data.series)==null?void 0:E.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],M=Array.isArray((B=e.data.series)==null?void 0:B.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],i=Array.isArray((I=e.data.series)==null?void 0:I.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0];return{labels:c,datasets:[{label:"–ù–æ–≤—ã–µ",data:u,backgroundColor:x=>{const g=x.chart,{ctx:l,chartArea:y}=g;return v(l,y,R.primary)},borderColor:R.primary,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.primary},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:b,backgroundColor:x=>{const g=x.chart,{ctx:l,chartArea:y}=g;return v(l,y,R.success)},borderColor:R.success,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.success},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:M,backgroundColor:R.successLight,borderColor:R.successLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.successLight},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:i,backgroundColor:R.warning,borderColor:R.warning,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.warning}]}}),f=F(()=>{var i,w,E;const c=d(),u=Array.isArray((i=e.data.series)==null?void 0:i.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],b=Array.isArray((w=e.data.series)==null?void 0:w.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],M=Array.isArray((E=e.data.series)==null?void 0:E.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:[e.data.carryoverTicketsCreatedOtherWeek??0];return{labels:c,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:u,backgroundColor:B=>{const I=B.chart,{ctx:x,chartArea:g}=I;return v(x,g,R.carryover)},borderColor:R.carryover,borderWidth:3,tension:.4,fill:!0,pointRadius:0,pointHoverRadius:5,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.carryover},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:b,backgroundColor:R.carryoverLight,borderColor:R.carryoverLight,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.carryoverLight},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:M,backgroundColor:R.carryoverDark,borderColor:R.carryoverDark,borderWidth:2,tension:.4,borderDash:[8,4],fill:!1,pointRadius:0,pointHoverRadius:4,pointHoverBorderWidth:2,pointHoverBorderColor:"#ffffff",pointBackgroundColor:R.carryoverDark}]}}),W=F(()=>{var x,g,l,y,N,L,H,A,z;const c=((x=e.meta)==null?void 0:x.weeks)||[],u=c.length>0?c.map(j=>`–ù–µ–¥–µ–ª—è ${j.weekNumber}`):[(g=e.meta)!=null&&g.weekNumber?`–ù–µ–¥–µ–ª—è ${e.meta.weekNumber}`:"–ù–µ–¥–µ–ª—è"],b=Array.isArray((l=e.data.series)==null?void 0:l.new)&&e.data.series.new.length>0?e.data.series.new:[e.data.newTickets??0],M=Array.isArray((y=e.data.series)==null?void 0:y.closed)&&e.data.series.closed.length>0?e.data.series.closed:[e.data.closedTickets??0],i=Array.isArray((N=e.data.series)==null?void 0:N.closedCreatedThisWeek)&&e.data.series.closedCreatedThisWeek.length>0?e.data.series.closedCreatedThisWeek:[e.data.closedTicketsCreatedThisWeek??0],w=Array.isArray((L=e.data.series)==null?void 0:L.closedCreatedOtherWeek)&&e.data.series.closedCreatedOtherWeek.length>0?e.data.series.closedCreatedOtherWeek:[e.data.closedTicketsCreatedOtherWeek??0],E=Array.isArray((H=e.data.series)==null?void 0:H.carryover)&&e.data.series.carryover.length>0?e.data.series.carryover:[e.data.carryoverTickets??0],B=Array.isArray((A=e.data.series)==null?void 0:A.carryoverCreatedThisWeek)&&e.data.series.carryoverCreatedThisWeek.length>0?e.data.series.carryoverCreatedThisWeek:[e.data.carryoverTicketsCreatedThisWeek??0],I=Array.isArray((z=e.data.series)==null?void 0:z.carryoverCreatedOtherWeek)&&e.data.series.carryoverCreatedOtherWeek.length>0?e.data.series.carryoverCreatedOtherWeek:[e.data.carryoverTicketsCreatedOtherWeek??0];return{labels:u,datasets:[{label:"–ù–æ–≤—ã–µ",data:b,backgroundColor:R.primary,borderColor:R.primary,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (–≤—Å–µ)",data:M,backgroundColor:R.success,borderColor:R.success,tension:.3,fill:!1},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:i,backgroundColor:R.successLight,borderColor:R.successLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:w,backgroundColor:R.warning,borderColor:R.warning,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (–≤—Å–µ)",data:E,backgroundColor:R.carryover,borderColor:R.carryover,tension:.3,fill:!1},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:B,backgroundColor:R.carryoverLight,borderColor:R.carryoverLight,tension:.3,fill:!1,borderDash:[5,5]},{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ (—Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π)",data:I,backgroundColor:R.carryoverDark,borderColor:R.carryoverDark,tension:.3,fill:!1,borderDash:[5,5]}]}}),U=F(()=>({labels:["–ù–æ–≤—ã–µ","–ó–∞–∫—Ä—ã—Ç—ã–µ","–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ"],datasets:[{data:[e.data.newTickets??0,e.data.closedTickets??0,e.data.carryoverTickets??0],backgroundColor:[R.primary,R.success,R.carryover],borderWidth:1}]})),G=F(()=>{switch(n.value){case"line":return ue;case"bar":return Et;case"doughnut":return Dt;default:return ue}}),P=F(()=>n.value==="doughnut"?U.value:W.value),$=c=>{if(!c)return"‚Äî";try{return new Date(c).toLocaleDateString("ru-RU",{day:"2-digit",month:"short"})}catch{return c}};function C(c){return c==null||isNaN(c)?"0":c>=1e3?c.toLocaleString("ru-RU"):c.toString()}function p(c){const u=c%10,b=c%100;return b>=11&&b<=14?"—Ç–∏–∫–µ—Ç–æ–≤":u===1?"—Ç–∏–∫–µ—Ç":u>=2&&u<=4?"—Ç–∏–∫–µ—Ç–∞":"—Ç–∏–∫–µ—Ç–æ–≤"}const m=F(()=>({responsive:!0,maintainAspectRatio:!1,resizeDelay:0,animation:{duration:800,easing:"easeOutQuart"},interaction:{intersect:!1,mode:"index"},plugins:{tooltip:{enabled:!0,backgroundColor:"rgba(255, 255, 255, 0.98)",titleColor:"#111827",bodyColor:"#374151",borderColor:"#e5e7eb",borderWidth:1,cornerRadius:8,padding:16,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},displayColors:!0,boxPadding:6,usePointStyle:!0,animation:{duration:300,easing:"easeOutQuart"},callbacks:{title:c=>{var E,B,I,x,g,l;if(!c||c.length===0)return"";const u=(E=c[0])==null?void 0:E.dataIndex,b=((B=e.meta)==null?void 0:B.weeks)||[];if(b.length>0&&u!==void 0&&b[u]){const y=b[u];return`–ù–µ–¥–µ–ª—è ${y.weekNumber} (${$(y.weekStartUtc)} ‚Äî ${$(y.weekEndUtc)})`}const M=(I=e.meta)==null?void 0:I.weekNumber,i=(x=e.meta)==null?void 0:x.weekStartUtc,w=(g=e.meta)==null?void 0:g.weekEndUtc;return M&&i&&w?`–ù–µ–¥–µ–ª—è ${M} (${$(i)} ‚Äî ${$(w)})`:((l=c[0])==null?void 0:l.label)||""},label:c=>{const u=c.parsed.y,b=c.dataset.label||"";if(u==null||isNaN(u))return`${b}: 0 —Ç–∏–∫–µ—Ç–æ–≤`;const M=C(u),i=p(u);return`${b}: ${M} ${i}`}}},legend:{position:"bottom",labels:{font:{size:13,weight:"500"},padding:12,boxWidth:18,boxHeight:12,usePointStyle:!0,pointStyle:"circle",generateLabels:c=>Ke.defaults.plugins.legend.labels.generateLabels(c).map((b,M)=>{const i=c.data.datasets[M],w=c.getDatasetMeta(M),E=i.borderDash&&Array.isArray(i.borderDash)&&i.borderDash.length>0||i.borderWidth===2||i.fill===!1;return w.hidden?(b.fontColor="#9ca3af",b.textDecoration="line-through",b.opacity=.5):E?b.fontColor="#6b7280":b.fontColor="#111827",b})},onClick:(c,u)=>{const b=u.datasetIndex;if(b==null){console.warn("[Legend] Invalid datasetIndex:",b);return}const M=c.chart;if(!M){console.warn("[Legend] Chart not found");return}const i=M.getDatasetMeta(b);if(!i){console.warn("[Legend] Dataset meta not found for index:",b);return}i.hidden=!i.hidden,M.update("active")},onHover:(c,u)=>{c.native&&c.native.target&&(c.native.target.style.cursor="pointer")},onLeave:(c,u)=>{c.native&&c.native.target&&(c.native.target.style.cursor="default")}}},scales:n.value==="doughnut"?{}:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10,color:"#374151",callback:c=>c==null||isNaN(c)?"0":C(c)},title:{display:!1},grid:{color:c=>{if(!c||!c.tick||c.tick.value===void 0)return"#e5e7eb";const u=c.tick.value;return isNaN(u)||!isFinite(u)?"#e5e7eb":u===0||u%5===0?"#d1d5db":"#e5e7eb"},lineWidth:c=>{if(!c||!c.tick||c.tick.value===void 0)return 1;const u=c.tick.value;return isNaN(u)||!isFinite(u)?1:u===0||u%5===0?1.5:1}}},x:{ticks:{maxRotation:45,minRotation:45,font:{size:14},padding:10,color:"#374151"},title:{display:!1},grid:{color:"#e5e7eb",lineWidth:1}}}})),h=F(()=>{var c,u,b,M;if((c=e.data)!=null&&c.series){const i=e.data.series,w=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,-1);if(w>=0){const E={newTickets:Array.isArray(i.new)&&i.new[w]!==void 0?i.new[w]:0,closedTickets:Array.isArray(i.closed)&&i.closed[w]!==void 0?i.closed[w]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[w]!==void 0?i.closedCreatedThisWeek[w]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[w]!==void 0?i.closedCreatedOtherWeek[w]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[w]!==void 0?i.carryover[w]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[w]!==void 0?i.carryoverCreatedThisWeek[w]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[w]!==void 0?i.carryoverCreatedOtherWeek[w]:0};if(E.newTickets>0||E.closedTickets>0||E.carryoverTickets>0)return E}}if((u=e.data)!=null&&u.currentWeek&&typeof e.data.currentWeek=="object"){const i=e.data.currentWeek;if((i.newTickets??0)>0||(i.closedTickets??0)>0||(i.carryoverTickets??0)>0)return i}if((b=e.data)!=null&&b.weeksData&&Array.isArray(e.data.weeksData)&&e.data.weeksData.length>0){const i=e.data.weeksData[e.data.weeksData.length-1];if((i.newTickets??0)>0||(i.closedTickets??0)>0||(i.carryoverTickets??0)>0)return i}if((M=e.data)!=null&&M.series){const i=e.data.series,w=Math.max((Array.isArray(i.new)?i.new.length:0)-1,(Array.isArray(i.closed)?i.closed.length:0)-1,(Array.isArray(i.carryover)?i.carryover.length:0)-1,-1);if(w>=0)return{newTickets:Array.isArray(i.new)&&i.new[w]!==void 0?i.new[w]:0,closedTickets:Array.isArray(i.closed)&&i.closed[w]!==void 0?i.closed[w]:0,closedTicketsCreatedThisWeek:Array.isArray(i.closedCreatedThisWeek)&&i.closedCreatedThisWeek[w]!==void 0?i.closedCreatedThisWeek[w]:0,closedTicketsCreatedOtherWeek:Array.isArray(i.closedCreatedOtherWeek)&&i.closedCreatedOtherWeek[w]!==void 0?i.closedCreatedOtherWeek[w]:0,carryoverTickets:Array.isArray(i.carryover)&&i.carryover[w]!==void 0?i.carryover[w]:0,carryoverTicketsCreatedThisWeek:Array.isArray(i.carryoverCreatedThisWeek)&&i.carryoverCreatedThisWeek[w]!==void 0?i.carryoverCreatedThisWeek[w]:0,carryoverTicketsCreatedOtherWeek:Array.isArray(i.carryoverCreatedOtherWeek)&&i.carryoverCreatedOtherWeek[w]!==void 0?i.carryoverCreatedOtherWeek[w]:0}}return e.data||{}}),D=c=>{var w;const u=h.value,b=(u==null?void 0:u.newTickets)??0,M=(u==null?void 0:u.closedTickets)??0,i=(u==null?void 0:u.carryoverTickets)??0;c==="new"&&b>0?s("open-stages"):c==="closed"&&M>0?(((w=e.data)==null?void 0:w.responsible)||[]).length>0&&s("open-responsible"):c==="carryover"&&i>0&&s("open-carryover")};return(c,u)=>{var b,M,i,w,E,B,I,x,g,l,y,N,L,H,A,z;return _(),T("div",xt,[o("header",Rt,[o("div",null,[u[3]||(u[3]=o("h2",{class:"ac-chart__title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),o("p",Ot," –ù–µ–¥–µ–ª—è "+S(((M=(b=a.meta)==null?void 0:b.currentWeek)==null?void 0:M.weekNumber)??((i=a.meta)==null?void 0:i.weekNumber)??"‚Äî")+" ¬∑ "+S((((E=(w=a.meta)==null?void 0:w.currentWeek)==null?void 0:E.weekStartUtc)??((B=a.meta)==null?void 0:B.weekStartUtc))||"‚Äî")+" ‚Äî "+S((((x=(I=a.meta)==null?void 0:I.currentWeek)==null?void 0:x.weekEndUtc)??((g=a.meta)==null?void 0:g.weekEndUtc))||"‚Äî")+" (UTC) ",1)]),o("div",Pt,[o("div",Lt,[(_(),T(q,null,X(r,j=>o("button",{key:j.value,class:K(["chart-type-btn",{active:n.value===j.value}]),onClick:de=>n.value=j.value},[o("span",Ft,S(j.icon),1),o("span",Vt,S(j.label),1)],10,Gt)),64))])])]),o("section",Ht,[o("div",{class:"summary-card summary-card--new",onClick:u[0]||(u[0]=j=>D("new"))},[u[4]||(u[4]=o("div",{class:"summary-card__label"},"–ù–æ–≤—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o("div",Yt,S(((l=h.value)==null?void 0:l.newTickets)??0),1)]),o("div",{class:"summary-card summary-card--closed-breakdown",onClick:u[1]||(u[1]=j=>D("closed"))},[u[9]||(u[9]=o("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o("div",zt,S(((y=h.value)==null?void 0:y.closedTickets)??0),1),o("div",jt,[o("div",qt,[u[5]||(u[5]=o("span",{class:"breakdown-item__icon"},"‚úì",-1)),o("span",Xt,S(((N=h.value)==null?void 0:N.closedTicketsCreatedThisWeek)??0),1),u[6]||(u[6]=o("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))]),o("div",Zt,[u[7]||(u[7]=o("span",{class:"breakdown-item__icon"},"‚Üª",-1)),o("span",Jt,S(((L=h.value)==null?void 0:L.closedTicketsCreatedOtherWeek)??0),1),u[8]||(u[8]=o("span",{class:"breakdown-item__label"},"–¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ–π",-1))])])]),o("div",{class:"summary-card summary-card--carryover-breakdown",onClick:u[2]||(u[2]=j=>D("carryover"))},[u[14]||(u[14]=o("div",{class:"summary-card__label"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),o("div",Kt,S(((H=h.value)==null?void 0:H.carryoverTickets)??0),1),o("div",Qt,[o("div",es,[u[10]||(u[10]=o("span",{class:"breakdown-item__icon"},"‚úì",-1)),o("span",ts,S(((A=h.value)==null?void 0:A.carryoverTicketsCreatedThisWeek)??0),1),u[11]||(u[11]=o("span",{class:"breakdown-item__label"},"—ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏",-1))]),o("div",ss,[u[12]||(u[12]=o("span",{class:"breakdown-item__icon"},"‚Üª",-1)),o("span",as,S(((z=h.value)==null?void 0:z.carryoverTicketsCreatedOtherWeek)??0),1),u[13]||(u[13]=o("span",{class:"breakdown-item__label"},"–ø—Ä–µ–¥—ã–¥—É—â–∏—Ö",-1))])])]),o("div",os,[u[15]||(u[15]=o("div",{class:"summary-card__label"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),o("div",rs,[(_(!0),T(q,null,X(a.data.stages||[],j=>(_(),T("span",{key:j.stageId,class:"stage-tag"},S(j.stageName||j.stageId)+" ‚Äî "+S(j.count),1))),128)),!a.data.stages||a.data.stages.length===0?(_(),T("span",ns," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Y("",!0)])])]),o("div",ls,[n.value==="line"?(_(),T("div",is,[o("div",ds,[u[16]||(u[16]=o("h3",{class:"chart-subtitle"},"–ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",-1)),o("div",cs,[V($e(ue),{data:k.value,options:m.value},null,8,["data","options"])])]),o("div",us,[u[17]||(u[17]=o("h3",{class:"chart-subtitle"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",-1)),o("div",hs,[V($e(ue),{data:f.value,options:m.value},null,8,["data","options"])])])])):(_(),se(mt(G.value),{key:1,data:P.value,options:m.value},null,8,["data","options"]))])])}}},ks=ae(vs,[["__scopeId","data-v-b9d17a07"]]),ms={class:"summary-cards-months"},ys={class:"summary-card summary-card--new"},fs={class:"card-content"},ps={class:"card-main-value"},gs=["title"],_s={class:"card-month-breakdown"},bs={class:"month-name"},ws={class:"month-value"},Ts={key:0,class:"month-item month-item--empty"},Cs={class:"summary-card summary-card--closed"},$s={class:"card-content"},Ds={class:"card-main-value"},Es=["title"],Ws={class:"card-month-breakdown-hierarchical"},Ms={class:"month-header"},Is={class:"month-name"},As={class:"month-value"},Ss={class:"month-breakdown"},Bs={class:"breakdown-item breakdown-this-week"},Ns={class:"breakdown-value"},Us={class:"breakdown-item breakdown-other-week"},xs={class:"breakdown-value"},Rs={key:0,class:"month-item-hierarchical month-item--empty"},Os={class:"summary-card summary-card--carryover"},Ps={class:"card-content"},Ls={class:"card-current-value"},Gs={class:"current-value"},Fs=["title"],Vs={class:"card-month-breakdown"},Hs={class:"month-name"},Ys={class:"month-value"},zs={key:0,class:"month-item month-item--empty"},js={class:"summary-card summary-card--stages"},qs={class:"card-content"},Xs={class:"stages-list"},Zs={class:"stage-icon"},Js={class:"stage-name"},Ks={class:"stage-value"},Qs={key:0,class:"stage-item stage-item--empty"},ea={__name:"SummaryCardsMonths",props:{data:{type:Object,required:!0,default:()=>({newTickets:0,newTicketsByMonth:[],closedTickets:0,closedTicketsByMonth:[],carryoverTickets:0,carryoverTicketsByMonth:[],stages:[]})}},setup(a){const t=a;function e(p){return p==null||isNaN(p)?"0":p>=1e6?(p/1e6).toFixed(1)+"M":p>=1e3?p.toLocaleString("ru-RU"):p.toString()}function s(p){return p==null||isNaN(p)?"":`${p>=0?"+":""}${p.toFixed(1)}%`}function r(p,m){if(typeof p!="number"||isNaN(p)||m==null||typeof m!="number"||isNaN(m)||m===0)return null;if(p===m)return 0;const h=(p-m)/m*100;return!isFinite(h)||isNaN(h)?null:h}const n=F(()=>{var p;return((p=t.data)==null?void 0:p.newTickets)||0}),d=F(()=>e(n.value)),v=F(()=>{var p;return((p=t.data)==null?void 0:p.newTicketsByMonth)||[]}),k=F(()=>{var p;return((p=t.data)==null?void 0:p.closedTicketsByMonth)||[]}),f=F(()=>{var p;return((p=t.data)==null?void 0:p.carryoverTicketsByMonth)||[]}),W=F(()=>{const p=f.value;if(p.length===0)return 0;const m=p[p.length-1];return(m==null?void 0:m.count)||0}),U=F(()=>{var h,D,c,u;const p=typeof((h=t.data)==null?void 0:h.newTickets)=="number"?t.data.newTickets:parseInt((D=t.data)==null?void 0:D.newTickets)||0,m=(u=(c=t.data)==null?void 0:c.previousPeriodData)==null?void 0:u.newTickets;return r(p,m)}),G=F(()=>{var h,D,c,u;const p=typeof((h=t.data)==null?void 0:h.closedTickets)=="number"?t.data.closedTickets:parseInt((D=t.data)==null?void 0:D.closedTickets)||0,m=(u=(c=t.data)==null?void 0:c.previousPeriodData)==null?void 0:u.closedTickets;return r(p,m)}),P=F(()=>{var D;const p=W.value,m=f.value,h=m.length>0?((D=m[0])==null?void 0:D.count)||0:null;return r(p,h)});function $(p){return{"DT140_12:SUCCESS":"stage-success","DT140_12:FAIL":"stage-fail","DT140_12:UC_0GBU8Z":"stage-other"}[p]||""}function C(p){return{"DT140_12:SUCCESS":"‚úì","DT140_12:FAIL":"‚úó","DT140_12:UC_0GBU8Z":"‚ö†"}[p]||"‚Ä¢"}return(p,m)=>(_(),T("div",ms,[o("div",ys,[m[0]||(m[0]=o("h3",{class:"card-title"},"–ù–æ–≤—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥",-1)),o("div",fs,[o("div",ps,[te(S(d.value)+" ",1),U.value!==null?(_(),T("span",{key:0,class:K(["percentage-badge",U.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(U.value)}`},S(s(U.value)),11,gs)):Y("",!0)]),o("div",_s,[(_(!0),T(q,null,X(v.value,h=>(_(),T("div",{key:`new-${h.month}`,class:"month-item"},[o("span",bs,S(h.monthName)+":",1),o("span",ws,S(e(h.count)),1)]))),128)),v.value.length===0?(_(),T("div",Ts," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Y("",!0)])])]),o("div",Cs,[m[5]||(m[5]=o("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç—ã–µ –≤—Å–µ–≥–æ",-1)),o("div",$s,[o("div",Ds,[te(S(e(a.data.closedTickets||0))+" ",1),G.value!==null?(_(),T("span",{key:0,class:K(["percentage-badge",G.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(G.value)}`},S(s(G.value)),11,Es)):Y("",!0)]),o("div",Ws,[(_(!0),T(q,null,X(k.value,h=>(_(),T("div",{key:`closed-${h.month}`,class:"month-item-hierarchical"},[o("div",Ms,[o("span",Is,S(h.monthName)+":",1),o("span",As,S(e(h.count||0)),1)]),o("div",Ss,[o("div",Bs,[m[1]||(m[1]=o("span",{class:"breakdown-icon"},"‚úì",-1)),m[2]||(m[2]=o("span",{class:"breakdown-label"},"—ç—Ç–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),o("span",Ns,S(e(h.closedCreatedThisWeek||0)),1)]),o("div",Us,[m[3]||(m[3]=o("span",{class:"breakdown-icon"},"‚Üª",-1)),m[4]||(m[4]=o("span",{class:"breakdown-label"},"–¥—Ä—É–≥–æ–≥–æ –º–µ—Å—è—Ü–∞:",-1)),o("span",xs,S(e(h.closedCreatedOtherWeek||0)),1)])])]))),128)),k.value.length===0?(_(),T("div",Rs," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Y("",!0)])])]),o("div",Os,[m[7]||(m[7]=o("h3",{class:"card-title"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –≤—Å–µ–≥–æ",-1)),m[8]||(m[8]=o("p",{class:"card-hint"},"–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–∏–∫–µ—Ç—ã —Å–µ–∫—Ç–æ—Ä–∞ –≤ —Ç—Ä–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–¥–∏—è—Ö (—Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)",-1)),o("div",Ps,[o("div",Ls,[m[6]||(m[6]=o("span",{class:"current-label"},"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:",-1)),o("span",Gs,[te(S(e(W.value))+" ",1),P.value!==null?(_(),T("span",{key:0,class:K(["percentage-badge",P.value>=0?"positive":"negative"]),title:`–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –ø–µ—Ä–∏–æ–¥–∞: ${s(P.value)}`},S(s(P.value)),11,Fs)):Y("",!0)])]),o("div",Vs,[(_(!0),T(q,null,X(f.value,h=>(_(),T("div",{key:`carryover-${h.month}`,class:"month-item"},[o("span",Hs,S(h.monthName)+":",1),o("span",Ys,S(e(h.count||0)),1)]))),128)),f.value.length===0?(_(),T("div",zs," –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö ")):Y("",!0)])])]),o("div",js,[m[10]||(m[10]=o("h3",{class:"card-title"},"–ó–∞–∫—Ä—ã—Ç–∏—è –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),o("div",qs,[o("div",Xs,[(_(!0),T(q,null,X(a.data.stages||[],h=>(_(),T("div",{key:h.stageId,class:K(["stage-item",$(h.stageId)])},[o("span",Zs,S(C(h.stageId)),1),o("span",Js,S(h.stageName||h.stageId)+":",1),o("span",Ks,S(e(h.count||0)),1)],2))),128)),!a.data.stages||a.data.stages.length===0?(_(),T("div",Qs,[...m[9]||(m[9]=[o("span",{class:"stage-name"},"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö",-1)])])):Y("",!0)])])])]))}},ta=ae(ea,[["__scopeId","data-v-15d88b90"]]);/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Xe=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var a=window.screen;if(a)return(a.deviceXDPI||1)/(a.logicalXDPI||1)}return 1}(),pe={toTextLines:function(a){var t=[],e;for(a=[].concat(a);a.length;)e=a.pop(),typeof e=="string"?t.unshift.apply(t,e.split(`
`)):Array.isArray(e)?a.push.apply(a,e):ye(a)||t.unshift(""+e);return t},textSize:function(a,t,e){var s=[].concat(t),r=s.length,n=a.font,d=0,v;for(a.font=e.string,v=0;v<r;++v)d=Math.max(a.measureText(s[v]).width,d);return a.font=n,{height:r*e.lineHeight,width:d}},bound:function(a,t,e){return Math.max(a,Math.min(t,e))},arrayDiff:function(a,t){var e=a.slice(),s=[],r,n,d,v;for(r=0,d=t.length;r<d;++r)v=t[r],n=e.indexOf(v),n===-1?s.push([v,1]):e.splice(n,1);for(r=0,d=e.length;r<d;++r)s.push([e[r],-1]);return s},rasterize:function(a){return Math.round(a*Xe)/Xe}};function Me(a,t){var e=t.x,s=t.y;if(e===null)return{x:0,y:-1};if(s===null)return{x:1,y:0};var r=a.x-e,n=a.y-s,d=Math.sqrt(r*r+n*n);return{x:d?r/d:0,y:d?n/d:-1}}function sa(a,t,e,s,r){switch(r){case"center":e=s=0;break;case"bottom":e=0,s=1;break;case"right":e=1,s=0;break;case"left":e=-1,s=0;break;case"top":e=0,s=-1;break;case"start":e=-e,s=-s;break;case"end":break;default:r*=Math.PI/180,e=Math.cos(r),s=Math.sin(r);break}return{x:a,y:t,vx:e,vy:s}}var aa=0,ot=1,rt=2,nt=4,lt=8;function be(a,t,e){var s=aa;return a<e.left?s|=ot:a>e.right&&(s|=rt),t<e.top?s|=lt:t>e.bottom&&(s|=nt),s}function oa(a,t){for(var e=a.x0,s=a.y0,r=a.x1,n=a.y1,d=be(e,s,t),v=be(r,n,t),k,f,W;!(!(d|v)||d&v);)k=d||v,k&lt?(f=e+(r-e)*(t.top-s)/(n-s),W=t.top):k&nt?(f=e+(r-e)*(t.bottom-s)/(n-s),W=t.bottom):k&rt?(W=s+(n-s)*(t.right-e)/(r-e),f=t.right):k&ot&&(W=s+(n-s)*(t.left-e)/(r-e),f=t.left),k===d?(e=f,s=W,d=be(e,s,t)):(r=f,n=W,v=be(r,n,t));return{x0:e,x1:r,y0:s,y1:n}}function we(a,t){var e=t.anchor,s=a,r,n;return t.clamp&&(s=oa(s,t.area)),e==="start"?(r=s.x0,n=s.y0):e==="end"?(r=s.x1,n=s.y1):(r=(s.x0+s.x1)/2,n=(s.y0+s.y1)/2),sa(r,n,a.vx,a.vy,t.align)}var Te={arc:function(a,t){var e=(a.startAngle+a.endAngle)/2,s=Math.cos(e),r=Math.sin(e),n=a.innerRadius,d=a.outerRadius;return we({x0:a.x+s*n,y0:a.y+r*n,x1:a.x+s*d,y1:a.y+r*d,vx:s,vy:r},t)},point:function(a,t){var e=Me(a,t.origin),s=e.x*a.options.radius,r=e.y*a.options.radius;return we({x0:a.x-s,y0:a.y-r,x1:a.x+s,y1:a.y+r,vx:e.x,vy:e.y},t)},bar:function(a,t){var e=Me(a,t.origin),s=a.x,r=a.y,n=0,d=0;return a.horizontal?(s=Math.min(a.x,a.base),n=Math.abs(a.base-a.x)):(r=Math.min(a.y,a.base),d=Math.abs(a.base-a.y)),we({x0:s,y0:r+d,x1:s+n,y1:r,vx:e.x,vy:e.y},t)},fallback:function(a,t){var e=Me(a,t.origin);return we({x0:a.x,y0:a.y,x1:a.x+(a.width||0),y1:a.y+(a.height||0),vx:e.x,vy:e.y},t)}},oe=pe.rasterize;function ra(a){var t=a.borderWidth||0,e=a.padding,s=a.size.height,r=a.size.width,n=-r/2,d=-s/2;return{frame:{x:n-e.left-t,y:d-e.top-t,w:r+e.width+t*2,h:s+e.height+t*2},text:{x:n,y:d,w:r,h:s}}}function na(a,t){var e=t.chart.getDatasetMeta(t.datasetIndex).vScale;if(!e)return null;if(e.xCenter!==void 0&&e.yCenter!==void 0)return{x:e.xCenter,y:e.yCenter};var s=e.getBasePixel();return a.horizontal?{x:s,y:null}:{x:null,y:s}}function la(a){return a instanceof _t?Te.arc:a instanceof bt?Te.point:a instanceof wt?Te.bar:Te.fallback}function ia(a,t,e,s,r,n){var d=Math.PI/2;if(n){var v=Math.min(n,r/2,s/2),k=t+v,f=e+v,W=t+s-v,U=e+r-v;a.moveTo(t,f),k<W&&f<U?(a.arc(k,f,v,-Math.PI,-d),a.arc(W,f,v,-d,0),a.arc(W,U,v,0,d),a.arc(k,U,v,d,Math.PI)):k<W?(a.moveTo(k,e),a.arc(W,f,v,-d,d),a.arc(k,f,v,d,Math.PI+d)):f<U?(a.arc(k,f,v,-Math.PI,0),a.arc(k,U,v,0,Math.PI)):a.arc(k,f,v,-Math.PI,Math.PI),a.closePath(),a.moveTo(t,e)}else a.rect(t,e,s,r)}function da(a,t,e){var s=e.backgroundColor,r=e.borderColor,n=e.borderWidth;!s&&(!r||!n)||(a.beginPath(),ia(a,oe(t.x)+n/2,oe(t.y)+n/2,oe(t.w)-n,oe(t.h)-n,e.borderRadius),a.closePath(),s&&(a.fillStyle=s,a.fill()),r&&n&&(a.strokeStyle=r,a.lineWidth=n,a.lineJoin="miter",a.stroke()))}function ca(a,t,e){var s=e.lineHeight,r=a.w,n=a.x,d=a.y+s/2;return t==="center"?n+=r/2:(t==="end"||t==="right")&&(n+=r),{h:s,w:r,x:n,y:d}}function ua(a,t,e){var s=a.shadowBlur,r=e.stroked,n=oe(e.x),d=oe(e.y),v=oe(e.w);r&&a.strokeText(t,n,d,v),e.filled&&(s&&r&&(a.shadowBlur=0),a.fillText(t,n,d,v),s&&r&&(a.shadowBlur=s))}function ha(a,t,e,s){var r=s.textAlign,n=s.color,d=!!n,v=s.font,k=t.length,f=s.textStrokeColor,W=s.textStrokeWidth,U=f&&W,G;if(!(!k||!d&&!U))for(e=ca(e,r,v),a.font=v.string,a.textAlign=r,a.textBaseline="middle",a.shadowBlur=s.textShadowBlur,a.shadowColor=s.textShadowColor,d&&(a.fillStyle=n),U&&(a.lineJoin="round",a.lineWidth=W,a.strokeStyle=f),G=0,k=t.length;G<k;++G)ua(a,t[G],{stroked:U,filled:d,w:e.w,x:e.x,y:e.y+e.h*G})}var it=function(a,t,e,s){var r=this;r._config=a,r._index=s,r._model=null,r._rects=null,r._ctx=t,r._el=e};_e(it.prototype,{_modelize:function(a,t,e,s){var r=this,n=r._index,d=ft(J([e.font,{}],s,n)),v=J([e.color,pt.color],s,n);return{align:J([e.align,"center"],s,n),anchor:J([e.anchor,"center"],s,n),area:s.chart.chartArea,backgroundColor:J([e.backgroundColor,null],s,n),borderColor:J([e.borderColor,null],s,n),borderRadius:J([e.borderRadius,0],s,n),borderWidth:J([e.borderWidth,0],s,n),clamp:J([e.clamp,!1],s,n),clip:J([e.clip,!1],s,n),color:v,display:a,font:d,lines:t,offset:J([e.offset,4],s,n),opacity:J([e.opacity,1],s,n),origin:na(r._el,s),padding:gt(J([e.padding,4],s,n)),positioner:la(r._el),rotation:J([e.rotation,0],s,n)*(Math.PI/180),size:pe.textSize(r._ctx,t,d),textAlign:J([e.textAlign,"start"],s,n),textShadowBlur:J([e.textShadowBlur,0],s,n),textShadowColor:J([e.textShadowColor,v],s,n),textStrokeColor:J([e.textStrokeColor,v],s,n),textStrokeWidth:J([e.textStrokeWidth,0],s,n)}},update:function(a){var t=this,e=null,s=null,r=t._index,n=t._config,d,v,k,f=J([n.display,!0],a,r);f&&(d=a.dataset.data[r],v=yt(Qe(n.formatter,[d,a]),d),k=ye(v)?[]:pe.toTextLines(v),k.length&&(e=t._modelize(f,k,n,a),s=ra(e))),t._model=e,t._rects=s},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(a,t){var e=this,s=a.ctx,r=e._model,n=e._rects,d;this.visible()&&(s.save(),r.clip&&(d=r.area,s.beginPath(),s.rect(d.left,d.top,d.right-d.left,d.bottom-d.top),s.clip()),s.globalAlpha=pe.bound(0,r.opacity,1),s.translate(oe(t.x),oe(t.y)),s.rotate(r.rotation),da(s,n.frame,r),ha(s,r.lines,n.text,r),s.restore())}});var va=Number.MIN_SAFE_INTEGER||-9007199254740991,ka=Number.MAX_SAFE_INTEGER||9007199254740991;function me(a,t,e){var s=Math.cos(e),r=Math.sin(e),n=t.x,d=t.y;return{x:n+s*(a.x-n)-r*(a.y-d),y:d+r*(a.x-n)+s*(a.y-d)}}function Ze(a,t){var e=ka,s=va,r=t.origin,n,d,v,k,f;for(n=0;n<a.length;++n)d=a[n],v=d.x-r.x,k=d.y-r.y,f=t.vx*v+t.vy*k,e=Math.min(e,f),s=Math.max(s,f);return{min:e,max:s}}function Ce(a,t){var e=t.x-a.x,s=t.y-a.y,r=Math.sqrt(e*e+s*s);return{vx:(t.x-a.x)/r,vy:(t.y-a.y)/r,origin:a,ln:r}}var dt=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};_e(dt.prototype,{center:function(){var a=this._rect;return{x:a.x+a.w/2,y:a.y+a.h/2}},update:function(a,t,e){this._rotation=e,this._rect={x:t.x+a.x,y:t.y+a.y,w:t.w,h:t.h}},contains:function(a){var t=this,e=1,s=t._rect;return a=me(a,t.center(),-t._rotation),!(a.x<s.x-e||a.y<s.y-e||a.x>s.x+s.w+e*2||a.y>s.y+s.h+e*2)},intersects:function(a){var t=this._points(),e=a._points(),s=[Ce(t[0],t[1]),Ce(t[0],t[3])],r,n,d;for(this._rotation!==a._rotation&&s.push(Ce(e[0],e[1]),Ce(e[0],e[3])),r=0;r<s.length;++r)if(n=Ze(t,s[r]),d=Ze(e,s[r]),n.max<d.min||d.max<n.min)return!1;return!0},_points:function(){var a=this,t=a._rect,e=a._rotation,s=a.center();return[me({x:t.x,y:t.y},s,e),me({x:t.x+t.w,y:t.y},s,e),me({x:t.x+t.w,y:t.y+t.h},s,e),me({x:t.x,y:t.y+t.h},s,e)]}});function ct(a,t,e){var s=t.positioner(a,t),r=s.vx,n=s.vy;if(!r&&!n)return{x:s.x,y:s.y};var d=e.w,v=e.h,k=t.rotation,f=Math.abs(d/2*Math.cos(k))+Math.abs(v/2*Math.sin(k)),W=Math.abs(d/2*Math.sin(k))+Math.abs(v/2*Math.cos(k)),U=1/Math.max(Math.abs(r),Math.abs(n));return f*=r*U,W*=n*U,f+=t.offset*r,W+=t.offset*n,{x:s.x+f,y:s.y+W}}function ma(a,t){var e,s,r,n;for(e=a.length-1;e>=0;--e)for(r=a[e].$layout,s=e-1;s>=0&&r._visible;--s)n=a[s].$layout,n._visible&&r._box.intersects(n._box)&&t(r,n);return a}function ya(a){var t,e,s,r,n,d,v;for(t=0,e=a.length;t<e;++t)s=a[t],r=s.$layout,r._visible&&(v=new Proxy(s._el,{get:(k,f)=>k.getProps([f],!0)[f]}),n=s.geometry(),d=ct(v,s.model(),n),r._box.update(d,n,s.rotation()));return ma(a,function(k,f){var W=k._hidable,U=f._hidable;W&&U||U?f._visible=!1:W&&(k._visible=!1)})}var ge={prepare:function(a){var t=[],e,s,r,n,d;for(e=0,r=a.length;e<r;++e)for(s=0,n=a[e].length;s<n;++s)d=a[e][s],t.push(d),d.$layout={_box:new dt,_hidable:!1,_visible:!0,_set:e,_idx:d._index};return t.sort(function(v,k){var f=v.$layout,W=k.$layout;return f._idx===W._idx?W._set-f._set:W._idx-f._idx}),this.update(t),t},update:function(a){var t=!1,e,s,r,n,d;for(e=0,s=a.length;e<s;++e)r=a[e],n=r.model(),d=r.$layout,d._hidable=n&&n.display==="auto",d._visible=r.visible(),t|=d._hidable;t&&ya(a)},lookup:function(a,t){var e,s;for(e=a.length-1;e>=0;--e)if(s=a[e].$layout,s&&s._visible&&s._box.contains(t))return a[e];return null},draw:function(a,t){var e,s,r,n,d,v;for(e=0,s=t.length;e<s;++e)r=t[e],n=r.$layout,n._visible&&(d=r.geometry(),v=ct(r._el,r.model(),d),n._box.update(v,d,r.rotation()),r.draw(a,v))}},fa=function(a){if(ye(a))return null;var t=a,e,s,r;if(Tt(a))if(!ye(a.label))t=a.label;else if(!ye(a.r))t=a.r;else for(t="",e=Object.keys(a),r=0,s=e.length;r<s;++r)t+=(r!==0?", ":"")+e[r]+": "+a[e[r]];return""+t},pa={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:fa,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},Q="$datalabels",ut="$default";function ga(a,t){var e=a.datalabels,s={},r=[],n,d;return e===!1?null:(e===!0&&(e={}),t=_e({},[t,e]),n=t.labels||{},d=Object.keys(n),delete t.labels,d.length?d.forEach(function(v){n[v]&&r.push(_e({},[t,n[v],{_key:v}]))}):r.push(t),s=r.reduce(function(v,k){return Ct(k.listeners||{},function(f,W){v[W]=v[W]||{},v[W][k._key||ut]=f}),delete k.listeners,v},{}),{labels:r,listeners:s})}function Ie(a,t,e,s){if(t){var r=e.$context,n=e.$groups,d;t[n._set]&&(d=t[n._set][n._key],d&&Qe(d,[r,s])===!0&&(a[Q]._dirty=!0,e.update(r)))}}function _a(a,t,e,s,r){var n,d;!e&&!s||(e?s?e!==s&&(d=n=!0):d=!0:n=!0,d&&Ie(a,t.leave,e,r),n&&Ie(a,t.enter,s,r))}function ba(a,t){var e=a[Q],s=e._listeners,r,n;if(!(!s.enter&&!s.leave)){if(t.type==="mousemove")n=ge.lookup(e._labels,t);else if(t.type!=="mouseout")return;r=e._hovered,e._hovered=n,_a(a,s,r,n,t)}}function wa(a,t){var e=a[Q],s=e._listeners.click,r=s&&ge.lookup(e._labels,t);r&&Ie(a,s,r,t)}var Ta={id:"datalabels",defaults:pa,beforeInit:function(a){a[Q]={_actives:[]}},beforeUpdate:function(a){var t=a[Q];t._listened=!1,t._listeners={},t._datasets=[],t._labels=[]},afterDatasetUpdate:function(a,t,e){var s=t.index,r=a[Q],n=r._datasets[s]=[],d=a.isDatasetVisible(s),v=a.data.datasets[s],k=ga(v,e),f=t.meta.data||[],W=a.ctx,U,G,P,$,C,p,m,h;for(W.save(),U=0,P=f.length;U<P;++U)if(m=f[U],m[Q]=[],d&&m&&a.getDataVisibility(U)&&!m.skip)for(G=0,$=k.labels.length;G<$;++G)C=k.labels[G],p=C._key,h=new it(C,W,m,U),h.$groups={_set:s,_key:p||ut},h.$context={active:!1,chart:a,dataIndex:U,dataset:v,datasetIndex:s},h.update(h.$context),m[Q].push(h),n.push(h);W.restore(),_e(r._listeners,k.listeners,{merger:function(D,c,u){c[D]=c[D]||{},c[D][t.index]=u[D],r._listened=!0}})},afterUpdate:function(a){a[Q]._labels=ge.prepare(a[Q]._datasets)},afterDatasetsDraw:function(a){ge.draw(a,a[Q]._labels)},beforeEvent:function(a,t){if(a[Q]._listened){var e=t.event;switch(e.type){case"mousemove":case"mouseout":ba(a,e);break;case"click":wa(a,e);break}}},afterEvent:function(a){var t=a[Q],e=t._actives,s=t._actives=a.getActiveElements(),r=pe.arrayDiff(e,s),n,d,v,k,f,W,U;for(n=0,d=r.length;n<d;++n)if(f=r[n],f[1])for(U=f[0].element[Q]||[],v=0,k=U.length;v<k;++v)W=U[v],W.$context.active=f[1]===1,W.update(W.$context);(t._dirty||r.length)&&(ge.update(t._labels),a.render()),delete t._dirty}};const Ca={class:"line-chart-months"},$a={class:"chart-section"},Da={class:"chart-title"},Ea={key:0,class:"chart-period"},Wa={class:"chart-wrapper"},Ma={class:"chart-container"},Ia={class:"chart-summary"},Aa={class:"summary-numbers"},Sa={class:"summary-row"},Ba={class:"summary-values"},Na={class:"summary-row"},Ua={class:"summary-values"},xa={class:"summary-analysis"},Ra=["innerHTML"],Oa={class:"chart-section"},Pa={class:"chart-title"},La={key:0,class:"chart-period"},Ga={class:"chart-wrapper"},Fa={class:"chart-container"},Va={class:"chart-analysis"},Ha={class:"analysis-content"},Ya=["innerHTML"],za={class:"chart-table-section"},ja={class:"chart-table-wrapper"},qa={class:"data-table"},Xa={class:"data-row data-row--new"},Za={class:"data-row data-row--closed"},Ja={class:"data-row data-row--carryover"},Ka={__name:"LineChartMonths",props:{data:{type:Object,required:!0,default:()=>({newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[]})},meta:{type:Object,default:()=>({months:[]})}},setup(a){Ke.register(Ta);const t=a;function e($){return $==null||isNaN($)?"0":$>=1e3?$.toLocaleString("ru-RU"):$.toString()}const s=F(()=>{var C,p,m;const $=new Set;return(C=t.data.newTicketsByMonth)==null||C.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(D=>{D&&D.weekNumber&&$.add(D.weekNumber)})}),(p=t.data.closedTicketsByMonth)==null||p.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(D=>{D&&D.weekNumber&&$.add(D.weekNumber)})}),(m=t.data.carryoverTicketsByMonth)==null||m.forEach(h=>{h.weeks&&Array.isArray(h.weeks)&&h.weeks.forEach(D=>{D&&D.weekNumber&&$.add(D.weekNumber)})}),Array.from($).sort((h,D)=>h-D)}),r=F(()=>{const $=t.data.newTicketsByMonth||[],C=$.map(h=>h.monthName||`–ú–µ—Å—è—Ü ${h.month}`),p=$.map(h=>h.count||0),m=(t.data.closedTicketsByMonth||[]).map(h=>h.count||0);return{labels:C,datasets:[{label:"–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã",data:p,borderColor:R.primary,backgroundColor:"rgba(0, 123, 255, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:10,color:R.primary,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:R.primary,borderWidth:1,borderRadius:4,padding:4}},{label:"–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã",data:m,borderColor:R.success,backgroundColor:"rgba(40, 167, 69, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"start",align:"bottom",offset:10,color:R.success,font:{size:12,weight:"bold"},backgroundColor:"rgba(255, 255, 255, 0.9)",borderColor:R.success,borderWidth:1,borderRadius:4,padding:4}}]}}),n=F(()=>{const $=t.data.carryoverTicketsByMonth||[],C=$.map(m=>m.monthName||`–ú–µ—Å—è—Ü ${m.month}`),p=$.map(m=>m.count||0);return{labels:C,datasets:[{label:"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã",data:p,borderColor:R.carryover,backgroundColor:"rgba(255, 152, 0, 0.1)",tension:.4,fill:!1,datalabels:{anchor:"end",align:"top",offset:4,color:R.carryover}}]}}),d={responsive:!0,maintainAspectRatio:!1,layout:{padding:{left:16,right:0,top:56,bottom:0}},plugins:{legend:{position:"left",labels:{font:{size:14,weight:"500"},padding:16,boxWidth:20,boxHeight:12}},tooltip:{enabled:!0,titleFont:{size:14,weight:"bold"},bodyFont:{size:13},padding:12},datalabels:{anchor:"end",align:"top",formatter:($,C)=>$==null||isNaN($)?"":$.toString(),color:"#333",font:{size:12,weight:"bold"},padding:{top:4,bottom:4},display:function($){const C=$.dataset.data[$.dataIndex];return C!=null&&!isNaN(C)&&isFinite(C)},backgroundColor:"rgba(255, 255, 255, 0.8)",borderColor:"#333",borderWidth:1,borderRadius:4,padding:4}},scales:{y:{beginAtZero:!0,ticks:{precision:0,font:{size:14},padding:10},grid:{lineWidth:1.5}},x:{ticks:{maxRotation:0,minRotation:0,font:{size:14},padding:10},grid:{lineWidth:1.5}}}};function v($){if(!$||$.length===0)return null;const C=$[0],p=$[$.length-1];if(!C||!p)return null;const m=C.monthName||`–ú–µ—Å—è—Ü ${C.month}`,h=p.monthName||`–ú–µ—Å—è—Ü ${p.month}`,D=C.year||new Date().getFullYear();return`${m} ‚Äî ${h} ${D}`}const k=F(()=>{var $;return v((($=t.data)==null?void 0:$.newTicketsByMonth)||[])}),f=F(()=>{var $;return v((($=t.data)==null?void 0:$.carryoverTicketsByMonth)||[])}),W=F(()=>{var h,D;const $=((h=t.data)==null?void 0:h.newTicketsByMonth)||[],C=((D=t.data)==null?void 0:D.closedTicketsByMonth)||[];if($.length===0)return{new:"‚Äî",closed:"‚Äî"};const p=$.map(c=>`${e(c.count||0)} (${c.monthName||c.month})`).join(" ‚Üí "),m=C.map(c=>`${e(c.count||0)} (${c.monthName||c.month})`).join(" ‚Üí ");return{new:p,closed:m}}),U=F(()=>{var D,c;const $=((D=t.data)==null?void 0:D.newTicketsByMonth)||[],C=((c=t.data)==null?void 0:c.closedTicketsByMonth)||[];if($.length<2)return["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const p=[],m=[],h=[];if($.length>=2){const u=$[0],b=$[1],M=$[2];if(b&&u&&typeof u.count=="number"&&typeof b.count=="number"){const i=u.monthName||u.month,w=b.monthName||b.month,E=e(u.count||0),B=e(b.count||0);if(u.count>0){const I=(b.count-u.count)/u.count*100;if(isFinite(I)&&!isNaN(I)){const x=I>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",g=Math.abs(I),l=I>=0?"+":"-",y=I>=0?"#28a745":"#dc3545",N=I>=0?"#28a745":"#dc3545";m.push(`  ‚Ä¢ <span style="color: ${y}; font-weight: 600;">${x}</span> —Å ${E} (${i}) –¥–æ ${B} (${w}) ‚Äî <span style="color: ${N}; font-weight: 600;">${l}${g.toFixed(1)}%</span>`)}}else u.count===0&&b.count>0&&m.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${i}) –¥–æ ${B} (${w})`)}if(M&&b&&typeof b.count=="number"&&typeof M.count=="number"){const i=b.monthName||b.month,w=M.monthName||M.month,E=e(b.count||0),B=e(M.count||0);if(b.count>0){const I=(M.count-b.count)/b.count*100;if(isFinite(I)&&!isNaN(I))if(Math.abs(I)<.1)m.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${E} (${i}) ‚Üí ${B} (${w}) ‚Äî 0.0%`);else{const x=I>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",g=Math.abs(I),l=I>=0?"+":"-",y=I>=0?"#28a745":"#dc3545",N=I>=0?"#28a745":"#dc3545";m.push(`  ‚Ä¢ <span style="color: ${y}; font-weight: 600;">${x}</span> —Å ${E} (${i}) –¥–æ ${B} (${w}) ‚Äî <span style="color: ${N}; font-weight: 600;">${l}${g.toFixed(1)}%</span>`)}}else b.count===0&&M.count>0&&m.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${i}) –¥–æ ${B} (${w})`)}}if(C.length>=2){const u=C[0],b=C[1],M=C[2];if(b&&u&&typeof u.count=="number"&&typeof b.count=="number"){const i=u.monthName||u.month,w=b.monthName||b.month,E=e(u.count||0),B=e(b.count||0);if(u.count>0){const I=(b.count-u.count)/u.count*100;if(isFinite(I)&&!isNaN(I))if(Math.abs(I)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${E} (${i}) ‚Üí ${B} (${w}) ‚Äî 0.0%`);else{const x=I>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",g=Math.abs(I),l=I>=0?"+":"-",y=I>=0?"#28a745":"#dc3545",N=I>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${y}; font-weight: 600;">${x}</span> —Å ${E} (${i}) –¥–æ ${B} (${w}) ‚Äî <span style="color: ${N}; font-weight: 600;">${l}${g.toFixed(1)}%</span>`)}}else u.count===0&&b.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${i}) –¥–æ ${B} (${w})`)}if(M&&b&&typeof b.count=="number"&&typeof M.count=="number"){const i=b.monthName||b.month,w=M.monthName||M.month,E=e(b.count||0),B=e(M.count||0);if(b.count>0){const I=(M.count-b.count)/b.count*100;if(isFinite(I)&&!isNaN(I))if(Math.abs(I)<.1)h.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${E} (${i}) ‚Üí ${B} (${w}) ‚Äî 0.0%`);else{const x=I>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",g=Math.abs(I),l=I>=0?"+":"-",y=I>=0?"#28a745":"#dc3545",N=I>=0?"#28a745":"#dc3545";h.push(`  ‚Ä¢ <span style="color: ${y}; font-weight: 600;">${x}</span> —Å ${E} (${i}) –¥–æ ${B} (${w}) ‚Äî <span style="color: ${N}; font-weight: 600;">${l}${g.toFixed(1)}%</span>`)}}else b.count===0&&M.count>0&&h.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–π: —Å 0 (${i}) –¥–æ ${B} (${w})`)}}if(m.length>0&&(p.push("–ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã:"),p.push(...m)),h.length>0&&(p.push("–ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã:"),p.push(...h)),$.length>=3&&C.length>=3){const u=$[0],b=$[$.length-1],M=C[0],i=C[C.length-1],w=u.count||0,E=b.count||0,B=M.count||0,I=i.count||0;if(w>0&&B>0){const x=(E-w)/w*100,g=(I-B)/B*100;if(isFinite(x)&&isFinite(g)){const l=u.monthName||u.month,y=b.monthName||b.month,N=M.monthName||M.month,L=i.monthName||i.month,H=x>=0?"#28a745":"#dc3545",A=x>=0?"#28a745":"#dc3545",z=g>=0?"#28a745":"#dc3545",j=g>=0?"#28a745":"#dc3545";p.push("–û–±—â–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥:"),p.push(`  ‚Ä¢ –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${H}; font-weight: 600;">${x>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(w)} (${l}) –¥–æ ${e(E)} (${y}) ‚Äî <span style="color: ${A}; font-weight: 600;">${x>=0?"+":"-"}${Math.abs(x).toFixed(1)}%</span>`),p.push(`  ‚Ä¢ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã: <span style="color: ${z}; font-weight: 600;">${g>=0?"—Ä–æ—Å—Ç":"—Å–Ω–∏–∂–µ–Ω–∏–µ"}</span> —Å ${e(B)} (${N}) –¥–æ ${e(I)} (${L}) ‚Äî <span style="color: ${j}; font-weight: 600;">${g>=0?"+":"-"}${Math.abs(g).toFixed(1)}%</span>`)}}}return p.length>0?p:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]}),G=F(()=>{var h;const $=((h=t.data)==null?void 0:h.carryoverTicketsByMonth)||[];if($.length===0)return["–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"];const C=[],p=[],m=$.filter(D=>D&&typeof D.count=="number").map(D=>`${e(D.count||0)} (${D.monthName||D.month||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"})`).join(" ‚Üí ");if(m&&C.push(`–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã: ${m}`),$.length>=2){const D=$[0],c=$[1],u=$[2];if(c&&D&&typeof D.count=="number"&&typeof c.count=="number"){const b=D.monthName||D.month,M=c.monthName||c.month,i=e(D.count||0),w=e(c.count||0);if(D.count>0){const E=(c.count-D.count)/D.count*100;if(isFinite(E)&&!isNaN(E))if(Math.abs(E)<.1)p.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${i} (${b}) ‚Üí ${w} (${M}) ‚Äî 0.0%`);else{const B=E>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",I=Math.abs(E),x=E>=0?"+":"-",g=E>=0?"#28a745":"#dc3545",l=E>=0?"#28a745":"#dc3545";p.push(`  ‚Ä¢ <span style="color: ${g}; font-weight: 600;">${B}</span> —Å ${i} (${b}) –¥–æ ${w} (${M}) ‚Äî <span style="color: ${l}; font-weight: 600;">${x}${I.toFixed(1)}%</span>`)}}else D.count===0&&c.count>0&&p.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${b}) –¥–æ ${w} (${M})`)}if(u&&c&&typeof c.count=="number"&&typeof u.count=="number"){const b=c.monthName||c.month,M=u.monthName||u.month,i=e(c.count||0),w=e(u.count||0);if(c.count>0){const E=(u.count-c.count)/c.count*100;if(isFinite(E)&&!isNaN(E))if(Math.abs(E)<.1)p.push(`  ‚Ä¢ –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: ${i} (${b}) ‚Üí ${w} (${M}) ‚Äî 0.0%`);else{const B=E>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",I=Math.abs(E),x=E>=0?"+":"-",g=E>=0?"#28a745":"#dc3545",l=E>=0?"#28a745":"#dc3545";p.push(`  ‚Ä¢ <span style="color: ${g}; font-weight: 600;">${B}</span> —Å ${i} (${b}) –¥–æ ${w} (${M}) ‚Äî <span style="color: ${l}; font-weight: 600;">${x}${I.toFixed(1)}%</span>`)}}else c.count===0&&u.count>0&&p.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${b}) –¥–æ ${w} (${M})`)}}if(p.length>0&&(C.push("–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:"),C.push(...p)),$.length>=3){const D=$[0],c=$[$.length-1];if(D&&c&&typeof D.count=="number"&&typeof c.count=="number"){const u=D.count||0,b=c.count||0,M=D.monthName||D.month,i=c.monthName||c.month,w=e(u),E=e(b);if(u>0){const B=(b-u)/u*100;if(isFinite(B)&&!isNaN(B))if(Math.abs(B)<1)C.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),C.push(`  ‚Ä¢ –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${w} (${M}) ‚Üí ${E} (${i}) ‚Äî –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–µ 1%`);else{const I=B>=0?"–†–æ—Å—Ç":"–°–Ω–∏–∂–µ–Ω–∏–µ",x=Math.abs(B),g=B>=0?"+":"-",l=B>=0?"#28a745":"#dc3545",y=B>=0?"#28a745":"#dc3545";C.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),C.push(`  ‚Ä¢ <span style="color: ${l}; font-weight: 600;">${I}</span> —Å ${w} (${M}) –¥–æ ${E} (${i}) ‚Äî <span style="color: ${y}; font-weight: 600;">${g}${x.toFixed(1)}%</span>`)}}else u===0&&b>0?(C.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),C.push(`  ‚Ä¢ –ü–æ—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å 0 (${M}) –¥–æ ${E} (${i})`)):u>0&&b===0&&(C.push("–¢–µ–Ω–¥–µ–Ω—Ü–∏—è –∑–∞ –ø–µ—Ä–∏–æ–¥:"),C.push(`  ‚Ä¢ –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤: —Å ${w} (${M}) –¥–æ 0 (${i})`))}}return C.length>0?C:["–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"]});function P($,C){let p=[];switch($){case"new":p=t.data.newTicketsByMonth||[];break;case"closed":p=t.data.closedTicketsByMonth||[];break;case"carryover":p=t.data.carryoverTicketsByMonth||[];break;default:return"-"}for(const m of p){if(!m.weeks||!Array.isArray(m.weeks))continue;const h=m.weeks.find(D=>D&&D.weekNumber===C);if(h){const D=h.count||0;return D>0?e(D):"-"}}return"-"}return($,C)=>(_(),T("div",Ca,[o("div",$a,[o("h3",Da,[C[0]||(C[0]=te(" –ù–æ–≤—ã–µ –∏ –ó–∞–∫—Ä—ã—Ç—ã–µ —Ç–∏–∫–µ—Ç—ã ",-1)),k.value?(_(),T("span",Ea,"("+S(k.value)+")",1)):Y("",!0)]),o("div",Wa,[o("div",Ma,[V($e(ue),{data:r.value,options:d},null,8,["data"])]),o("div",Ia,[C[3]||(C[3]=o("h4",{class:"summary-title"},"–°–≤–æ–¥–Ω—ã–π –∏—Ç–æ–≥",-1)),o("div",Aa,[o("div",Sa,[C[1]||(C[1]=o("span",{class:"summary-label"},"–ù–æ–≤—ã–µ:",-1)),o("span",Ba,S(W.value.new),1)]),o("div",Na,[C[2]||(C[2]=o("span",{class:"summary-label"},"–ó–∞–∫—Ä—ã—Ç—ã–µ:",-1)),o("span",Ua,S(W.value.closed),1)])]),o("div",xa,[(_(!0),T(q,null,X(U.value,(p,m)=>(_(),T("p",{key:m,innerHTML:p},null,8,Ra))),128))])])])]),o("div",Oa,[o("h3",Pa,[C[4]||(C[4]=te(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã ",-1)),f.value?(_(),T("span",La,"("+S(f.value)+")",1)):Y("",!0)]),o("div",Ga,[o("div",Fa,[V($e(ue),{data:n.value,options:d},null,8,["data"])]),o("div",Va,[C[5]||(C[5]=o("h4",{class:"analysis-title"},"–ê–Ω–∞–ª–∏–∑",-1)),o("div",Ha,[(_(!0),T(q,null,X(G.value,(p,m)=>(_(),T("p",{key:m,innerHTML:p},null,8,Ya))),128))])])])]),o("div",za,[C[10]||(C[10]=o("h3",{class:"chart-title"},"–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º –∏ –Ω–µ–¥–µ–ª—è–º",-1)),o("div",ja,[o("table",qa,[o("thead",null,[o("tr",null,[C[6]||(C[6]=o("th",{class:"month-header-cell"},"–ú–µ—Å—è—Ü",-1)),(_(!0),T(q,null,X(s.value,p=>(_(),T("th",{key:`week-${p}`,class:"week-header-cell"}," –ù–µ–¥–µ–ª—è "+S(p),1))),128))])]),o("tbody",null,[o("tr",Xa,[C[7]||(C[7]=o("td",{class:"data-type-cell"},"–ù–æ–≤—ã–µ",-1)),(_(!0),T(q,null,X(s.value,p=>(_(),T("td",{key:`new-${p}`,class:"week-data-cell"},S(P("new",p)),1))),128))]),o("tr",Za,[C[8]||(C[8]=o("td",{class:"data-type-cell"},"–ó–∞–∫—Ä—ã—Ç—ã–µ",-1)),(_(!0),T(q,null,X(s.value,p=>(_(),T("td",{key:`closed-${p}`,class:"week-data-cell"},S(P("closed",p)),1))),128))]),o("tr",Ja,[C[9]||(C[9]=o("td",{class:"data-type-cell"},"–ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ",-1)),(_(!0),T(q,null,X(s.value,p=>(_(),T("td",{key:`carryover-${p}`,class:"week-data-cell"},S(P("carryover",p)),1))),128))])])])])])]))}},Qa=ae(Ka,[["__scopeId","data-v-31a3d565"]]),eo={class:"months-preloader"},to={class:"preloader-content"},so={class:"progress-container"},ao={class:"progress-bar"},oo={class:"progress-text"},ro={class:"preloader-message"},no={class:"stages-list"},lo={class:"stage-icon"},io={class:"stage-text"},co={__name:"MonthsModePreloader",props:{progress:{type:Number,required:!0,validator:a=>a>=0&&a<=100},currentStage:{type:String,default:""}},setup(a){const t=a,e=[{label:"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",threshold:5},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...",threshold:35},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...",threshold:65},{label:"–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...",threshold:85},{label:"–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...",threshold:90},{label:"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",threshold:100}];function s(n){return t.progress>=e[n].threshold}function r(n){const d=e[n].threshold,v=n>0?e[n-1].threshold:0;return t.progress>=v&&t.progress<d}return(n,d)=>(_(),T("div",eo,[o("div",to,[d[0]||(d[0]=$t('<div class="preloader-spinner" data-v-b571fe67><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div><div class="spinner-ring" data-v-b571fe67></div></div><h3 class="preloader-title" data-v-b571fe67>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ 3 –º–µ—Å—è—Ü–∞</h3>',2)),o("div",so,[o("div",ao,[o("div",{class:"progress-fill",style:ne({width:`${a.progress}%`})},null,4)]),o("div",oo,S(Math.round(a.progress))+"%",1)]),o("p",ro,S(a.currentStage),1),o("div",no,[(_(),T(q,null,X(e,(v,k)=>o("div",{key:k,class:K(["stage-item",{"stage-completed":s(k),"stage-current":r(k)}])},[o("span",lo,S(s(k)?"‚úì":r(k)?"‚Üí":"‚óã"),1),o("span",io,S(v.label),1)],2)),64))])])]))}},uo=ae(co,[["__scopeId","data-v-b571fe67"]]),ho="/api/graph-1c-admission-closure.php";function vo(a){var s,r,n,d,v,k,f,W,U,G,P,$,C,p,m,h,D,c,u,b,M,i,w,E,B,I,x,g,l,y,N,L,H,A,z,j,de,he,ve,ke,le,Ne,Ue,xe,Re,Oe,Pe,Le,Ge,Fe,Ve,He,Ye;if(!a)return{meta:null,data:{currentWeek:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0},newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,series:{new:[0],closed:[0],closedCreatedThisWeek:[0],closedCreatedOtherWeek:[0],carryover:[0],carryoverCreatedThisWeek:[0],carryoverCreatedOtherWeek:[0]},weeksData:[],stages:[],responsible:[],responsibleCreatedThisWeek:[],responsibleCreatedOtherWeek:[]}};const t=a.data||a.result||a,e=t.meta||a.meta||null;return{meta:{...e,currentWeek:(e==null?void 0:e.currentWeek)||(e?{weekNumber:e.weekNumber,weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc}:null),weeks:(e==null?void 0:e.weeks)||[]},data:{currentWeek:((s=t.data)==null?void 0:s.currentWeek)||(t.data?{newTickets:t.data.newTickets??0,closedTickets:t.data.closedTickets??0,closedTicketsCreatedThisWeek:t.data.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:t.data.closedTicketsCreatedOtherWeek??0,carryoverTickets:t.data.carryoverTickets??0,carryoverTicketsCreatedThisWeek:t.data.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:t.data.carryoverTicketsCreatedOtherWeek??0}:{newTickets:0,closedTickets:0,closedTicketsCreatedThisWeek:0,closedTicketsCreatedOtherWeek:0,carryoverTickets:0,carryoverTicketsCreatedThisWeek:0,carryoverTicketsCreatedOtherWeek:0}),newTickets:((n=(r=t.data)==null?void 0:r.currentWeek)==null?void 0:n.newTickets)??((d=t.data)==null?void 0:d.newTickets)??t.newTickets??0,closedTickets:((k=(v=t.data)==null?void 0:v.currentWeek)==null?void 0:k.closedTickets)??((f=t.data)==null?void 0:f.closedTickets)??t.closedTickets??0,closedTicketsCreatedThisWeek:((U=(W=t.data)==null?void 0:W.currentWeek)==null?void 0:U.closedTicketsCreatedThisWeek)??((G=t.data)==null?void 0:G.closedTicketsCreatedThisWeek)??t.closedTicketsCreatedThisWeek??0,closedTicketsCreatedOtherWeek:(($=(P=t.data)==null?void 0:P.currentWeek)==null?void 0:$.closedTicketsCreatedOtherWeek)??((C=t.data)==null?void 0:C.closedTicketsCreatedOtherWeek)??t.closedTicketsCreatedOtherWeek??0,carryoverTickets:((m=(p=t.data)==null?void 0:p.currentWeek)==null?void 0:m.carryoverTickets)??((h=t.data)==null?void 0:h.carryoverTickets)??t.carryoverTickets??0,carryoverTicketsCreatedThisWeek:((c=(D=t.data)==null?void 0:D.currentWeek)==null?void 0:c.carryoverTicketsCreatedThisWeek)??((u=t.data)==null?void 0:u.carryoverTicketsCreatedThisWeek)??t.carryoverTicketsCreatedThisWeek??0,carryoverTicketsCreatedOtherWeek:((M=(b=t.data)==null?void 0:b.currentWeek)==null?void 0:M.carryoverTicketsCreatedOtherWeek)??((i=t.data)==null?void 0:i.carryoverTicketsCreatedOtherWeek)??t.carryoverTicketsCreatedOtherWeek??0,series:{new:((E=(w=t.data)==null?void 0:w.series)==null?void 0:E.new)??((B=t.series)==null?void 0:B.new)??[0],closed:((x=(I=t.data)==null?void 0:I.series)==null?void 0:x.closed)??((g=t.series)==null?void 0:g.closed)??[0],closedCreatedThisWeek:((y=(l=t.data)==null?void 0:l.series)==null?void 0:y.closedCreatedThisWeek)??((N=t.series)==null?void 0:N.closedCreatedThisWeek)??[0],closedCreatedOtherWeek:((H=(L=t.data)==null?void 0:L.series)==null?void 0:H.closedCreatedOtherWeek)??((A=t.series)==null?void 0:A.closedCreatedOtherWeek)??[0],carryover:((j=(z=t.data)==null?void 0:z.series)==null?void 0:j.carryover)??((de=t.series)==null?void 0:de.carryover)??[0],carryoverCreatedThisWeek:((ve=(he=t.data)==null?void 0:he.series)==null?void 0:ve.carryoverCreatedThisWeek)??((ke=t.series)==null?void 0:ke.carryoverCreatedThisWeek)??[0],carryoverCreatedOtherWeek:((Ne=(le=t.data)==null?void 0:le.series)==null?void 0:Ne.carryoverCreatedOtherWeek)??((Ue=t.series)==null?void 0:Ue.carryoverCreatedOtherWeek)??[0]},weeksData:((xe=t.data)==null?void 0:xe.weeksData)??t.weeksData??[],stages:((Re=t.data)==null?void 0:Re.stages)??t.stages??[],responsible:((Oe=t.data)==null?void 0:Oe.responsible)??t.responsible??[],responsibleCreatedThisWeek:((Pe=t.data)==null?void 0:Pe.responsibleCreatedThisWeek)??t.responsibleCreatedThisWeek??[],responsibleCreatedOtherWeek:((Le=t.data)==null?void 0:Le.responsibleCreatedOtherWeek)??t.responsibleCreatedOtherWeek??[],newTicketsByStages:((Ge=t.data)==null?void 0:Ge.newTicketsByStages)??t.newTicketsByStages??null,carryoverTicketsByDuration:((Fe=t.data)==null?void 0:Fe.carryoverTicketsByDuration)??t.carryoverTicketsByDuration??null,newTicketsByMonth:((Ve=t.data)==null?void 0:Ve.newTicketsByMonth)??t.newTicketsByMonth??[],closedTicketsByMonth:((He=t.data)==null?void 0:He.closedTicketsByMonth)??t.closedTicketsByMonth??[],carryoverTicketsByMonth:((Ye=t.data)==null?void 0:Ye.carryoverTicketsByMonth)??t.carryoverTicketsByMonth??[]}}}async function ie(a={}){const{endpoint:t=ho,product:e="1C",weekStartUtc:s=null,weekEndUtc:r=null,periodMode:n="weeks",useCache:d=!0,forceRefresh:v=!1,includeTickets:k=!1,includeNewTicketsByStages:f=!1,includeCarryoverTickets:W=!0,includeCarryoverTicketsByDuration:U=!1}=a,P=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({product:e,weekStartUtc:s,weekEndUtc:r,periodMode:n,useCache:d,forceRefresh:v,includeTickets:k,includeNewTicketsByStages:f,includeCarryoverTickets:W,includeCarryoverTicketsByDuration:U})});if(!P.ok)throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ (${P.status})`);const $=await P.json();if(($==null?void 0:$.success)===!1)throw new Error($.message||"–ë—ç–∫–µ–Ω–¥ –≤–µ—Ä–Ω—É–ª –æ—à–∏–±–∫—É");return vo($)}const ko={class:"ac-dashboard-months"},mo={key:"content"},yo={class:"dashboard-header"},fo={class:"header-content"},po={class:"breadcrumbs-row"},go=["aria-label","aria-disabled","data-fallback","disabled"],_o={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},bo={class:"dashboard-layout"},wo={class:"filters-container"},To={class:"chart-container"},Co={__name:"GraphAdmissionClosureMonthsDashboard",setup(a){const t=et(),e=O(!0),s=O(0),r=O("–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö..."),n=O(null),d=O(null),v=O({newTickets:0,closedTickets:0,carryoverTickets:0,newTicketsByMonth:[],closedTicketsByMonth:[],carryoverTicketsByMonth:[],previousPeriodData:{newTickets:null,closedTickets:null,carryoverTickets:null}}),k=O(!1),f=F(()=>typeof window>"u"?!1:window.history.length>1),W=F(()=>f.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),U={name:"dashboard-sector-1c"};function G(i){var w;if((w=i==null?void 0:i.preventDefault)==null||w.call(i),!k.value){k.value=!0;try{if(f.value){t.back();return}console.warn("GraphAdmissionClosureMonthsDashboard: fallback navigation to dashboard-sector-1c"),t.push(U)}finally{k.value=!1}}}const P=O({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),$=F(()=>{const i=P.value.customDateRange.startDate||P.value.customDateRange.endDate,w=P.value.employees.length===1&&P.value.employees.includes("all");return i||!w});async function C(i,w,E=500){const B=s.value,I=10,x=(i-B)/I,g=E/I;for(let l=0;l<I;l++)await new Promise(y=>setTimeout(y,g)),s.value=Math.min(B+x*(l+1),i);s.value=i,r.value=w}async function p(){console.log("[DEBUG MonthsDashboard] loadData called"),console.log("[DEBUG MonthsDashboard] isLoading before:",e.value),e.value=!0,n.value=null,s.value=0,r.value="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",console.log("[DEBUG MonthsDashboard] isLoading set to true");let i=null,w=null;try{console.log("[DEBUG MonthsDashboard] Starting API call"),await C(5,"–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö...",200);const E=Date.now(),B=2e4;i=setInterval(()=>{const l=Date.now()-E,y=Math.min(5+l/B*85,90);s.value=y,y<35?r.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 1)...":y<65?r.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 2)...":y<85?r.value="–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (–∑–∞–ø—Ä–æ—Å 3)...":r.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö..."},500),w=setTimeout(()=>{i&&(clearInterval(i),i=null)},B+1e4);const I=await ie({product:"1C",periodMode:"months",includeTickets:!0});clearTimeout(w),i&&(clearInterval(i),i=null),s.value=90,r.value="–ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞",await C(100,"–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤...",300),console.log("[DEBUG MonthsDashboard] API call successful, result:",I);const{meta:x,data:g}=I;d.value=x,v.value=g,console.log("[DEBUG MonthsDashboard] Data set, meta:",x,"data keys:",Object.keys(g)),await new Promise(l=>setTimeout(l,200))}catch(E){i&&(clearInterval(i),i=null),w&&(clearTimeout(w),w=null),console.error("[DEBUG MonthsDashboard] API call failed:",E),n.value=E instanceof Error?E:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureMonthsDashboard] loadData error:",E),s.value=100,r.value="–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö"}finally{console.log("[DEBUG MonthsDashboard] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG MonthsDashboard] isLoading after:",e.value)}}function m(i){P.value.stages=i}function h(i){P.value.employees=i}function D(i){P.value.dateRange=i}function c(i){P.value.customDateRange=i}function u(){P.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},b()}function b(){p()}function M(i){if(!["weeks","months"].includes(i)){console.warn("[GraphAdmissionClosureMonthsDashboard] Invalid periodMode:",i);return}i==="weeks"&&window.dispatchEvent(new CustomEvent("period-mode-change",{detail:{mode:i}}))}return Se(()=>{console.log("[DEBUG MonthsDashboard] onMounted called"),console.log("[DEBUG MonthsDashboard] isLoading before loadData:",e.value),p()}),(i,w)=>{const E=tt("router-link");return _(),T("div",ko,[V(ee,{name:"fade",mode:"out-in"},{default:Z(()=>[e.value?(_(),se(uo,{key:"preloader",progress:s.value,"current-stage":r.value},null,8,["progress","current-stage"])):(_(),T("div",mo,[o("div",yo,[o("div",fo,[o("div",po,[o("button",{class:"btn-back-link",type:"button",onClick:G,"aria-label":W.value,"aria-disabled":!f.value,"data-fallback":!f.value,disabled:k.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,go),o("nav",_o,[V(E,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:Z(()=>[...w[0]||(w[0]=[te(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),w[2]||(w[2]=o("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),V(E,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:Z(()=>[...w[1]||(w[1]=[te(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),w[3]||(w[3]=o("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),w[4]||(w[4]=o("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),w[5]||(w[5]=o("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),w[6]||(w[6]=o("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),o("div",bo,[o("div",wo,[V(at,{stages:P.value.stages,employees:P.value.employees,dateRange:P.value.dateRange,customDateRange:P.value.customDateRange,hasActiveFilters:$.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":"months","onUpdate:stages":m,"onUpdate:employees":h,"onUpdate:dateRange":D,"onUpdate:customDateRange":c,"onUpdate:periodMode":M,onReset:u,onApply:b},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters"])]),o("div",To,[n.value?(_(),se(st,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:n.value.message},null,8,["message"])):(_(),T(q,{key:1},[V(ta,{data:v.value},null,8,["data"]),V(Qa,{data:v.value,meta:d.value},null,8,["data","meta"])],64))])])]))]),_:1})])}}},$o=ae(Co,[["__scopeId","data-v-fe3ca7ed"]]);class Ae{static async getSectorData(){try{const t=await this.getAllTickets();console.log("Total tickets loaded:",t.length);const e=this.extractUniqueEmployeeIds(t);console.log("Unique employee IDs:",e);const s=await this.getEmployeesByIds(e);return console.log("Loaded employees:",s.length),{stages:this.groupTicketsByStages(t,s),employees:s,zeroPointTickets:this.getZeroPointTickets(t)}}catch(t){throw console.error("Error getting sector data:",t),t}}static async getAllTickets(){const t=["DT140_12:UC_0VHWE2","DT140_12:PREPARATION","DT140_12:CLIENT"],e=[];for(const s of t){console.log(`Loading tickets for stage: ${s}`);const r=await this.getTicketsByStage(s);e.push(...r),console.log(`Loaded ${r.length} tickets for stage ${s}`)}return e}static async getTicketsByStage(t){const e=[];let s=0;const r=50;let n=!0;for(;n;)try{const v=await ce.call("crm.item.list",{entityTypeId:this.ENTITY_TYPE_ID,filter:{stageId:t},select:["*"],order:{id:"DESC"},start:s,useOriginalUfNames:"Y"});let k=[];v&&v.result&&(Array.isArray(v.result)?k=v.result:v.result.items&&Array.isArray(v.result.items)?k=v.result.items:v.result.data&&Array.isArray(v.result.data)&&(k=v.result.data)),k.length>0?(e.push(...k),s+=k.length,n=k.length===r):n=!1}catch(v){console.error(`Error loading tickets batch for stage ${t} (start: ${s}):`,v),n=!1}e.length>0&&(console.log("Sample ticket structure (full JSON):",JSON.stringify(e[0],null,2)),console.log("Sample ticket keys:",Object.keys(e[0])),console.log("Sample ticket assignedById variants:",{assignedById:e[0].assignedById,assignedByIdId:e[0].assignedByIdId,ASSIGNED_BY_ID:e[0].ASSIGNED_BY_ID}));const d=e.filter(v=>{const k=v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product||v.ufCrm7TypeProduct||v.UF_CRM_7_TYPE_PRODUCT||v.uf_crm_7_type_product;return Array.isArray(k)?k.includes(this.SECTOR_TAG):typeof k=="object"&&k!==null?k.value===this.SECTOR_TAG||k===this.SECTOR_TAG:k===this.SECTOR_TAG});return console.log(`Filtered ${d.length} tickets from ${e.length} for stage ${t} (sector tag: ${this.SECTOR_TAG})`),d}static extractUniqueEmployeeIds(t){if(!Array.isArray(t))return[];const e=new Set;return t.forEach(s=>{const r=s.assignedById||s.assignedByIdId||s.ASSIGNED_BY_ID||s.assignedById||s.assignedById&&typeof s.assignedById=="object"&&(s.assignedById.id||s.assignedById.ID)||s.assignedById&&typeof s.assignedById=="object"&&s.assignedById.value;if(r){const n=parseInt(r);n&&!isNaN(n)&&n>0&&e.add(n)}}),t.length>0&&(console.log("Sample ticket for employee extraction:",t[0]),console.log("Sample ticket assignedById variants:",{assignedById:t[0].assignedById,assignedByIdId:t[0].assignedByIdId,ASSIGNED_BY_ID:t[0].ASSIGNED_BY_ID}),console.log("Extracted employee IDs:",Array.from(e))),Array.from(e)}static async getEmployeesByIds(t){if(!Array.isArray(t)||t.length===0)return[];try{const e=await ce.call("user.get",{filter:{ID:t}});let s=[];return e&&e.result&&(Array.isArray(e.result)?s=e.result:console.warn("Unexpected user.get result format:",e)),s.map(r=>({id:parseInt(r.ID||r.id||0),name:`${r.NAME||r.name||""} ${r.LAST_NAME||r.lastName||""}`.trim()||r.EMAIL||r.email||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π",position:r.WORK_POSITION||r.workPosition||"–°–æ—Ç—Ä—É–¥–Ω–∏–∫",email:r.EMAIL||r.email||"",tickets:[]}))}catch(e){return console.error("Error getting employees by IDs:",e),[]}}static groupTicketsByStages(t,e){Array.isArray(t)||(console.warn("Tickets is not an array:",t),t=[]),Array.isArray(e)||(console.warn("Employees is not an array:",e),e=[]);const s=[{id:"formed",name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",color:"#007bff",employees:e.map(r=>({...r,tickets:[]}))},{id:"review",name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",color:"#ffc107",employees:e.map(r=>({...r,tickets:[]}))},{id:"execution",name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",color:"#28a745",employees:e.map(r=>({...r,tickets:[]}))}];return t.forEach(r=>{const n=this.mapStageId(r.stageId||r.STAGE_ID||""),d=s.find(v=>v.id===n);if(d){const v=r.assignedById||r.ASSIGNED_BY_ID||null,k=v?parseInt(v):null;if(k){let f=d.employees.find(W=>W.id===k);f||(f={id:k,name:`–°–æ—Ç—Ä—É–¥–Ω–∏–∫ #${k}`,position:"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ",email:"",tickets:[]},d.employees.push(f)),f.tickets.push(this.mapTicket(r))}}}),s}static mapStageId(t){return{"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"}[t]||"formed"}static mapStageIdToBitrix(t){return{formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"}[t]||"DT140_12:UC_0VHWE2"}static mapTicket(t){const e=parseInt(t.id||t.ID||0),s=t.title||t.TITLE||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è",r=t.stageId||t.STAGE_ID||"",n=t.assignedById||t.ASSIGNED_BY_ID||null,d=t.createdTime||t.CREATED_DATE||t.CREATED_TIME||"",v=t.updatedTime||t.MODIFY_DATE||t.UPDATED_TIME||"",k=t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.ufCrm7UfPriority||t.UF_CRM_7_UF_PRIORITY||t.uf_crm_7_uf_priority||t.priority||t.PRIORITY||null,f=je(k),W=Wt(f);return{id:e,title:s,priorityId:f.id,priorityLabel:f.label,priorityColors:W,priority:f.id,priorityBitrixValue:f.bitrixValue||null,status:this.mapStatus(r),assigneeId:n?parseInt(n):null,stageId:this.mapStageId(r),createdAt:d,modifiedAt:v,amount:t.opportunity||t.OPPORTUNITY||0,currency:t.currencyId||t.CURRENCY_ID||"RUB",description:t.comments||t.COMMENTS||""}}static mapPriority(t){return je(t).id}static mapPriorityToBitrix(t){if(t&&typeof t=="object")return t.bitrixValue||null;const e=qe(t);if(e&&e.bitrixValue)return e.bitrixValue;const s={3:"3",2:"2",1:"1",high:"3",medium:"2",low:"1"};return s[t]?s[t]:qe(Mt).bitrixValue}static mapStatus(t){return"in_progress"}static getZeroPointTickets(t){const e={formed:[],review:[],execution:[]};return Array.isArray(t)?(t.filter(s=>!(s.assignedById||s.ASSIGNED_BY_ID)).forEach(s=>{const r=this.mapStageId(s.stageId||s.STAGE_ID||"");e[r]&&e[r].push(this.mapTicket(s))}),e):(console.warn("Tickets is not an array in getZeroPointTickets:",t),e)}static async assignTicket(t,e,s){try{const r=this.mapStageIdToBitrix(s);return(await ce.call("crm.item.update",{entityTypeId:this.ENTITY_TYPE_ID,id:t,fields:{assignedById:e,stageId:r}})).result===!0}catch(r){throw console.error("Error assigning ticket:",r),r}}static async createTicket(t){try{const e=await ce.call("crm.item.add",{entityTypeId:this.ENTITY_TYPE_ID,fields:{title:t.title,assignedById:t.employeeId,stageId:this.mapStageIdToBitrix(t.stageId)}});return e.result?parseInt(e.result):0}catch(e){throw console.error("Error creating ticket:",e),e}}static async getTicket(t){try{const e=await ce.call("crm.item.get",{entityTypeId:this.ENTITY_TYPE_ID,id:t});return this.mapTicket(e.result)}catch(e){throw console.error("Error getting ticket:",e),e}}static async addComment(t,e){try{return(await ce.call("crm.timeline.comment.add",{fields:{entityId:t,entityType:"DYNAMIC_"+this.ENTITY_TYPE_ID,comment:e}})).result!==void 0}catch(s){throw console.error("Error adding comment:",s),s}}}We(Ae,"ENTITY_TYPE_ID",140),We(Ae,"SECTOR_TAG","1C");const Do={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Eo={class:"modal"},Wo={key:0,class:"modal__tabs"},Mo={key:"level-0-categories",class:"level-0"},Io={class:"modal__header"},Ao={class:"modal__title"},So={key:0},Bo={class:"modal__body"},No={class:"categories-list"},Uo=["onClick"],xo={class:"category-item"},Ro={class:"category-item__icon"},Oo={key:0},Po={key:1},Lo={class:"category-item__content"},Go={class:"category-item__label"},Fo={class:"category-item__count"},Vo={key:0,class:"category-item__arrow"},Ho={class:"modal__footer"},Yo={key:"level-1-categories",class:"level-1"},zo={class:"modal__header"},jo={class:"modal__body"},qo={key:"loading",class:"loading-names"},Xo={key:"empty",class:"modal__empty"},Zo={key:"list",class:"responsible-list"},Jo=["onClick"],Ko={class:"responsible-list__name"},Qo={class:"responsible-list__count"},er={key:0,class:"responsible-list__arrow"},tr={class:"modal__footer"},sr={key:"level-2-categories",class:"level-2"},ar={class:"modal__header"},or={class:"modal__title"},rr={class:"modal__body"},nr={key:"loading",class:"loading-state"},lr={key:"error",class:"error-state"},ir={class:"error-message"},dr={key:"empty",class:"empty-state"},cr={key:"tickets",class:"tickets-list-container"},ur={key:"level-0-employees",class:"level-0"},hr={class:"modal__header"},vr={class:"modal__title"},kr={key:0},mr={class:"modal__body"},yr={key:"loading",class:"loading-names"},fr={key:"empty",class:"modal__empty"},pr={key:"list",class:"responsible-list"},gr=["onClick"],_r={class:"responsible-list__name"},br={class:"responsible-list__count"},wr={key:0,class:"responsible-list__arrow"},Tr={class:"modal__footer"},Cr={key:"level-1-employees",class:"level-1"},$r={class:"modal__header"},Dr={class:"modal__title"},Er={class:"modal__body"},Wr={class:"categories-list"},Mr=["onClick"],Ir={class:"category-item"},Ar={class:"category-item__icon"},Sr={key:0},Br={key:1},Nr={class:"category-item__content"},Ur={class:"category-item__label"},xr={class:"category-item__count"},Rr={key:0,class:"category-item__arrow"},Or={class:"modal__footer"},Pr={key:"level-2-employees",class:"level-2"},Lr={class:"modal__header"},Gr={class:"modal__title"},Fr={class:"modal__body"},Vr={key:"loading",class:"loading-state"},Hr={key:"error",class:"error-state"},Yr={class:"error-message"},zr={key:"empty",class:"empty-state"},jr={class:"empty-state-message"},qr={key:"tickets",class:"tickets-list-container"},Xr={__name:"ResponsibleModal",props:{isVisible:{type:Boolean,default:!1},responsible:{type:Array,default:()=>[]},closedTicketsCreatedThisWeek:{type:Number,default:0},closedTicketsCreatedOtherWeek:{type:Number,default:0},responsibleCreatedThisWeek:{type:Array,default:()=>[]},responsibleCreatedOtherWeek:{type:Array,default:()=>[]},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},setup(a){const t=a,e=O(0),s=O("categories"),r=O(null),n=O(null),d=O(null),v=O([]),k=O(!1),f=O(null),W=O([]),U=O([]),G=O(!1),P=F(()=>[{id:"created-this-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é",count:t.closedTicketsCreatedThisWeek??0,responsible:t.responsibleCreatedThisWeek??[]},{id:"created-other-week",label:"–¢–∏–∫–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç—ã–µ —ç—Ç–æ–π –Ω–µ–¥–µ–ª—å—é –∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ",count:t.closedTicketsCreatedOtherWeek??0,responsible:t.responsibleCreatedOtherWeek??[]}]),$=F(()=>{const g=new Map;return(t.responsibleCreatedThisWeek||[]).forEach(l=>{const y=l.id??"unassigned";g.has(y)||g.set(y,{id:l.id,name:l.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const N=g.get(y);N.thisWeekCount=l.count??0,N.thisWeekTickets=l.tickets||[],N.totalCount+=N.thisWeekCount}),(t.responsibleCreatedOtherWeek||[]).forEach(l=>{const y=l.id??"unassigned";g.has(y)||g.set(y,{id:l.id,name:l.name,thisWeekCount:0,otherWeekCount:0,totalCount:0,thisWeekTickets:[],otherWeekTickets:[]});const N=g.get(y);N.otherWeekCount=l.count??0,N.otherWeekTickets=l.tickets||[],N.totalCount+=N.otherWeekCount}),Array.from(g.values())}),C=F(()=>{if(!n.value)return[];const g=n.value.thisWeekTickets||[],l=n.value.otherWeekTickets||[];return console.log("[ResponsibleModal] Computing gradations for employee:",{id:n.value.id,name:n.value.name,thisWeekCount:n.value.thisWeekCount,otherWeekCount:n.value.otherWeekCount,thisWeekTickets:g.length,otherWeekTickets:l.length,employee:n.value}),[{id:"this-week",label:"–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ",count:n.value.thisWeekCount??0,tickets:g,employeeId:n.value.id},{id:"other-week",label:"–ù–∞ –¥—Ä—É–≥–æ–π –Ω–µ–¥–µ–ª–µ",count:n.value.otherWeekCount??0,tickets:l,employeeId:n.value.id}]}),p=F(()=>(U.value||[]).length>0);async function m(g){const l=g.filter(y=>y.id!==null&&y.id!==void 0).map(y=>y.id);if(l.length===0)return g;try{const y=await Ae.getEmployeesByIds(l),N=new Map;return y.forEach(L=>{N.set(L.id,L.name)}),g.map(L=>L.id&&N.has(L.id)?{...L,name:N.get(L.id)}:L)}catch(y){return console.error("[ResponsibleModal] Error enriching names:",y),g}}re([()=>s.value,()=>$.value],async([g,l])=>{if(!(g!=="employees"||e.value!==0)){if(!l||l.length===0){U.value=[];return}G.value=!0;try{U.value=await m(l)}catch(y){console.error("[ResponsibleModal] Error loading employee names:",y),U.value=l}finally{G.value=!1}}},{immediate:!0}),re(()=>t.responsible,async g=>{if(!(e.value!==0||r.value||s.value!=="categories")){if(!g||g.length===0){W.value=[];return}G.value=!0;try{W.value=await m(g)}catch(l){console.error("[ResponsibleModal] Error loading employee names:",l),W.value=g}finally{G.value=!1}}},{immediate:!1});const h=F(()=>(W.value||[]).length>0);function D(g){s.value!==g&&(s.value=g,e.value=0,r.value=null,n.value=null,d.value=null,v.value=[],f.value=null,W.value=[],U.value=[])}async function c(g){if(!(!g||g.count===0)){r.value=g,e.value=1,G.value=!0;try{W.value=await m(g.responsible)}catch(l){console.error("[ResponsibleModal] Error loading employee names:",l),W.value=g.responsible}finally{G.value=!1}}}async function u(g,l=null){var y,N;!g||!g.id||g.totalCount===0||(l&&l.currentTarget&&(l.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{l.currentTarget&&(l.currentTarget.style.transform="")},150)),console.log("[ResponsibleModal] Employee selected from list:",{id:g.id,name:g.name,thisWeekCount:g.thisWeekCount,otherWeekCount:g.otherWeekCount,thisWeekTickets:((y=g.thisWeekTickets)==null?void 0:y.length)||0,otherWeekTickets:((N=g.otherWeekTickets)==null?void 0:N.length)||0,employee:g}),n.value={...g,thisWeekTickets:g.thisWeekTickets||[],otherWeekTickets:g.otherWeekTickets||[]},e.value=1)}async function b(g){var y;if(!g||g.count===0)return;d.value=g,e.value=2;const l=g.tickets||[];console.log("[ResponsibleModal] Gradation clicked:",{id:g.id,label:g.label,count:g.count,ticketsInGradation:l.length,selectedEmployee:(y=n.value)==null?void 0:y.id}),l.length>0?(console.log("[ResponsibleModal] Loading tickets from gradation:",l.length),await M(l)):(console.log("[ResponsibleModal] Tickets not in gradation, loading from API"),await i(g))}async function M(g){k.value=!0,f.value=null;try{try{const{prepareTicketsForDisplay:l}=await fe(async()=>{const{prepareTicketsForDisplay:y}=await import("./ticketListUtils-BHM22wDD.js").then(N=>N.t);return{prepareTicketsForDisplay:y}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await l(g,null,null)}catch(l){console.error("[ResponsibleModal] Error preparing tickets:",l),v.value=g}v.value.length===0&&(f.value=null)}catch(l){f.value=l.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",l),v.value=[]}finally{k.value=!1}}async function i(g){k.value=!0,f.value=null;try{if(!t.weekStartUtc||!t.weekEndUtc||!n.value)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫");const l=await ie({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),y=g.id==="this-week"?l.data.responsibleCreatedThisWeek:l.data.responsibleCreatedOtherWeek,N=y==null?void 0:y.find(H=>H.id===n.value.id),L=(N==null?void 0:N.tickets)||[];try{const{prepareTicketsForDisplay:H}=await fe(async()=>{const{prepareTicketsForDisplay:A}=await import("./ticketListUtils-BHM22wDD.js").then(z=>z.t);return{prepareTicketsForDisplay:A}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await H(L,null,null)}catch(H){console.error("[ResponsibleModal] Error preparing tickets:",H),v.value=L}v.value.length===0&&(f.value=null)}catch(l){f.value=l.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets from API:",l),v.value=[]}finally{k.value=!1}}async function w(g,l=null){!g||!g.id||g.count===0||(l&&l.currentTarget&&(l.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{l.currentTarget&&(l.currentTarget.style.transform="")},150)),n.value=g,e.value=2,await E(g.id))}async function E(g){var l;k.value=!0,f.value=null;try{let y=[];if(r.value&&r.value.responsible){const N=r.value.responsible.find(L=>L.id===g);y=(N==null?void 0:N.tickets)||[]}if(y.length===0&&t.weekStartUtc&&t.weekEndUtc){const N=await ie({product:"1C",weekStartUtc:t.weekStartUtc,weekEndUtc:t.weekEndUtc,includeTickets:!0}),L=((l=r.value)==null?void 0:l.id)==="created-this-week"?N.data.responsibleCreatedThisWeek:N.data.responsibleCreatedOtherWeek,H=L==null?void 0:L.find(A=>A.id===g);y=(H==null?void 0:H.tickets)||[]}try{const{prepareTicketsForDisplay:N}=await fe(async()=>{const{prepareTicketsForDisplay:L}=await import("./ticketListUtils-BHM22wDD.js").then(H=>H.t);return{prepareTicketsForDisplay:L}},__vite__mapDeps([0,1,2,3,4,5]));v.value=await N(y,null,null)}catch(N){console.error("[ResponsibleModal] Error preparing tickets:",N),v.value=y}v.value.length===0&&(f.value=null)}catch(y){f.value=y.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[ResponsibleModal] Error loading tickets:",y),v.value=[]}finally{k.value=!1}}function B(){e.value===2?(e.value=1,s.value==="categories"?n.value=null:d.value=null,v.value=[],f.value=null):e.value===1&&(e.value=0,s.value==="categories"?(r.value=null,W.value=[]):n.value=null)}function I(g){const l=Be(g.id);window.open(l,"_blank")}function x(){s.value==="employees"&&d.value?M(d.value.tickets):s.value==="categories"&&n.value&&E(n.value.id)}return re(()=>t.isVisible,g=>{g||(e.value=0,s.value="categories",r.value=null,n.value=null,d.value=null,v.value=[],f.value=null,W.value=[],U.value=[])}),(g,l)=>a.isVisible?(_(),T("div",Do,[o("div",Eo,[e.value===0?(_(),T("div",Wo,[o("button",{class:K(["modal__tab",{"modal__tab--active":s.value==="categories"}]),onClick:l[0]||(l[0]=y=>D("categories"))}," –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º ",2),o("button",{class:K(["modal__tab",{"modal__tab--active":s.value==="employees"}]),onClick:l[1]||(l[1]=y=>D("employees"))}," –ü–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º ",2)])):Y("",!0),V(ee,{name:"level",mode:"out-in"},{default:Z(()=>{var y,N,L,H;return[s.value==="categories"&&e.value===0?(_(),T("div",Mo,[o("header",Io,[o("h3",Ao,[l[12]||(l[12]=te(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a.weekNumber?(_(),T("span",So," ¬∑ –ù–µ–¥–µ–ª—è "+S(a.weekNumber),1)):Y("",!0)]),o("button",{class:"modal__close",onClick:l[2]||(l[2]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",Bo,[o("ul",No,[(_(!0),T(q,null,X(P.value,A=>(_(),T("li",{key:A.id,class:K(["categories-list__item",{"categories-list__item--clickable":A.count>0}]),onClick:z=>c(A)},[o("div",xo,[o("div",Ro,[A.id==="created-this-week"?(_(),T("span",Oo,"‚úì")):(_(),T("span",Po,"‚Üª"))]),o("div",Lo,[o("div",Go,S(A.label),1),o("div",Fo,S(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),A.count>0?(_(),T("span",Vo,"‚Üí")):Y("",!0)])],10,Uo))),128))])]),o("footer",Ho,[o("button",{class:"btn",onClick:l[3]||(l[3]=A=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="categories"&&e.value===1?(_(),T("div",Yo,[o("header",zo,[o("button",{class:"btn-back",onClick:B,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),l[13]||(l[13]=o("h3",{class:"modal__title"},"–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),o("button",{class:"modal__close",onClick:l[4]||(l[4]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",jo,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>[G.value?(_(),T("div",qo,[...l[14]||(l[14]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):h.value?(_(),T("ul",Zo,[(_(!0),T(q,null,X(W.value,A=>(_(),T("li",{key:A.id||A.name,class:K(["responsible-list__item",{"responsible-list__item--clickable":A.id&&A.count>0}]),onClick:z=>w(A,z),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[o("span",Ko,S(A.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),o("span",Qo,S(A.count??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.id&&A.count>0?(_(),T("span",er,"‚Üí")):Y("",!0)],10,Jo))),128))])):(_(),T("p",Xo,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º"))]),_:1})]),o("footer",tr,[o("button",{class:"btn",onClick:l[5]||(l[5]=A=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="categories"&&e.value===2?(_(),T("div",sr,[o("header",ar,[o("button",{class:"btn-back",onClick:B,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o("h3",or,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+S(((y=n.value)==null?void 0:y.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),o("button",{class:"modal__close",onClick:l[6]||(l[6]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",rr,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>[k.value?(_(),T("div",nr,[...l[15]||(l[15]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(_(),T("div",lr,[l[16]||(l[16]=o("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),l[17]||(l[17]=o("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),o("p",ir,S(f.value),1),o("button",{class:"btn btn-retry",onClick:x},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(_(),T("div",dr,[...l[18]||(l[18]=[o("div",{class:"empty-state-icon"},"üìã",-1),o("p",{class:"empty-state-message"},"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é",-1)])])):(_(),T("div",cr,[V(De,{name:"ticket",tag:"div",class:"tickets-list"},{default:Z(()=>[(_(!0),T(q,null,X(v.value,(A,z)=>(_(),se(Ee,{key:A.id,ticket:A,draggable:!1,style:ne({"--ticket-index":z}),onClick:I},null,8,["ticket","style"]))),128))]),_:1})]))]),_:1})])])):s.value==="employees"&&e.value===0?(_(),T("div",ur,[o("header",hr,[o("h3",vr,[l[19]||(l[19]=te(" –ó–∞–∫—Ä—ã—Ç—ã–µ –∑–∞ –Ω–µ–¥–µ–ª—é",-1)),a.weekNumber?(_(),T("span",kr," ¬∑ –ù–µ–¥–µ–ª—è "+S(a.weekNumber),1)):Y("",!0)]),o("button",{class:"modal__close",onClick:l[7]||(l[7]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",mr,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>[G.value?(_(),T("div",yr,[...l[20]||(l[20]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∏–º—ë–Ω —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤...",-1)])])):p.value?(_(),T("ul",pr,[(_(!0),T(q,null,X(U.value,A=>(_(),T("li",{key:A.id||A.name,class:K(["responsible-list__item",{"responsible-list__item--clickable":A.id&&A.totalCount>0}]),onClick:z=>u(A,z),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≥—Ä–∞–¥–∞—Ü–∏–∏ —Ç–∏–∫–µ—Ç–æ–≤ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞"},[o("span",_r,S(A.name||"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω"),1),o("span",br,S(A.totalCount??0)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),A.id&&A.totalCount>0?(_(),T("span",wr,"‚Üí")):Y("",!0)],10,gr))),128))])):(_(),T("p",fr,"–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º"))]),_:1})]),o("footer",Tr,[o("button",{class:"btn",onClick:l[8]||(l[8]=A=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="employees"&&e.value===1?(_(),T("div",Cr,[o("header",$r,[o("button",{class:"btn-back",onClick:B,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o("h3",Dr,"–¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+S(((N=n.value)==null?void 0:N.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),o("button",{class:"modal__close",onClick:l[9]||(l[9]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",Er,[o("ul",Wr,[(_(!0),T(q,null,X(C.value,A=>(_(),T("li",{key:A.id,class:K(["categories-list__item",{"categories-list__item--clickable":A.count>0}]),onClick:z=>b(A)},[o("div",Ir,[o("div",Ar,[A.id==="this-week"?(_(),T("span",Sr,"‚úì")):(_(),T("span",Br,"‚Üª"))]),o("div",Nr,[o("div",Ur,S(A.label),1),o("div",xr,S(A.count)+" —Ç–∏–∫–µ—Ç–æ–≤",1)]),A.count>0?(_(),T("span",Rr,"‚Üí")):Y("",!0)])],10,Mr))),128))])]),o("footer",Or,[o("button",{class:"btn",onClick:l[10]||(l[10]=A=>g.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value==="employees"&&e.value===2?(_(),T("div",Pr,[o("header",Lr,[o("button",{class:"btn-back",onClick:B,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o("h3",Gr," –¢–∏–∫–µ—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞: "+S(((L=n.value)==null?void 0:L.name)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ")+" ("+S(((H=d.value)==null?void 0:H.label)||"")+") ",1),o("button",{class:"modal__close",onClick:l[11]||(l[11]=A=>g.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",Fr,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>{var A;return[k.value?(_(),T("div",Vr,[...l[21]||(l[21]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):f.value?(_(),T("div",Hr,[l[22]||(l[22]=o("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),l[23]||(l[23]=o("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),o("p",Yr,S(f.value),1),o("button",{class:"btn btn-retry",onClick:x},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):v.value.length===0?(_(),T("div",zr,[l[24]||(l[24]=o("div",{class:"empty-state-icon"},"üìã",-1)),o("p",jr,S(s.value==="employees"?`–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç —Ç–∏–∫–µ—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${((A=d.value)==null?void 0:A.label)||""}"`:"–£ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –Ω–µ—Ç –∑–∞–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é"),1)])):(_(),T("div",qr,[V(De,{name:"ticket",tag:"div",class:"tickets-list"},{default:Z(()=>[(_(!0),T(q,null,X(v.value,(z,j)=>(_(),se(Ee,{key:z.id,ticket:z,draggable:!1,style:ne({"--ticket-index":j}),onClick:I},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},Zr=ae(Xr,[["__scopeId","data-v-3b229bb4"]]),Jr={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Kr={class:"modal"},Qr={key:"level-1",class:"level-1"},en={class:"modal__header"},tn={class:"modal__title"},sn={key:0},an={class:"modal__body"},on={key:"loading",class:"loading-names"},rn={key:"empty",class:"modal__empty"},nn={key:"list",class:"stages-list"},ln=["onClick"],dn={class:"stages-list__name"},cn={class:"stages-list__count"},un={key:0,class:"stages-list__arrow"},hn={class:"modal__footer"},vn={key:"level-2",class:"level-2"},kn={class:"modal__header"},mn={class:"modal__title"},yn={class:"modal__body"},fn={key:"loading",class:"loading-state"},pn={key:"error",class:"error-state"},gn={class:"error-message"},_n={key:"empty",class:"empty-state"},bn={class:"empty-state-message"},wn={key:"tickets",class:"tickets-list-container"},Tn={__name:"StagesModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(a,{emit:t}){const e=a,s=O(1),r=O(null),n=O([]),d=O(!1),v=O(!1),k=O(null),f=O([]),W=F(()=>f.value.length>0&&f.value.some(m=>m.count>0));async function U(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}v.value=!0,k.value=null;try{const m=await ie({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0});f.value=m.data.newTicketsByStages||[]}catch(m){k.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞–¥–∏–π",console.error("[StagesModal] Error loading stages:",m),f.value=[]}finally{v.value=!1}}async function G(m,h=null){!m||m.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),r.value=m,s.value=2,await P(m.stageId))}async function P(m){var h;d.value=!0,k.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const c=(h=(await ie({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeNewTicketsByStages:!0,includeTickets:!0})).data.newTicketsByStages)==null?void 0:h.find(b=>b.stageId===m),u=(c==null?void 0:c.tickets)||[];try{const{prepareTicketsForDisplay:b}=await fe(async()=>{const{prepareTicketsForDisplay:M}=await import("./ticketListUtils-BHM22wDD.js").then(i=>i.t);return{prepareTicketsForDisplay:M}},__vite__mapDeps([0,1,2,3,4,5]));n.value=await b(u,null,null)}catch(b){console.error("[StagesModal] Error preparing tickets:",b),n.value=u}n.value.length===0&&(k.value=null)}catch(D){k.value=D.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[StagesModal] Error loading tickets:",D),n.value=[]}finally{d.value=!1}}function $(){s.value=1,r.value=null,n.value=[],k.value=null}function C(m){const h=Be(m.id);window.open(h,"_blank")}function p(){r.value&&P(r.value.stageId)}return re(()=>e.isVisible,m=>{m?U():(s.value=1,r.value=null,n.value=[],k.value=null,f.value=[])}),re([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&U()}),(m,h)=>a.isVisible?(_(),T("div",Jr,[o("div",Kr,[V(ee,{name:"level",mode:"out-in"},{default:Z(()=>{var D;return[s.value===1?(_(),T("div",Qr,[o("header",en,[o("h3",tn,[h[3]||(h[3]=te(" –ù–æ–≤—ã–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ç–∞–¥–∏—è–º",-1)),a.weekNumber?(_(),T("span",sn," ¬∑ –ù–µ–¥–µ–ª—è "+S(a.weekNumber),1)):Y("",!0)]),o("button",{class:"modal__close",onClick:h[0]||(h[0]=c=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",an,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>[v.value?(_(),T("div",on,[...h[4]||(h[4]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞–¥–∏–π...",-1)])])):W.value?(_(),T("ul",nn,[(_(!0),T(q,null,X(f.value,c=>(_(),T("li",{key:c.stageId,class:K(["stages-list__item",{"stages-list__item--clickable":c.count>0}]),style:ne({"--stage-color":c.color}),onClick:u=>G(c,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ —Å—Ç–∞–¥–∏–∏"},[o("span",{class:"stages-list__color",style:ne({backgroundColor:c.color})},null,4),o("span",dn,S(c.stageName),1),o("span",cn,S(c.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),c.count>0?(_(),T("span",un,"‚Üí")):Y("",!0)],14,ln))),128))])):(_(),T("p",rn," –ù–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),o("footer",hn,[o("button",{class:"btn",onClick:h[1]||(h[1]=c=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value===2?(_(),T("div",vn,[o("header",kn,[o("button",{class:"btn-back",onClick:$,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o("h3",mn," –¢–∏–∫–µ—Ç—ã —Å—Ç–∞–¥–∏–∏: "+S(((D=r.value)==null?void 0:D.stageName)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),o("button",{class:"modal__close",onClick:h[2]||(h[2]=c=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",yn,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>{var c;return[d.value?(_(),T("div",fn,[...h[5]||(h[5]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):k.value?(_(),T("div",pn,[h[6]||(h[6]=o("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=o("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),o("p",gn,S(k.value),1),o("button",{class:"btn btn-retry",onClick:p},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):n.value.length===0?(_(),T("div",_n,[h[8]||(h[8]=o("div",{class:"empty-state-icon"},"üìã",-1)),o("p",bn," –ù–∞ —Å—Ç–∞–¥–∏–∏ ¬´"+S((c=r.value)==null?void 0:c.stageName)+"¬ª –Ω–µ—Ç –Ω–æ–≤—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é ",1)])):(_(),T("div",wn,[V(De,{name:"ticket",tag:"div",class:"tickets-list"},{default:Z(()=>[(_(!0),T(q,null,X(n.value,(u,b)=>(_(),se(Ee,{key:u.id,ticket:u,draggable:!1,style:ne({"--ticket-index":b}),onClick:C},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},Cn=ae(Tn,[["__scopeId","data-v-4af0cfce"]]),$n={key:0,class:"modal-backdrop",role:"dialog","aria-modal":"true"},Dn={class:"modal"},En={key:"level-1",class:"level-1"},Wn={class:"modal__header"},Mn={class:"modal__title"},In={key:0},An={class:"modal__body"},Sn={key:"loading",class:"loading-names"},Bn={key:"empty",class:"modal__empty"},Nn={key:"list",class:"duration-list"},Un=["onClick"],xn={class:"duration-list__name"},Rn={class:"duration-list__count"},On={key:0,class:"duration-list__arrow"},Pn={class:"modal__footer"},Ln={key:"level-2",class:"level-2"},Gn={class:"modal__header"},Fn={class:"modal__title"},Vn={class:"modal__body"},Hn={key:"loading",class:"loading-state"},Yn={key:"error",class:"error-state"},zn={class:"error-message"},jn={key:"empty",class:"empty-state"},qn={class:"empty-state-message"},Xn={key:"tickets",class:"tickets-list-container"},Zn={__name:"CarryoverDurationModal",props:{isVisible:{type:Boolean,default:!1},weekNumber:{type:Number,default:null},weekStartUtc:{type:String,default:null},weekEndUtc:{type:String,default:null}},emits:["close"],setup(a,{emit:t}){const e=a,s=O(1),r=O(null),n=O([]),d=O(!1),v=O(!1),k=O(null),f=O([]),W=F(()=>f.value.length>0&&f.value.some(m=>m.count>0));async function U(){if(!e.weekStartUtc||!e.weekEndUtc){f.value=[];return}v.value=!0,k.value=null;try{const m=await ie({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0});f.value=m.data.carryoverTicketsByDuration||[]}catch(m){k.value=m.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π",console.error("[CarryoverDurationModal] Error loading categories:",m),f.value=[]}finally{v.value=!1}}async function G(m,h=null){!m||m.count===0||(h&&h.currentTarget&&(h.currentTarget.style.transform="scale(0.98)",setTimeout(()=>{h.currentTarget&&(h.currentTarget.style.transform="")},150)),r.value=m,s.value=2,await P(m.durationCategory))}async function P(m){var h;d.value=!0,k.value=null;try{if(!e.weekStartUtc||!e.weekEndUtc)throw new Error("–ù–µ —É–∫–∞–∑–∞–Ω—ã –≥—Ä–∞–Ω–∏—Ü—ã –Ω–µ–¥–µ–ª–∏");const c=(h=(await ie({product:"1C",weekStartUtc:e.weekStartUtc,weekEndUtc:e.weekEndUtc,includeCarryoverTickets:!0,includeCarryoverTicketsByDuration:!0,includeTickets:!0})).data.carryoverTicketsByDuration)==null?void 0:h.find(b=>b.durationCategory===m),u=(c==null?void 0:c.tickets)||[];try{const{prepareTicketsForDisplay:b}=await fe(async()=>{const{prepareTicketsForDisplay:M}=await import("./ticketListUtils-BHM22wDD.js").then(i=>i.t);return{prepareTicketsForDisplay:M}},__vite__mapDeps([0,1,2,3,4,5]));n.value=await b(u,null,null)}catch(b){console.error("[CarryoverDurationModal] Error preparing tickets:",b),n.value=u}n.value.length===0&&(k.value=null)}catch(D){k.value=D.message||"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∏–∫–µ—Ç–æ–≤",console.error("[CarryoverDurationModal] Error loading tickets:",D),n.value=[]}finally{d.value=!1}}function $(){s.value=1,r.value=null,n.value=[],k.value=null}function C(m){const h=Be(m.id);window.open(h,"_blank")}function p(){r.value&&P(r.value.durationCategory)}return re(()=>e.isVisible,m=>{m?U():(s.value=1,r.value=null,n.value=[],k.value=null,f.value=[])}),re([()=>e.weekStartUtc,()=>e.weekEndUtc],()=>{e.isVisible&&U()}),(m,h)=>a.isVisible?(_(),T("div",$n,[o("div",Dn,[V(ee,{name:"level",mode:"out-in"},{default:Z(()=>{var D;return[s.value===1?(_(),T("div",En,[o("header",Wn,[o("h3",Mn,[h[3]||(h[3]=te(" –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ —Ç–∏–∫–µ—Ç—ã –ø–æ —Å—Ä–æ–∫–∞–º",-1)),a.weekNumber?(_(),T("span",In," ¬∑ –ù–µ–¥–µ–ª—è "+S(a.weekNumber),1)):Y("",!0)]),o("button",{class:"modal__close",onClick:h[0]||(h[0]=c=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",An,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>[v.value?(_(),T("div",Sn,[...h[4]||(h[4]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...",-1)])])):W.value?(_(),T("ul",Nn,[(_(!0),T(q,null,X(f.value,c=>(_(),T("li",{key:c.durationCategory,class:K(["duration-list__item",{"duration-list__item--clickable":c.count>0}]),style:ne({"--duration-color":c.color}),onClick:u=>G(c,u),title:"–ö–ª–∏–∫–Ω–∏—Ç–µ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ç–∏–∫–µ—Ç–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"},[o("span",{class:"duration-list__color",style:ne({backgroundColor:c.color})},null,4),o("span",xn,S(c.durationLabel),1),o("span",Rn,S(c.count)+" —Ç–∏–∫–µ—Ç–æ–≤ ",1),c.count>0?(_(),T("span",On,"‚Üí")):Y("",!0)],14,Un))),128))])):(_(),T("p",Bn," –ù–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é "))]),_:1})]),o("footer",Pn,[o("button",{class:"btn",onClick:h[1]||(h[1]=c=>m.$emit("close"))},"–ó–∞–∫—Ä—ã—Ç—å")])])):s.value===2?(_(),T("div",Ln,[o("header",Gn,[o("button",{class:"btn-back",onClick:$,"aria-label":"–ù–∞–∑–∞–¥"},"‚Üê –ù–∞–∑–∞–¥"),o("h3",Fn," –¢–∏–∫–µ—Ç—ã: "+S(((D=r.value)==null?void 0:D.durationLabel)||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"),1),o("button",{class:"modal__close",onClick:h[2]||(h[2]=c=>m.$emit("close")),"aria-label":"–ó–∞–∫—Ä—ã—Ç—å"}," ‚úï ")]),o("section",Vn,[V(ee,{name:"loading",mode:"out-in"},{default:Z(()=>{var c;return[d.value?(_(),T("div",Hn,[...h[5]||(h[5]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–∏–∫–µ—Ç–æ–≤...",-1)])])):k.value?(_(),T("div",Yn,[h[6]||(h[6]=o("div",{class:"error-icon"},"‚ö†Ô∏è",-1)),h[7]||(h[7]=o("p",{class:"error-title"},"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",-1)),o("p",zn,S(k.value),1),o("button",{class:"btn btn-retry",onClick:p},"–ü–æ–≤—Ç–æ—Ä–∏—Ç—å")])):n.value.length===0?(_(),T("div",jn,[h[8]||(h[8]=o("div",{class:"empty-state-icon"},"üìã",-1)),o("p",qn," –í –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ¬´"+S((c=r.value)==null?void 0:c.durationLabel)+"¬ª –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö —Ç–∏–∫–µ—Ç–æ–≤ ",1)])):(_(),T("div",Xn,[V(De,{name:"ticket",tag:"div",class:"tickets-list"},{default:Z(()=>[(_(!0),T(q,null,X(n.value,(u,b)=>(_(),se(Ee,{key:u.id,ticket:u,draggable:!1,style:ne({"--ticket-index":b}),onClick:C},null,8,["ticket","style"]))),128))]),_:1})]))]}),_:1})])])):Y("",!0)]}),_:1})])])):Y("",!0)}},Jn=ae(Zn,[["__scopeId","data-v-c26f06c2"]]),Kn={class:"ac-dashboard"},Qn={key:"preloader",class:"chart-preloader"},el={class:"preloader-content"},tl={class:"preloader-message"},sl={key:"content"},al={key:1,class:"weeks-dashboard"},ol={class:"dashboard-header"},rl={class:"header-content"},nl={class:"breadcrumbs-row"},ll=["aria-label","aria-disabled","data-fallback","disabled"],il={class:"breadcrumbs","aria-label":"–ù–∞–≤–∏–≥–∞—Ü–∏—è"},dl={class:"dashboard-layout"},cl={class:"filters-container"},ul={class:"chart-container"},hl={__name:"GraphAdmissionClosureDashboard",setup(a){const t=et(),e=O(!1),s=O(null),r=O(null),n=O({newTickets:0,closedTickets:0,series:{new:[0],closed:[0]},stages:[],responsible:[]}),d=O(!1),v=O(!1),k=O(!1),f=O(!0),W=O(!1),U=F(()=>typeof window>"u"?!1:window.history.length>1),G=F(()=>U.value?"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É":"–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É"),P={name:"dashboard-sector-1c"};function $(l){var y;if((y=l==null?void 0:l.preventDefault)==null||y.call(l),!W.value){W.value=!0;try{if(U.value){t.back();return}console.warn("GraphAdmissionClosureDashboard: fallback navigation to dashboard-sector-1c"),t.push(P)}finally{W.value=!1}}}const C=O({stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}}),p=O("weeks"),m=F(()=>{const l=C.value.customDateRange.startDate||C.value.customDateRange.endDate,y=C.value.employees.length===1&&C.value.employees.includes("all");return l||!y});async function h(){if(console.log("[DEBUG] loadData called"),console.log("[DEBUG] periodMode:",p.value),console.log("[DEBUG] isLoading before:",e.value),p.value!=="weeks"){console.log("[DEBUG] loadData: periodMode is not weeks, returning and resetting isLoading"),e.value=!1;return}console.log("[DEBUG] Setting isLoading to true"),e.value=!0,s.value=null;const l=new Promise(y=>setTimeout(y,300));try{console.log("[DEBUG] Starting API call");const y=g(),N=y.weekStartUtc,L=y.weekEndUtc;console.log("[DEBUG] Week bounds:",{weekStartUtc:N,weekEndUtc:L});const[H,A]=await Promise.all([l,ie({product:"1C",periodMode:"weeks",weekStartUtc:N,weekEndUtc:L,includeTickets:!0})]);console.log("[DEBUG] API call successful, result:",A);const{meta:z,data:j}=A;r.value=z,n.value=j,console.log("[DEBUG] Data set, meta:",z,"data keys:",Object.keys(j))}catch(y){console.error("[DEBUG] API call failed:",y),s.value=y instanceof Error?y:new Error("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏"),console.error("[GraphAdmissionClosureDashboard] loadData error:",y)}finally{console.log("[DEBUG] Finally block: setting isLoading to false"),e.value=!1,console.log("[DEBUG] isLoading after:",e.value)}}function D(l){C.value.stages=l}function c(l){C.value.employees=l}function u(l){C.value.dateRange=l}function b(l){C.value.customDateRange=l}function M(l){if(!["weeks","months"].includes(l)){console.warn("[GraphAdmissionClosureDashboard] Invalid periodMode:",l);return}l!==p.value&&(p.value=l,h())}function i(l){const{mode:y}=l.detail;["weeks","months"].includes(y)&&M(y)}function w(){C.value={stages:{formed:!0,review:!0,execution:!0},employees:["all"],dateRange:"last-week",customDateRange:{startDate:null,endDate:null}},E()}function E(){h()}function B(l){["weeks","months"].includes(l)&&(p.value=l)}function I(){console.log("[DEBUG] handleCloseModal called"),console.log("[DEBUG] showPeriodModeInfo before:",f.value),console.log("[DEBUG] isLoading before:",e.value),console.log("[DEBUG] periodMode:",p.value),f.value=!1,e.value=!0,console.log("[DEBUG] showPeriodModeInfo after:",f.value),console.log("[DEBUG] isLoading after:",e.value),ze(()=>{console.log("[DEBUG] handleCloseModal: calling handleStartLoading in nextTick"),x()})}function x(){console.log("[DEBUG] handleStartLoading called"),console.log("[DEBUG] periodMode before check:",p.value),console.log("[DEBUG] showPeriodModeInfo:",f.value),console.log("[DEBUG] isLoading:",e.value),(!p.value||!["weeks","months"].includes(p.value))&&(console.warn('[GraphAdmissionClosureDashboard] Period mode not set, using default "weeks"'),p.value="weeks"),console.log("[GraphAdmissionClosureDashboard] Starting loading, periodMode:",p.value),ze(()=>{console.log("[DEBUG] nextTick callback, periodMode:",p.value),console.log("[DEBUG] isLoading in nextTick:",e.value),p.value==="weeks"?(console.log("[GraphAdmissionClosureDashboard] Loading data for weeks mode"),h()):p.value==="months"&&(console.log("[GraphAdmissionClosureDashboard] Months mode - data will be loaded by GraphAdmissionClosureMonthsDashboard"),e.value=!1,console.log("[DEBUG] Reset parent isLoading to false for months mode"))})}Se(()=>{try{const l="graph-admission-closure-period-mode-info-shown";localStorage.getItem(l)&&localStorage.removeItem(l);const y="graph-admission-closure-period-mode";localStorage.getItem(y)&&localStorage.removeItem(y)}catch(l){console.warn("[GraphAdmissionClosureDashboard] Failed to clean localStorage:",l)}window.addEventListener("period-mode-change",i)}),Je(()=>{window.removeEventListener("period-mode-change",i)});function g(){const l=new Date,y=new Date(Date.UTC(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate())),N=y.getUTCDay(),L=y.getUTCDate()-N+(N===0?-6:1),H=new Date(Date.UTC(y.getUTCFullYear(),y.getUTCMonth(),L,0,0,0)),A=new Date(H);return A.setUTCDate(A.getUTCDate()+6),A.setUTCHours(23,59,59,999),{weekStartUtc:H.toISOString(),weekEndUtc:A.toISOString()}}return(l,y)=>{var L,H,A,z,j,de,he,ve,ke;const N=tt("router-link");return _(),T("div",Kn,[V(ee,{name:"fade",mode:"out-in"},{default:Z(()=>[e.value?(_(),T("div",Qn,[o("div",el,[y[6]||(y[6]=o("div",{class:"preloader-spinner"},[o("div",{class:"spinner-ring"}),o("div",{class:"spinner-ring"}),o("div",{class:"spinner-ring"})],-1)),y[7]||(y[7]=o("h3",{class:"preloader-title"},"–ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞",-1)),o("p",tl," –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ "+S(p.value==="weeks"?"4 –Ω–µ–¥–µ–ª–∏":"3 –º–µ—Å—è—Ü–∞")+"... ",1),y[8]||(y[8]=o("div",{class:"preloader-dots"},[o("span",{class:"dot"}),o("span",{class:"dot"}),o("span",{class:"dot"})],-1))])])):!f.value&&!e.value?(_(),T("div",sl,[p.value==="months"?(_(),se($o,{key:0})):(_(),T("div",al,[o("div",ol,[o("div",rl,[o("div",nl,[o("button",{class:"btn-back-link",type:"button",onClick:$,"aria-label":G.value,"aria-disabled":!U.value,"data-fallback":!U.value,disabled:W.value,title:"–ù–∞–∑–∞–¥"}," ‚Üê ",8,ll),o("nav",il,[V(N,{to:{name:"dashboard-sector-1c"},class:"breadcrumb-link"},{default:Z(()=>[...y[9]||(y[9]=[te(" –î–∞—à–±–æ—Ä–¥ —Å–µ–∫—Ç–æ—Ä–∞ 1–° ",-1)])]),_:1}),y[11]||(y[11]=o("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),V(N,{to:{name:"dashboard-graph-state"},class:"breadcrumb-link"},{default:Z(()=>[...y[10]||(y[10]=[te(" –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è ",-1)])]),_:1}),y[12]||(y[12]=o("span",{class:"breadcrumb-separator","aria-hidden":"true"},"/",-1)),y[13]||(y[13]=o("span",{class:"breadcrumb-current"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π",-1))])]),y[14]||(y[14]=o("h1",{class:"dashboard-title"},"–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–∏—ë–º–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–π —Å–µ–∫—Ç–æ—Ä–∞ 1–°",-1)),y[15]||(y[15]=o("p",{class:"dashboard-subtitle"}," –î–æ—Å—Ç—É–ø—ã –∏ —Ñ–∏–ª—å—Ç—Ä—ã –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã ¬´–ì—Ä–∞—Ñ–∏–∫—É —Å–æ—Å—Ç–æ—è–Ω–∏—è¬ª, —Å–µ–ª–µ–∫—Ç–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫—Ä—ã—Ç. ",-1))])]),o("div",dl,[o("div",cl,[V(at,{stages:C.value.stages,employees:C.value.employees,dateRange:C.value.dateRange,customDateRange:C.value.customDateRange,hasActiveFilters:m.value,hideStages:!0,weekPickerMode:!1,showPeriodMode:!0,"period-mode":p.value,"onUpdate:stages":D,"onUpdate:employees":c,"onUpdate:dateRange":u,"onUpdate:customDateRange":b,"onUpdate:periodMode":M,onReset:w,onApply:E},null,8,["stages","employees","dateRange","customDateRange","hasActiveFilters","period-mode"])]),o("div",ul,[s.value?(_(),se(st,{key:0,type:"error",title:"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏",message:s.value.message},null,8,["message"])):(_(),se(ks,{key:1,meta:r.value,data:n.value,onOpenResponsible:y[0]||(y[0]=le=>d.value=!0),onOpenStages:y[1]||(y[1]=le=>v.value=!0),onOpenCarryover:y[2]||(y[2]=le=>k.value=!0)},null,8,["meta","data"]))])])]))])):Y("",!0)]),_:1}),V(Zr,{"is-visible":d.value,responsible:n.value.responsible||[],"closed-tickets-created-this-week":n.value.closedTicketsCreatedThisWeek??0,"closed-tickets-created-other-week":n.value.closedTicketsCreatedOtherWeek??0,"responsible-created-this-week":n.value.responsibleCreatedThisWeek||[],"responsible-created-other-week":n.value.responsibleCreatedOtherWeek||[],"week-number":((L=r.value)==null?void 0:L.weekNumber)||null,"week-start-utc":((H=r.value)==null?void 0:H.weekStartUtc)||null,"week-end-utc":((A=r.value)==null?void 0:A.weekEndUtc)||null,onClose:y[3]||(y[3]=le=>d.value=!1)},null,8,["is-visible","responsible","closed-tickets-created-this-week","closed-tickets-created-other-week","responsible-created-this-week","responsible-created-other-week","week-number","week-start-utc","week-end-utc"]),V(Cn,{"is-visible":v.value,"week-number":((z=r.value)==null?void 0:z.weekNumber)||null,"week-start-utc":((j=r.value)==null?void 0:j.weekStartUtc)||null,"week-end-utc":((de=r.value)==null?void 0:de.weekEndUtc)||null,onClose:y[4]||(y[4]=le=>v.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),V(Jn,{"is-visible":k.value,"week-number":((he=r.value)==null?void 0:he.weekNumber)||null,"week-start-utc":((ve=r.value)==null?void 0:ve.weekStartUtc)||null,"week-end-utc":((ke=r.value)==null?void 0:ke.weekEndUtc)||null,onClose:y[5]||(y[5]=le=>k.value=!1)},null,8,["is-visible","week-number","week-start-utc","week-end-utc"]),f.value?(_(),se(Ut,{key:0,"is-visible":f.value,"current-mode":p.value,onClose:I,onSelectMode:B},null,8,["is-visible","current-mode"])):Y("",!0)])}}},pl=ae(hl,[["__scopeId","data-v-6c4434cd"]]);export{pl as default};
