import{_ as V,g as B,c as i,a as T,d as O,b as u,t as _,l as g,o as b}from"./main-Csf6z4mr.js";const R={SECTOR_1C:366,SECTOR_HARDWARE:368,SECTOR_BITRIX24:369,SECTOR_PDM:367,KEEPER:1051},U=[R.SECTOR_1C,R.SECTOR_HARDWARE,R.SECTOR_BITRIX24,R.SECTOR_PDM];function Ct(t){return U.includes(t)}const F=140,m={FORMED:{name:"–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ",bitrixId:"DT140_12:UC_0VHWE2"},REVIEW:{name:"–†–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ –¢–ó",bitrixId:"DT140_12:PREPARATION"},EXECUTION:{name:"–ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ",bitrixId:"DT140_12:CLIENT"}},Et={"DT140_12:UC_0VHWE2":"formed","DT140_12:PREPARATION":"review","DT140_12:CLIENT":"execution"},Tt={formed:"DT140_12:UC_0VHWE2",review:"DT140_12:PREPARATION",execution:"DT140_12:CLIENT"};function gt(){return[m.FORMED.bitrixId,m.REVIEW.bitrixId,m.EXECUTION.bitrixId]}const z="https://bitrix24.kompo.by",K="servisdeskitotdel";function j(t){return`${z}/page/${K}/servisdesk/type/${F}/details/${t}/`}const l={TODAY:"today",YESTERDAY:"yesterday",THIS_WEEK:"this_week",LAST_WEEK:"last_week",MORE_THAN_TWO_WEEKS:"more_than_two_weeks",UP_TO_ONE_MONTH:"up_to_one_month",MORE_THAN_TWO_MONTHS:"more_than_two_months",MORE_THAN_HALF_YEAR:"more_than_half_year",MORE_THAN_YEAR:"more_than_year"},X={[l.TODAY]:{label:"–°–ï–ì–û–î–ù–Ø",color:"#28a745",backgroundColor:"#d4edda",textColor:"#155724"},[l.YESTERDAY]:{label:"–í–ß–ï–†–ê",color:"#20c997",backgroundColor:"#d1f2eb",textColor:"#0c5460"},[l.THIS_WEEK]:{label:"–ù–ê –≠–¢–û–ô –ù–ï–î–ï–õ–ï",color:"#17a2b8",backgroundColor:"#d1ecf1",textColor:"#0c5460"},[l.LAST_WEEK]:{label:"–ù–ê –ü–†–û–®–õ–û–ô –ù–ï–î–ï–õ–ï",color:"#ffc107",backgroundColor:"#fff3cd",textColor:"#856404"},[l.MORE_THAN_TWO_WEEKS]:{label:"–ë–û–õ–ï–ï –î–í–£–• –ù–ï–î–ï–õ–¨",color:"#fd7e14",backgroundColor:"#ffe5d0",textColor:"#7d3f00"},[l.UP_TO_ONE_MONTH]:{label:"–î–û 1 –ú–ï–°–Ø–¶–ê",color:"#dc3545",backgroundColor:"#f8d7da",textColor:"#721c24"},[l.MORE_THAN_TWO_MONTHS]:{label:"–ë–û–õ–ï–ï 2 –ú–ï–°–Ø–¶–ï–í",color:"#6c757d",backgroundColor:"#e2e3e5",textColor:"#383d41"},[l.MORE_THAN_HALF_YEAR]:{label:"–ë–û–õ–ï–ï –ü–û–õ–£–ì–û–î–ê",color:"#6c757d",backgroundColor:"#d6d8db",textColor:"#212529"},[l.MORE_THAN_YEAR]:{label:"–ë–û–õ–ï–ï –ì–û–î–ê",color:"#343a40",backgroundColor:"#c6c8ca",textColor:"#000000"}};function v(t){if(!t)return null;const e=String(t).trim();if(e.length===0)return null;try{const r=new Date(e);return isNaN(r.getTime())?(console.warn("Invalid date format:",t),null):r}catch(r){return console.error("Error parsing date:",t,r),null}}function y(t){if(!t)return"";let e;if(t instanceof Date?e=t:e=new Date(t),isNaN(e.getTime()))return"";const r=e.getDate(),o=e.getMonth()+1,c=e.getFullYear(),d=String(r).padStart(2,"0"),s=String(o).padStart(2,"0"),n=String(c);return`${d}.${s}.${n}`}function G(t,e=new Date){if(!t)return"";const r=t instanceof Date?t:new Date(t),o=e instanceof Date?e:new Date(e);if(isNaN(r.getTime())||isNaN(o.getTime()))return y(r);const c=new Date(r.getFullYear(),r.getMonth(),r.getDate()),s=new Date(o.getFullYear(),o.getMonth(),o.getDate())-c,n=Math.floor(s/(1e3*60*60*24));return n===0?"–°–µ–≥–æ–¥–Ω—è":y(r)}function p(t,e=new Date){if(!t)return l.MORE_THAN_YEAR;const r=t instanceof Date?t:new Date(t),o=e instanceof Date?e:new Date(e);if(isNaN(r.getTime())||isNaN(o.getTime()))return l.MORE_THAN_YEAR;const c=new Date(r.getFullYear(),r.getMonth(),r.getDate()),d=new Date(o.getFullYear(),o.getMonth(),o.getDate()),s=d-c;if(s<0)return l.TODAY;const n=Math.floor(s/(1e3*60*60*24)),A=Math.floor(n/7),C=Math.floor(n/30),I=Math.floor(n/365);if(n===0)return l.TODAY;if(n===1)return l.YESTERDAY;const f=new Date(d),k=d.getDay(),N=k===0?6:k-1;if(f.setDate(d.getDate()-N),f.setHours(0,0,0,0),c>=f&&n<7)return l.THIS_WEEK;const D=new Date(f);return D.setDate(f.getDate()-7),c>=D&&c<f?l.LAST_WEEK:A>=2&&C<1?l.MORE_THAN_TWO_WEEKS:C>=1&&C<2?l.UP_TO_ONE_MONTH:C>=2&&C<6?l.MORE_THAN_TWO_MONTHS:C>=6&&I<1?l.MORE_THAN_HALF_YEAR:l.MORE_THAN_YEAR}const q={name:"TicketCard",props:{ticket:{type:Object,required:!0},draggable:{type:Boolean,default:!0}},emits:["click","drag-start","drag-end"],setup(t,{emit:e}){const r=B(!1),o=i(()=>!1),c={color:"#ced4da",backgroundColor:"#f1f3f5",textColor:"#6c757d"},d={color:"#ced4da",backgroundColor:"#f8f9fa",textColor:"#6c757d"},s={color:"#dee2e6",backgroundColor:"#f8f9fa",textColor:"#6c757d"},n=i(()=>({label:t.ticket.priorityLabel||"–ù–µ —É–∫–∞–∑–∞–Ω–æ",colors:t.ticket.priorityColors||c})),A=i(()=>n.value.label||"–ù–µ —É–∫–∞–∑–∞–Ω–æ"),C=i(()=>({color:n.value.colors.textColor||c.textColor,backgroundColor:n.value.colors.backgroundColor||c.backgroundColor,borderColor:n.value.colors.color||c.color})),I=i(()=>({borderLeftColor:n.value.colors.color||c.color})),f=i(()=>{const a=t.ticket.service||{};return{label:a.label||t.ticket.serviceLabel||"–ù–µ —É–∫–∞–∑–∞–Ω–æ",colors:a.colors||t.ticket.serviceColors||d}}),k=i(()=>f.value.label||"–ù–µ —É–∫–∞–∑–∞–Ω–æ"),N=i(()=>({color:f.value.colors.textColor||d.textColor,backgroundColor:f.value.colors.backgroundColor||d.backgroundColor,borderColor:f.value.colors.color||d.color})),D=i(()=>{const a=t.ticket.actionStr||t.ticket.ufActionStr||null;if(!a)return null;const S=String(a).trim();return S.length>0?S:null}),L=i(()=>({color:s.textColor,backgroundColor:s.backgroundColor,borderColor:s.color})),P=i(()=>{if(!t.ticket.createdAt)return"";const a=v(t.ticket.createdAt);return a?G(a):""}),x=i(()=>{if(!t.ticket.createdAt)return null;const a=v(t.ticket.createdAt);return p(a)}),h=i(()=>{const a=x.value;return a&&X[a]||null}),W=i(()=>{const a=h.value;return a?{color:a.textColor,backgroundColor:a.backgroundColor,borderColor:a.color,border:`1px solid ${a.color}`}:{}});return{handleDragStart:a=>{o.value&&(a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("application/json",JSON.stringify(t.ticket)),a.dataTransfer.setDragImage(a.target,0,0),r.value=!0,e("drag-start",t.ticket))},handleDragEnd:()=>{o.value&&(r.value=!1,e("drag-end"))},handleCardClick:a=>{if(r.value)return;const S=j(t.ticket.id);window.open(S,"_blank"),e("click",t.ticket)},isDragEnabled:o,priorityChipStyle:C,displayPriorityLabel:A,priorityBorderStyle:I,displayServiceLabel:k,serviceChipStyle:N,actionStrValue:D,actionChipStyle:L,formattedCreatedDate:P,dateAccentCategory:x,dateAccentConfig:h,dateAccentStyle:W}}},J=["draggable"],Q={key:0,class:"ticket-department"},Z={class:"ticket-header"},$={class:"ticket-id"},tt={class:"ticket-title"},et={class:"ticket-meta"},ot={key:1,class:"ticket-action"},rt={key:2,class:"ticket-description"},at={class:"ticket-date-label"},nt={class:"ticket-date-value"};function lt(t,e,r,o,c,d){var s;return b(),T("div",{class:"ticket-card",draggable:o.isDragEnabled,style:g(o.priorityBorderStyle),onClick:e[0]||(e[0]=(...n)=>o.handleCardClick&&o.handleCardClick(...n)),onDragstart:e[1]||(e[1]=(...n)=>o.handleDragStart&&o.handleDragStart(...n)),onDragend:e[2]||(e[2]=(...n)=>o.handleDragEnd&&o.handleDragEnd(...n))},[r.ticket.departmentHead?(b(),T("div",Q,_(r.ticket.departmentHead),1)):O("",!0),u("div",Z,[e[3]||(e[3]=u("span",{class:"ticket-icon"},"üé´",-1)),u("span",$,"#"+_(r.ticket.id),1)]),u("div",tt,_(r.ticket.ufSubject||r.ticket.title||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"),1),u("div",et,[u("span",{class:"ticket-priority",style:g(o.priorityChipStyle)},_(o.displayPriorityLabel),5),u("span",{class:"ticket-service",style:g(o.serviceChipStyle)},_(o.displayServiceLabel),5)]),o.actionStrValue?(b(),T("div",ot,[u("span",{class:"ticket-action-chip",style:g(o.actionChipStyle)},_(o.actionStrValue),5)])):O("",!0),r.ticket.description?(b(),T("div",rt,_(r.ticket.description),1)):O("",!0),o.formattedCreatedDate?(b(),T("div",{key:3,class:"ticket-created-date",style:g(o.dateAccentStyle)},[u("span",at,_(((s=o.dateAccentConfig)==null?void 0:s.label)||""),1),u("span",nt,_(o.formattedCreatedDate),1)],4)):O("",!0)],44,J)}const bt=V(q,[["render",lt],["__scopeId","data-v-9cda001c"]]);function M(t){return t==null?null:String(t).trim().toLowerCase()||null}const H=[{id:"general",label:"–ì–µ–Ω–µ—Ä–∞–ª—å—Å–∫–∏–π",bitrixValue:"–ì–µ–Ω–µ—Ä–∞–ª—å—Å–∫–∏–π",color:"#6f42c1",backgroundColor:"#f4edfd",textColor:"#3a275f",order:1,description:"–í—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–≥–µ–Ω–µ—Ä–∞–ª—å—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)"},{id:"external",label:"–í–Ω–µ—à–Ω–∏–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞",bitrixValue:"–í–Ω–µ—à–Ω–∏–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞",color:"#d63384",backgroundColor:"#fce8f3",textColor:"#8a1c56",order:2,description:"–í–Ω–µ—à–Ω–∏–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞/–±–ª–æ–∫–µ—Ä—ã"},{id:"board",label:"–ó–∞–¥–∞—á–∏ –ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤",bitrixValue:"–ó–∞–¥–∞—á–∏ –ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤",color:"#0d6efd",backgroundColor:"#e7f1ff",textColor:"#0a58ca",order:3,description:"–ó–∞–¥–∞—á–∏ –ø—Ä–∞–≤–ª–µ–Ω–∏—è / —Å–æ–≤–µ—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤"},{id:"errors",label:"–û—à–∏–±–∫–∏/—Å–±–æ–∏",bitrixValue:"–û—à–∏–±–∫–∏/—Å–±–æ–∏",color:"#dc3545",backgroundColor:"#fdecef",textColor:"#8c1b29",order:4,description:"–ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã, –æ—à–∏–±–∫–∏ –∏ —Å–±–æ–∏"},{id:"operations",label:"–¢–µ–∫—É—â–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å",bitrixValue:"–¢–µ–∫—É—â–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å",color:"#6c757d",backgroundColor:"#f1f3f5",textColor:"#343a40",order:5,description:"–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å"},{id:"projects",label:"–ü—Ä–æ–µ–∫—Ç—ã",bitrixValue:"–ü—Ä–æ–µ–∫—Ç—ã",color:"#198754",backgroundColor:"#e9f6ef",textColor:"#0f5132",order:6,description:"–ü—Ä–æ–µ–∫—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏"},{id:"optimization",label:"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è",bitrixValue:"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è",color:"#ffc107",backgroundColor:"#fff8e1",textColor:"#8c6d1f",order:7,description:"–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è"}],E={id:"unknown",label:"–ù–µ —É–∫–∞–∑–∞–Ω–æ",bitrixValue:null,color:"#ced4da",backgroundColor:"#f1f3f5",textColor:"#6c757d",order:99,description:"Fallback –¥–ª—è –ø—É—Å—Ç—ã—Ö/–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π"},kt=E.id,Y={},w={};[...H,E].forEach(t=>{Y[t.id]=t;const e=M(t.bitrixValue);e&&(w[e]=t)});function ct(t){if(!t)return E;const e=String(t).trim();return Y[e]||E}function it(t){const e=M(t);if(!e)return E;const r=w[e];return r||E}function dt(){return[...H,E].sort((t,e)=>t.order-e.order)}function Dt(t){if(t&&typeof t=="object"&&t.color)return{color:t.color,backgroundColor:t.backgroundColor,textColor:t.textColor};const e=ct(t)||it(t)||E;return{color:e.color,backgroundColor:e.backgroundColor,textColor:e.textColor}}dt();export{kt as D,F as E,m as S,bt as T,Dt as a,ct as b,j as c,Tt as d,R as e,l as f,it as g,X as h,Ct as i,p as j,gt as k,Et as l};
