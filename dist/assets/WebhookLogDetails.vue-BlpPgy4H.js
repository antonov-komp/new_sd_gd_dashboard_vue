import{h as w,i as N,o as q}from"./chunk-zzKzT0er.js";import{a as G,b as H}from"./chunk-5KLkf_eP.js";import{_ as Q}from"./chunk-CCQQUMtL.js";import{a as r,b as f,o as l,d as e,t as c,F as z,f as F,i as W,r as S,c as m,M as $}from"./chunk-IDUYkvJI.js";import"./chunk-BLNkvvQZ.js";import"./chunk-CEPkt3e7.js";import"./chunk-CYuVzfAf.js";import"./chunk-DLgBCjTL.js";import"./chunk-C7JhVT7I.js";const tt={name:"WebhookLogDetails",props:{log:{type:Object,default:null}},emits:["close"],setup(h,{emit:a}){const g=S(!1),o=S(null),C=S(!1),_=S(!1),s=5e4,y=2e5,n=m(()=>{if(!h.log)return null;const t=w(h.log);return N(t)?t:(console.error("[WebhookLogDetails] Invalid log entry:",h.log),null)}),B=m(()=>!n.value||!n.value.details?null:q(n.value.details)?n.value.details:(console.warn("[WebhookLogDetails] Invalid event details:",n.value.details),null)),L=m(()=>M.value>y),A=m(()=>P.value>y),D=async t=>{g.value=!1,o.value=null;try{if(!navigator.clipboard)throw new Error("Clipboard API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è");await navigator.clipboard.writeText(t),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch(d){console.error("Failed to copy:",d),o.value=d.message;try{const i=document.createElement("textarea");i.value=t,i.style.position="fixed",i.style.left="-999999px",document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch{o.value="–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å"}}},O=()=>{if(!(!n.value||!n.value.payload))try{const t=JSON.stringify(n.value.payload,null,2);D(t)}catch(t){console.error("[WebhookLogDetails] Error copying payload:",t),o.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ payload"}},T=(t,d)=>{try{const i=`${t}: ${typeof d=="object"?p(d,2):d}`;D(i)}catch(i){console.error("[WebhookLogDetails] Error copying field:",i),o.value="–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—è"}},J=m(()=>{if(!n.value)return{};const t=n.value;return{timestamp:t.timestamp,event:t.event,category:t.category,ip:t.ip||"N/A"}}),j=t=>t?H(t,"long"):"‚Äî",x=t=>t?G(t):"‚Äî",V=t=>`category-${t}`,X=t=>t?.startsWith("ONTASK")?"event-task":t?.startsWith("ONCRMDYNAMIC")?"event-smart-process":"event-other",Y=t=>({timestamp:"–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è",event:"–¢–∏–ø —Å–æ–±—ã—Ç–∏—è",category:"–ö–∞—Ç–µ–≥–æ—Ä–∏—è",ip:"IP –∞–¥—Ä–µ—Å",task_id:"ID –∑–∞–¥–∞—á–∏",task_title:"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",entity_id:"ID —Å—É—â–Ω–æ—Å—Ç–∏",title:"–ù–∞–∑–≤–∞–Ω–∏–µ",comment_text:"–¢–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è"})[t]||t.charAt(0).toUpperCase()+t.slice(1).replace(/_/g," "),Z=t=>{if(t==null)return"N/A";if(typeof t=="boolean")return t?"–î–∞":"–ù–µ—Ç";if(typeof t=="object"){if(Array.isArray(t))return t.length===0?"–ü—É—Å—Ç–æ":t.join(", ");try{return p(t,2)}catch{return"[–ù–µ —É–¥–∞–ª–æ—Å—å —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å]"}}return String(t)},E=new WeakMap,p=(t,d=2)=>{const i=new WeakSet;return JSON.stringify(t,(v,u)=>{if(typeof u=="object"&&u!==null){if(i.has(u))return"[Circular]";i.add(u)}return u},d)},I=(t,d=null,i=!1)=>{if(!t)return"N/A";try{if(E.has(t)&&!i){const k=E.get(t);if(k.maxSize===d&&k.showFull===i)return k.result}const v=p(t,2),u=new Blob([v]).size;let b;return d&&u>d&&!i?b=v.substring(0,d)+`

... [JSON –æ–±—Ä–µ–∑–∞–Ω, –Ω–∞–∂–º–∏—Ç–µ "–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é" –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞]`:b=v,u<1e5&&E.set(t,{result:b,maxSize:d,showFull:i,size:u}),b}catch(v){return console.error("[WebhookLogDetails] Error formatting JSON:",v),`[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON: ${v.message}]`}},M=m(()=>{if(!n.value||!n.value.payload)return 0;try{const t=JSON.stringify(n.value.payload);return new Blob([t]).size}catch(t){return console.error("[WebhookLogDetails] Error calculating payload size:",t),0}}),P=m(()=>{if(!n.value?.metadata)return 0;try{const t=p(n.value.metadata);return new Blob([t]).size}catch(t){return console.warn("[WebhookLogDetails] Error calculating metadata size:",t),0}}),K=m(()=>{if(!n.value||!n.value.payload)return"{}";if(L.value)return"";try{return JSON.stringify(n.value.payload,null,2)}catch(t){return console.error("[WebhookLogDetails] Error formatting payload:",t),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è]"}}),R=m(()=>{if(!n.value?.metadata)return"N/A";if(A.value)return"";try{return I(n.value.metadata,_.value?null:s,_.value)}catch(t){return console.error("[WebhookLogDetails] Error formatting metadata:",t),"[–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è metadata]"}}),U=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`;return $(()=>h.log,t=>{if(C.value=!1,_.value=!1,t){const d=w(t);N(d)||console.error("[WebhookLogDetails] Invalid log entry received:",t)}},{immediate:!0}),{validatedLog:n,validatedDetails:B,copySuccess:g,copyError:o,copyToClipboard:D,copyFullPayload:O,copyField:T,mainInfo:J,formatTimestamp:j,getCategoryLabel:x,getCategoryClass:V,getEventClass:X,formatKey:Y,formatValue:Z,formatJson:I,formattedPayload:K,formattedMetadata:R,payloadSize:M,metadataSize:P,showFullPayload:C,showFullMetadata:_,MAX_DISPLAY_SIZE:s,isPayloadTooLarge:L,isMetadataTooLarge:A,formatBytes:U,handleClose:()=>{a("close")}}}},ot={key:0,class:"webhook-log-details"},et={class:"details-header"},at={class:"header-actions"},st={class:"details-content"},nt={key:0,class:"copy-success-message"},rt={key:1,class:"copy-error-message"},lt={class:"details-section"},it={class:"info-grid"},dt={class:"info-value-wrapper"},ct={key:0},yt={key:1},ut={key:2},ft={key:3},mt=["onClick"],gt={key:2,class:"details-section"},vt={class:"info-grid"},ht={class:"details-section"},_t={class:"section-header"},pt={class:"section-actions"},bt={key:0,class:"size-warning"},kt={class:"json-container"},St={key:0,class:"json-content"},Ct={key:1,class:"payload-too-large"},Dt={key:3,class:"details-section"},Et={class:"section-header"},Lt={class:"section-actions"},At={key:0,class:"size-warning"},It={class:"json-container"},Mt={key:0,class:"json-content"},Pt={key:1,class:"payload-too-large"},wt={class:"details-footer"};function Nt(h,a,g,o,C,_){return o.validatedLog?(l(),r("div",ot,[e("div",et,[a[7]||(a[7]=e("h3",null,"–î–µ—Ç–∞–ª–∏ –ª–æ–≥–∞ –≤–µ–±—Ö—É–∫–∞",-1)),e("div",at,[e("button",{onClick:a[0]||(a[0]=(...s)=>o.copyFullPayload&&o.copyFullPayload(...s)),class:"btn-copy",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å JSON "),e("button",{onClick:a[1]||(a[1]=(...s)=>o.handleClose&&o.handleClose(...s)),class:"btn-close"},"√ó")])]),e("div",st,[o.copySuccess?(l(),r("div",nt," ‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! ")):f("",!0),o.copyError?(l(),r("div",rt," ‚ùå "+c(o.copyError),1)):f("",!0),e("div",lt,[a[8]||(a[8]=e("h4",null,"–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è",-1)),e("div",it,[(l(!0),r(z,null,F(o.mainInfo,(s,y)=>(l(),r("div",{key:y,class:"info-item"},[e("label",null,c(o.formatKey(y))+":",1),e("div",dt,[y==="event"?(l(),r("span",ct,[e("span",{class:W(["event-badge",o.getEventClass(s)])},c(s),3)])):y==="category"?(l(),r("span",yt,[e("span",{class:W(["category-badge",o.getCategoryClass(s)])},c(o.getCategoryLabel(s)),3)])):y==="timestamp"?(l(),r("span",ut,c(o.formatTimestamp(s)),1)):(l(),r("span",ft,c(s||"N/A"),1)),e("button",{onClick:n=>o.copyField(y,s),class:"btn-copy-field",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ"}," üìã ",8,mt)])]))),128))])]),o.validatedDetails&&Object.keys(o.validatedDetails).length>0?(l(),r("div",gt,[a[9]||(a[9]=e("h4",null,"–î–µ—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è",-1)),e("div",vt,[(l(!0),r(z,null,F(o.validatedDetails,(s,y)=>(l(),r("div",{key:y,class:"info-item"},[e("label",null,c(o.formatKey(y))+":",1),e("span",null,c(o.formatValue(s)),1)]))),128))])])):f("",!0),e("div",ht,[e("div",_t,[a[10]||(a[10]=e("h4",null,"–ü–æ–ª–Ω—ã–π payload",-1)),e("div",pt,[o.payloadSize>o.MAX_DISPLAY_SIZE?(l(),r("span",bt," –ë–æ–ª—å—à–æ–π JSON ("+c(o.formatBytes(o.payloadSize))+") ",1)):f("",!0),o.payloadSize>o.MAX_DISPLAY_SIZE&&!o.showFullPayload?(l(),r("button",{key:1,onClick:a[2]||(a[2]=s=>o.showFullPayload=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):f("",!0),e("button",{onClick:a[3]||(a[3]=(...s)=>o.copyFullPayload&&o.copyFullPayload(...s)),class:"btn-copy-section",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å payload"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å ")])]),e("div",kt,[o.isPayloadTooLarge?(l(),r("div",Ct,[e("p",null,"‚ö†Ô∏è Payload —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+c(o.formatBytes(o.payloadSize))+")",1),a[11]||(a[11]=e("p",null,'–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É "–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏.',-1)),e("button",{onClick:a[4]||(a[4]=(...s)=>o.copyFullPayload&&o.copyFullPayload(...s)),class:"btn-copy-section"}," üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å payload ")])):(l(),r("pre",St,c(o.formattedPayload),1))])]),g.log.metadata?(l(),r("div",Dt,[e("div",Et,[a[12]||(a[12]=e("h4",null,"–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ",-1)),e("div",Lt,[o.metadataSize>o.MAX_DISPLAY_SIZE?(l(),r("span",At," –ë–æ–ª—å—à–æ–π JSON ("+c(o.formatBytes(o.metadataSize))+") ",1)):f("",!0),o.metadataSize>o.MAX_DISPLAY_SIZE&&!o.showFullMetadata?(l(),r("button",{key:1,onClick:a[5]||(a[5]=s=>o.showFullMetadata=!0),class:"btn-show-more"}," –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é ")):f("",!0)])]),e("div",It,[o.isMetadataTooLarge?(l(),r("div",Pt,[e("p",null,"‚ö†Ô∏è Metadata —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è ("+c(o.formatBytes(o.metadataSize))+")",1),a[13]||(a[13]=e("p",null,"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.",-1))])):(l(),r("pre",Mt,c(o.formattedMetadata),1))])])):f("",!0)]),e("div",wt,[e("button",{onClick:a[6]||(a[6]=(...s)=>o.handleClose&&o.handleClose(...s)),class:"btn-close-details"},"–ó–∞–∫—Ä—ã—Ç—å")])])):f("",!0)}const Xt=Q(tt,[["render",Nt],["__scopeId","data-v-59ae6997"]]);export{Xt as default};
