import{c as d,o as p,e as s,b as x,t as u,q as m,i as n,v as f,s as y,F as v,j as k,k as c}from"./chunk-I0uP6mPC.js";import{_ as g}from"./main-C9zzQH-_.js";import"./chunk-9iq4XG5J.js";import"./chunk-YawslCp9.js";import"./chunk-C85b5Dwb.js";const F={name:"ExportModal",emits:["close","export"],props:{dataType:{type:String,default:"users"},filters:{type:Object,default:()=>({})},selectedUsers:{type:Array,default:()=>[]}},data(){return{exportFormat:"csv",exportData:["basic","activity"]}},computed:{appliedFilters(){return Object.fromEntries(Object.entries(this.filters).filter(([o,t])=>t!==""&&t!==null&&t!==void 0&&(Array.isArray(t)?t.length>0:!0)))},canExport(){return this.exportData.length>0},estimatedFileSize(){const o=this.dataType==="users"?this.selectedUsers.length||100:1,t=this.exportData.length,l=this.exportFormat==="json"?1.5:1,i=Math.round(o*t*l*.1);return i<1?"< 1 KB":i<1024?`${i} KB`:`${Math.round(i/1024)} MB`},estimatedTime(){const o=this.dataType==="users"?(this.selectedUsers.length||100)*.01:.1,t=this.exportData.length,l=o*t;return l<1?"< 1 сек":l<60?`${Math.round(l)} сек`:`${Math.round(l/60)} мин`}},methods:{getFilterLabel(o){return{search:"Поиск",department_ids:"Отделы",activity_filter:"Активность",time_range:"Период",sort_by:"Сортировка",sort_order:"Порядок"}[o]||o},formatFilterValue(o,t){if(Array.isArray(t))return t.length>3?`${t.length} выбрано`:t.join(", ");const l={activity_filter:i=>({all:"Все",active:"Активные",inactive:"Неактивные",new:"Новые"})[i]||i,time_range:i=>({today:"Сегодня",week:"Неделя",month:"Месяц",quarter:"Квартал",year:"Год"})[i]||i,sort_order:i=>i==="asc"?"По возрастанию":"По убыванию"};return l[o]?l[o](t):t},startExport(){const o={format:this.exportFormat,data:this.exportData,filters:this.appliedFilters,dataType:this.dataType,selectedUsers:this.selectedUsers};this.$emit("export",o)}}},D={class:"modal-header"},U={class:"modal-body"},M={class:"export-summary"},T={key:0,class:"summary-item"},V={class:"summary-value"},E={key:1,class:"summary-item"},h={class:"summary-value"},C={class:"export-options"},j={class:"option-group"},S={class:"format-options"},B={class:"format-option"},_={class:"format-option"},A={class:"format-option"},w={class:"option-group"},z={class:"data-options"},N={class:"data-option"},O={class:"data-option"},L={class:"data-option"},q={key:0,class:"data-option"},K={key:0,class:"option-group"},I={class:"filter-summary"},J={class:"filter-key"},R={class:"filter-value"},G={class:"export-estimation"},H={class:"estimation-item"},P={class:"estimation-value"},Q={class:"estimation-item"},W={class:"estimation-value"},X={class:"modal-footer"},Y=["disabled"];function Z(o,t,l,i,r,a){return p(),d("div",{class:"modal-overlay",onClick:t[11]||(t[11]=e=>o.$emit("close"))},[s("div",{class:"modal-content",onClick:t[10]||(t[10]=c(()=>{},["stop"]))},[s("div",D,[t[12]||(t[12]=s("h3",null,"Экспорт данных",-1)),s("button",{onClick:t[0]||(t[0]=e=>o.$emit("close")),class:"close-btn"},"×")]),s("div",U,[s("div",M,[l.dataType==="users"?(p(),d("div",T,[t[13]||(t[13]=s("span",{class:"summary-label"},"Пользователей для экспорта:",-1)),s("span",V,u(l.selectedUsers.length||"все"),1)])):x("",!0),l.dataType==="user"?(p(),d("div",E,[t[14]||(t[14]=s("span",{class:"summary-label"},"Пользователь:",-1)),s("span",h,u(l.selectedUsers[0]?.name||"не выбран"),1)])):x("",!0)]),s("div",C,[s("div",j,[t[21]||(t[21]=s("label",{class:"option-label"},"Формат экспорта:",-1)),s("div",S,[s("label",B,[m(s("input",{type:"radio",value:"csv","onUpdate:modelValue":t[1]||(t[1]=e=>r.exportFormat=e)},null,512),[[f,r.exportFormat]]),t[15]||(t[15]=s("span",{class:"checkmark"},null,-1)),t[16]||(t[16]=n(" CSV (Excel) ",-1))]),s("label",_,[m(s("input",{type:"radio",value:"xlsx","onUpdate:modelValue":t[2]||(t[2]=e=>r.exportFormat=e)},null,512),[[f,r.exportFormat]]),t[17]||(t[17]=s("span",{class:"checkmark"},null,-1)),t[18]||(t[18]=n(" Excel (.xlsx) ",-1))]),s("label",A,[m(s("input",{type:"radio",value:"json","onUpdate:modelValue":t[3]||(t[3]=e=>r.exportFormat=e)},null,512),[[f,r.exportFormat]]),t[19]||(t[19]=s("span",{class:"checkmark"},null,-1)),t[20]||(t[20]=n(" JSON ",-1))])])]),s("div",w,[t[30]||(t[30]=s("label",{class:"option-label"},"Что экспортировать:",-1)),s("div",z,[s("label",N,[m(s("input",{type:"checkbox",value:"basic","onUpdate:modelValue":t[4]||(t[4]=e=>r.exportData=e)},null,512),[[y,r.exportData]]),t[22]||(t[22]=s("span",{class:"checkmark"},null,-1)),t[23]||(t[23]=n(" Основная информация ",-1))]),s("label",O,[m(s("input",{type:"checkbox",value:"activity","onUpdate:modelValue":t[5]||(t[5]=e=>r.exportData=e)},null,512),[[y,r.exportData]]),t[24]||(t[24]=s("span",{class:"checkmark"},null,-1)),t[25]||(t[25]=n(" Статистика активности ",-1))]),s("label",L,[m(s("input",{type:"checkbox",value:"permissions","onUpdate:modelValue":t[6]||(t[6]=e=>r.exportData=e)},null,512),[[y,r.exportData]]),t[26]||(t[26]=s("span",{class:"checkmark"},null,-1)),t[27]||(t[27]=n(" Права доступа ",-1))]),l.dataType==="users"?(p(),d("label",q,[m(s("input",{type:"checkbox",value:"departments","onUpdate:modelValue":t[7]||(t[7]=e=>r.exportData=e)},null,512),[[y,r.exportData]]),t[28]||(t[28]=s("span",{class:"checkmark"},null,-1)),t[29]||(t[29]=n(" Информация об отделах ",-1))])):x("",!0)])]),l.dataType==="users"?(p(),d("div",K,[t[31]||(t[31]=s("label",{class:"option-label"},"Фильтры экспорта:",-1)),s("div",I,[(p(!0),d(v,null,k(a.appliedFilters,(e,b)=>(p(),d("div",{key:b,class:"filter-item"},[s("span",J,u(a.getFilterLabel(b))+":",1),s("span",R,u(a.formatFilterValue(b,e)),1)]))),128))])])):x("",!0)]),s("div",G,[s("div",H,[t[32]||(t[32]=s("span",{class:"estimation-label"},"Примерный размер файла:",-1)),s("span",P,u(a.estimatedFileSize),1)]),s("div",Q,[t[33]||(t[33]=s("span",{class:"estimation-label"},"Время подготовки:",-1)),s("span",W,u(a.estimatedTime),1)])]),t[34]||(t[34]=s("div",{class:"placeholder-note"},[s("strong",null,"Статус:"),n(" Функционал экспорта в разработке ")],-1))]),s("div",X,[s("button",{onClick:t[8]||(t[8]=e=>o.$emit("close")),class:"cancel-btn"},"Отмена"),s("button",{onClick:t[9]||(t[9]=(...e)=>a.startExport&&a.startExport(...e)),class:"export-btn",disabled:!a.canExport}," Экспортировать ",8,Y)])])])}const lt=g(F,[["render",Z],["__scopeId","data-v-78f0170e"]]);export{lt as default};
