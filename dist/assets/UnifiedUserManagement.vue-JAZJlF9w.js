import{_ as He}from"./main-CRD-9ltg.js";import{c as S,o as T,e as n,I as ze,b as V,t as $,g as l}from"./chunk-B18qXr3N.js";import"./chunk-CNxVt5Js.js";import"./chunk-C8Ia5wc2.js";import"./chunk-D-aTIMKk.js";const Je={name:"UnifiedUserManagement",props:{initialUsers:{type:Array,default:()=>[]},initialFilters:{type:Object,default:()=>({})},initialSelectedUser:{type:Object,default:null},config:{type:Object,default:()=>({enablePersistence:!0,enableKeyboardShortcuts:!0,defaultView:"global"})}},emits:["user-selected","context-changed","data-exported","permissions-updated","bulk-action-completed"],setup(a,{emit:i}){const{state:s,hasSelectedUsers:G,selectedUserStats:h,canEditPermissions:L,canDeleteUsers:u,contextTitle:tt,isContextGlobal:st,isContextUser:at,isContextManagement:it,loadUsers:R,loadGlobalMetrics:ot,selectUser:B,deselectUser:nt,switchToGlobal:j,switchToManagement:q,updateFilters:m,resetFilters:rt,saveFilterPreset:ct,loadFilterPreset:H,updateBreadcrumbs:lt,goBack:z,updateUserPermissions:J,toggleUserVisibility:Q,performBulkAction:I,refreshData:E,emitNotification:W}=useUnifiedUserManagement({enablePersistence:a.config.enablePersistence,defaultContext:a.config.defaultView}),{canGoBack:dt,canGoForward:ut,currentCrumb:mt,previousCrumb:vt,isAtRoot:ft,navigationPath:ht,navigateToContext:X,goBack:pt,navigateToCrumb:gt,goToRoot:yt,addCustomCrumb:Y,removeLastCrumb:Z,clearNavigation:wt,getNavigationHistory:bt,clearNavigationHistory:Ut}=useContextNavigation({enablePersistence:a.config.enablePersistence}),v=l(!1),p=l(!1),d=l(!1),g=l(null),y=l(null),f=l("users"),w=l(null),c=l(null),ee=computed(()=>s.loading),te=computed(()=>s.loadingMessage),se=computed(()=>!!s.error),ae=computed(()=>s.error),ie=computed(()=>s.currentContext),b=computed(()=>s.selectedUser),oe=computed(()=>s.selectedUsers),ne=computed(()=>s.breadcrumbs),re=computed(()=>s.filters),ce=computed(()=>s.filters),le=computed(()=>s.filteredUsers),de=computed(()=>s.pagination),ue=computed(()=>s.globalMetrics),me=computed(()=>s.viewOptions),ve=computed(()=>s.departments||[]),fe=computed(()=>s.activityTypes||[]),he=computed(()=>s.filterPresets||[]),pe=computed(()=>s.activePreset),ge=computed(()=>s.recentActivity||[]),ye=computed(()=>s.auditLog||[]),we=computed(()=>s.isNavigating),be=computed(()=>[{id:"change_department",label:"–ò–∑–º–µ–Ω–∏—Ç—å –æ—Ç–¥–µ–ª",icon:"BuildingIcon"},{id:"toggle_admin",label:"–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",icon:"ShieldIcon"},{id:"export",label:"–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö",icon:"DownloadIcon"},{id:"hide_users",label:"–°–∫—Ä—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",icon:"EyeOffIcon"}]),Ue=computed(()=>b.value?{timeline:[],sessions:[],stats:h.value,trends:{}}:{}),ke=async e=>{try{await B(e),i("user-selected",e)}catch{o("–û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è","error")}},Ce=e=>{s.selectedUsers=e},xe=e=>{m(e)},Pe=async e=>{await R({page:e})},Ae=e=>{Object.assign(s.viewOptions,e),localStorage.setItem("um-view-options",JSON.stringify(s.viewOptions))},Me=async(e,t)=>{try{switch(e){case"view-profile":await D(t);break;case"edit-permissions":await N(t);break;case"toggle-visibility":await Q(t.id);break;case"delete":confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${t.name}?`)&&await I("delete",[t.id]);break;default:console.warn("[UnifiedUserManagement] Unknown user action:",e)}}catch(r){o(`–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è: ${r.message}`,"error")}},Se=async e=>{try{e.action?await e.action():await X(e.context,e.data)}catch{o("–û—à–∏–±–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏","error")}},Te=async()=>{try{await z()||await j()}catch{o("–û—à–∏–±–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞","error")}},Be=e=>{switch(e.id){case"refresh":k();break;case"export":C();break;case"settings":F();break;default:console.warn("[UnifiedUserManagement] Unknown additional action:",e)}},Ie=()=>[{id:"refresh",text:"–û–±–Ω–æ–≤–∏—Ç—å",icon:"RefreshCwIcon",class:"refresh"},{id:"export",text:"–≠–∫—Å–ø–æ—Ä—Ç",icon:"DownloadIcon",class:"export"},{id:"settings",text:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏",icon:"SettingsIcon",class:"settings"}],D=async e=>{g.value=e,y.value=await K(e.id),v.value=!0},N=async e=>{await q({selectedUsers:[e]})},O=e=>{f.value="user",s.selectedUsers=[e],d.value=!0},Ee=()=>{O(b.value)},De=()=>{Y({id:"detailed-analysis",label:"–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑",icon:"BarChartIcon",action:()=>Z()})},Ne=async(e,t)=>{try{await J(e,t),o("–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã","success"),i("permissions-updated",{userId:e,permissions:t})}catch{o("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤","error")}},U=async(e,t)=>{try{await I(e,s.selectedUsers.map(r=>r.id),t),o(`–ú–∞—Å—Å–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ "${e}" –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`,"success"),i("bulk-action-completed",{action:e,data:t})}catch{o(`–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è "${e}"`,"error")}},k=async()=>{try{await E(),o("–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã","success")}catch{o("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö","error")}},C=()=>{f.value="users",d.value=!0},F=()=>{o("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ - —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ","info")},x=()=>{v.value=!1,g.value=null,y.value=null},Oe=async e=>{try{await new Promise(r=>setTimeout(r,500));const t=s.users.findIndex(r=>r.id===e.id);t!==-1&&(s.users[t]={...s.users[t],...e}),o("–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω","success"),x()}catch{o("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è","error")}},P=()=>{p.value=!1},Fe=async e=>{await U(e.id,e.data),P()},A=()=>{d.value=!1,f.value="users"},Ke=async e=>{try{await new Promise(t=>setTimeout(t,1e3)),o("–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω","success"),A(),i("data-exported",e)}catch{o("–û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞","error")}},_e=e=>{localStorage.setItem("um-sidebar-collapsed",e)},Ve=e=>{switch(e.id){case"active_users":m({activity_filter:"active"});break;case"new_users_today":m({time_range:"today",activity_filter:"new"});break}},$e=e=>{H(e.id),o(`–ü—Ä–∏–º–µ–Ω–µ–Ω —Ñ–∏–ª—å—Ç—Ä "${e.label}"`,"success")},Ge=e=>{console.log("Activity clicked:",e)},Le=e=>{m(e)},Re=async e=>{await U(e.action,e.users.map(t=>t.id))},K=async e=>(await new Promise(t=>setTimeout(t,300)),{timeline:[],sessions:[],stats:h.value}),je=async()=>{s.error=null;try{await E()}catch(e){s.error=e.message}},o=(e,t="info")=>{w.value={message:e,type:t},c.value&&clearTimeout(c.value),c.value=setTimeout(()=>{_()},5e3),W(e,t)},_=()=>{w.value=null,c.value&&(clearTimeout(c.value),c.value=null)},qe=()=>{const e=t=>{(t.ctrlKey||t.metaKey)&&t.key==="r"&&(t.preventDefault(),k()),(t.ctrlKey||t.metaKey)&&t.key==="e"&&(t.preventDefault(),C()),t.key==="Escape"&&(v.value?x():p.value?P():d.value&&A())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}};let M;return onMounted(async()=>{a.config.enableKeyboardShortcuts&&(M=qe());try{a.initialUsers.length>0&&(s.users=a.initialUsers),a.initialSelectedUser&&await B(a.initialSelectedUser),await nextTick()}catch(e){console.error("[UnifiedUserManagement] Initialization error:",e),s.error=e.message}}),onUnmounted(()=>{M&&M(),c.value&&clearTimeout(c.value)}),{showUserProfileModal:v,showBulkActionsModal:p,showExportModal:d,modalUser:g,modalActivityData:y,exportDataType:f,notification:w,isLoading:ee,loadingMessage:te,hasError:se,errorMessage:ae,currentContext:ie,selectedUser:b,selectedUsers:oe,breadcrumbs:ne,filters:re,userFilters:ce,filteredUsers:le,pagination:de,globalMetrics:ue,viewOptions:me,departments:ve,activityTypes:fe,filterPresets:he,activePreset:pe,recentActivity:ge,auditLog:ye,isNavigating:we,bulkActions:be,userActivityData:Ue,handleUserSelect:ke,handleUserSelectMultiple:Ce,handleFiltersChange:xe,handlePaginationChange:Pe,handleViewOptionsChange:Ae,handleUserAction:Me,handleBreadcrumbNavigate:Se,handleGoBack:Te,handleAdditionalAction:Be,getAdditionalActions:Ie,handleViewProfile:D,handleEditPermissions:N,handleExportData:O,handleExportUserData:Ee,handleViewDetailedAnalysis:De,handlePermissionsChange:Ne,handleBulkUpdate:U,handleRefresh:k,handleGlobalExport:C,handleSettings:F,closeUserProfileModal:x,handleUserProfileSave:Oe,closeBulkActionsModal:P,handleBulkActionExecute:Fe,closeExportModal:A,handleExportExecute:Ke,handleSidebarToggle:_e,handleMetricClick:Ve,handleFilterPresetApply:$e,handleActivityClick:Ge,handleUserFilterChange:Le,handleBulkAction:Re,loadUserActivityData:K,retryLoading:je,showNotification:o,closeNotification:_}}},Qe={class:"unified-user-management"},We={class:"test-content"},Xe={class:"test-actions"},Ye={key:0,class:"test-results"},Ze={key:1,class:"architecture-info"};function et(a,i,s,G,h,L){return T(),S("div",Qe,[i[5]||(i[5]=n("div",{class:"test-header"},[n("h1",null,"üéØ –ù–æ–≤—ã–π –µ–¥–∏–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"),n("p",null,"TASK-089: –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ —Å—Ç–∞—Ä–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞")],-1)),n("div",We,[i[4]||(i[4]=ze('<div class="status-grid" data-v-e8248669><div class="status-card" data-v-e8248669><h3 data-v-e8248669>‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ</h3><ul data-v-e8248669><li data-v-e8248669>–°—Ç–∞—Ä—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–¥–∞–ª–µ–Ω</li><li data-v-e8248669>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞</li><li data-v-e8248669>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã</li></ul></div><div class="status-card" data-v-e8248669><h3 data-v-e8248669>üîß –í —Ä–∞–±–æ—Ç–µ</h3><ul data-v-e8248669><li data-v-e8248669>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</li><li data-v-e8248669>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞</li><li data-v-e8248669>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ API</li></ul></div><div class="status-card" data-v-e8248669><h3 data-v-e8248669>üéØ –¶–µ–ª—å</h3><ul data-v-e8248669><li data-v-e8248669>–ï–¥–∏–Ω—ã–π drill-down –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</li><li data-v-e8248669>–ë–µ–∑ –∫–Ω–æ–ø–∫–∏ &quot;–î–∞—à–±–æ—Ä–¥ –∞–Ω–∞–ª–∏–∑–∞&quot;</li><li data-v-e8248669>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</li></ul></div></div>',1)),n("div",Xe,[n("button",{onClick:i[0]||(i[0]=(...u)=>a.testComponents&&a.testComponents(...u)),class:"test-btn"}," üß™ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã "),n("button",{onClick:i[1]||(i[1]=(...u)=>a.showArchitecture&&a.showArchitecture(...u)),class:"info-btn"}," üìã –ü–æ–∫–∞–∑–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É ")]),a.testResults?(T(),S("div",Ye,[i[2]||(i[2]=n("h3",null,"üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:",-1)),n("pre",null,$(a.testResults),1)])):V("",!0),a.architectureInfo?(T(),S("div",Ze,[i[3]||(i[3]=n("h3",null,"üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:",-1)),n("pre",null,$(a.architectureInfo),1)])):V("",!0)])])}const Mt=He(Je,[["render",et],["__scopeId","data-v-e8248669"]]);export{Mt as default};
